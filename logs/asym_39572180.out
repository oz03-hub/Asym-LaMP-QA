Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-08 13:50:21.440930_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-08 13:50:21.440930_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-08 13:50:21.440930_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<02:04,  3.22it/s]
  0%|          | 2/401 [00:00<01:48,  3.67it/s]
  1%|          | 3/401 [00:02<08:13,  1.24s/it]
  1%|          | 4/401 [00:04<08:43,  1.32s/it]
  1%|          | 5/401 [00:05<08:58,  1.36s/it]
  1%|▏         | 6/401 [00:07<09:12,  1.40s/it]
  2%|▏         | 7/401 [00:08<09:21,  1.43s/it]
  2%|▏         | 8/401 [00:10<09:17,  1.42s/it]
  2%|▏         | 9/401 [00:11<09:21,  1.43s/it]
  2%|▏         | 10/401 [00:12<07:26,  1.14s/it]
  3%|▎         | 11/401 [00:13<08:29,  1.31s/it]
  3%|▎         | 13/401 [00:15<07:03,  1.09s/it]
  3%|▎         | 14/401 [00:18<10:44,  1.66s/it]
  4%|▎         | 15/401 [00:19<08:06,  1.26s/it]
  4%|▍         | 17/401 [00:19<04:58,  1.29it/s]
  4%|▍         | 18/401 [00:20<06:18,  1.01it/s]
  5%|▍         | 19/401 [00:22<07:21,  1.16s/it]
  5%|▍         | 20/401 [00:26<12:22,  1.95s/it]
  5%|▌         | 21/401 [00:27<09:22,  1.48s/it]
  5%|▌         | 22/401 [00:31<14:00,  2.22s/it]
  6%|▌         | 23/401 [00:32<12:58,  2.06s/it]
  6%|▌         | 24/401 [00:36<16:50,  2.68s/it]
  6%|▌         | 25/401 [00:37<12:05,  1.93s/it]
  6%|▋         | 26/401 [00:37<08:52,  1.42s/it]
  7%|▋         | 27/401 [00:41<13:54,  2.23s/it]
  7%|▋         | 28/401 [00:41<10:16,  1.65s/it]
  7%|▋         | 29/401 [00:41<07:23,  1.19s/it]
  7%|▋         | 30/401 [00:43<07:35,  1.23s/it]
  8%|▊         | 31/401 [00:44<07:23,  1.20s/it]
  8%|▊         | 32/401 [00:44<05:30,  1.12it/s]
  8%|▊         | 33/401 [00:45<05:56,  1.03it/s]
  8%|▊         | 34/401 [00:47<07:45,  1.27s/it]
  9%|▊         | 35/401 [00:47<05:36,  1.09it/s]
  9%|▉         | 37/401 [00:48<03:35,  1.69it/s]
 10%|▉         | 39/401 [00:49<03:39,  1.65it/s]
 10%|█         | 41/401 [00:50<03:50,  1.56it/s]
 10%|█         | 42/401 [00:51<03:22,  1.77it/s]
 11%|█         | 43/401 [00:51<02:59,  2.00it/s]
 11%|█         | 44/401 [00:52<03:39,  1.62it/s]
 11%|█▏        | 46/401 [00:52<02:44,  2.15it/s]
 12%|█▏        | 47/401 [00:54<04:49,  1.22it/s]
 12%|█▏        | 48/401 [00:55<04:14,  1.39it/s]
 12%|█▏        | 49/401 [00:55<03:42,  1.58it/s]
 12%|█▏        | 50/401 [00:56<03:55,  1.49it/s]
 13%|█▎        | 51/401 [00:56<03:29,  1.67it/s]
 13%|█▎        | 53/401 [00:57<02:37,  2.21it/s]
 13%|█▎        | 54/401 [00:57<02:14,  2.57it/s]
 14%|█▎        | 55/401 [01:00<05:44,  1.01it/s]
 14%|█▍        | 56/401 [01:01<06:12,  1.08s/it]
 14%|█▍        | 57/401 [01:02<06:00,  1.05s/it]
 14%|█▍        | 58/401 [01:02<04:29,  1.28it/s]
 15%|█▍        | 59/401 [01:05<07:40,  1.35s/it]
 15%|█▍        | 60/401 [01:06<06:30,  1.15s/it]
 15%|█▌        | 61/401 [01:06<05:19,  1.07it/s]
 15%|█▌        | 62/401 [01:06<04:14,  1.33it/s]
 16%|█▌        | 63/401 [01:07<03:47,  1.48it/s]
 16%|█▌        | 64/401 [01:07<03:27,  1.63it/s]
 16%|█▌        | 65/401 [01:08<03:14,  1.73it/s]
 16%|█▋        | 66/401 [01:09<04:24,  1.26it/s]
 17%|█▋        | 67/401 [01:09<03:32,  1.57it/s]
 17%|█▋        | 68/401 [01:10<02:48,  1.98it/s]
 17%|█▋        | 69/401 [01:10<02:07,  2.60it/s]
 17%|█▋        | 70/401 [01:11<03:16,  1.69it/s]
 18%|█▊        | 71/401 [01:11<02:51,  1.93it/s]
 18%|█▊        | 72/401 [01:12<03:36,  1.52it/s]
 18%|█▊        | 73/401 [01:12<03:03,  1.79it/s]
 18%|█▊        | 74/401 [01:13<03:42,  1.47it/s]
 19%|█▊        | 75/401 [01:14<04:11,  1.30it/s]
 19%|█▉        | 76/401 [01:15<04:29,  1.21it/s]
 19%|█▉        | 77/401 [01:16<04:43,  1.14it/s]
 19%|█▉        | 78/401 [01:16<03:32,  1.52it/s]
 20%|█▉        | 79/401 [01:17<04:03,  1.32it/s]
 20%|█▉        | 80/401 [01:18<04:22,  1.22it/s]
 20%|██        | 81/401 [01:19<04:16,  1.25it/s]
 20%|██        | 82/401 [01:20<04:32,  1.17it/s]
 21%|██        | 83/401 [01:21<04:43,  1.12it/s]
 21%|██        | 84/401 [01:22<04:51,  1.09it/s]
 21%|██        | 85/401 [01:22<03:58,  1.32it/s]
 21%|██▏       | 86/401 [01:23<04:17,  1.22it/s]
 22%|██▏       | 87/401 [01:26<07:19,  1.40s/it]
 22%|██▏       | 88/401 [01:27<06:38,  1.27s/it]
 22%|██▏       | 89/401 [01:28<06:40,  1.28s/it]
 22%|██▏       | 90/401 [01:29<04:58,  1.04it/s]
 23%|██▎       | 91/401 [01:29<03:41,  1.40it/s]
 23%|██▎       | 92/401 [01:30<04:05,  1.26it/s]
 23%|██▎       | 93/401 [01:30<03:10,  1.62it/s]
 23%|██▎       | 94/401 [01:32<05:15,  1.03s/it]
 24%|██▎       | 95/401 [01:33<05:39,  1.11s/it]
 24%|██▍       | 96/401 [01:34<05:26,  1.07s/it]
 24%|██▍       | 97/401 [01:35<05:15,  1.04s/it]
 24%|██▍       | 98/401 [01:36<04:17,  1.18it/s]
 25%|██▍       | 99/401 [01:36<03:15,  1.55it/s]
 25%|██▍       | 100/401 [01:36<02:41,  1.86it/s]
 25%|██▌       | 101/401 [01:37<03:02,  1.64it/s]
 25%|██▌       | 102/401 [01:37<02:19,  2.15it/s]
 26%|██▌       | 103/401 [01:37<02:14,  2.22it/s]
 26%|██▌       | 104/401 [01:38<02:59,  1.65it/s]
 26%|██▌       | 105/401 [01:39<03:31,  1.40it/s]
 27%|██▋       | 107/401 [01:40<02:30,  1.95it/s]
 27%|██▋       | 108/401 [01:40<02:03,  2.37it/s]
 27%|██▋       | 109/401 [01:41<02:45,  1.76it/s]
 27%|██▋       | 110/401 [01:41<02:08,  2.27it/s]
 28%|██▊       | 111/401 [01:42<02:49,  1.71it/s]
 28%|██▊       | 112/401 [01:43<03:20,  1.44it/s]
 28%|██▊       | 113/401 [01:44<03:16,  1.47it/s]
 28%|██▊       | 114/401 [01:44<03:09,  1.52it/s]
 29%|██▊       | 115/401 [01:45<02:33,  1.86it/s]
 29%|██▉       | 116/401 [01:46<03:08,  1.51it/s]
 29%|██▉       | 117/401 [01:46<02:52,  1.65it/s]
 29%|██▉       | 118/401 [01:46<02:17,  2.06it/s]
 30%|██▉       | 119/401 [01:47<03:15,  1.44it/s]
 30%|██▉       | 120/401 [01:48<02:32,  1.84it/s]
 30%|███       | 121/401 [01:48<02:04,  2.25it/s]
 30%|███       | 122/401 [01:48<02:17,  2.03it/s]
 31%|███       | 123/401 [01:50<03:24,  1.36it/s]
 31%|███       | 124/401 [01:51<04:11,  1.10it/s]
 31%|███       | 125/401 [01:52<04:43,  1.03s/it]
 31%|███▏      | 126/401 [01:53<03:36,  1.27it/s]
 32%|███▏      | 127/401 [01:54<04:18,  1.06it/s]
 32%|███▏      | 128/401 [01:55<04:48,  1.06s/it]
 32%|███▏      | 129/401 [01:56<04:39,  1.03s/it]
 32%|███▏      | 130/401 [01:57<05:00,  1.11s/it]
 33%|███▎      | 131/401 [01:58<04:32,  1.01s/it]
 33%|███▎      | 132/401 [01:58<03:31,  1.27it/s]
 33%|███▎      | 133/401 [02:01<06:08,  1.38s/it]
 33%|███▎      | 134/401 [02:02<05:35,  1.26s/it]
 34%|███▎      | 135/401 [02:03<05:13,  1.18s/it]
 34%|███▍      | 136/401 [02:04<04:55,  1.12s/it]
 34%|███▍      | 137/401 [02:04<03:37,  1.21it/s]
 34%|███▍      | 138/401 [02:05<03:48,  1.15it/s]
 35%|███▍      | 139/401 [02:06<03:39,  1.19it/s]
 35%|███▍      | 140/401 [02:06<02:50,  1.53it/s]
 35%|███▌      | 141/401 [02:08<04:15,  1.02it/s]
 35%|███▌      | 142/401 [02:09<04:40,  1.08s/it]
 36%|███▌      | 143/401 [02:10<03:48,  1.13it/s]
 36%|███▌      | 144/401 [02:11<03:53,  1.10it/s]
 36%|███▌      | 145/401 [02:11<03:04,  1.39it/s]
 36%|███▋      | 146/401 [02:12<03:23,  1.25it/s]
 37%|███▋      | 147/401 [02:13<03:35,  1.18it/s]
 37%|███▋      | 148/401 [02:13<03:01,  1.40it/s]
 37%|███▋      | 149/401 [02:14<03:18,  1.27it/s]
 37%|███▋      | 150/401 [02:15<03:31,  1.19it/s]
 38%|███▊      | 151/401 [02:17<04:07,  1.01it/s]
 38%|███▊      | 152/401 [02:18<04:04,  1.02it/s]
 38%|███▊      | 153/401 [02:18<03:22,  1.22it/s]
 38%|███▊      | 154/401 [02:18<02:56,  1.40it/s]
 39%|███▊      | 155/401 [02:20<03:38,  1.13it/s]
 39%|███▉      | 156/401 [02:21<04:08,  1.01s/it]
 39%|███▉      | 157/401 [02:22<04:28,  1.10s/it]
 40%|███▉      | 159/401 [02:23<03:19,  1.21it/s]
 40%|███▉      | 160/401 [02:24<02:53,  1.39it/s]
 40%|████      | 162/401 [02:25<02:42,  1.47it/s]
 41%|████      | 163/401 [02:26<02:49,  1.40it/s]
 41%|████      | 164/401 [02:27<02:52,  1.37it/s]
 41%|████      | 165/401 [02:28<03:07,  1.26it/s]
 41%|████▏     | 166/401 [02:29<03:18,  1.18it/s]
 42%|████▏     | 167/401 [02:29<02:32,  1.54it/s]
 42%|████▏     | 168/401 [02:30<02:52,  1.35it/s]
 42%|████▏     | 169/401 [02:31<03:06,  1.25it/s]
 42%|████▏     | 170/401 [02:32<03:16,  1.17it/s]
 43%|████▎     | 171/401 [02:33<03:23,  1.13it/s]
 43%|████▎     | 172/401 [02:33<02:51,  1.33it/s]
 43%|████▎     | 173/401 [02:34<03:07,  1.22it/s]
 43%|████▎     | 174/401 [02:35<03:18,  1.14it/s]
 44%|████▎     | 175/401 [02:36<03:23,  1.11it/s]
 44%|████▍     | 176/401 [02:37<03:27,  1.09it/s]
 44%|████▍     | 177/401 [02:38<03:53,  1.04s/it]
 44%|████▍     | 178/401 [02:39<03:46,  1.02s/it]
 45%|████▍     | 179/401 [02:40<03:41,  1.00it/s]
 45%|████▍     | 180/401 [02:41<03:38,  1.01it/s]
 45%|████▌     | 181/401 [02:42<03:36,  1.01it/s]
 45%|████▌     | 182/401 [02:43<03:35,  1.01it/s]
 46%|████▌     | 183/401 [02:47<06:26,  1.77s/it]
 46%|████▌     | 184/401 [02:50<08:20,  2.31s/it]
 46%|████▌     | 185/401 [02:54<09:44,  2.70s/it]
 46%|████▋     | 186/401 [02:58<10:39,  2.98s/it]
 47%|████▋     | 187/401 [03:01<11:18,  3.17s/it]
 47%|████▋     | 188/401 [03:01<08:06,  2.28s/it]
 47%|████▋     | 189/401 [03:05<09:32,  2.70s/it]
 47%|████▋     | 190/401 [03:09<10:27,  2.97s/it]
 48%|████▊     | 191/401 [03:10<09:10,  2.62s/it]
 48%|████▊     | 192/401 [03:12<08:16,  2.38s/it]
 48%|████▊     | 193/401 [03:12<05:57,  1.72s/it]
 48%|████▊     | 194/401 [03:13<04:26,  1.29s/it]
 49%|████▊     | 195/401 [03:16<06:49,  1.99s/it]
 49%|████▉     | 196/401 [03:18<06:35,  1.93s/it]
 49%|████▉     | 197/401 [03:20<06:37,  1.95s/it]
 49%|████▉     | 198/401 [03:24<08:14,  2.43s/it]
 50%|████▉     | 199/401 [03:25<07:33,  2.25s/it]
 50%|████▉     | 200/401 [03:27<07:05,  2.12s/it]
 50%|█████     | 201/401 [03:29<06:46,  2.03s/it]
 50%|█████     | 202/401 [03:31<06:30,  1.96s/it]
 51%|█████     | 203/401 [03:33<06:19,  1.92s/it]
 51%|█████     | 204/401 [03:35<06:11,  1.89s/it]
 51%|█████     | 205/401 [03:35<04:26,  1.36s/it]
 51%|█████▏    | 206/401 [03:37<04:52,  1.50s/it]
 52%|█████▏    | 207/401 [03:38<05:10,  1.60s/it]
 52%|█████▏    | 208/401 [03:40<05:18,  1.65s/it]
 52%|█████▏    | 209/401 [03:41<04:05,  1.28s/it]
 52%|█████▏    | 210/401 [03:42<04:35,  1.44s/it]
 53%|█████▎    | 211/401 [03:43<03:55,  1.24s/it]
 53%|█████▎    | 212/401 [03:44<03:17,  1.04s/it]
 53%|█████▎    | 213/401 [03:44<03:01,  1.04it/s]
 53%|█████▎    | 214/401 [03:46<03:47,  1.22s/it]
 54%|█████▎    | 215/401 [03:47<03:12,  1.04s/it]
 54%|█████▍    | 216/401 [03:48<03:27,  1.12s/it]
 54%|█████▍    | 218/401 [03:49<02:19,  1.32it/s]
 55%|█████▍    | 219/401 [03:50<02:12,  1.38it/s]
 55%|█████▍    | 220/401 [03:50<02:06,  1.44it/s]
 55%|█████▌    | 221/401 [03:53<03:45,  1.25s/it]
 55%|█████▌    | 222/401 [03:54<03:12,  1.07s/it]
 56%|█████▌    | 223/401 [03:54<02:23,  1.24it/s]
 56%|█████▌    | 224/401 [03:54<01:58,  1.49it/s]
 56%|█████▌    | 225/401 [03:54<01:31,  1.93it/s]
 56%|█████▋    | 226/401 [03:54<01:10,  2.49it/s]
 57%|█████▋    | 227/401 [03:54<01:00,  2.89it/s]
 57%|█████▋    | 228/401 [03:55<01:16,  2.27it/s]
 57%|█████▋    | 229/401 [03:55<01:02,  2.76it/s]
 57%|█████▋    | 230/401 [03:57<02:04,  1.37it/s]
 58%|█████▊    | 231/401 [03:57<01:35,  1.78it/s]
 58%|█████▊    | 232/401 [03:58<01:35,  1.78it/s]
 58%|█████▊    | 234/401 [04:01<03:13,  1.16s/it]
 59%|█████▊    | 235/401 [04:02<02:38,  1.05it/s]
 59%|█████▉    | 236/401 [04:02<02:01,  1.36it/s]
 59%|█████▉    | 237/401 [04:02<01:53,  1.45it/s]
 59%|█████▉    | 238/401 [04:03<01:42,  1.59it/s]
 60%|█████▉    | 239/401 [04:03<01:41,  1.60it/s]
 60%|█████▉    | 240/401 [04:04<01:20,  2.00it/s]
 60%|██████    | 242/401 [04:04<00:52,  3.04it/s]
 61%|██████    | 243/401 [04:05<01:08,  2.31it/s]
 61%|██████    | 244/401 [04:05<01:05,  2.39it/s]
 61%|██████    | 245/401 [04:05<00:53,  2.94it/s]
 61%|██████▏   | 246/401 [04:06<01:04,  2.40it/s]
 62%|██████▏   | 247/401 [04:06<01:13,  2.11it/s]
 62%|██████▏   | 248/401 [04:06<00:56,  2.71it/s]
 62%|██████▏   | 249/401 [04:08<01:42,  1.48it/s]
 63%|██████▎   | 251/401 [04:08<01:07,  2.23it/s]
 63%|██████▎   | 252/401 [04:08<00:54,  2.72it/s]
 63%|██████▎   | 254/401 [04:09<00:42,  3.42it/s]
 64%|██████▎   | 255/401 [04:10<01:27,  1.67it/s]
 64%|██████▍   | 256/401 [04:11<01:16,  1.89it/s]
 64%|██████▍   | 257/401 [04:11<01:08,  2.09it/s]
 64%|██████▍   | 258/401 [04:11<01:03,  2.26it/s]
 65%|██████▍   | 259/401 [04:12<00:57,  2.46it/s]
 65%|██████▌   | 261/401 [04:12<00:53,  2.62it/s]
 65%|██████▌   | 262/401 [04:13<00:50,  2.73it/s]
 66%|██████▌   | 263/401 [04:13<00:49,  2.81it/s]
 66%|██████▌   | 264/401 [04:13<00:43,  3.18it/s]
 66%|██████▌   | 265/401 [04:14<00:43,  3.13it/s]
 66%|██████▋   | 266/401 [04:14<00:43,  3.10it/s]
 67%|██████▋   | 267/401 [04:14<00:36,  3.64it/s]
 67%|██████▋   | 268/401 [04:14<00:33,  4.03it/s]
 67%|██████▋   | 269/401 [04:15<00:45,  2.90it/s]
 67%|██████▋   | 270/401 [04:15<00:54,  2.38it/s]
 68%|██████▊   | 272/401 [04:16<00:34,  3.69it/s]
 68%|██████▊   | 273/401 [04:16<00:30,  4.15it/s]
 68%|██████▊   | 274/401 [04:16<00:26,  4.78it/s]
 69%|██████▊   | 275/401 [04:16<00:23,  5.34it/s]
 69%|██████▉   | 276/401 [04:16<00:22,  5.62it/s]
 69%|██████▉   | 277/401 [04:17<00:34,  3.64it/s]
 69%|██████▉   | 278/401 [04:17<00:29,  4.21it/s]
 70%|██████▉   | 279/401 [04:17<00:24,  4.91it/s]
 70%|██████▉   | 280/401 [04:17<00:31,  3.88it/s]
 70%|███████   | 281/401 [04:17<00:26,  4.55it/s]
 70%|███████   | 282/401 [04:18<00:22,  5.33it/s]
 71%|███████   | 283/401 [04:18<00:35,  3.35it/s]
 71%|███████   | 284/401 [04:18<00:35,  3.31it/s]
 71%|███████   | 285/401 [04:19<00:31,  3.66it/s]
 71%|███████▏  | 286/401 [04:19<00:32,  3.50it/s]
 72%|███████▏  | 287/401 [04:19<00:33,  3.42it/s]
 72%|███████▏  | 288/401 [04:19<00:28,  4.03it/s]
 72%|███████▏  | 289/401 [04:20<00:26,  4.21it/s]
 73%|███████▎  | 291/401 [04:20<00:25,  4.24it/s]
 73%|███████▎  | 292/401 [04:22<00:57,  1.88it/s]
 73%|███████▎  | 293/401 [04:22<01:09,  1.56it/s]
 73%|███████▎  | 294/401 [04:26<02:18,  1.29s/it]
 74%|███████▎  | 295/401 [04:26<01:42,  1.04it/s]
 74%|███████▍  | 296/401 [04:27<01:40,  1.04it/s]
 74%|███████▍  | 297/401 [04:27<01:15,  1.37it/s]
 74%|███████▍  | 298/401 [04:27<01:04,  1.61it/s]
 75%|███████▍  | 299/401 [04:29<01:28,  1.16it/s]
 75%|███████▍  | 300/401 [04:29<01:26,  1.17it/s]
 75%|███████▌  | 301/401 [04:30<01:04,  1.55it/s]
 75%|███████▌  | 302/401 [04:30<00:48,  2.05it/s]
 76%|███████▌  | 303/401 [04:30<00:58,  1.68it/s]
 76%|███████▌  | 304/401 [04:31<00:59,  1.62it/s]
 76%|███████▌  | 305/401 [04:32<01:13,  1.31it/s]
 76%|███████▋  | 306/401 [04:33<01:13,  1.29it/s]
 77%|███████▋  | 307/401 [04:34<01:18,  1.20it/s]
 77%|███████▋  | 308/401 [04:34<01:06,  1.40it/s]
 77%|███████▋  | 309/401 [04:35<01:03,  1.46it/s]
 77%|███████▋  | 310/401 [04:36<00:54,  1.66it/s]
 78%|███████▊  | 311/401 [04:36<00:59,  1.50it/s]
 78%|███████▊  | 312/401 [04:37<00:51,  1.72it/s]
 78%|███████▊  | 313/401 [04:37<00:40,  2.16it/s]
 78%|███████▊  | 314/401 [04:37<00:38,  2.24it/s]
 79%|███████▊  | 315/401 [04:38<00:32,  2.61it/s]
 79%|███████▉  | 316/401 [04:38<00:26,  3.16it/s]
 79%|███████▉  | 317/401 [04:39<00:54,  1.54it/s]
 79%|███████▉  | 318/401 [04:40<00:50,  1.64it/s]
 80%|███████▉  | 319/401 [04:40<00:41,  1.98it/s]
 80%|███████▉  | 320/401 [04:40<00:40,  2.01it/s]
 80%|████████  | 321/401 [04:41<00:39,  2.05it/s]
 80%|████████  | 322/401 [04:41<00:38,  2.06it/s]
 81%|████████  | 323/401 [04:45<01:46,  1.36s/it]
 81%|████████  | 324/401 [04:48<02:30,  1.96s/it]
 81%|████████  | 325/401 [04:51<03:01,  2.38s/it]
 81%|████████▏ | 326/401 [04:52<02:26,  1.96s/it]
 82%|████████▏ | 327/401 [04:53<01:59,  1.62s/it]
 82%|████████▏ | 328/401 [04:54<01:34,  1.29s/it]
 82%|████████▏ | 329/401 [04:55<01:40,  1.40s/it]
 82%|████████▏ | 330/401 [04:59<02:21,  1.99s/it]
 83%|████████▎ | 331/401 [05:00<01:57,  1.68s/it]
 83%|████████▎ | 332/401 [05:03<02:32,  2.21s/it]
 83%|████████▎ | 333/401 [05:07<02:53,  2.55s/it]
 83%|████████▎ | 334/401 [05:07<02:06,  1.89s/it]
 84%|████████▎ | 335/401 [05:10<02:34,  2.34s/it]
 84%|████████▍ | 336/401 [05:14<02:52,  2.66s/it]
 84%|████████▍ | 337/401 [05:15<02:20,  2.20s/it]
 84%|████████▍ | 338/401 [05:15<01:47,  1.70s/it]
 85%|████████▍ | 339/401 [05:16<01:23,  1.35s/it]
 85%|████████▍ | 340/401 [05:16<01:00,  1.00it/s]
 85%|████████▌ | 341/401 [05:16<00:43,  1.37it/s]
 85%|████████▌ | 342/401 [05:16<00:35,  1.66it/s]
 86%|████████▌ | 343/401 [05:17<00:33,  1.74it/s]
 86%|████████▌ | 344/401 [05:17<00:28,  2.01it/s]
 86%|████████▌ | 345/401 [05:19<00:43,  1.28it/s]
 86%|████████▋ | 346/401 [05:19<00:36,  1.50it/s]
 87%|████████▋ | 347/401 [05:20<00:30,  1.74it/s]
 87%|████████▋ | 348/401 [05:20<00:27,  1.90it/s]
 87%|████████▋ | 349/401 [05:20<00:23,  2.25it/s]
 87%|████████▋ | 350/401 [05:23<01:02,  1.23s/it]
 88%|████████▊ | 351/401 [05:27<01:33,  1.88s/it]
 88%|████████▊ | 352/401 [05:27<01:07,  1.38s/it]
 88%|████████▊ | 353/401 [05:30<01:36,  2.02s/it]
 89%|████████▊ | 355/401 [05:31<00:54,  1.19s/it]
 89%|████████▉ | 356/401 [05:34<01:14,  1.66s/it]
 89%|████████▉ | 357/401 [05:35<01:02,  1.41s/it]
 89%|████████▉ | 358/401 [05:36<00:57,  1.33s/it]
 90%|████████▉ | 359/401 [05:37<00:51,  1.23s/it]
 90%|████████▉ | 360/401 [05:38<00:46,  1.14s/it]
 90%|█████████ | 361/401 [05:38<00:37,  1.06it/s]
 90%|█████████ | 362/401 [05:38<00:29,  1.33it/s]
 91%|█████████ | 363/401 [05:39<00:23,  1.63it/s]
 91%|█████████ | 364/401 [05:39<00:17,  2.06it/s]
 91%|█████████ | 365/401 [05:41<00:30,  1.17it/s]
 91%|█████████▏| 366/401 [05:41<00:23,  1.49it/s]
 92%|█████████▏| 367/401 [05:41<00:21,  1.62it/s]
 92%|█████████▏| 368/401 [05:41<00:15,  2.14it/s]
 92%|█████████▏| 369/401 [05:42<00:13,  2.45it/s]
 92%|█████████▏| 370/401 [05:43<00:24,  1.25it/s]
 93%|█████████▎| 371/401 [05:45<00:32,  1.07s/it]
 93%|█████████▎| 372/401 [05:45<00:23,  1.26it/s]
 93%|█████████▎| 373/401 [05:47<00:30,  1.07s/it]
 93%|█████████▎| 374/401 [05:49<00:34,  1.27s/it]
 94%|█████████▎| 375/401 [05:50<00:36,  1.40s/it]
 94%|█████████▍| 376/401 [05:53<00:47,  1.89s/it]
 94%|█████████▍| 377/401 [05:54<00:34,  1.45s/it]
 94%|█████████▍| 378/401 [05:57<00:44,  1.95s/it]
 95%|█████████▍| 379/401 [06:00<00:52,  2.39s/it]
 95%|█████████▍| 380/401 [06:02<00:45,  2.19s/it]
 95%|█████████▌| 382/401 [06:05<00:35,  1.89s/it]
 96%|█████████▌| 383/401 [06:08<00:39,  2.19s/it]
 96%|█████████▌| 384/401 [06:11<00:37,  2.23s/it]
 96%|█████████▌| 385/401 [06:14<00:40,  2.54s/it]
 96%|█████████▋| 386/401 [06:15<00:31,  2.07s/it]
 97%|█████████▋| 387/401 [06:16<00:25,  1.85s/it]
 97%|█████████▋| 388/401 [06:17<00:21,  1.64s/it]
 97%|█████████▋| 389/401 [06:18<00:15,  1.30s/it]
 97%|█████████▋| 390/401 [06:18<00:11,  1.08s/it]
 98%|█████████▊| 391/401 [06:19<00:08,  1.21it/s]
 98%|█████████▊| 392/401 [06:20<00:08,  1.09it/s]
 98%|█████████▊| 393/401 [06:20<00:05,  1.43it/s]
 98%|█████████▊| 394/401 [06:20<00:03,  1.76it/s]
 99%|█████████▊| 395/401 [06:20<00:02,  2.02it/s]
 99%|█████████▉| 396/401 [06:24<00:06,  1.40s/it]
 99%|█████████▉| 397/401 [06:24<00:04,  1.06s/it]
 99%|█████████▉| 398/401 [06:28<00:05,  1.81s/it]
100%|█████████▉| 399/401 [06:31<00:04,  2.29s/it]
100%|█████████▉| 400/401 [06:31<00:01,  1.66s/it]
100%|██████████| 401/401 [06:32<00:00,  1.20s/it]
100%|██████████| 401/401 [06:32<00:00,  1.02it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-08 13:50:21.440930_ae_processed_test.json', '--output_addr', 'data/out/rag/asym/test_ae_output.json', '--temperature', '0.0', '--top_p', '0.95', '--max_tokens', '4096', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/work/pi_hzamani_umass_edu/ozel_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.11 examples/s]
Generating train split: 401 examples [00:00, 565.69 examples/s]
INFO 07-08 13:57:25 config.py:510] This model supports multiple tasks: {'score', 'reward', 'generate', 'embed', 'classify'}. Defaulting to 'generate'.
INFO 07-08 13:57:25 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/work/pi_hzamani_umass_edu/ozel_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-08 13:57:26 selector.py:120] Using Flash Attention backend.
INFO 07-08 13:57:27 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-08 13:57:28 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.57it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.50it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.51it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.56it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.55it/s]

INFO 07-08 13:57:31 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-08 13:57:33 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-08 13:57:33 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-08 13:57:33 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-08 13:57:33 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-08 13:57:33 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-08 13:57:36 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  3.04it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.35it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.47it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.53it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.56it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.59it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.58it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.60it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.59it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.61it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.63it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.65it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.66it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.67it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.67it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.66it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.70it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.75it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.77it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.79it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.80it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.81it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.83it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.83it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.84it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.85it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.84it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.85it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.77it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.82it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.84it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.87it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.81it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.85it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.88it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.73it/s]
INFO 07-08 13:57:45 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-08 13:57:45 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.34 seconds
RAG ON
EXAMPLE PROMPT
<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Is Boogiepop series connected to the Boogie music genre? Looking up the Oxford dictionary, the definition of "boogie" is:  A style of blues played on the piano with a strong, fast beat.From Wikipedia it is defined as:  Boogie (sometimes called post-disco) is a rhythm and blues genre of electronic dance music with close ties to the post-disco styleAs I am unfamiliar with the genre, I tried a few sample of boogie music. I don't really see it matches the atmosphere of the anime (neither the 2000 nor 2019 adaptation). Boogiepop himself "seems fond of whistling the prelude to Wagner's Die Meistersinger von Nürnberg" which is also not related to boogie genre.Also I don't see it too related to pop genre either.

Boogiepop and Others Promotional Trailer references 2019's "Boogiepop and Others" TV series has a promotional trailer. However the trailer is kind of "fake", because many footage are not present in the actual TV show.The main ones are:On Opera stageA man fighting a fire ability userBoogiepop walking closer to another girl, and the background switches with each swing from BoogiepopAre these referencing other unadapted stories in the series? If yes, which are those?
# Current post question:
Are the two music notes a reference?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
What happened to Hibiya and Hiyori after they broke out of the time loop? (It's been over four years since I watched Mekaku City Actors and it wasn't the most coherent anime, so please forgive me if I've gotten any details wrong or missed something obvious.)In the episode "Heat Haze Daze", Hibiya and Hiyori are trapped in an infinite time loop in which Hiyori keeps dying, and Hibiya keeps trying and failing to save her. They finally break out of the time loop (I presume) when   Hibiya sacrifices himself to save Hiyori's life.The next time we see them is when Haruka breaks open the back of a van to find them bound and gagged inside. I don't recall there ever being an explanation of how they got there.What happened to Hibiya and Hiyori between them breaking out of the time loop and Haruka finding them in the van? Who put them there, and why?

Why didn't Roberta kill these characters? In Part 4 of Black Lagoon: Roberta's Blood Trail, Shenhua attacks Roberta and is swiftly backed up by Sawyer and Rotton. Roberta breaks Sawyer's chainsaw and one of Shenhua's kukris, has the two held at gunpoint... then just kicks Rotton in the balls and walks away, sparing all three of them.I haven't watched Part 5 yet, but so far this is the only time Roberta has shown mercy in the entire OVA. Later on in Part 4, she reacts to Eda helping her by promising to kill her painlessly, yet here she spares three random strangers who were trying to kill her, two-thirds of whom were still armed in some capacity. I don't understand why.It could be that Roberta's just trying to catch up to the American soldiers and/or Garcia, and doesn't want to waste time killing them, but she doesn't seem to be in that much of a hurry - as I noted, she walks away from the incident in question. It could also just be that she's gone completely insane at this point, and trying to analyse her actions is a waste of time. But I'd like to try anyway.Why didn't Roberta kill Shenhua, Sawyer, and Rotton?To repeat: I haven't seen Part 5 yet, so I don't want to Google anything in case I stumble across any spoilers. If the answer is "watch Part 5", so be it.
# Current post question:
How come Neiru hasn't revived her sister yet?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Who was able to resist more punches from Saitama, Boros or Garou? It's known few characteres can resist punches from Saitama when he's half serious (probably only Boros, Garou and Orochi until now)Who was able to resist more punches from Saitama, Boros or Garou?

Was Suiryu or Garou who defeated Saitama in Virtual Reality? In OVA #4 season 2, Saitama is defeating playing Virtual Reality and Genos says the one who defeated might be able to defeat Saitama in real life. Then we see those moving to the finals of the competition are Suiryu and Garou.Was Suiryu or Garou who defeated Saitama in Virtual Reality?
# Current post question:
Was Saitama sweating with worry when he saw Garou in this scene?
<|im_end|>
<|im_start|>assistant

None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:12<1:21:00, 12.15s/it, est. speed input: 37.69 toks/s, output: 7.16 toks/s]
Processed prompts:   0%|          | 2/401 [00:12<34:39,  5.21s/it, est. speed input: 67.42 toks/s, output: 14.48 toks/s] 
Processed prompts:   1%|          | 3/401 [00:12<19:44,  2.98s/it, est. speed input: 107.18 toks/s, output: 22.00 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:13<06:57,  1.06s/it, est. speed input: 193.89 toks/s, output: 45.12 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:13<03:33,  1.83it/s, est. speed input: 298.85 toks/s, output: 74.24 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:13<02:11,  2.95it/s, est. speed input: 446.42 toks/s, output: 104.55 toks/s]
Processed prompts:   4%|▍         | 17/401 [00:14<01:36,  3.99it/s, est. speed input: 519.37 toks/s, output: 127.42 toks/s]
Processed prompts:   5%|▍         | 19/401 [00:14<01:22,  4.62it/s, est. speed input: 565.75 toks/s, output: 141.79 toks/s]
Processed prompts:   5%|▌         | 21/401 [00:14<01:07,  5.66it/s, est. speed input: 628.57 toks/s, output: 157.26 toks/s]
Processed prompts:   6%|▌         | 23/401 [00:14<00:59,  6.33it/s, est. speed input: 670.36 toks/s, output: 171.56 toks/s]
Processed prompts:   6%|▋         | 26/401 [00:14<00:49,  7.57it/s, est. speed input: 747.16 toks/s, output: 193.31 toks/s]
Processed prompts:   8%|▊         | 32/401 [00:15<00:34, 10.70it/s, est. speed input: 901.21 toks/s, output: 238.52 toks/s]
Processed prompts:   9%|▉         | 36/401 [00:15<00:28, 12.88it/s, est. speed input: 998.25 toks/s, output: 268.72 toks/s]
Processed prompts:  10%|▉         | 39/401 [00:15<00:27, 13.21it/s, est. speed input: 1071.92 toks/s, output: 289.70 toks/s]
Processed prompts:  10%|█         | 42/401 [00:15<00:24, 14.80it/s, est. speed input: 1164.48 toks/s, output: 311.77 toks/s]
Processed prompts:  11%|█         | 44/401 [00:15<00:26, 13.66it/s, est. speed input: 1202.56 toks/s, output: 324.39 toks/s]
Processed prompts:  11%|█▏        | 46/401 [00:16<00:24, 14.21it/s, est. speed input: 1247.30 toks/s, output: 338.47 toks/s]
Processed prompts:  12%|█▏        | 49/401 [00:16<00:22, 15.70it/s, est. speed input: 1364.35 toks/s, output: 359.97 toks/s]
Processed prompts:  13%|█▎        | 53/401 [00:16<00:21, 16.26it/s, est. speed input: 1434.50 toks/s, output: 387.49 toks/s]
Processed prompts:  15%|█▍        | 59/401 [00:16<00:19, 17.17it/s, est. speed input: 1603.69 toks/s, output: 428.59 toks/s]
Processed prompts:  16%|█▌        | 65/401 [00:17<00:19, 17.10it/s, est. speed input: 1803.12 toks/s, output: 468.03 toks/s]
Processed prompts:  18%|█▊        | 73/401 [00:17<00:17, 18.77it/s, est. speed input: 2046.67 toks/s, output: 521.63 toks/s]
Processed prompts:  19%|█▊        | 75/401 [00:17<00:18, 17.50it/s, est. speed input: 2088.23 toks/s, output: 532.65 toks/s]
Processed prompts:  19%|█▉        | 78/401 [00:17<00:18, 17.73it/s, est. speed input: 2167.70 toks/s, output: 551.59 toks/s]
Processed prompts:  20%|██        | 81/401 [00:18<00:19, 16.35it/s, est. speed input: 2233.04 toks/s, output: 568.21 toks/s]
Processed prompts:  21%|██        | 85/401 [00:18<00:18, 16.65it/s, est. speed input: 2308.86 toks/s, output: 592.35 toks/s]
Processed prompts:  22%|██▏       | 89/401 [00:18<00:20, 14.97it/s, est. speed input: 2377.45 toks/s, output: 612.89 toks/s]
Processed prompts:  23%|██▎       | 92/401 [00:18<00:20, 15.07it/s, est. speed input: 2447.90 toks/s, output: 629.69 toks/s]
Processed prompts:  23%|██▎       | 94/401 [00:19<00:21, 14.03it/s, est. speed input: 2485.80 toks/s, output: 639.11 toks/s]
Processed prompts:  24%|██▍       | 98/401 [00:19<00:19, 15.31it/s, est. speed input: 2572.93 toks/s, output: 662.70 toks/s]
Processed prompts:  26%|██▌       | 103/401 [00:19<00:17, 16.79it/s, est. speed input: 2666.74 toks/s, output: 692.39 toks/s]
Processed prompts:  27%|██▋       | 107/401 [00:19<00:19, 14.85it/s, est. speed input: 2754.42 toks/s, output: 710.84 toks/s]
Processed prompts:  28%|██▊       | 111/401 [00:20<00:18, 15.52it/s, est. speed input: 2828.07 toks/s, output: 732.80 toks/s]
Processed prompts:  28%|██▊       | 114/401 [00:20<00:19, 14.43it/s, est. speed input: 2877.63 toks/s, output: 746.23 toks/s]
Processed prompts:  29%|██▉       | 118/401 [00:20<00:16, 16.89it/s, est. speed input: 2965.55 toks/s, output: 770.89 toks/s]
Processed prompts:  30%|██▉       | 120/401 [00:20<00:18, 15.53it/s, est. speed input: 2982.73 toks/s, output: 779.45 toks/s]
Processed prompts:  31%|███       | 123/401 [00:20<00:16, 16.41it/s, est. speed input: 3054.99 toks/s, output: 796.12 toks/s]
Processed prompts:  32%|███▏      | 128/401 [00:21<00:15, 17.39it/s, est. speed input: 3159.43 toks/s, output: 823.54 toks/s]
Processed prompts:  33%|███▎      | 131/401 [00:21<00:14, 18.61it/s, est. speed input: 3218.72 toks/s, output: 840.95 toks/s]
Processed prompts:  34%|███▍      | 137/401 [00:21<00:15, 17.30it/s, est. speed input: 3335.86 toks/s, output: 870.42 toks/s]
Processed prompts:  35%|███▌      | 142/401 [00:21<00:14, 18.02it/s, est. speed input: 3458.42 toks/s, output: 896.97 toks/s]
Processed prompts:  36%|███▌      | 144/401 [00:21<00:15, 16.95it/s, est. speed input: 3486.86 toks/s, output: 905.35 toks/s]
Processed prompts:  38%|███▊      | 154/401 [00:22<00:08, 28.07it/s, est. speed input: 3731.94 toks/s, output: 972.67 toks/s]
Processed prompts:  41%|████      | 165/401 [00:22<00:05, 41.04it/s, est. speed input: 4008.13 toks/s, output: 1049.20 toks/s]
Processed prompts:  43%|████▎     | 172/401 [00:22<00:05, 45.09it/s, est. speed input: 4201.79 toks/s, output: 1096.45 toks/s]
Processed prompts:  45%|████▌     | 182/401 [00:22<00:03, 54.88it/s, est. speed input: 4411.44 toks/s, output: 1167.01 toks/s]
Processed prompts:  47%|████▋     | 189/401 [00:22<00:04, 52.29it/s, est. speed input: 4543.66 toks/s, output: 1213.45 toks/s]
Processed prompts:  49%|████▊     | 195/401 [00:22<00:03, 52.72it/s, est. speed input: 4747.45 toks/s, output: 1254.56 toks/s]
Processed prompts:  51%|█████     | 204/401 [00:22<00:03, 60.39it/s, est. speed input: 5012.42 toks/s, output: 1319.88 toks/s]
Processed prompts:  53%|█████▎    | 211/401 [00:22<00:03, 56.69it/s, est. speed input: 5214.21 toks/s, output: 1368.24 toks/s]
Processed prompts:  54%|█████▍    | 217/401 [00:23<00:03, 57.00it/s, est. speed input: 5395.29 toks/s, output: 1411.07 toks/s]
Processed prompts:  56%|█████▌    | 223/401 [00:23<00:03, 45.53it/s, est. speed input: 5581.64 toks/s, output: 1448.37 toks/s]
Processed prompts:  57%|█████▋    | 229/401 [00:23<00:03, 45.36it/s, est. speed input: 5720.45 toks/s, output: 1490.88 toks/s]
Processed prompts:  58%|█████▊    | 234/401 [00:24<00:07, 21.13it/s, est. speed input: 5734.23 toks/s, output: 1496.62 toks/s]
Processed prompts:  59%|█████▉    | 238/401 [00:24<00:08, 18.89it/s, est. speed input: 5784.06 toks/s, output: 1515.71 toks/s]
Processed prompts:  60%|██████    | 241/401 [00:24<00:09, 16.33it/s, est. speed input: 5806.90 toks/s, output: 1526.41 toks/s]
Processed prompts:  61%|██████    | 244/401 [00:24<00:08, 17.47it/s, est. speed input: 5862.97 toks/s, output: 1538.31 toks/s]
Processed prompts:  62%|██████▏   | 247/401 [00:24<00:09, 17.03it/s, est. speed input: 5913.03 toks/s, output: 1551.94 toks/s]
Processed prompts:  62%|██████▏   | 250/401 [00:25<00:10, 14.22it/s, est. speed input: 5915.68 toks/s, output: 1548.56 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [00:25<00:12, 12.36it/s, est. speed input: 5911.21 toks/s, output: 1549.20 toks/s]
Processed prompts:  64%|██████▍   | 257/401 [00:25<00:08, 17.22it/s, est. speed input: 6062.59 toks/s, output: 1568.78 toks/s]
Processed prompts:  66%|██████▌   | 263/401 [00:25<00:06, 22.39it/s, est. speed input: 6185.11 toks/s, output: 1600.76 toks/s]
Processed prompts:  67%|██████▋   | 269/401 [00:25<00:04, 26.72it/s, est. speed input: 6306.70 toks/s, output: 1626.14 toks/s]
Processed prompts:  68%|██████▊   | 274/401 [00:26<00:04, 30.23it/s, est. speed input: 6409.96 toks/s, output: 1649.35 toks/s]
Processed prompts:  70%|██████▉   | 280/401 [00:26<00:03, 36.23it/s, est. speed input: 6541.07 toks/s, output: 1675.69 toks/s]
Processed prompts:  72%|███████▏  | 287/401 [00:26<00:02, 43.74it/s, est. speed input: 6711.70 toks/s, output: 1709.13 toks/s]
Processed prompts:  73%|███████▎  | 292/401 [00:26<00:02, 40.30it/s, est. speed input: 6815.11 toks/s, output: 1731.20 toks/s]
Processed prompts:  74%|███████▍  | 298/401 [00:26<00:02, 42.73it/s, est. speed input: 6986.32 toks/s, output: 1765.46 toks/s]
Processed prompts:  77%|███████▋  | 309/401 [00:26<00:01, 56.63it/s, est. speed input: 7253.83 toks/s, output: 1824.99 toks/s]
Processed prompts:  79%|███████▉  | 317/401 [00:26<00:01, 57.23it/s, est. speed input: 7421.61 toks/s, output: 1870.49 toks/s]
Processed prompts:  81%|████████  | 325/401 [00:26<00:01, 58.19it/s, est. speed input: 7675.82 toks/s, output: 1908.52 toks/s]
Processed prompts:  84%|████████▎ | 335/401 [00:27<00:00, 67.27it/s, est. speed input: 7913.10 toks/s, output: 1969.44 toks/s]
Processed prompts:  86%|████████▌ | 343/401 [00:27<00:00, 70.35it/s, est. speed input: 8121.36 toks/s, output: 2024.48 toks/s]
Processed prompts:  88%|████████▊ | 353/401 [00:27<00:00, 71.40it/s, est. speed input: 8398.83 toks/s, output: 2087.85 toks/s]
Processed prompts:  90%|█████████ | 361/401 [00:27<00:00, 65.61it/s, est. speed input: 8578.86 toks/s, output: 2133.34 toks/s]
Processed prompts:  92%|█████████▏| 368/401 [00:27<00:00, 57.35it/s, est. speed input: 8709.06 toks/s, output: 2170.50 toks/s]
Processed prompts:  93%|█████████▎| 374/401 [00:27<00:00, 45.79it/s, est. speed input: 8802.93 toks/s, output: 2207.81 toks/s]
Processed prompts:  95%|█████████▍| 380/401 [00:27<00:00, 48.35it/s, est. speed input: 9010.92 toks/s, output: 2251.04 toks/s]
Processed prompts:  96%|█████████▋| 386/401 [00:28<00:00, 30.29it/s, est. speed input: 9116.75 toks/s, output: 2281.78 toks/s]
Processed prompts:  98%|█████████▊| 391/401 [00:28<00:00, 19.18it/s, est. speed input: 9157.99 toks/s, output: 2294.01 toks/s]
Processed prompts:  99%|█████████▊| 395/401 [00:29<00:00, 11.07it/s, est. speed input: 9014.98 toks/s, output: 2275.17 toks/s]
Processed prompts:  99%|█████████▉| 398/401 [00:30<00:00, 10.38it/s, est. speed input: 8987.92 toks/s, output: 2287.22 toks/s]
Processed prompts: 100%|█████████▉| 400/401 [00:30<00:00, 10.74it/s, est. speed input: 9001.26 toks/s, output: 2303.58 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:31<00:00, 12.74it/s, est. speed input: 8709.71 toks/s, output: 2234.71 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts on Sefaria are often used to enhance readability and provide additional context. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is typically used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) are often references to other texts or sources. The quotes (like ' and ") are used to denote direct speech or specific references. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּל חָכְמָה מֵיהוָה וִעָמְוָה הִיא לְעוֹלָמִים) are used to include additional information or to clarify the text. The hyphens between words are used to separate parts of a compound word. The italics are used to emphasize certain words or phrases. While these modern formatting elements can be removed to make the text more natural, they do provide important context and should be retained if you want to preserve the original meaning and structure of the text. As for the font, the earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which is a direct descendant of the Phoenician alphabet. The square script you see in modern Hebrew texts, known as Ktav Ashurith, evolved from the Aramaic script and was adopted by the Jews during the Babylonian captivity. So, while the Torah could have been written in Paleo-Hebrew, the square script is the most common and recognizable form used today."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.02s/it, est. speed input: 651.94 toks/s, output: 81.49 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.02s/it, est. speed input: 651.94 toks/s, output: 81.49 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are often used to enhance readability and provide additional context. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is typically used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) often indicate references to other texts or sources. The quotes (like ' and ") are used to denote direct speech or specific phrases. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּל חָכְמָה מֵיהוָה וִעָמְוָה הִיא לְעוֹלָמִים) are used to include additional information or to clarify the text. The italics and hyphens are used for stylistic or editorial purposes. While these modern formatting elements can be removed or changed to make the text more natural, they do not represent the original text's script or font. The earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which evolved into the modern Hebrew square script. The Samaritan script is a direct descendant of Paleo-Hebrew, and the Aramaic script developed later. The Torah, as we know it today, was likely written in the Paleo-Hebrew script, but over time, the square script became the standard. If you want to remove these modern elements, you can do so, but it's important to understand that they serve to clarify and enhance the text for modern readers."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.18s/it, est. speed input: 781.97 toks/s, output: 80.78 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.18s/it, est. speed input: 781.97 toks/s, output: 80.78 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts on Sefaria are primarily modern additions to make the texts more readable and accessible to contemporary readers. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is likely used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) and the brackets [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] are used to provide references or additional information. The quotes (like ' and ") are modern additions to denote speech or quotations. The use of parentheses and brackets is often to include additional commentary or references. The hyphens between words are likely used for clarity or to separate words that might otherwise run together. The italics are used for emphasis or to denote foreign words or names. While these modern additions can be helpful, if you want to remove them to make the text more 'natural' and closer to the original, you can do so. However, it's important to note that some of these elements, like the references and commentary, are part of the scholarly tradition and can provide valuable context. If you want to remove them, you can use a text editor or script to strip out these elements, but be aware that you might lose some of the scholarly insights and context."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.60s/it, est. speed input: 710.55 toks/s, output: 81.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.61s/it, est. speed input: 710.55 toks/s, output: 81.00 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in the Hebrew/Aramaic texts on Sefaria are modern additions that help with readability and provide context. The bold and italics are used to highlight specific names, phrases, or important sections. The large and small text sizes, such as <big><strong>ר' אהרן</strong></big>, are used to emphasize key figures or terms. Quotes, like ' and ", are used to denote speech or specific references. Parentheses and brackets, such as (תהלים ק\"ד, כ\"ד) and [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.], are used to provide additional information or references. Hyphens between words are used to clarify the meaning or pronunciation of certain terms. These modern additions are not part of the original texts and can be removed or changed to make the text more natural and closer to the original. For the earliest Hebrew texts, the script would have been Paleo-Hebrew, which is a direct descendant of the Phoenician alphabet. The Samaritan script and Aramaic script came later. The Torah, if written in its earliest form, would likely have been in Paleo-Hebrew. However, the exact script used for the Torah is a matter of tradition and interpretation, with some believing it to be Ktav Ashurith, the block script seen in modern Torah scrolls. To remove or change these modern additions, you can use text processing tools or scripts that identify and remove these formatting styles, making the text cleaner and more aligned with the original script."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.86s/it, est. speed input: 673.69 toks/s, output: 81.33 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.86s/it, est. speed input: 673.69 toks/s, output: 81.33 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts on Sefaria are modern additions meant to enhance readability and provide context. The bold and italics are used for emphasis, such as highlighting names or important phrases. The big text, like <big><strong>ר' אהרן</strong></big>, is often used to denote important figures or titles. The quotes, like ' and ", are used to indicate speech or quotations. The small parenthesized sections, like <small>(תהלים ק\"ד, כ\"ד)</small>, are references to other texts or passages. The brackets and parentheses, like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.), are used to include additional information or citations. The hyphens between words are used for clarity, especially in cases where words run together. These elements are not part of the original texts and can be removed or modified to make the text more natural. As for the script of the earliest Hebrew texts, they were likely written in Paleo-Hebrew, which is a direct descendant of the Phoenician alphabet. The square script you see in modern Torah scrolls, known as Ktav Ashurith, is a later development that evolved from Aramaic script. So, while the original texts would have been written in Paleo-Hebrew, the script you see on Sefaria is a more modern adaptation."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:07<00:00,  7.45s/it, est. speed input: 439.42 toks/s, output: 82.73 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:07<00:00,  7.45s/it, est. speed input: 439.42 toks/s, output: 82.73 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are primarily there for readability and to provide context. The small parentheses and quotes, like 'הקדמה:' and <small>(תהלים ק\"ד, כ\"ד)</small>, are used to denote footnotes, references, or additional information. The bold text, such as <big><strong>ר' אהרן</strong></big>, highlights important names or terms. The brackets and parentheses, like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (בן אריאל), are used to indicate editorial notes, translations, or clarifications. The italics and hyphens are often used for stylistic or typographical reasons. While these elements can be seen as 'modern' or 'English' additions, they are not part of the original texts and can be removed or changed to make the text more natural. If you want a cleaner version of the text, you can strip out these formatting elements, keeping only the core text. For example, the original text without these modern additions would look more like: \n\nהקדמה: ואמו\"ר הצדיקים הקדושים, כי מן זמן התגלות הבעל שם טוב הקדוש התחיל התנוצצות המשיח, והענין בודאי הוא אמת לאמתו, על פי מה דאיתא בספר הקדוש תולדות יעקב יוסף פ' וישב רל\"ג ע\"א, ומובא לקמן בספר זה בפרשת לך אות ב', כי סוד המשיח הוא סוד הדעת, וע\"ש בהגה ג', וזה מובן על פי פשוטו גם כן, כי כן כתב הרמב\"ם בפרק ט' מהלכות תשובה הלכה ב', וזה לשונו, ומפני זה נתאוו כל ישראל נביאיהם וחכמיהם לימות המשיח וכו', לפי שבאותן הימים תרבה הדעה והחכמה והאמת, שנאמר (ישעיהו י\"א:ט׳) כי מלאה האם דעה את ה' וכו' ע\"ש, ולקמן פ' שמות אות ט"ז העתקתי מס' תולדות יעקב יוסף סוף פ' וישלח, שזה היה ענין גאולת מצרים, מה שנתגלה הדעת על ידי משה רבינו עליו השלום, ובגאולה העתידה יתגלה הדעת ביתר שאת ויתר עוז, כי זה הדעת שנתגלה במצרים נקרא דעת דנוקבא, ובגאולה העתידה במהרה בימינו יתגלה דעת דדכורא ע\"ש היטב."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.21s/it, est. speed input: 526.65 toks/s, output: 82.25 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.21s/it, est. speed input: 526.65 toks/s, output: 82.25 toks/s]
[rank0]:[W708 13:58:51.464881666 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/test_ae_output.json
Cleaned temporary files.
