Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-08 16:33:58.993154_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-08 16:33:58.993154_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-08 16:33:58.993154_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<02:04,  3.22it/s]
  0%|          | 2/401 [00:00<01:45,  3.77it/s]
  1%|          | 3/401 [00:02<08:13,  1.24s/it]
  1%|          | 4/401 [00:04<08:43,  1.32s/it]
  1%|          | 5/401 [00:05<08:57,  1.36s/it]
  1%|▏         | 6/401 [00:07<09:12,  1.40s/it]
  2%|▏         | 7/401 [00:08<09:21,  1.43s/it]
  2%|▏         | 8/401 [00:10<09:18,  1.42s/it]
  2%|▏         | 9/401 [00:11<09:21,  1.43s/it]
  2%|▏         | 10/401 [00:12<07:26,  1.14s/it]
  3%|▎         | 11/401 [00:13<08:30,  1.31s/it]
  3%|▎         | 13/401 [00:15<07:03,  1.09s/it]
  3%|▎         | 14/401 [00:18<10:42,  1.66s/it]
  4%|▎         | 15/401 [00:19<08:05,  1.26s/it]
  4%|▍         | 17/401 [00:19<04:57,  1.29it/s]
  4%|▍         | 18/401 [00:20<06:17,  1.01it/s]
  5%|▍         | 19/401 [00:22<07:21,  1.15s/it]
  5%|▍         | 20/401 [00:26<12:21,  1.95s/it]
  5%|▌         | 21/401 [00:26<09:21,  1.48s/it]
  5%|▌         | 22/401 [00:31<13:59,  2.21s/it]
  6%|▌         | 23/401 [00:32<12:57,  2.06s/it]
  6%|▌         | 24/401 [00:36<16:49,  2.68s/it]
  6%|▌         | 25/401 [00:37<12:04,  1.93s/it]
  6%|▋         | 26/401 [00:37<08:51,  1.42s/it]
  7%|▋         | 27/401 [00:41<13:54,  2.23s/it]
  7%|▋         | 28/401 [00:41<10:16,  1.65s/it]
  7%|▋         | 29/401 [00:41<07:23,  1.19s/it]
  7%|▋         | 30/401 [00:43<07:36,  1.23s/it]
  8%|▊         | 31/401 [00:44<07:23,  1.20s/it]
  8%|▊         | 32/401 [00:44<05:30,  1.12it/s]
  8%|▊         | 33/401 [00:45<05:57,  1.03it/s]
  8%|▊         | 34/401 [00:47<07:47,  1.27s/it]
  9%|▊         | 35/401 [00:47<05:37,  1.08it/s]
  9%|▉         | 37/401 [00:48<03:36,  1.68it/s]
 10%|▉         | 39/401 [00:49<03:39,  1.65it/s]
 10%|█         | 41/401 [00:50<03:51,  1.56it/s]
 10%|█         | 42/401 [00:51<03:22,  1.77it/s]
 11%|█         | 43/401 [00:51<02:59,  1.99it/s]
 11%|█         | 44/401 [00:52<03:40,  1.62it/s]
 11%|█▏        | 46/401 [00:52<02:44,  2.15it/s]
 12%|█▏        | 47/401 [00:54<04:50,  1.22it/s]
 12%|█▏        | 48/401 [00:55<04:15,  1.38it/s]
 12%|█▏        | 49/401 [00:55<03:42,  1.58it/s]
 12%|█▏        | 50/401 [00:56<03:56,  1.49it/s]
 13%|█▎        | 51/401 [00:56<03:30,  1.66it/s]
 13%|█▎        | 53/401 [00:57<02:37,  2.20it/s]
 13%|█▎        | 54/401 [00:57<02:15,  2.57it/s]
 14%|█▎        | 55/401 [01:00<05:45,  1.00it/s]
 14%|█▍        | 56/401 [01:01<06:14,  1.09s/it]
 14%|█▍        | 57/401 [01:02<06:01,  1.05s/it]
 14%|█▍        | 58/401 [01:02<04:29,  1.27it/s]
 15%|█▍        | 59/401 [01:05<07:41,  1.35s/it]
 15%|█▍        | 60/401 [01:06<06:31,  1.15s/it]
 15%|█▌        | 61/401 [01:06<05:20,  1.06it/s]
 15%|█▌        | 62/401 [01:06<04:15,  1.33it/s]
 16%|█▌        | 63/401 [01:07<03:48,  1.48it/s]
 16%|█▌        | 64/401 [01:07<03:27,  1.62it/s]
 16%|█▌        | 65/401 [01:08<03:14,  1.72it/s]
 16%|█▋        | 66/401 [01:09<04:25,  1.26it/s]
 17%|█▋        | 67/401 [01:09<03:32,  1.57it/s]
 17%|█▋        | 68/401 [01:10<02:49,  1.96it/s]
 17%|█▋        | 69/401 [01:10<02:08,  2.58it/s]
 17%|█▋        | 70/401 [01:11<03:17,  1.68it/s]
 18%|█▊        | 71/401 [01:11<02:51,  1.92it/s]
 18%|█▊        | 72/401 [01:12<03:37,  1.51it/s]
 18%|█▊        | 73/401 [01:12<03:03,  1.79it/s]
 18%|█▊        | 74/401 [01:13<03:42,  1.47it/s]
 19%|█▊        | 75/401 [01:14<04:12,  1.29it/s]
 19%|█▉        | 76/401 [01:15<04:30,  1.20it/s]
 19%|█▉        | 77/401 [01:16<04:44,  1.14it/s]
 19%|█▉        | 78/401 [01:16<03:33,  1.52it/s]
 20%|█▉        | 79/401 [01:17<04:02,  1.33it/s]
 20%|█▉        | 80/401 [01:18<04:22,  1.22it/s]
 20%|██        | 81/401 [01:19<04:16,  1.25it/s]
 20%|██        | 82/401 [01:20<04:32,  1.17it/s]
 21%|██        | 83/401 [01:21<04:44,  1.12it/s]
 21%|██        | 84/401 [01:22<04:51,  1.09it/s]
 21%|██        | 85/401 [01:23<03:59,  1.32it/s]
 21%|██▏       | 86/401 [01:23<04:18,  1.22it/s]
 22%|██▏       | 87/401 [01:26<07:20,  1.40s/it]
 22%|██▏       | 88/401 [01:27<06:38,  1.27s/it]
 22%|██▏       | 89/401 [01:29<06:40,  1.28s/it]
 22%|██▏       | 90/401 [01:29<04:59,  1.04it/s]
 23%|██▎       | 91/401 [01:29<03:42,  1.39it/s]
 23%|██▎       | 92/401 [01:30<04:05,  1.26it/s]
 23%|██▎       | 93/401 [01:30<03:10,  1.62it/s]
 23%|██▎       | 94/401 [01:32<05:15,  1.03s/it]
 24%|██▎       | 95/401 [01:33<05:39,  1.11s/it]
 24%|██▍       | 96/401 [01:34<05:26,  1.07s/it]
 24%|██▍       | 97/401 [01:35<05:15,  1.04s/it]
 24%|██▍       | 98/401 [01:36<04:16,  1.18it/s]
 25%|██▍       | 99/401 [01:36<03:14,  1.55it/s]
 25%|██▍       | 100/401 [01:36<02:41,  1.86it/s]
 25%|██▌       | 101/401 [01:37<03:02,  1.64it/s]
 25%|██▌       | 102/401 [01:37<02:18,  2.15it/s]
 26%|██▌       | 103/401 [01:37<02:14,  2.22it/s]
 26%|██▌       | 104/401 [01:38<03:00,  1.65it/s]
 26%|██▌       | 105/401 [01:39<03:32,  1.39it/s]
 27%|██▋       | 107/401 [01:40<02:30,  1.95it/s]
 27%|██▋       | 108/401 [01:40<02:04,  2.36it/s]
 27%|██▋       | 109/401 [01:41<02:45,  1.76it/s]
 27%|██▋       | 110/401 [01:41<02:08,  2.27it/s]
 28%|██▊       | 111/401 [01:42<02:49,  1.71it/s]
 28%|██▊       | 112/401 [01:43<03:20,  1.44it/s]
 28%|██▊       | 113/401 [01:44<03:17,  1.46it/s]
 28%|██▊       | 114/401 [01:44<03:10,  1.51it/s]
 29%|██▊       | 115/401 [01:45<02:33,  1.86it/s]
 29%|██▉       | 116/401 [01:46<03:08,  1.51it/s]
 29%|██▉       | 117/401 [01:46<02:52,  1.64it/s]
 29%|██▉       | 118/401 [01:46<02:17,  2.06it/s]
 30%|██▉       | 119/401 [01:47<03:15,  1.44it/s]
 30%|██▉       | 120/401 [01:48<02:32,  1.84it/s]
 30%|███       | 121/401 [01:48<02:04,  2.25it/s]
 30%|███       | 122/401 [01:48<02:17,  2.03it/s]
 31%|███       | 123/401 [01:50<03:24,  1.36it/s]
 31%|███       | 124/401 [01:51<04:11,  1.10it/s]
 31%|███       | 125/401 [01:52<04:44,  1.03s/it]
 31%|███▏      | 126/401 [01:53<03:37,  1.26it/s]
 32%|███▏      | 127/401 [01:54<04:18,  1.06it/s]
 32%|███▏      | 128/401 [01:55<04:48,  1.06s/it]
 32%|███▏      | 129/401 [01:56<04:39,  1.03s/it]
 32%|███▏      | 130/401 [01:58<05:01,  1.11s/it]
 33%|███▎      | 131/401 [01:58<04:32,  1.01s/it]
 33%|███▎      | 132/401 [01:59<03:32,  1.27it/s]
 33%|███▎      | 133/401 [02:01<06:08,  1.38s/it]
 33%|███▎      | 134/401 [02:02<05:35,  1.26s/it]
 34%|███▎      | 135/401 [02:03<05:13,  1.18s/it]
 34%|███▍      | 136/401 [02:04<04:56,  1.12s/it]
 34%|███▍      | 137/401 [02:04<03:38,  1.21it/s]
 34%|███▍      | 138/401 [02:05<03:48,  1.15it/s]
 35%|███▍      | 139/401 [02:06<03:40,  1.19it/s]
 35%|███▍      | 140/401 [02:06<02:50,  1.53it/s]
 35%|███▌      | 141/401 [02:08<04:14,  1.02it/s]
 35%|███▌      | 142/401 [02:09<04:40,  1.08s/it]
 36%|███▌      | 143/401 [02:10<03:48,  1.13it/s]
 36%|███▌      | 144/401 [02:11<03:53,  1.10it/s]
 36%|███▌      | 145/401 [02:11<03:03,  1.39it/s]
 36%|███▋      | 146/401 [02:12<03:23,  1.25it/s]
 37%|███▋      | 147/401 [02:13<03:35,  1.18it/s]
 37%|███▋      | 148/401 [02:13<03:01,  1.39it/s]
 37%|███▋      | 149/401 [02:14<03:18,  1.27it/s]
 37%|███▋      | 150/401 [02:15<03:31,  1.19it/s]
 38%|███▊      | 151/401 [02:17<04:05,  1.02it/s]
 38%|███▊      | 152/401 [02:18<04:03,  1.02it/s]
 38%|███▊      | 153/401 [02:18<03:22,  1.23it/s]
 38%|███▊      | 154/401 [02:19<02:56,  1.40it/s]
 39%|███▊      | 155/401 [02:20<03:38,  1.12it/s]
 39%|███▉      | 156/401 [02:21<04:08,  1.02s/it]
 39%|███▉      | 157/401 [02:22<04:28,  1.10s/it]
 40%|███▉      | 159/401 [02:23<03:19,  1.21it/s]
 40%|███▉      | 160/401 [02:24<02:54,  1.38it/s]
 40%|████      | 162/401 [02:25<02:42,  1.47it/s]
 41%|████      | 163/401 [02:26<02:50,  1.40it/s]
 41%|████      | 164/401 [02:27<02:53,  1.37it/s]
 41%|████      | 165/401 [02:28<03:07,  1.26it/s]
 41%|████▏     | 166/401 [02:29<03:18,  1.18it/s]
 42%|████▏     | 167/401 [02:29<02:32,  1.54it/s]
 42%|████▏     | 168/401 [02:30<02:52,  1.35it/s]
 42%|████▏     | 169/401 [02:31<03:06,  1.24it/s]
 42%|████▏     | 170/401 [02:32<03:17,  1.17it/s]
 43%|████▎     | 171/401 [02:33<03:24,  1.13it/s]
 43%|████▎     | 172/401 [02:33<02:52,  1.33it/s]
 43%|████▎     | 173/401 [02:34<03:07,  1.22it/s]
 43%|████▎     | 174/401 [02:35<03:18,  1.14it/s]
 44%|████▎     | 175/401 [02:36<03:23,  1.11it/s]
 44%|████▍     | 176/401 [02:37<03:27,  1.08it/s]
 44%|████▍     | 177/401 [02:38<03:53,  1.04s/it]
 44%|████▍     | 178/401 [02:39<03:46,  1.02s/it]
 45%|████▍     | 179/401 [02:40<03:42,  1.00s/it]
 45%|████▍     | 180/401 [02:41<03:39,  1.01it/s]
 45%|████▌     | 181/401 [02:42<03:37,  1.01it/s]
 45%|████▌     | 182/401 [02:43<03:36,  1.01it/s]
 46%|████▌     | 183/401 [02:47<06:26,  1.78s/it]
 46%|████▌     | 184/401 [02:50<08:21,  2.31s/it]
 46%|████▌     | 185/401 [02:54<09:45,  2.71s/it]
 46%|████▋     | 186/401 [02:58<10:41,  2.98s/it]
 47%|████▋     | 187/401 [03:01<11:19,  3.18s/it]
 47%|████▋     | 188/401 [03:02<08:07,  2.29s/it]
 47%|████▋     | 189/401 [03:05<09:33,  2.71s/it]
 47%|████▋     | 190/401 [03:09<10:28,  2.98s/it]
 48%|████▊     | 191/401 [03:11<09:12,  2.63s/it]
 48%|████▊     | 192/401 [03:12<08:17,  2.38s/it]
 48%|████▊     | 193/401 [03:13<05:58,  1.72s/it]
 48%|████▊     | 194/401 [03:13<04:26,  1.29s/it]
 49%|████▊     | 195/401 [03:17<06:51,  2.00s/it]
 49%|████▉     | 196/401 [03:18<06:36,  1.93s/it]
 49%|████▉     | 197/401 [03:20<06:38,  1.95s/it]
 49%|████▉     | 198/401 [03:24<08:15,  2.44s/it]
 50%|████▉     | 199/401 [03:26<07:34,  2.25s/it]
 50%|████▉     | 200/401 [03:28<07:05,  2.12s/it]
 50%|█████     | 201/401 [03:29<06:46,  2.03s/it]
 50%|█████     | 202/401 [03:31<06:30,  1.96s/it]
 51%|█████     | 203/401 [03:33<06:20,  1.92s/it]
 51%|█████     | 204/401 [03:35<06:11,  1.89s/it]
 51%|█████     | 205/401 [03:35<04:26,  1.36s/it]
 51%|█████▏    | 206/401 [03:37<04:52,  1.50s/it]
 52%|█████▏    | 207/401 [03:39<05:11,  1.60s/it]
 52%|█████▏    | 208/401 [03:40<05:19,  1.66s/it]
 52%|█████▏    | 209/401 [03:41<04:05,  1.28s/it]
 52%|█████▏    | 210/401 [03:43<04:35,  1.44s/it]
 53%|█████▎    | 211/401 [03:43<03:56,  1.24s/it]
 53%|█████▎    | 212/401 [03:44<03:17,  1.05s/it]
 53%|█████▎    | 213/401 [03:45<03:01,  1.03it/s]
 53%|█████▎    | 214/401 [03:47<03:48,  1.22s/it]
 54%|█████▎    | 215/401 [03:47<03:13,  1.04s/it]
 54%|█████▍    | 216/401 [03:48<03:27,  1.12s/it]
 54%|█████▍    | 218/401 [03:49<02:19,  1.31it/s]
 55%|█████▍    | 219/401 [03:50<02:12,  1.38it/s]
 55%|█████▍    | 220/401 [03:50<02:06,  1.43it/s]
 55%|█████▌    | 221/401 [03:53<03:46,  1.26s/it]
 55%|█████▌    | 222/401 [03:54<03:12,  1.08s/it]
 56%|█████▌    | 223/401 [03:54<02:23,  1.24it/s]
 56%|█████▌    | 224/401 [03:54<01:59,  1.48it/s]
 56%|█████▌    | 225/401 [03:54<01:31,  1.92it/s]
 56%|█████▋    | 226/401 [03:55<01:10,  2.48it/s]
 57%|█████▋    | 227/401 [03:55<01:00,  2.88it/s]
 57%|█████▋    | 228/401 [03:55<01:16,  2.26it/s]
 57%|█████▋    | 229/401 [03:56<01:02,  2.75it/s]
 57%|█████▋    | 230/401 [03:57<02:04,  1.37it/s]
 58%|█████▊    | 231/401 [03:57<01:35,  1.78it/s]
 58%|█████▊    | 232/401 [03:58<01:35,  1.77it/s]
 58%|█████▊    | 234/401 [04:02<03:13,  1.16s/it]
 59%|█████▊    | 235/401 [04:02<02:38,  1.05it/s]
 59%|█████▉    | 236/401 [04:02<02:02,  1.35it/s]
 59%|█████▉    | 237/401 [04:03<01:53,  1.44it/s]
 59%|█████▉    | 238/401 [04:03<01:42,  1.59it/s]
 60%|█████▉    | 239/401 [04:04<01:41,  1.60it/s]
 60%|█████▉    | 240/401 [04:04<01:20,  2.00it/s]
 60%|██████    | 242/401 [04:04<00:52,  3.04it/s]
 61%|██████    | 243/401 [04:05<01:08,  2.30it/s]
 61%|██████    | 244/401 [04:05<01:05,  2.39it/s]
 61%|██████    | 245/401 [04:05<00:53,  2.93it/s]
 61%|██████▏   | 246/401 [04:06<01:04,  2.39it/s]
 62%|██████▏   | 247/401 [04:07<01:13,  2.10it/s]
 62%|██████▏   | 248/401 [04:07<00:56,  2.70it/s]
 62%|██████▏   | 249/401 [04:08<01:43,  1.47it/s]
 63%|██████▎   | 251/401 [04:09<01:07,  2.22it/s]
 63%|██████▎   | 252/401 [04:09<00:55,  2.71it/s]
 63%|██████▎   | 254/401 [04:09<00:43,  3.40it/s]
 64%|██████▎   | 255/401 [04:11<01:27,  1.66it/s]
 64%|██████▍   | 256/401 [04:11<01:17,  1.88it/s]
 64%|██████▍   | 257/401 [04:11<01:08,  2.09it/s]
 64%|██████▍   | 258/401 [04:12<01:03,  2.26it/s]
 65%|██████▍   | 259/401 [04:12<00:57,  2.45it/s]
 65%|██████▌   | 261/401 [04:13<00:53,  2.61it/s]
 65%|██████▌   | 262/401 [04:13<00:51,  2.72it/s]
 66%|██████▌   | 263/401 [04:13<00:49,  2.79it/s]
 66%|██████▌   | 264/401 [04:14<00:43,  3.17it/s]
 66%|██████▌   | 265/401 [04:14<00:43,  3.11it/s]
 66%|██████▋   | 266/401 [04:14<00:43,  3.08it/s]
 67%|██████▋   | 267/401 [04:14<00:37,  3.62it/s]
 67%|██████▋   | 268/401 [04:15<00:33,  4.01it/s]
 67%|██████▋   | 269/401 [04:15<00:45,  2.89it/s]
 67%|██████▋   | 270/401 [04:16<00:55,  2.37it/s]
 68%|██████▊   | 272/401 [04:16<00:35,  3.67it/s]
 68%|██████▊   | 273/401 [04:16<00:30,  4.14it/s]
 68%|██████▊   | 274/401 [04:16<00:26,  4.76it/s]
 69%|██████▊   | 275/401 [04:16<00:23,  5.32it/s]
 69%|██████▉   | 276/401 [04:17<00:22,  5.58it/s]
 69%|██████▉   | 277/401 [04:17<00:34,  3.63it/s]
 69%|██████▉   | 278/401 [04:17<00:29,  4.20it/s]
 70%|██████▉   | 279/401 [04:17<00:24,  4.90it/s]
 70%|██████▉   | 280/401 [04:18<00:31,  3.87it/s]
 70%|███████   | 281/401 [04:18<00:26,  4.54it/s]
 70%|███████   | 282/401 [04:18<00:22,  5.32it/s]
 71%|███████   | 283/401 [04:18<00:35,  3.35it/s]
 71%|███████   | 284/401 [04:19<00:35,  3.30it/s]
 71%|███████   | 285/401 [04:19<00:31,  3.66it/s]
 71%|███████▏  | 286/401 [04:19<00:32,  3.49it/s]
 72%|███████▏  | 287/401 [04:20<00:33,  3.40it/s]
 72%|███████▏  | 288/401 [04:20<00:28,  4.02it/s]
 72%|███████▏  | 289/401 [04:20<00:26,  4.20it/s]
 73%|███████▎  | 291/401 [04:20<00:26,  4.22it/s]
 73%|███████▎  | 292/401 [04:22<00:58,  1.87it/s]
 73%|███████▎  | 293/401 [04:23<01:09,  1.55it/s]
 73%|███████▎  | 294/401 [04:26<02:18,  1.29s/it]
 74%|███████▎  | 295/401 [04:26<01:42,  1.04it/s]
 74%|███████▍  | 296/401 [04:27<01:40,  1.04it/s]
 74%|███████▍  | 297/401 [04:27<01:15,  1.37it/s]
 74%|███████▍  | 298/401 [04:27<01:04,  1.61it/s]
 75%|███████▍  | 299/401 [04:29<01:28,  1.16it/s]
 75%|███████▍  | 300/401 [04:30<01:26,  1.17it/s]
 75%|███████▌  | 301/401 [04:30<01:04,  1.55it/s]
 75%|███████▌  | 302/401 [04:30<00:48,  2.05it/s]
 76%|███████▌  | 303/401 [04:31<00:58,  1.68it/s]
 76%|███████▌  | 304/401 [04:32<00:59,  1.62it/s]
 76%|███████▌  | 305/401 [04:33<01:13,  1.31it/s]
 76%|███████▋  | 306/401 [04:33<01:14,  1.28it/s]
 77%|███████▋  | 307/401 [04:34<01:18,  1.20it/s]
 77%|███████▋  | 308/401 [04:35<01:06,  1.39it/s]
 77%|███████▋  | 309/401 [04:35<01:03,  1.45it/s]
 77%|███████▋  | 310/401 [04:36<00:54,  1.66it/s]
 78%|███████▊  | 311/401 [04:37<01:00,  1.50it/s]
 78%|███████▊  | 312/401 [04:37<00:51,  1.72it/s]
 78%|███████▊  | 313/401 [04:37<00:40,  2.16it/s]
 78%|███████▊  | 314/401 [04:38<00:38,  2.24it/s]
 79%|███████▊  | 315/401 [04:38<00:32,  2.62it/s]
 79%|███████▉  | 316/401 [04:38<00:26,  3.16it/s]
 79%|███████▉  | 317/401 [04:40<00:54,  1.54it/s]
 79%|███████▉  | 318/401 [04:40<00:50,  1.65it/s]
 80%|███████▉  | 319/401 [04:40<00:41,  1.98it/s]
 80%|███████▉  | 320/401 [04:41<00:40,  2.01it/s]
 80%|████████  | 321/401 [04:41<00:39,  2.05it/s]
 80%|████████  | 322/401 [04:42<00:38,  2.06it/s]
 81%|████████  | 323/401 [04:45<01:46,  1.37s/it]
 81%|████████  | 324/401 [04:48<02:31,  1.96s/it]
 81%|████████  | 325/401 [04:52<03:01,  2.39s/it]
 81%|████████▏ | 326/401 [04:53<02:27,  1.96s/it]
 82%|████████▏ | 327/401 [04:54<02:00,  1.63s/it]
 82%|████████▏ | 328/401 [04:54<01:34,  1.29s/it]
 82%|████████▏ | 329/401 [04:56<01:40,  1.40s/it]
 82%|████████▏ | 330/401 [04:59<02:22,  2.00s/it]
 83%|████████▎ | 331/401 [05:00<01:58,  1.69s/it]
 83%|████████▎ | 332/401 [05:04<02:32,  2.21s/it]
 83%|████████▎ | 333/401 [05:07<02:54,  2.56s/it]
 83%|████████▎ | 334/401 [05:07<02:07,  1.90s/it]
 84%|████████▎ | 335/401 [05:11<02:35,  2.35s/it]
 84%|████████▍ | 336/401 [05:14<02:53,  2.66s/it]
 84%|████████▍ | 337/401 [05:15<02:20,  2.20s/it]
 84%|████████▍ | 338/401 [05:16<01:47,  1.70s/it]
 85%|████████▍ | 339/401 [05:16<01:23,  1.35s/it]
 85%|████████▍ | 340/401 [05:17<01:00,  1.00it/s]
 85%|████████▌ | 341/401 [05:17<00:43,  1.37it/s]
 85%|████████▌ | 342/401 [05:17<00:35,  1.65it/s]
 86%|████████▌ | 343/401 [05:17<00:33,  1.72it/s]
 86%|████████▌ | 344/401 [05:18<00:28,  1.99it/s]
 86%|████████▌ | 345/401 [05:19<00:44,  1.27it/s]
 86%|████████▋ | 346/401 [05:20<00:36,  1.49it/s]
 87%|████████▋ | 347/401 [05:20<00:31,  1.73it/s]
 87%|████████▋ | 348/401 [05:20<00:28,  1.89it/s]
 87%|████████▋ | 349/401 [05:21<00:23,  2.24it/s]
 87%|████████▋ | 350/401 [05:24<01:03,  1.24s/it]
 88%|████████▊ | 351/401 [05:27<01:34,  1.88s/it]
 88%|████████▊ | 352/401 [05:27<01:07,  1.38s/it]
 88%|████████▊ | 353/401 [05:31<01:36,  2.02s/it]
 89%|████████▊ | 355/401 [05:31<00:54,  1.19s/it]
 89%|████████▉ | 356/401 [05:34<01:14,  1.66s/it]
 89%|████████▉ | 357/401 [05:35<01:01,  1.41s/it]
 89%|████████▉ | 358/401 [05:36<00:57,  1.33s/it]
 90%|████████▉ | 359/401 [05:37<00:51,  1.23s/it]
 90%|████████▉ | 360/401 [05:38<00:46,  1.14s/it]
 90%|█████████ | 361/401 [05:39<00:37,  1.06it/s]
 90%|█████████ | 362/401 [05:39<00:29,  1.33it/s]
 91%|█████████ | 363/401 [05:39<00:23,  1.63it/s]
 91%|█████████ | 364/401 [05:39<00:17,  2.06it/s]
 91%|█████████ | 365/401 [05:41<00:30,  1.16it/s]
 91%|█████████▏| 366/401 [05:41<00:23,  1.49it/s]
 92%|█████████▏| 367/401 [05:42<00:21,  1.61it/s]
 92%|█████████▏| 368/401 [05:42<00:15,  2.13it/s]
 92%|█████████▏| 369/401 [05:42<00:13,  2.43it/s]
 92%|█████████▏| 370/401 [05:44<00:24,  1.25it/s]
 93%|█████████▎| 371/401 [05:46<00:32,  1.08s/it]
 93%|█████████▎| 372/401 [05:46<00:23,  1.25it/s]
 93%|█████████▎| 373/401 [05:47<00:30,  1.08s/it]
 93%|█████████▎| 374/401 [05:49<00:34,  1.27s/it]
 94%|█████████▎| 375/401 [05:51<00:36,  1.41s/it]
 94%|█████████▍| 376/401 [05:54<00:47,  1.90s/it]
 94%|█████████▍| 377/401 [05:54<00:35,  1.46s/it]
 94%|█████████▍| 378/401 [05:58<00:45,  1.96s/it]
 95%|█████████▍| 379/401 [06:01<00:52,  2.39s/it]
 95%|█████████▍| 380/401 [06:03<00:46,  2.20s/it]
 95%|█████████▌| 382/401 [06:06<00:36,  1.90s/it]
 96%|█████████▌| 383/401 [06:09<00:39,  2.19s/it]
 96%|█████████▌| 384/401 [06:11<00:37,  2.23s/it]
 96%|█████████▌| 385/401 [06:15<00:40,  2.55s/it]
 96%|█████████▋| 386/401 [06:15<00:31,  2.07s/it]
 97%|█████████▋| 387/401 [06:17<00:25,  1.85s/it]
 97%|█████████▋| 388/401 [06:18<00:21,  1.64s/it]
 97%|█████████▋| 389/401 [06:18<00:15,  1.30s/it]
 97%|█████████▋| 390/401 [06:19<00:11,  1.08s/it]
 98%|█████████▊| 391/401 [06:19<00:08,  1.21it/s]
 98%|█████████▊| 392/401 [06:20<00:08,  1.09it/s]
 98%|█████████▊| 393/401 [06:20<00:05,  1.42it/s]
 98%|█████████▊| 394/401 [06:21<00:04,  1.75it/s]
 99%|█████████▊| 395/401 [06:21<00:03,  2.00it/s]
 99%|█████████▉| 396/401 [06:25<00:07,  1.40s/it]
 99%|█████████▉| 397/401 [06:25<00:04,  1.07s/it]
 99%|█████████▉| 398/401 [06:28<00:05,  1.81s/it]
100%|█████████▉| 399/401 [06:32<00:04,  2.29s/it]
100%|█████████▉| 400/401 [06:32<00:01,  1.66s/it]
100%|██████████| 401/401 [06:32<00:00,  1.21s/it]
100%|██████████| 401/401 [06:32<00:00,  1.02it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-08 16:33:58.993154_ae_processed_test.json', '--output_addr', 'data/out/rag/full_profile/ae_rag_full_profile_test_2_output.json', '--temperature', '0.0', '--top_p', '0.95', '--max_tokens', '4096', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/work/pi_hzamani_umass_edu/ozel_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.01 examples/s]
Generating train split: 401 examples [00:00, 554.66 examples/s]
INFO 07-08 16:41:05 config.py:510] This model supports multiple tasks: {'embed', 'reward', 'score', 'generate', 'classify'}. Defaulting to 'generate'.
INFO 07-08 16:41:05 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/work/pi_hzamani_umass_edu/ozel_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-08 16:41:06 selector.py:120] Using Flash Attention backend.
INFO 07-08 16:41:07 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-08 16:41:07 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.47it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.42it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.40it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.43it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.43it/s]

INFO 07-08 16:41:11 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-08 16:41:13 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-08 16:41:13 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-08 16:41:13 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-08 16:41:13 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-08 16:41:13 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-08 16:41:16 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  2.85it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:10,  3.25it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.40it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.48it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.53it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.56it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:07,  3.58it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.60it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.58it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.60it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.62it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.63it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.64it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.65it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.65it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.66it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.70it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:05<00:04,  3.74it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.76it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.76it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.78it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.79it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.80it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.82it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.83it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.84it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.85it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.85it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.87it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.88it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.88it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.87it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.81it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.85it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.87it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.71it/s]
INFO 07-08 16:41:25 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-08 16:41:25 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.44 seconds
RAG ON
EXAMPLE PROMPT
<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Is Boogiepop series connected to the Boogie music genre? Looking up the Oxford dictionary, the definition of "boogie" is:  A style of blues played on the piano with a strong, fast beat.From Wikipedia it is defined as:  Boogie (sometimes called post-disco) is a rhythm and blues genre of electronic dance music with close ties to the post-disco styleAs I am unfamiliar with the genre, I tried a few sample of boogie music. I don't really see it matches the atmosphere of the anime (neither the 2000 nor 2019 adaptation). Boogiepop himself "seems fond of whistling the prelude to Wagner's Die Meistersinger von Nürnberg" which is also not related to boogie genre.Also I don't see it too related to pop genre either.

Boogiepop and Others Promotional Trailer references 2019's "Boogiepop and Others" TV series has a promotional trailer. However the trailer is kind of "fake", because many footage are not present in the actual TV show.The main ones are:On Opera stageA man fighting a fire ability userBoogiepop walking closer to another girl, and the background switches with each swing from BoogiepopAre these referencing other unadapted stories in the series? If yes, which are those?
# Current post question:
Are the two music notes a reference?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
What happened to Hibiya and Hiyori after they broke out of the time loop? (It's been over four years since I watched Mekaku City Actors and it wasn't the most coherent anime, so please forgive me if I've gotten any details wrong or missed something obvious.)In the episode "Heat Haze Daze", Hibiya and Hiyori are trapped in an infinite time loop in which Hiyori keeps dying, and Hibiya keeps trying and failing to save her. They finally break out of the time loop (I presume) when   Hibiya sacrifices himself to save Hiyori's life.The next time we see them is when Haruka breaks open the back of a van to find them bound and gagged inside. I don't recall there ever being an explanation of how they got there.What happened to Hibiya and Hiyori between them breaking out of the time loop and Haruka finding them in the van? Who put them there, and why?

Why didn't Roberta kill these characters? In Part 4 of Black Lagoon: Roberta's Blood Trail, Shenhua attacks Roberta and is swiftly backed up by Sawyer and Rotton. Roberta breaks Sawyer's chainsaw and one of Shenhua's kukris, has the two held at gunpoint... then just kicks Rotton in the balls and walks away, sparing all three of them.I haven't watched Part 5 yet, but so far this is the only time Roberta has shown mercy in the entire OVA. Later on in Part 4, she reacts to Eda helping her by promising to kill her painlessly, yet here she spares three random strangers who were trying to kill her, two-thirds of whom were still armed in some capacity. I don't understand why.It could be that Roberta's just trying to catch up to the American soldiers and/or Garcia, and doesn't want to waste time killing them, but she doesn't seem to be in that much of a hurry - as I noted, she walks away from the incident in question. It could also just be that she's gone completely insane at this point, and trying to analyse her actions is a waste of time. But I'd like to try anyway.Why didn't Roberta kill Shenhua, Sawyer, and Rotton?To repeat: I haven't seen Part 5 yet, so I don't want to Google anything in case I stumble across any spoilers. If the answer is "watch Part 5", so be it.
# Current post question:
How come Neiru hasn't revived her sister yet?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Who was able to resist more punches from Saitama, Boros or Garou? It's known few characteres can resist punches from Saitama when he's half serious (probably only Boros, Garou and Orochi until now)Who was able to resist more punches from Saitama, Boros or Garou?

Was Suiryu or Garou who defeated Saitama in Virtual Reality? In OVA #4 season 2, Saitama is defeating playing Virtual Reality and Genos says the one who defeated might be able to defeat Saitama in real life. Then we see those moving to the finals of the competition are Suiryu and Garou.Was Suiryu or Garou who defeated Saitama in Virtual Reality?
# Current post question:
Was Saitama sweating with worry when he saw Garou in this scene?
<|im_end|>
<|im_start|>assistant

None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:12<1:21:21, 12.20s/it, est. speed input: 37.53 toks/s, output: 7.13 toks/s]
Processed prompts:   0%|          | 2/401 [00:12<34:48,  5.23s/it, est. speed input: 67.12 toks/s, output: 14.41 toks/s] 
Processed prompts:   1%|          | 3/401 [00:12<19:50,  2.99s/it, est. speed input: 106.67 toks/s, output: 21.89 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:13<07:00,  1.06s/it, est. speed input: 192.96 toks/s, output: 44.91 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:13<03:35,  1.82it/s, est. speed input: 297.37 toks/s, output: 73.87 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:14<02:12,  2.93it/s, est. speed input: 444.19 toks/s, output: 104.03 toks/s]
Processed prompts:   4%|▍         | 17/401 [00:14<01:36,  3.97it/s, est. speed input: 516.77 toks/s, output: 126.78 toks/s]
Processed prompts:   5%|▍         | 19/401 [00:14<01:23,  4.59it/s, est. speed input: 562.91 toks/s, output: 141.07 toks/s]
Processed prompts:   5%|▌         | 21/401 [00:14<01:07,  5.63it/s, est. speed input: 625.40 toks/s, output: 156.47 toks/s]
Processed prompts:   6%|▌         | 23/401 [00:14<01:00,  6.29it/s, est. speed input: 666.95 toks/s, output: 170.69 toks/s]
Processed prompts:   6%|▋         | 26/401 [00:15<00:49,  7.52it/s, est. speed input: 743.36 toks/s, output: 192.32 toks/s]
Processed prompts:   8%|▊         | 32/401 [00:15<00:34, 10.63it/s, est. speed input: 896.60 toks/s, output: 237.30 toks/s]
Processed prompts:   9%|▉         | 36/401 [00:15<00:28, 12.81it/s, est. speed input: 993.18 toks/s, output: 267.35 toks/s]
Processed prompts:  10%|▉         | 39/401 [00:15<00:27, 13.13it/s, est. speed input: 1066.41 toks/s, output: 288.22 toks/s]
Processed prompts:  10%|█         | 42/401 [00:15<00:24, 14.71it/s, est. speed input: 1158.49 toks/s, output: 310.17 toks/s]
Processed prompts:  11%|█         | 44/401 [00:16<00:26, 13.56it/s, est. speed input: 1196.29 toks/s, output: 322.70 toks/s]
Processed prompts:  11%|█▏        | 46/401 [00:16<00:25, 14.10it/s, est. speed input: 1240.75 toks/s, output: 336.69 toks/s]
Processed prompts:  12%|█▏        | 49/401 [00:16<00:22, 15.56it/s, est. speed input: 1357.11 toks/s, output: 358.06 toks/s]
Processed prompts:  13%|█▎        | 53/401 [00:16<00:21, 16.13it/s, est. speed input: 1426.85 toks/s, output: 385.43 toks/s]
Processed prompts:  15%|█▍        | 59/401 [00:16<00:20, 17.03it/s, est. speed input: 1595.05 toks/s, output: 426.28 toks/s]
Processed prompts:  16%|█▌        | 65/401 [00:17<00:19, 16.96it/s, est. speed input: 1793.27 toks/s, output: 465.47 toks/s]
Processed prompts:  18%|█▊        | 73/401 [00:17<00:17, 18.65it/s, est. speed input: 2035.58 toks/s, output: 518.81 toks/s]
Processed prompts:  19%|█▊        | 75/401 [00:17<00:18, 17.37it/s, est. speed input: 2076.77 toks/s, output: 529.73 toks/s]
Processed prompts:  19%|█▉        | 78/401 [00:17<00:18, 17.63it/s, est. speed input: 2155.97 toks/s, output: 548.60 toks/s]
Processed prompts:  20%|██        | 81/401 [00:18<00:19, 16.25it/s, est. speed input: 2220.92 toks/s, output: 565.13 toks/s]
Processed prompts:  21%|██        | 85/401 [00:18<00:19, 16.57it/s, est. speed input: 2296.42 toks/s, output: 589.16 toks/s]
Processed prompts:  22%|██▏       | 89/401 [00:18<00:20, 14.90it/s, est. speed input: 2364.71 toks/s, output: 609.61 toks/s]
Processed prompts:  23%|██▎       | 92/401 [00:18<00:20, 15.02it/s, est. speed input: 2434.95 toks/s, output: 626.36 toks/s]
Processed prompts:  23%|██▎       | 94/401 [00:19<00:21, 13.98it/s, est. speed input: 2472.65 toks/s, output: 635.73 toks/s]
Processed prompts:  24%|██▍       | 98/401 [00:19<00:19, 15.21it/s, est. speed input: 2559.08 toks/s, output: 659.13 toks/s]
Processed prompts:  26%|██▌       | 103/401 [00:19<00:17, 16.71it/s, est. speed input: 2652.57 toks/s, output: 688.71 toks/s]
Processed prompts:  27%|██▋       | 107/401 [00:19<00:19, 14.80it/s, est. speed input: 2739.96 toks/s, output: 707.11 toks/s]
Processed prompts:  28%|██▊       | 111/401 [00:20<00:18, 15.48it/s, est. speed input: 2813.37 toks/s, output: 728.99 toks/s]
Processed prompts:  28%|██▊       | 114/401 [00:20<00:19, 14.37it/s, est. speed input: 2862.61 toks/s, output: 742.34 toks/s]
Processed prompts:  29%|██▉       | 118/401 [00:20<00:16, 16.83it/s, est. speed input: 2950.11 toks/s, output: 766.87 toks/s]
Processed prompts:  30%|██▉       | 120/401 [00:20<00:18, 15.46it/s, est. speed input: 2967.13 toks/s, output: 775.37 toks/s]
Processed prompts:  31%|███       | 123/401 [00:20<00:17, 16.34it/s, est. speed input: 3039.08 toks/s, output: 791.97 toks/s]
Processed prompts:  32%|███▏      | 128/401 [00:21<00:15, 17.28it/s, est. speed input: 3142.76 toks/s, output: 819.19 toks/s]
Processed prompts:  33%|███▎      | 131/401 [00:21<00:14, 18.50it/s, est. speed input: 3201.81 toks/s, output: 836.53 toks/s]
Processed prompts:  34%|███▍      | 137/401 [00:21<00:15, 17.26it/s, est. speed input: 3318.73 toks/s, output: 865.95 toks/s]
Processed prompts:  35%|███▌      | 142/401 [00:21<00:14, 17.99it/s, est. speed input: 3440.85 toks/s, output: 892.41 toks/s]
Processed prompts:  36%|███▌      | 144/401 [00:22<00:15, 16.90it/s, est. speed input: 3469.12 toks/s, output: 900.75 toks/s]
Processed prompts:  38%|███▊      | 154/401 [00:22<00:08, 27.96it/s, est. speed input: 3712.88 toks/s, output: 967.70 toks/s]
Processed prompts:  41%|████      | 165/401 [00:22<00:05, 40.83it/s, est. speed input: 3987.56 toks/s, output: 1043.81 toks/s]
Processed prompts:  43%|████▎     | 172/401 [00:22<00:05, 44.84it/s, est. speed input: 4180.16 toks/s, output: 1090.81 toks/s]
Processed prompts:  45%|████▌     | 182/401 [00:22<00:04, 54.47it/s, est. speed input: 4388.55 toks/s, output: 1160.96 toks/s]
Processed prompts:  47%|████▋     | 189/401 [00:22<00:04, 51.81it/s, est. speed input: 4519.86 toks/s, output: 1207.09 toks/s]
Processed prompts:  49%|████▊     | 195/401 [00:22<00:03, 51.88it/s, est. speed input: 4721.84 toks/s, output: 1247.80 toks/s]
Processed prompts:  51%|█████     | 204/401 [00:22<00:03, 59.48it/s, est. speed input: 4985.20 toks/s, output: 1312.72 toks/s]
Processed prompts:  53%|█████▎    | 211/401 [00:23<00:03, 55.90it/s, est. speed input: 5185.71 toks/s, output: 1360.76 toks/s]
Processed prompts:  54%|█████▍    | 217/401 [00:23<00:03, 56.28it/s, est. speed input: 5365.70 toks/s, output: 1403.33 toks/s]
Processed prompts:  56%|█████▌    | 223/401 [00:23<00:03, 45.06it/s, est. speed input: 5550.95 toks/s, output: 1440.40 toks/s]
Processed prompts:  57%|█████▋    | 228/401 [00:23<00:03, 45.98it/s, est. speed input: 5652.25 toks/s, output: 1476.24 toks/s]
Processed prompts:  58%|█████▊    | 233/401 [00:24<00:08, 20.71it/s, est. speed input: 5679.59 toks/s, output: 1481.22 toks/s]
Processed prompts:  59%|█████▉    | 237/401 [00:24<00:08, 19.17it/s, est. speed input: 5747.63 toks/s, output: 1501.85 toks/s]
Processed prompts:  60%|██████    | 241/401 [00:24<00:09, 16.33it/s, est. speed input: 5773.93 toks/s, output: 1517.75 toks/s]
Processed prompts:  61%|██████    | 244/401 [00:24<00:09, 17.41it/s, est. speed input: 5829.64 toks/s, output: 1529.57 toks/s]
Processed prompts:  62%|██████▏   | 247/401 [00:25<00:09, 16.97it/s, est. speed input: 5879.35 toks/s, output: 1543.10 toks/s]
Processed prompts:  62%|██████▏   | 250/401 [00:25<00:10, 14.19it/s, est. speed input: 5881.93 toks/s, output: 1539.73 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [00:25<00:12, 12.34it/s, est. speed input: 5877.37 toks/s, output: 1540.33 toks/s]
Processed prompts:  64%|██████▍   | 257/401 [00:25<00:08, 17.12it/s, est. speed input: 6027.81 toks/s, output: 1559.78 toks/s]
Processed prompts:  66%|██████▌   | 263/401 [00:25<00:06, 22.21it/s, est. speed input: 6149.55 toks/s, output: 1591.55 toks/s]
Processed prompts:  67%|██████▋   | 269/401 [00:26<00:04, 26.46it/s, est. speed input: 6270.22 toks/s, output: 1616.73 toks/s]
Processed prompts:  68%|██████▊   | 274/401 [00:26<00:04, 29.92it/s, est. speed input: 6372.73 toks/s, output: 1639.77 toks/s]
Processed prompts:  70%|██████▉   | 280/401 [00:26<00:03, 35.82it/s, est. speed input: 6502.86 toks/s, output: 1665.90 toks/s]
Processed prompts:  72%|███████▏  | 287/401 [00:26<00:02, 43.21it/s, est. speed input: 6672.29 toks/s, output: 1699.10 toks/s]
Processed prompts:  73%|███████▎  | 292/401 [00:26<00:02, 39.79it/s, est. speed input: 6774.77 toks/s, output: 1720.96 toks/s]
Processed prompts:  74%|███████▍  | 298/401 [00:26<00:02, 42.18it/s, est. speed input: 6944.72 toks/s, output: 1754.95 toks/s]
Processed prompts:  77%|███████▋  | 309/401 [00:26<00:01, 55.90it/s, est. speed input: 7210.44 toks/s, output: 1814.07 toks/s]
Processed prompts:  79%|███████▉  | 317/401 [00:26<00:01, 56.49it/s, est. speed input: 7376.93 toks/s, output: 1859.23 toks/s]
Processed prompts:  81%|████████  | 325/401 [00:27<00:01, 57.40it/s, est. speed input: 7629.28 toks/s, output: 1896.95 toks/s]
Processed prompts:  84%|████████▎ | 335/401 [00:27<00:00, 66.36it/s, est. speed input: 7864.88 toks/s, output: 1957.43 toks/s]
Processed prompts:  86%|████████▌ | 343/401 [00:27<00:00, 69.41it/s, est. speed input: 8071.65 toks/s, output: 2012.09 toks/s]
Processed prompts:  88%|████████▊ | 353/401 [00:27<00:00, 70.50it/s, est. speed input: 8347.23 toks/s, output: 2075.02 toks/s]
Processed prompts:  90%|█████████ | 361/401 [00:27<00:00, 64.82it/s, est. speed input: 8525.92 toks/s, output: 2120.17 toks/s]
Processed prompts:  92%|█████████▏| 368/401 [00:27<00:00, 56.65it/s, est. speed input: 8655.00 toks/s, output: 2157.02 toks/s]
Processed prompts:  93%|█████████▎| 374/401 [00:27<00:00, 45.21it/s, est. speed input: 8747.79 toks/s, output: 2193.98 toks/s]
Processed prompts:  95%|█████████▍| 380/401 [00:28<00:00, 47.76it/s, est. speed input: 8954.31 toks/s, output: 2236.90 toks/s]
Processed prompts:  96%|█████████▋| 386/401 [00:28<00:00, 29.95it/s, est. speed input: 9058.99 toks/s, output: 2267.33 toks/s]
Processed prompts:  98%|█████████▊| 391/401 [00:29<00:00, 19.02it/s, est. speed input: 9100.12 toks/s, output: 2279.51 toks/s]
Processed prompts:  99%|█████████▊| 395/401 [00:29<00:00, 10.99it/s, est. speed input: 8958.04 toks/s, output: 2260.80 toks/s]
Processed prompts:  99%|█████████▉| 398/401 [00:30<00:00, 10.31it/s, est. speed input: 8931.22 toks/s, output: 2272.79 toks/s]
Processed prompts: 100%|█████████▉| 400/401 [00:30<00:00, 10.67it/s, est. speed input: 8944.48 toks/s, output: 2289.05 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:31<00:00, 12.66it/s, est. speed input: 8654.21 toks/s, output: 2220.47 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts on Sefaria are often used to enhance readability and provide additional context. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is typically used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) are often references to other texts or sources. The quotes (like ' and ") are used to denote direct speech or specific references. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּל חָכְמָה מֵיהוָה וִעָמְוָה הִיא לְעוֹלָמִים) are used to include additional information or to clarify the text. The hyphens between words are used to separate parts of a compound word. The italics are used to emphasize certain words or phrases. While these modern formatting elements can be removed to make the text more natural, they do provide important context and should be retained if you want to preserve the original meaning and structure of the text. As for the font, the earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which is a direct descendant of the Phoenician alphabet. The square script you see in modern Hebrew texts, known as Ktav Ashurith, evolved from the Aramaic script and was adopted by the Jews during the Babylonian captivity. So, while the Torah could have been written in Paleo-Hebrew, the square script is the most common and recognizable form used today."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.06s/it, est. speed input: 646.79 toks/s, output: 80.85 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.06s/it, est. speed input: 646.79 toks/s, output: 80.85 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are often used to enhance readability and provide additional context. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is typically used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) often indicate references to other texts or sources. The quotes (like ' and ") are used to denote direct speech or specific phrases. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּל חָכְמָה מֵיהוָה וִעָמְוָה הִיא לְעוֹלָמִים) are used to include additional information or to clarify the text. The italics and hyphens are used for stylistic or editorial purposes. While these modern formatting elements can be removed or changed to make the text more natural, they do not represent the original text's script or font. The earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which evolved into the modern Hebrew square script. The Samaritan script is a direct descendant of Paleo-Hebrew, and the Aramaic script developed later. The Torah, as we know it today, was likely written in the Paleo-Hebrew script, but over time, the square script became the standard. If you want to remove these modern elements, you can do so, but it's important to understand that they serve to clarify and enhance the text for modern readers."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.22s/it, est. speed input: 776.09 toks/s, output: 80.17 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.22s/it, est. speed input: 776.09 toks/s, output: 80.17 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts on Sefaria are primarily modern additions to make the texts more readable and accessible to contemporary readers. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is likely used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) and the brackets [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] are used to provide references or additional information. The quotes (like ' and ") are modern additions to denote speech or quotations. The use of parentheses and brackets is often to include additional commentary or references. The hyphens between words are likely used for clarity or to separate words that might otherwise run together. The italics are used for emphasis or to denote foreign words or names. While these modern additions can be helpful, if you want to remove them to make the text more 'natural' and closer to the original, you can do so. However, it's important to note that some of these elements, like the references and commentary, are part of the scholarly tradition and can provide valuable context. If you want to remove them, you can use a text editor or script to strip out these elements, but be aware that you might lose some of the scholarly insights and context."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.64s/it, est. speed input: 705.16 toks/s, output: 80.39 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.64s/it, est. speed input: 705.16 toks/s, output: 80.39 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in the Hebrew/Aramaic texts on Sefaria are modern additions that help with readability and provide context. The bold and italics are used to highlight specific names, phrases, or important sections. The large and small text sizes, such as <big><strong>ר' אהרן</strong></big>, are used to emphasize key figures or terms. Quotes, like ' and ", are used to denote speech or specific references. Parentheses and brackets, such as (תהלים ק\"ד, כ\"ד) and [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.], are used to provide additional information or references. Hyphens between words are used to clarify the meaning or pronunciation of certain terms. These modern additions are not part of the original texts and can be removed or changed to make the text more natural and closer to the original. For the earliest Hebrew texts, the script would have been Paleo-Hebrew, which is a direct descendant of the Phoenician alphabet. The Samaritan script and Aramaic script came later. The Torah, if written in its earliest form, would likely have been in Paleo-Hebrew. However, the exact script used for the Torah is a matter of tradition and interpretation, with some believing it to be Ktav Ashurith, the block script seen in modern Torah scrolls. To remove or change these modern additions, you can use text processing tools or scripts that identify and remove these formatting styles, making the text cleaner and more aligned with the original script."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.89s/it, est. speed input: 668.49 toks/s, output: 80.70 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.89s/it, est. speed input: 668.49 toks/s, output: 80.70 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts on Sefaria are modern additions meant to enhance readability and provide context. The bold and italics are used for emphasis, such as highlighting names or important phrases. The big text, like <big><strong>ר' אהרן</strong></big>, is often used to denote important figures or titles. The quotes, like ' and ", are used to indicate speech or quotations. The small parenthesized sections, like <small>(תהלים ק\"ד, כ\"ד)</small>, are references to other texts or passages. The brackets and parentheses, like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.), are used to include additional information or citations. The hyphens between words are used for clarity, especially in cases where words run together. These elements are not part of the original texts and can be removed or modified to make the text more natural. As for the script of the earliest Hebrew texts, they were likely written in Paleo-Hebrew, which is a direct descendant of the Phoenician alphabet. The square script you see in modern Torah scrolls, known as Ktav Ashurith, is a later development that evolved from Aramaic script. So, while the original texts would have been written in Paleo-Hebrew, the script you see on Sefaria is a more modern adaptation."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:07<00:00,  7.51s/it, est. speed input: 435.94 toks/s, output: 82.07 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:07<00:00,  7.51s/it, est. speed input: 435.94 toks/s, output: 82.07 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are primarily there for readability and to provide context. The small parentheses and quotes, like 'הקדמה:' and <small>(תהלים ק\"ד, כ\"ד)</small>, are used to denote footnotes, references, or additional information. The bold text, such as <big><strong>ר' אהרן</strong></big>, highlights important names or terms. The brackets and parentheses, like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (בן אריאל), are used to indicate editorial notes, translations, or clarifications. The italics and hyphens are often used for stylistic or typographical reasons. While these elements can be seen as 'modern' or 'English' additions, they are not part of the original texts and can be removed or changed to make the text more natural. If you want a cleaner version of the text, you can strip out these formatting elements, keeping only the core text. For example, the original text without these modern additions would look more like: \n\nהקדמה: ואמו\"ר הצדיקים הקדושים, כי מן זמן התגלות הבעל שם טוב הקדוש התחיל התנוצצות המשיח, והענין בודאי הוא אמת לאמתו, על פי מה דאיתא בספר הקדוש תולדות יעקב יוסף פ' וישב רל\"ג ע\"א, ומובא לקמן בספר זה בפרשת לך אות ב', כי סוד המשיח הוא סוד הדעת, וע\"ש בהגה ג', וזה מובן על פי פשוטו גם כן, כי כן כתב הרמב\"ם בפרק ט' מהלכות תשובה הלכה ב', וזה לשונו, ומפני זה נתאוו כל ישראל נביאיהם וחכמיהם לימות המשיח וכו', לפי שבאותן הימים תרבה הדעה והחכמה והאמת, שנאמר (ישעיהו י\"א:ט׳) כי מלאה האם דעה את ה' וכו' ע\"ש, ולקמן פ' שמות אות ט"ז העתקתי מס' תולדות יעקב יוסף סוף פ' וישלח, שזה היה ענין גאולת מצרים, מה שנתגלה הדעת על ידי משה רבינו עליו השלום, ובגאולה העתידה יתגלה הדעת ביתר שאת ויתר עוז, כי זה הדעת שנתגלה במצרים נקרא דעת דנוקבא, ובגאולה העתידה במהרה בימינו יתגלה דעת דדכורא ע\"ש היטב."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.26s/it, est. speed input: 522.52 toks/s, output: 81.60 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.26s/it, est. speed input: 522.52 toks/s, output: 81.60 toks/s]
[rank0]:[W708 16:42:31.016571049 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/ae_rag_full_profile_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-08 16:42:35.718999_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-08 16:42:35.718999_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-08 16:42:35.718999_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:36,  3.35it/s]
  1%|          | 3/526 [00:00<01:22,  6.35it/s]
  1%|          | 5/526 [00:00<00:56,  9.15it/s]
  1%|▏         | 7/526 [00:00<00:44, 11.55it/s]
  2%|▏         | 9/526 [00:01<01:45,  4.91it/s]
  2%|▏         | 11/526 [00:01<01:19,  6.44it/s]
  2%|▏         | 13/526 [00:02<01:32,  5.53it/s]
  3%|▎         | 15/526 [00:02<01:17,  6.58it/s]
  3%|▎         | 16/526 [00:02<01:19,  6.39it/s]
  3%|▎         | 18/526 [00:02<01:03,  8.03it/s]
  4%|▍         | 20/526 [00:03<01:18,  6.47it/s]
  4%|▍         | 21/526 [00:04<02:53,  2.92it/s]
  4%|▍         | 22/526 [00:04<03:00,  2.80it/s]
  4%|▍         | 23/526 [00:05<03:43,  2.25it/s]
  5%|▍         | 24/526 [00:06<04:19,  1.93it/s]
  5%|▍         | 25/526 [00:07<05:28,  1.52it/s]
  5%|▍         | 26/526 [00:07<04:39,  1.79it/s]
  5%|▌         | 27/526 [00:07<03:41,  2.25it/s]
  5%|▌         | 28/526 [00:07<03:34,  2.32it/s]
  6%|▌         | 30/526 [00:09<04:47,  1.73it/s]
  6%|▌         | 31/526 [00:10<04:39,  1.77it/s]
  6%|▌         | 32/526 [00:10<03:58,  2.07it/s]
  6%|▋         | 33/526 [00:11<05:45,  1.43it/s]
  6%|▋         | 34/526 [00:12<05:59,  1.37it/s]
  7%|▋         | 35/526 [00:13<06:35,  1.24it/s]
  7%|▋         | 36/526 [00:13<05:07,  1.60it/s]
  7%|▋         | 37/526 [00:13<04:25,  1.84it/s]
  7%|▋         | 39/526 [00:13<02:35,  3.13it/s]
  8%|▊         | 40/526 [00:14<02:20,  3.46it/s]
  8%|▊         | 42/526 [00:14<01:47,  4.50it/s]
  8%|▊         | 43/526 [00:14<02:26,  3.30it/s]
  9%|▊         | 45/526 [00:15<01:44,  4.62it/s]
  9%|▊         | 46/526 [00:15<01:50,  4.33it/s]
  9%|▉         | 47/526 [00:15<02:07,  3.77it/s]
  9%|▉         | 48/526 [00:16<02:42,  2.94it/s]
 10%|▉         | 50/526 [00:16<02:06,  3.76it/s]
 10%|▉         | 52/526 [00:16<01:36,  4.89it/s]
 10%|█         | 53/526 [00:18<03:27,  2.28it/s]
 10%|█         | 54/526 [00:21<08:51,  1.13s/it]
 11%|█         | 56/526 [00:21<05:29,  1.43it/s]
 11%|█         | 58/526 [00:22<04:27,  1.75it/s]
 11%|█         | 59/526 [00:23<04:45,  1.64it/s]
 11%|█▏        | 60/526 [00:24<05:07,  1.52it/s]
 12%|█▏        | 61/526 [00:24<05:01,  1.54it/s]
 12%|█▏        | 62/526 [00:25<06:04,  1.27it/s]
 12%|█▏        | 63/526 [00:27<07:27,  1.04it/s]
 12%|█▏        | 64/526 [00:27<06:02,  1.27it/s]
 12%|█▏        | 65/526 [00:27<04:36,  1.67it/s]
 13%|█▎        | 66/526 [00:28<03:53,  1.97it/s]
 13%|█▎        | 67/526 [00:28<03:42,  2.06it/s]
 13%|█▎        | 68/526 [00:29<04:45,  1.60it/s]
 13%|█▎        | 69/526 [00:29<03:38,  2.09it/s]
 13%|█▎        | 70/526 [00:30<05:49,  1.31it/s]
 13%|█▎        | 71/526 [00:31<05:58,  1.27it/s]
 14%|█▎        | 72/526 [00:32<05:32,  1.37it/s]
 14%|█▍        | 73/526 [00:33<06:20,  1.19it/s]
 14%|█▍        | 74/526 [00:34<07:42,  1.02s/it]
 14%|█▍        | 75/526 [00:35<05:44,  1.31it/s]
 14%|█▍        | 76/526 [00:35<04:17,  1.75it/s]
 15%|█▍        | 77/526 [00:36<05:23,  1.39it/s]
 15%|█▍        | 78/526 [00:37<06:59,  1.07it/s]
 15%|█▌        | 79/526 [00:37<05:08,  1.45it/s]
 15%|█▌        | 80/526 [00:38<04:11,  1.77it/s]
 16%|█▌        | 82/526 [00:39<04:25,  1.67it/s]
 16%|█▌        | 84/526 [00:40<04:13,  1.74it/s]
 16%|█▌        | 85/526 [00:42<06:08,  1.20it/s]
 16%|█▋        | 86/526 [00:42<05:13,  1.40it/s]
 17%|█▋        | 87/526 [00:43<05:44,  1.27it/s]
 17%|█▋        | 88/526 [00:43<04:48,  1.52it/s]
 17%|█▋        | 89/526 [00:44<04:08,  1.76it/s]
 17%|█▋        | 90/526 [00:44<03:40,  1.97it/s]
 17%|█▋        | 91/526 [00:44<03:28,  2.09it/s]
 17%|█▋        | 92/526 [00:45<02:44,  2.64it/s]
 18%|█▊        | 94/526 [00:45<01:45,  4.09it/s]
 18%|█▊        | 95/526 [00:45<01:31,  4.72it/s]
 18%|█▊        | 96/526 [00:45<02:01,  3.54it/s]
 18%|█▊        | 97/526 [00:46<02:46,  2.57it/s]
 19%|█▊        | 98/526 [00:49<08:07,  1.14s/it]
 19%|█▉        | 99/526 [00:52<12:20,  1.73s/it]
 19%|█▉        | 101/526 [00:53<07:30,  1.06s/it]
 19%|█▉        | 102/526 [00:53<06:25,  1.10it/s]
 20%|█▉        | 103/526 [00:54<05:55,  1.19it/s]
 20%|█▉        | 104/526 [00:55<06:50,  1.03it/s]
 20%|██        | 106/526 [00:56<04:41,  1.49it/s]
 21%|██        | 108/526 [00:56<03:29,  2.00it/s]
 21%|██        | 109/526 [00:57<03:13,  2.15it/s]
 21%|██        | 110/526 [00:58<04:09,  1.67it/s]
 21%|██        | 111/526 [00:58<03:50,  1.80it/s]
 21%|██▏       | 112/526 [00:58<03:37,  1.91it/s]
 21%|██▏       | 113/526 [00:59<02:49,  2.44it/s]
 22%|██▏       | 114/526 [00:59<02:19,  2.96it/s]
 22%|██▏       | 115/526 [00:59<01:55,  3.57it/s]
 22%|██▏       | 116/526 [00:59<01:33,  4.38it/s]
 22%|██▏       | 117/526 [01:00<03:33,  1.91it/s]
 22%|██▏       | 118/526 [01:01<05:02,  1.35it/s]
 23%|██▎       | 119/526 [01:02<04:11,  1.62it/s]
 23%|██▎       | 120/526 [01:03<04:57,  1.36it/s]
 23%|██▎       | 121/526 [01:03<03:55,  1.72it/s]
 23%|██▎       | 122/526 [01:04<05:18,  1.27it/s]
 23%|██▎       | 123/526 [01:05<05:55,  1.13it/s]
 24%|██▎       | 124/526 [01:07<06:45,  1.01s/it]
 24%|██▍       | 125/526 [01:07<05:00,  1.34it/s]
 24%|██▍       | 127/526 [01:07<03:07,  2.12it/s]
 24%|██▍       | 128/526 [01:07<02:37,  2.52it/s]
 25%|██▍       | 129/526 [01:08<02:36,  2.54it/s]
 25%|██▍       | 130/526 [01:08<02:35,  2.55it/s]
 25%|██▍       | 131/526 [01:08<02:17,  2.88it/s]
 25%|██▌       | 132/526 [01:08<01:54,  3.46it/s]
 25%|██▌       | 133/526 [01:09<01:39,  3.96it/s]
 26%|██▌       | 135/526 [01:09<01:29,  4.38it/s]
 26%|██▌       | 136/526 [01:09<01:38,  3.98it/s]
 26%|██▌       | 138/526 [01:10<01:19,  4.85it/s]
 26%|██▋       | 139/526 [01:10<01:30,  4.29it/s]
 27%|██▋       | 140/526 [01:10<01:22,  4.66it/s]
 27%|██▋       | 141/526 [01:10<01:21,  4.73it/s]
 27%|██▋       | 142/526 [01:10<01:15,  5.10it/s]
 27%|██▋       | 143/526 [01:11<01:57,  3.26it/s]
 27%|██▋       | 144/526 [01:11<01:39,  3.83it/s]
 28%|██▊       | 145/526 [01:12<03:27,  1.83it/s]
 28%|██▊       | 146/526 [01:13<03:02,  2.09it/s]
 28%|██▊       | 147/526 [01:13<02:50,  2.22it/s]
 28%|██▊       | 149/526 [01:14<02:09,  2.92it/s]
 29%|██▊       | 150/526 [01:14<01:49,  3.43it/s]
 29%|██▊       | 151/526 [01:14<01:35,  3.93it/s]
 29%|██▉       | 152/526 [01:14<01:25,  4.35it/s]
 29%|██▉       | 154/526 [01:15<02:16,  2.73it/s]
 29%|██▉       | 155/526 [01:16<03:04,  2.01it/s]
 30%|██▉       | 156/526 [01:17<03:50,  1.60it/s]
 30%|██▉       | 157/526 [01:17<03:28,  1.77it/s]
 30%|███       | 159/526 [01:18<02:06,  2.90it/s]
 30%|███       | 160/526 [01:19<03:37,  1.68it/s]
 31%|███       | 161/526 [01:19<03:08,  1.94it/s]
 31%|███       | 162/526 [01:21<05:29,  1.10it/s]
 31%|███       | 164/526 [01:22<03:37,  1.66it/s]
 32%|███▏      | 166/526 [01:22<02:28,  2.43it/s]
 32%|███▏      | 167/526 [01:22<02:20,  2.55it/s]
 32%|███▏      | 168/526 [01:23<03:30,  1.70it/s]
 32%|███▏      | 169/526 [01:24<03:05,  1.92it/s]
 33%|███▎      | 171/526 [01:26<04:18,  1.37it/s]
 33%|███▎      | 172/526 [01:26<03:32,  1.67it/s]
 33%|███▎      | 173/526 [01:26<03:06,  1.89it/s]
 33%|███▎      | 174/526 [01:27<02:52,  2.04it/s]
 33%|███▎      | 175/526 [01:27<02:18,  2.54it/s]
 33%|███▎      | 176/526 [01:28<03:09,  1.85it/s]
 34%|███▎      | 177/526 [01:28<02:27,  2.36it/s]
 34%|███▍      | 178/526 [01:28<01:58,  2.94it/s]
 34%|███▍      | 179/526 [01:28<01:38,  3.53it/s]
 34%|███▍      | 180/526 [01:29<03:17,  1.75it/s]
 34%|███▍      | 181/526 [01:29<02:33,  2.25it/s]
 35%|███▍      | 182/526 [01:31<04:16,  1.34it/s]
 35%|███▍      | 183/526 [01:31<03:11,  1.79it/s]
 35%|███▍      | 184/526 [01:32<03:11,  1.78it/s]
 35%|███▌      | 186/526 [01:33<04:06,  1.38it/s]
 36%|███▌      | 187/526 [01:34<03:39,  1.55it/s]
 36%|███▌      | 188/526 [01:34<03:23,  1.66it/s]
 36%|███▌      | 190/526 [01:34<02:09,  2.59it/s]
 36%|███▋      | 191/526 [01:35<01:52,  2.97it/s]
 37%|███▋      | 192/526 [01:35<01:37,  3.44it/s]
 37%|███▋      | 193/526 [01:35<01:20,  4.13it/s]
 37%|███▋      | 194/526 [01:35<01:09,  4.76it/s]
 37%|███▋      | 195/526 [01:36<02:47,  1.98it/s]
 37%|███▋      | 196/526 [01:38<03:53,  1.41it/s]
 37%|███▋      | 197/526 [01:38<03:09,  1.74it/s]
 38%|███▊      | 198/526 [01:38<02:51,  1.92it/s]
 38%|███▊      | 199/526 [01:40<05:09,  1.06it/s]
 38%|███▊      | 200/526 [01:40<04:00,  1.36it/s]
 38%|███▊      | 201/526 [01:41<04:09,  1.30it/s]
 38%|███▊      | 202/526 [01:41<03:17,  1.64it/s]
 39%|███▊      | 203/526 [01:42<03:36,  1.49it/s]
 39%|███▉      | 205/526 [01:42<02:06,  2.54it/s]
 39%|███▉      | 206/526 [01:43<01:46,  3.00it/s]
 39%|███▉      | 207/526 [01:43<01:36,  3.29it/s]
 40%|███▉      | 210/526 [01:43<00:53,  5.95it/s]
 40%|████      | 212/526 [01:44<01:39,  3.16it/s]
 41%|████      | 214/526 [01:44<01:19,  3.93it/s]
 41%|████      | 215/526 [01:45<01:41,  3.05it/s]
 41%|████      | 216/526 [01:45<01:42,  3.03it/s]
 41%|████▏     | 217/526 [01:46<02:29,  2.07it/s]
 41%|████▏     | 218/526 [01:47<03:07,  1.64it/s]
 42%|████▏     | 219/526 [01:48<03:19,  1.54it/s]
 42%|████▏     | 220/526 [01:48<02:33,  1.99it/s]
 42%|████▏     | 222/526 [01:48<01:35,  3.17it/s]
 42%|████▏     | 223/526 [01:49<02:25,  2.08it/s]
 43%|████▎     | 224/526 [01:50<02:01,  2.49it/s]
 43%|████▎     | 225/526 [01:50<01:59,  2.52it/s]
 43%|████▎     | 227/526 [01:50<01:37,  3.05it/s]
 43%|████▎     | 228/526 [01:51<01:23,  3.57it/s]
 44%|████▎     | 229/526 [01:51<01:32,  3.21it/s]
 44%|████▎     | 230/526 [01:51<01:23,  3.55it/s]
 44%|████▍     | 231/526 [01:52<02:19,  2.12it/s]
 44%|████▍     | 232/526 [01:52<01:48,  2.70it/s]
 44%|████▍     | 233/526 [01:52<01:32,  3.17it/s]
 44%|████▍     | 234/526 [01:54<02:51,  1.70it/s]
 45%|████▍     | 235/526 [01:54<02:41,  1.80it/s]
 45%|████▍     | 236/526 [01:54<02:06,  2.29it/s]
 45%|████▌     | 237/526 [01:55<01:59,  2.42it/s]
 45%|████▌     | 238/526 [01:55<01:40,  2.87it/s]
 46%|████▌     | 240/526 [01:55<01:03,  4.48it/s]
 46%|████▌     | 241/526 [01:56<01:59,  2.38it/s]
 46%|████▌     | 243/526 [01:57<01:41,  2.78it/s]
 46%|████▋     | 244/526 [01:57<01:44,  2.70it/s]
 47%|████▋     | 245/526 [01:58<02:26,  1.91it/s]
 47%|████▋     | 246/526 [01:58<02:09,  2.15it/s]
 47%|████▋     | 247/526 [01:58<01:47,  2.60it/s]
 47%|████▋     | 248/526 [01:59<02:06,  2.20it/s]
 47%|████▋     | 249/526 [02:00<02:46,  1.66it/s]
 48%|████▊     | 250/526 [02:00<02:10,  2.11it/s]
 48%|████▊     | 251/526 [02:01<02:46,  1.65it/s]
 48%|████▊     | 252/526 [02:01<02:23,  1.91it/s]
 48%|████▊     | 253/526 [02:02<01:55,  2.37it/s]
 48%|████▊     | 255/526 [02:03<02:06,  2.13it/s]
 49%|████▊     | 256/526 [02:03<01:52,  2.41it/s]
 49%|████▉     | 257/526 [02:04<02:50,  1.57it/s]
 49%|████▉     | 258/526 [02:05<03:13,  1.39it/s]
 49%|████▉     | 259/526 [02:05<02:28,  1.79it/s]
 49%|████▉     | 260/526 [02:05<01:56,  2.28it/s]
 50%|████▉     | 261/526 [02:06<02:01,  2.18it/s]
 50%|████▉     | 262/526 [02:06<01:34,  2.80it/s]
 50%|█████     | 263/526 [02:07<02:20,  1.87it/s]
 50%|█████     | 264/526 [02:08<02:42,  1.61it/s]
 50%|█████     | 265/526 [02:08<02:05,  2.08it/s]
 51%|█████     | 266/526 [02:09<02:15,  1.92it/s]
 51%|█████     | 267/526 [02:09<02:22,  1.82it/s]
 51%|█████     | 268/526 [02:09<01:50,  2.33it/s]
 51%|█████     | 269/526 [02:10<01:34,  2.73it/s]
 51%|█████▏    | 270/526 [02:10<01:46,  2.41it/s]
 52%|█████▏    | 271/526 [02:10<01:28,  2.88it/s]
 52%|█████▏    | 272/526 [02:11<01:41,  2.49it/s]
 52%|█████▏    | 273/526 [02:12<02:25,  1.73it/s]
 52%|█████▏    | 274/526 [02:12<02:12,  1.91it/s]
 52%|█████▏    | 275/526 [02:15<05:33,  1.33s/it]
 52%|█████▏    | 276/526 [02:16<04:06,  1.01it/s]
 53%|█████▎    | 277/526 [02:16<03:06,  1.34it/s]
 53%|█████▎    | 278/526 [02:17<03:04,  1.35it/s]
 53%|█████▎    | 279/526 [02:20<06:04,  1.48s/it]
 53%|█████▎    | 280/526 [02:23<08:07,  1.98s/it]
 53%|█████▎    | 281/526 [02:26<09:32,  2.34s/it]
 54%|█████▎    | 282/526 [02:29<10:32,  2.59s/it]
 54%|█████▍    | 283/526 [02:32<11:11,  2.77s/it]
 54%|█████▍    | 284/526 [02:36<11:38,  2.89s/it]
 54%|█████▍    | 285/526 [02:36<08:38,  2.15s/it]
 54%|█████▍    | 286/526 [02:37<07:01,  1.76s/it]
 55%|█████▍    | 287/526 [02:37<05:06,  1.28s/it]
 55%|█████▍    | 288/526 [02:37<03:51,  1.03it/s]
 55%|█████▍    | 289/526 [02:37<02:53,  1.36it/s]
 55%|█████▌    | 291/526 [02:39<02:31,  1.55it/s]
 56%|█████▌    | 292/526 [02:39<02:05,  1.87it/s]
 56%|█████▌    | 293/526 [02:39<02:15,  1.72it/s]
 56%|█████▌    | 294/526 [02:40<01:58,  1.96it/s]
 56%|█████▌    | 295/526 [02:40<01:44,  2.21it/s]
 56%|█████▋    | 296/526 [02:40<01:35,  2.40it/s]
 57%|█████▋    | 298/526 [02:44<03:37,  1.05it/s]
 57%|█████▋    | 299/526 [02:47<05:33,  1.47s/it]
 57%|█████▋    | 300/526 [02:48<05:32,  1.47s/it]
 57%|█████▋    | 301/526 [02:49<05:04,  1.35s/it]
 57%|█████▋    | 302/526 [02:51<05:07,  1.37s/it]
 58%|█████▊    | 303/526 [02:52<05:12,  1.40s/it]
 58%|█████▊    | 304/526 [02:52<04:01,  1.09s/it]
 58%|█████▊    | 305/526 [02:54<04:24,  1.20s/it]
 58%|█████▊    | 306/526 [02:55<04:36,  1.26s/it]
 58%|█████▊    | 307/526 [02:57<04:49,  1.32s/it]
 59%|█████▊    | 308/526 [02:58<04:57,  1.37s/it]
 59%|█████▊    | 309/526 [02:58<03:45,  1.04s/it]
 59%|█████▉    | 310/526 [02:59<03:36,  1.00s/it]
 59%|█████▉    | 311/526 [03:00<02:45,  1.30it/s]
 59%|█████▉    | 312/526 [03:01<03:32,  1.01it/s]
 60%|█████▉    | 313/526 [03:03<04:03,  1.14s/it]
 60%|█████▉    | 314/526 [03:04<04:34,  1.30s/it]
 60%|█████▉    | 315/526 [03:07<06:31,  1.85s/it]
 60%|██████    | 316/526 [03:08<04:39,  1.33s/it]
 60%|██████    | 317/526 [03:08<04:08,  1.19s/it]
 60%|██████    | 318/526 [03:09<03:45,  1.09s/it]
 61%|██████    | 319/526 [03:10<03:00,  1.15it/s]
 61%|██████    | 320/526 [03:10<02:14,  1.53it/s]
 61%|██████    | 321/526 [03:11<03:16,  1.04it/s]
 61%|██████    | 322/526 [03:12<02:38,  1.28it/s]
 61%|██████▏   | 323/526 [03:12<02:04,  1.63it/s]
 62%|██████▏   | 324/526 [03:12<01:41,  1.99it/s]
 62%|██████▏   | 325/526 [03:13<01:26,  2.31it/s]
 62%|██████▏   | 326/526 [03:13<01:08,  2.92it/s]
 62%|██████▏   | 327/526 [03:13<01:07,  2.94it/s]
 62%|██████▏   | 328/526 [03:13<00:56,  3.48it/s]
 63%|██████▎   | 330/526 [03:13<00:37,  5.29it/s]
 63%|██████▎   | 331/526 [03:14<00:40,  4.85it/s]
 63%|██████▎   | 332/526 [03:14<00:57,  3.38it/s]
 63%|██████▎   | 333/526 [03:14<00:52,  3.68it/s]
 63%|██████▎   | 334/526 [03:16<01:48,  1.78it/s]
 64%|██████▎   | 335/526 [03:16<01:47,  1.78it/s]
 64%|██████▍   | 336/526 [03:17<02:27,  1.29it/s]
 64%|██████▍   | 337/526 [03:18<02:24,  1.30it/s]
 64%|██████▍   | 338/526 [03:19<02:16,  1.38it/s]
 64%|██████▍   | 339/526 [03:19<01:59,  1.57it/s]
 65%|██████▍   | 340/526 [03:22<04:20,  1.40s/it]
 65%|██████▍   | 341/526 [03:23<03:08,  1.02s/it]
 65%|██████▌   | 342/526 [03:23<02:37,  1.17it/s]
 65%|██████▌   | 343/526 [03:24<02:35,  1.17it/s]
 66%|██████▌   | 345/526 [03:31<06:09,  2.04s/it]
 66%|██████▌   | 346/526 [03:34<06:58,  2.33s/it]
 66%|██████▌   | 347/526 [03:41<10:20,  3.46s/it]
 66%|██████▌   | 348/526 [03:42<08:17,  2.80s/it]
 66%|██████▋   | 349/526 [03:42<06:19,  2.14s/it]
 67%|██████▋   | 350/526 [03:49<10:14,  3.49s/it]
 67%|██████▋   | 351/526 [03:52<09:55,  3.40s/it]
 67%|██████▋   | 352/526 [03:52<07:10,  2.48s/it]
 67%|██████▋   | 353/526 [03:53<05:11,  1.80s/it]
 67%|██████▋   | 355/526 [03:53<03:08,  1.10s/it]
 68%|██████▊   | 356/526 [03:53<02:26,  1.16it/s]
 68%|██████▊   | 357/526 [03:54<02:13,  1.27it/s]
 68%|██████▊   | 358/526 [03:54<02:03,  1.36it/s]
 68%|██████▊   | 359/526 [03:55<01:40,  1.66it/s]
 68%|██████▊   | 360/526 [03:55<01:17,  2.14it/s]
 69%|██████▊   | 361/526 [03:55<01:06,  2.49it/s]
 69%|██████▉   | 363/526 [03:56<01:02,  2.63it/s]
 69%|██████▉   | 364/526 [03:56<00:54,  2.96it/s]
 69%|██████▉   | 365/526 [03:57<01:06,  2.44it/s]
 70%|██████▉   | 366/526 [03:58<02:01,  1.32it/s]
 70%|██████▉   | 367/526 [03:58<01:32,  1.72it/s]
 70%|██████▉   | 368/526 [03:59<01:12,  2.17it/s]
 70%|███████   | 369/526 [03:59<01:10,  2.22it/s]
 70%|███████   | 370/526 [04:06<05:56,  2.29s/it]
 71%|███████   | 371/526 [04:13<09:20,  3.61s/it]
 71%|███████   | 372/526 [04:19<11:35,  4.52s/it]
 71%|███████   | 374/526 [04:19<06:17,  2.49s/it]
 71%|███████▏  | 375/526 [04:26<08:54,  3.54s/it]
 71%|███████▏  | 376/526 [04:26<06:37,  2.65s/it]
 72%|███████▏  | 377/526 [04:27<05:11,  2.09s/it]
 72%|███████▏  | 379/526 [04:27<03:09,  1.29s/it]
 72%|███████▏  | 380/526 [04:28<02:31,  1.04s/it]
 72%|███████▏  | 381/526 [04:34<05:55,  2.45s/it]
 73%|███████▎  | 382/526 [04:35<04:37,  1.93s/it]
 73%|███████▎  | 383/526 [04:35<03:36,  1.51s/it]
 73%|███████▎  | 384/526 [04:42<06:59,  2.96s/it]
 73%|███████▎  | 385/526 [04:48<09:30,  4.05s/it]
 73%|███████▎  | 386/526 [04:49<07:21,  3.16s/it]
 74%|███████▎  | 387/526 [04:50<05:20,  2.30s/it]
 74%|███████▍  | 388/526 [04:50<03:59,  1.74s/it]
 74%|███████▍  | 389/526 [04:51<03:12,  1.41s/it]
 74%|███████▍  | 390/526 [04:51<02:39,  1.17s/it]
 74%|███████▍  | 391/526 [04:52<01:57,  1.15it/s]
 75%|███████▍  | 392/526 [04:52<01:26,  1.56it/s]
 75%|███████▍  | 393/526 [04:52<01:24,  1.58it/s]
 75%|███████▍  | 394/526 [04:52<01:03,  2.09it/s]
 75%|███████▌  | 396/526 [04:53<00:39,  3.29it/s]
 75%|███████▌  | 397/526 [04:53<00:33,  3.81it/s]
 76%|███████▌  | 398/526 [04:53<00:33,  3.78it/s]
 76%|███████▌  | 399/526 [05:00<04:19,  2.04s/it]
 76%|███████▌  | 400/526 [05:00<03:09,  1.50s/it]
 76%|███████▌  | 401/526 [05:07<06:18,  3.03s/it]
 76%|███████▋  | 402/526 [05:07<04:44,  2.29s/it]
 77%|███████▋  | 403/526 [05:08<03:31,  1.72s/it]
 77%|███████▋  | 404/526 [05:08<02:35,  1.27s/it]
 77%|███████▋  | 405/526 [05:08<01:55,  1.04it/s]
 77%|███████▋  | 406/526 [05:13<04:18,  2.16s/it]
 78%|███████▊  | 408/526 [05:13<02:23,  1.22s/it]
 78%|███████▊  | 409/526 [05:14<02:04,  1.06s/it]
 78%|███████▊  | 410/526 [05:14<01:35,  1.21it/s]
 78%|███████▊  | 411/526 [05:21<04:40,  2.44s/it]
 78%|███████▊  | 412/526 [05:21<03:26,  1.81s/it]
 79%|███████▊  | 414/526 [05:21<01:58,  1.06s/it]
 79%|███████▉  | 415/526 [05:21<01:38,  1.13it/s]
 79%|███████▉  | 417/526 [05:22<01:07,  1.61it/s]
 79%|███████▉  | 418/526 [05:24<01:34,  1.14it/s]
 80%|███████▉  | 419/526 [05:24<01:14,  1.43it/s]
 80%|████████  | 421/526 [05:28<02:03,  1.18s/it]
 80%|████████  | 422/526 [05:28<01:37,  1.07it/s]
 80%|████████  | 423/526 [05:28<01:20,  1.27it/s]
 81%|████████  | 424/526 [05:28<01:03,  1.62it/s]
 81%|████████  | 425/526 [05:28<00:48,  2.07it/s]
 81%|████████  | 426/526 [05:28<00:41,  2.41it/s]
 81%|████████  | 427/526 [05:29<00:33,  2.95it/s]
 81%|████████▏ | 428/526 [05:29<00:26,  3.65it/s]
 82%|████████▏ | 429/526 [05:29<00:22,  4.25it/s]
 82%|████████▏ | 431/526 [05:30<00:35,  2.71it/s]
 82%|████████▏ | 433/526 [05:30<00:25,  3.64it/s]
 83%|████████▎ | 435/526 [05:33<00:59,  1.54it/s]
 83%|████████▎ | 436/526 [05:34<01:03,  1.41it/s]
 83%|████████▎ | 438/526 [05:35<00:56,  1.57it/s]
 83%|████████▎ | 439/526 [05:36<00:59,  1.47it/s]
 84%|████████▎ | 440/526 [05:36<00:58,  1.48it/s]
 84%|████████▍ | 442/526 [05:37<00:42,  1.97it/s]
 84%|████████▍ | 444/526 [05:39<00:52,  1.57it/s]
 85%|████████▍ | 445/526 [05:40<01:08,  1.18it/s]
 85%|████████▍ | 446/526 [05:40<00:57,  1.40it/s]
 85%|████████▍ | 447/526 [05:41<00:49,  1.59it/s]
 85%|████████▌ | 448/526 [05:41<00:40,  1.93it/s]
 86%|████████▌ | 450/526 [05:41<00:25,  3.00it/s]
 86%|████████▌ | 451/526 [05:41<00:21,  3.50it/s]
 86%|████████▌ | 453/526 [05:41<00:14,  4.97it/s]
 86%|████████▋ | 454/526 [05:42<00:20,  3.55it/s]
 87%|████████▋ | 456/526 [05:42<00:15,  4.47it/s]
 87%|████████▋ | 458/526 [05:43<00:12,  5.25it/s]
 87%|████████▋ | 459/526 [05:43<00:13,  5.04it/s]
 87%|████████▋ | 460/526 [05:43<00:18,  3.61it/s]
 88%|████████▊ | 461/526 [05:43<00:15,  4.19it/s]
 88%|████████▊ | 462/526 [05:44<00:14,  4.33it/s]
 88%|████████▊ | 463/526 [05:44<00:16,  3.71it/s]
 88%|████████▊ | 465/526 [05:44<00:13,  4.45it/s]
 89%|████████▊ | 466/526 [05:45<00:15,  3.84it/s]
 89%|████████▉ | 467/526 [05:45<00:17,  3.29it/s]
 89%|████████▉ | 468/526 [05:45<00:14,  3.88it/s]
 89%|████████▉ | 470/526 [05:46<00:10,  5.45it/s]
 90%|████████▉ | 471/526 [05:46<00:09,  6.05it/s]
 90%|████████▉ | 472/526 [05:46<00:12,  4.29it/s]
 90%|█████████ | 474/526 [05:46<00:08,  6.03it/s]
 90%|█████████ | 475/526 [05:47<00:16,  3.14it/s]
 90%|█████████ | 476/526 [05:47<00:16,  2.98it/s]
 91%|█████████ | 478/526 [05:48<00:10,  4.58it/s]
 91%|█████████ | 479/526 [05:48<00:17,  2.76it/s]
 91%|█████████▏| 480/526 [05:49<00:17,  2.68it/s]
 91%|█████████▏| 481/526 [05:50<00:29,  1.52it/s]
 92%|█████████▏| 482/526 [05:51<00:24,  1.78it/s]
 92%|█████████▏| 483/526 [05:51<00:20,  2.13it/s]
 92%|█████████▏| 484/526 [05:51<00:16,  2.48it/s]
 92%|█████████▏| 485/526 [05:51<00:14,  2.81it/s]
 92%|█████████▏| 486/526 [05:51<00:11,  3.39it/s]
 93%|█████████▎| 487/526 [05:52<00:10,  3.75it/s]
 93%|█████████▎| 489/526 [05:52<00:07,  4.85it/s]
 93%|█████████▎| 490/526 [05:52<00:07,  4.89it/s]
 93%|█████████▎| 491/526 [05:53<00:11,  3.11it/s]
 94%|█████████▎| 493/526 [05:56<00:32,  1.02it/s]
 94%|█████████▍| 495/526 [05:57<00:20,  1.49it/s]
 94%|█████████▍| 496/526 [05:57<00:16,  1.78it/s]
 94%|█████████▍| 497/526 [05:58<00:19,  1.46it/s]
 95%|█████████▍| 498/526 [06:00<00:26,  1.07it/s]
 95%|█████████▍| 499/526 [06:02<00:31,  1.17s/it]
 95%|█████████▌| 500/526 [06:02<00:23,  1.12it/s]
 95%|█████████▌| 501/526 [06:02<00:17,  1.42it/s]
 96%|█████████▌| 503/526 [06:02<00:10,  2.26it/s]
 96%|█████████▌| 504/526 [06:02<00:08,  2.49it/s]
 96%|█████████▌| 505/526 [06:03<00:08,  2.37it/s]
 96%|█████████▌| 506/526 [06:03<00:07,  2.72it/s]
 96%|█████████▋| 507/526 [06:03<00:05,  3.28it/s]
 97%|█████████▋| 508/526 [06:04<00:06,  2.91it/s]
 97%|█████████▋| 510/526 [06:05<00:06,  2.32it/s]
 97%|█████████▋| 511/526 [06:05<00:06,  2.16it/s]
 97%|█████████▋| 512/526 [06:06<00:05,  2.58it/s]
 98%|█████████▊| 513/526 [06:06<00:06,  1.98it/s]
 98%|█████████▊| 514/526 [06:07<00:05,  2.17it/s]
 98%|█████████▊| 515/526 [06:07<00:04,  2.25it/s]
 98%|█████████▊| 516/526 [06:07<00:03,  2.79it/s]
 98%|█████████▊| 517/526 [06:08<00:03,  2.68it/s]
 98%|█████████▊| 518/526 [06:08<00:02,  2.90it/s]
 99%|█████████▊| 519/526 [06:08<00:02,  3.48it/s]
 99%|█████████▉| 520/526 [06:09<00:02,  2.02it/s]
 99%|█████████▉| 521/526 [06:09<00:01,  2.64it/s]
 99%|█████████▉| 522/526 [06:13<00:05,  1.27s/it]
 99%|█████████▉| 523/526 [06:16<00:05,  1.90s/it]
100%|█████████▉| 524/526 [06:19<00:04,  2.36s/it]
100%|█████████▉| 525/526 [06:20<00:01,  1.76s/it]
100%|██████████| 526/526 [06:23<00:00,  2.24s/it]
100%|██████████| 526/526 [06:23<00:00,  1.37it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-08 16:42:35.718999_lp_processed_test.json', '--output_addr', 'data/out/rag/full_profile/lp_rag_full_profile_test_2_output.json', '--temperature', '0.0', '--top_p', '0.95', '--max_tokens', '4096', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/work/pi_hzamani_umass_edu/ozel_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.03 examples/s]
Generating train split: 526 examples [00:00, 716.41 examples/s]
INFO 07-08 16:49:33 config.py:510] This model supports multiple tasks: {'embed', 'score', 'classify', 'reward', 'generate'}. Defaulting to 'generate'.
INFO 07-08 16:49:33 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/work/pi_hzamani_umass_edu/ozel_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-08 16:49:34 selector.py:120] Using Flash Attention backend.
INFO 07-08 16:49:35 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-08 16:49:35 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.64it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.60it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.58it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.61it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.61it/s]

INFO 07-08 16:49:38 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-08 16:49:40 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-08 16:49:40 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-08 16:49:40 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-08 16:49:40 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-08 16:49:40 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-08 16:49:43 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  3.01it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.36it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.49it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.55it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.59it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.62it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.62it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.63it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.63it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.64it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.65it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.67it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.69it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.70it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.70it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.70it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.74it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.78it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.80it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.82it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.84it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.85it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.86it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.87it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.88it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:06<00:02,  3.89it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.90it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.90it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.92it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.83it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.87it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.90it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.85it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.89it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.92it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.76it/s]
INFO 07-08 16:49:52 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-08 16:49:52 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.25 seconds
RAG ON
EXAMPLE PROMPT
<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Is giving child ride considered spoiling? My sister lives 15-20min walk from her school but my mom gives her a ride in the car every morning.  Is this considered spoiling the child or no.  In my opinion it is because I think it's a perfectly close enough distance to walk.

Is investing all your savings into a small number of individual stocks risky? I want to invest 90% of my savings into stock market and split between 4-6 stocks.  How risky is this and is it a bad idea.  I feel like the stock market goes up over time so unless something like 2008 depression happens again there is actually not that much risk?Note that I'm trying to turn this into a form of income and not simply getting decent returns for retirement etc.  I am okay with reasonable risk so I can work less hopefully.
# Current post question:
Is cycling on this 35mph road too dangerous?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
First time repairing a rear wheel hub, I am hearing bearing on bearing rattle/clicks when spinning For the sake of doing a restoration I just serviced a rear wheel: new bearings, new grease, new axle and new dust caps.I think I have put enough grease. When spinning the wheel before putting it on the bike I was feeling a bit of crunchiness but no noise. After putting the wheel on, truing it, setting the brakes, I did a spin test: there is no resistance, the wheel does spin for a while with a single push. Unfortunately there is a significant metal on metal noise, feels like a bearing on bearing friction. The wheel has also a tiny bit of play but it is attached safety to the bike.Here is a video with audio: https://imgur.com/a/BTmexIYAlso, I had to replace the dust caps by a wee bit smaller ones (25mm vs 28mm), but I do not think this is to blame.

New DIY project: restoring this bike from the bins. How can I service this back wheel? I picked a broken bike from the garbage around the block. The bike has some damage. It looks like a stolen bike (spray paint awfully over original color), so it must have had some tough love. I have identified the brand and model from its parts but no one has reported it stolen, yet. It will turn into a restoration job soon.I am not the sharpest bike wrench so I could use some advice. Most parts are in good state. Obviously it needs new brake pads and new tires, and most probably a new chain, as this one is full or rust. The rear derailleur was so bent into the spokes that it broke. Definitely needs replacement by a new one.The work that needs to be done on the rear wheel is not clear to me. The spokes are unbroken but it needs truing. I found it with some of its bearings opened, the ones on the non-driving side. When looking inside: not much contamination but some of the balls seem to be missing. I already have grease. Can I just buy any balls bearings? How do I know how many I need? Also the lock ring on these bearings is crooked? See pictures. Will it close? Or do I need a new one? Is it needed to buy a new axle + bearings? Is it simpler?Here are some pictures https://imgur.com/a/UbB8NrlMany thanks.
# Current post question:
Shimano crankset is near end of life, can I use a Tiagra 4700 replacement?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
How to care for bent avocado tree I have an avocado tree I started from a pit. It has lived in upstate New York indoors and has grown tall and skinny. I recently moved to Atlanta, Georgia and so can have it outdoors more. The tree is somewhat crooked. Should I prune it? (Possibly even cutting off the top half of the tree?)Should I get a bigger pot?Should I get some kind of system going to stabilize and/or straighten it out? Should I keep it outside all of the time?

Trees for southern Idaho/northern Utah mountain environment My goal is to find trees that would survive in the fairly harsh climate of the mountains of northern Utah/southern Idaho (near Bear Lake). Being in the mountains, it is around 7,000 feet. The trees need to be able to withstand cold temperatures of roughly -20 degrees Fahrenheit as well as be drought resistant. However, we can water them once or twice per week in the summer. What kind of trees meet the bill?We have had some success with aspen trees and some, but less, success with pine trees.
# Current post question:
Repair Marin Hawk Hill (cracked frame) or get new bike?
<|im_end|>
<|im_start|>assistant

None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:12<1:49:48, 12.55s/it, est. speed input: 40.08 toks/s, output: 7.33 toks/s]
Processed prompts:   0%|          | 2/526 [00:13<47:46,  5.47s/it, est. speed input: 107.47 toks/s, output: 15.00 toks/s]
Processed prompts:   1%|          | 4/526 [00:13<18:05,  2.08s/it, est. speed input: 169.06 toks/s, output: 30.70 toks/s]
Processed prompts:   1%|          | 6/526 [00:13<10:12,  1.18s/it, est. speed input: 219.14 toks/s, output: 45.82 toks/s]
Processed prompts:   2%|▏         | 9/526 [00:13<05:26,  1.59it/s, est. speed input: 294.83 toks/s, output: 69.27 toks/s]
Processed prompts:   2%|▏         | 12/526 [00:13<03:22,  2.54it/s, est. speed input: 379.36 toks/s, output: 93.02 toks/s]
Processed prompts:   3%|▎         | 14/526 [00:14<02:35,  3.29it/s, est. speed input: 453.88 toks/s, output: 108.82 toks/s]
Processed prompts:   3%|▎         | 16/526 [00:14<02:05,  4.08it/s, est. speed input: 522.19 toks/s, output: 124.09 toks/s]
Processed prompts:   3%|▎         | 18/526 [00:14<01:41,  5.02it/s, est. speed input: 586.47 toks/s, output: 139.37 toks/s]
Processed prompts:   4%|▍         | 23/526 [00:14<01:03,  7.96it/s, est. speed input: 715.99 toks/s, output: 178.66 toks/s]
Processed prompts:   6%|▌         | 29/526 [00:15<00:46, 10.59it/s, est. speed input: 921.63 toks/s, output: 224.83 toks/s]
Processed prompts:   6%|▋         | 33/526 [00:15<00:37, 13.01it/s, est. speed input: 1030.87 toks/s, output: 256.67 toks/s]
Processed prompts:   7%|▋         | 35/526 [00:15<00:35, 13.73it/s, est. speed input: 1080.10 toks/s, output: 271.99 toks/s]
Processed prompts:   7%|▋         | 37/526 [00:15<00:34, 14.29it/s, est. speed input: 1141.56 toks/s, output: 286.98 toks/s]
Processed prompts:   8%|▊         | 40/526 [00:15<00:35, 13.73it/s, est. speed input: 1240.55 toks/s, output: 308.01 toks/s]
Processed prompts:   9%|▊         | 46/526 [00:16<00:33, 14.40it/s, est. speed input: 1386.91 toks/s, output: 350.69 toks/s]
Processed prompts:  10%|▉         | 51/526 [00:16<00:32, 14.79it/s, est. speed input: 1528.57 toks/s, output: 385.46 toks/s]
Processed prompts:  11%|█         | 56/526 [00:16<00:29, 16.17it/s, est. speed input: 1677.91 toks/s, output: 421.23 toks/s]
Processed prompts:  11%|█         | 59/526 [00:16<00:30, 15.31it/s, est. speed input: 1756.33 toks/s, output: 440.28 toks/s]
Processed prompts:  12%|█▏        | 64/526 [00:17<00:25, 17.87it/s, est. speed input: 1950.58 toks/s, output: 476.47 toks/s]
Processed prompts:  13%|█▎        | 68/526 [00:17<00:26, 17.52it/s, est. speed input: 2160.08 toks/s, output: 502.61 toks/s]
Processed prompts:  14%|█▍        | 73/526 [00:17<00:24, 18.36it/s, est. speed input: 2302.02 toks/s, output: 536.44 toks/s]
Processed prompts:  15%|█▍        | 77/526 [00:17<00:21, 20.49it/s, est. speed input: 2421.67 toks/s, output: 564.99 toks/s]
Processed prompts:  16%|█▌        | 82/526 [00:18<00:21, 20.60it/s, est. speed input: 2572.69 toks/s, output: 598.02 toks/s]
Processed prompts:  16%|█▋        | 86/526 [00:18<00:21, 20.06it/s, est. speed input: 2679.79 toks/s, output: 623.48 toks/s]
Processed prompts:  17%|█▋        | 91/526 [00:18<00:19, 22.38it/s, est. speed input: 2826.64 toks/s, output: 658.22 toks/s]
Processed prompts:  18%|█▊        | 94/526 [00:18<00:20, 21.43it/s, est. speed input: 2887.06 toks/s, output: 676.86 toks/s]
Processed prompts:  19%|█▊        | 98/526 [00:18<00:22, 18.92it/s, est. speed input: 2999.07 toks/s, output: 699.46 toks/s]
Processed prompts:  20%|█▉        | 103/526 [00:19<00:20, 21.01it/s, est. speed input: 3116.31 toks/s, output: 732.79 toks/s]
Processed prompts:  21%|██        | 109/526 [00:19<00:19, 21.08it/s, est. speed input: 3223.64 toks/s, output: 769.95 toks/s]
Processed prompts:  22%|██▏       | 114/526 [00:19<00:18, 21.83it/s, est. speed input: 3344.14 toks/s, output: 801.40 toks/s]
Processed prompts:  22%|██▏       | 117/526 [00:19<00:20, 20.42it/s, est. speed input: 3416.70 toks/s, output: 817.75 toks/s]
Processed prompts:  23%|██▎       | 121/526 [00:19<00:20, 19.58it/s, est. speed input: 3492.11 toks/s, output: 840.10 toks/s]
Processed prompts:  24%|██▍       | 125/526 [00:20<00:18, 21.94it/s, est. speed input: 3580.00 toks/s, output: 866.50 toks/s]
Processed prompts:  24%|██▍       | 128/526 [00:20<00:19, 20.29it/s, est. speed input: 3626.95 toks/s, output: 882.43 toks/s]
Processed prompts:  25%|██▌       | 133/526 [00:20<00:20, 19.09it/s, est. speed input: 3724.64 toks/s, output: 909.49 toks/s]
Processed prompts:  26%|██▌       | 138/526 [00:20<00:20, 19.23it/s, est. speed input: 3880.72 toks/s, output: 937.72 toks/s]
Processed prompts:  28%|██▊       | 146/526 [00:21<00:19, 19.83it/s, est. speed input: 4073.99 toks/s, output: 983.29 toks/s]
Processed prompts:  28%|██▊       | 149/526 [00:21<00:18, 20.44it/s, est. speed input: 4145.19 toks/s, output: 1000.98 toks/s]
Processed prompts:  29%|██▉       | 155/526 [00:21<00:19, 18.65it/s, est. speed input: 4236.59 toks/s, output: 1030.32 toks/s]
Processed prompts:  30%|███       | 158/526 [00:21<00:18, 20.11it/s, est. speed input: 4290.90 toks/s, output: 1048.92 toks/s]
Processed prompts:  31%|███       | 161/526 [00:21<00:17, 20.29it/s, est. speed input: 4363.30 toks/s, output: 1065.56 toks/s]
Processed prompts:  31%|███       | 164/526 [00:22<00:18, 19.99it/s, est. speed input: 4406.78 toks/s, output: 1081.44 toks/s]
Processed prompts:  32%|███▏      | 167/526 [00:22<00:17, 20.25it/s, est. speed input: 4447.66 toks/s, output: 1097.99 toks/s]
Processed prompts:  32%|███▏      | 170/526 [00:22<00:21, 16.65it/s, est. speed input: 4484.67 toks/s, output: 1108.32 toks/s]
Processed prompts:  34%|███▎      | 177/526 [00:22<00:18, 18.61it/s, est. speed input: 4610.50 toks/s, output: 1146.70 toks/s]
Processed prompts:  34%|███▍      | 180/526 [00:22<00:18, 18.31it/s, est. speed input: 4651.48 toks/s, output: 1161.35 toks/s]
Processed prompts:  35%|███▍      | 182/526 [00:23<00:20, 16.89it/s, est. speed input: 4674.18 toks/s, output: 1168.75 toks/s]
Processed prompts:  35%|███▌      | 185/526 [00:23<00:18, 17.99it/s, est. speed input: 4720.24 toks/s, output: 1185.05 toks/s]
Processed prompts:  36%|███▌      | 187/526 [00:23<00:19, 17.47it/s, est. speed input: 4744.77 toks/s, output: 1194.17 toks/s]
Processed prompts:  36%|███▌      | 190/526 [00:23<00:19, 16.93it/s, est. speed input: 4771.83 toks/s, output: 1207.74 toks/s]
Processed prompts:  37%|███▋      | 192/526 [00:23<00:21, 15.39it/s, est. speed input: 4791.52 toks/s, output: 1214.53 toks/s]
Processed prompts:  37%|███▋      | 195/526 [00:23<00:19, 17.04it/s, est. speed input: 4862.06 toks/s, output: 1230.69 toks/s]
Processed prompts:  38%|███▊      | 199/526 [00:24<00:20, 16.11it/s, est. speed input: 4897.97 toks/s, output: 1247.60 toks/s]
Processed prompts:  39%|███▉      | 206/526 [00:24<00:23, 13.85it/s, est. speed input: 5013.44 toks/s, output: 1271.39 toks/s]
Processed prompts:  40%|███▉      | 209/526 [00:24<00:21, 14.81it/s, est. speed input: 5052.11 toks/s, output: 1286.46 toks/s]
Processed prompts:  40%|████      | 213/526 [00:25<00:23, 13.58it/s, est. speed input: 5073.59 toks/s, output: 1299.12 toks/s]
Processed prompts:  41%|████      | 215/526 [00:25<00:22, 13.67it/s, est. speed input: 5114.45 toks/s, output: 1307.20 toks/s]
Processed prompts:  41%|████▏     | 218/526 [00:25<00:22, 13.90it/s, est. speed input: 5136.92 toks/s, output: 1319.79 toks/s]
Processed prompts:  42%|████▏     | 220/526 [00:25<00:21, 14.03it/s, est. speed input: 5166.74 toks/s, output: 1328.15 toks/s]
Processed prompts:  42%|████▏     | 223/526 [00:25<00:22, 13.76it/s, est. speed input: 5197.08 toks/s, output: 1339.59 toks/s]
Processed prompts:  43%|████▎     | 226/526 [00:26<00:23, 12.51it/s, est. speed input: 5260.66 toks/s, output: 1347.99 toks/s]
Processed prompts:  44%|████▎     | 229/526 [00:26<00:22, 12.99it/s, est. speed input: 5341.47 toks/s, output: 1360.47 toks/s]
Processed prompts:  44%|████▍     | 233/526 [00:26<00:21, 13.88it/s, est. speed input: 5386.24 toks/s, output: 1378.52 toks/s]
Processed prompts:  45%|████▍     | 235/526 [00:26<00:23, 12.62it/s, est. speed input: 5387.19 toks/s, output: 1383.20 toks/s]
Processed prompts:  45%|████▌     | 239/526 [00:27<00:20, 14.23it/s, est. speed input: 5422.43 toks/s, output: 1403.16 toks/s]
Processed prompts:  46%|████▌     | 241/526 [00:27<00:22, 12.46it/s, est. speed input: 5469.54 toks/s, output: 1406.78 toks/s]
Processed prompts:  46%|████▌     | 243/526 [00:27<00:25, 11.27it/s, est. speed input: 5473.32 toks/s, output: 1410.76 toks/s]
Processed prompts:  47%|████▋     | 245/526 [00:27<00:25, 10.91it/s, est. speed input: 5481.06 toks/s, output: 1412.04 toks/s]
Processed prompts:  47%|████▋     | 247/526 [00:28<00:32,  8.69it/s, est. speed input: 5461.37 toks/s, output: 1410.15 toks/s]
Processed prompts:  47%|████▋     | 248/526 [00:28<00:34,  8.14it/s, est. speed input: 5450.98 toks/s, output: 1406.27 toks/s]
Processed prompts:  47%|████▋     | 249/526 [00:28<00:37,  7.36it/s, est. speed input: 5440.39 toks/s, output: 1404.99 toks/s]
Processed prompts:  48%|████▊     | 250/526 [00:28<00:45,  6.10it/s, est. speed input: 5411.30 toks/s, output: 1400.17 toks/s]
Processed prompts:  48%|████▊     | 251/526 [00:29<00:51,  5.31it/s, est. speed input: 5375.53 toks/s, output: 1391.22 toks/s]
Processed prompts:  48%|████▊     | 253/526 [00:29<00:47,  5.74it/s, est. speed input: 5357.77 toks/s, output: 1384.47 toks/s]
Processed prompts:  48%|████▊     | 254/526 [00:29<00:50,  5.37it/s, est. speed input: 5338.36 toks/s, output: 1382.44 toks/s]
Processed prompts:  49%|████▉     | 257/526 [00:29<00:35,  7.57it/s, est. speed input: 5349.32 toks/s, output: 1383.91 toks/s]
Processed prompts:  49%|████▉     | 258/526 [00:29<00:34,  7.76it/s, est. speed input: 5341.39 toks/s, output: 1382.60 toks/s]
Processed prompts:  49%|████▉     | 260/526 [00:30<00:33,  8.06it/s, est. speed input: 5332.12 toks/s, output: 1380.78 toks/s]
Processed prompts:  50%|████▉     | 261/526 [00:30<00:35,  7.36it/s, est. speed input: 5316.51 toks/s, output: 1377.47 toks/s]
Processed prompts:  50%|████▉     | 262/526 [00:30<00:36,  7.15it/s, est. speed input: 5339.06 toks/s, output: 1379.28 toks/s]
Processed prompts:  50%|█████     | 265/526 [00:30<00:28,  9.13it/s, est. speed input: 5361.30 toks/s, output: 1382.11 toks/s]
Processed prompts:  51%|█████     | 268/526 [00:30<00:22, 11.73it/s, est. speed input: 5391.36 toks/s, output: 1388.96 toks/s]
Processed prompts:  51%|█████▏    | 270/526 [00:31<00:22, 11.14it/s, est. speed input: 5389.02 toks/s, output: 1389.13 toks/s]
Processed prompts:  52%|█████▏    | 272/526 [00:31<00:22, 11.25it/s, est. speed input: 5401.48 toks/s, output: 1391.18 toks/s]
Processed prompts:  52%|█████▏    | 276/526 [00:31<00:15, 16.05it/s, est. speed input: 5454.33 toks/s, output: 1404.77 toks/s]
Processed prompts:  54%|█████▍    | 283/526 [00:31<00:10, 24.27it/s, est. speed input: 5560.88 toks/s, output: 1433.21 toks/s]
Processed prompts:  55%|█████▍    | 288/526 [00:31<00:08, 28.61it/s, est. speed input: 5613.07 toks/s, output: 1451.94 toks/s]
Processed prompts:  56%|█████▌    | 293/526 [00:31<00:07, 32.26it/s, est. speed input: 5746.01 toks/s, output: 1467.60 toks/s]
Processed prompts:  57%|█████▋    | 298/526 [00:31<00:06, 35.27it/s, est. speed input: 5835.80 toks/s, output: 1489.04 toks/s]
Processed prompts:  58%|█████▊    | 304/526 [00:32<00:06, 36.80it/s, est. speed input: 5919.09 toks/s, output: 1509.53 toks/s]
Processed prompts:  59%|█████▊    | 308/526 [00:32<00:10, 20.50it/s, est. speed input: 5919.85 toks/s, output: 1507.95 toks/s]
Processed prompts:  60%|█████▉    | 315/526 [00:32<00:07, 27.80it/s, est. speed input: 6036.95 toks/s, output: 1534.18 toks/s]
Processed prompts:  61%|██████    | 322/526 [00:32<00:05, 34.94it/s, est. speed input: 6150.65 toks/s, output: 1562.15 toks/s]
Processed prompts:  63%|██████▎   | 329/526 [00:32<00:04, 41.55it/s, est. speed input: 6287.20 toks/s, output: 1589.69 toks/s]
Processed prompts:  64%|██████▎   | 335/526 [00:32<00:04, 45.21it/s, est. speed input: 6395.99 toks/s, output: 1611.93 toks/s]
Processed prompts:  65%|██████▌   | 343/526 [00:33<00:03, 53.33it/s, est. speed input: 6528.34 toks/s, output: 1644.67 toks/s]
Processed prompts:  67%|██████▋   | 353/526 [00:33<00:02, 60.36it/s, est. speed input: 6687.23 toks/s, output: 1685.33 toks/s]
Processed prompts:  69%|██████▊   | 361/526 [00:33<00:02, 61.12it/s, est. speed input: 6835.49 toks/s, output: 1717.62 toks/s]
Processed prompts:  71%|███████   | 372/526 [00:33<00:02, 69.06it/s, est. speed input: 7016.22 toks/s, output: 1770.05 toks/s]
Processed prompts:  73%|███████▎  | 382/526 [00:33<00:01, 72.95it/s, est. speed input: 7202.29 toks/s, output: 1814.72 toks/s]
Processed prompts:  74%|███████▍  | 390/526 [00:33<00:01, 71.44it/s, est. speed input: 7341.15 toks/s, output: 1846.21 toks/s]
Processed prompts:  76%|███████▌  | 398/526 [00:33<00:01, 70.66it/s, est. speed input: 7473.19 toks/s, output: 1885.29 toks/s]
Processed prompts:  77%|███████▋  | 406/526 [00:33<00:01, 72.94it/s, est. speed input: 7608.55 toks/s, output: 1921.19 toks/s]
Processed prompts:  79%|███████▉  | 416/526 [00:34<00:01, 75.83it/s, est. speed input: 7785.02 toks/s, output: 1962.06 toks/s]
Processed prompts:  81%|████████  | 424/526 [00:34<00:01, 73.57it/s, est. speed input: 7906.53 toks/s, output: 1996.02 toks/s]
Processed prompts:  82%|████████▏ | 432/526 [00:34<00:01, 72.55it/s, est. speed input: 8058.20 toks/s, output: 2038.10 toks/s]
Processed prompts:  85%|████████▍ | 445/526 [00:34<00:00, 85.82it/s, est. speed input: 8291.61 toks/s, output: 2102.61 toks/s]
Processed prompts:  87%|████████▋ | 455/526 [00:34<00:00, 88.47it/s, est. speed input: 8534.28 toks/s, output: 2149.88 toks/s]
Processed prompts:  88%|████████▊ | 464/526 [00:34<00:00, 84.21it/s, est. speed input: 8732.09 toks/s, output: 2186.88 toks/s]
Processed prompts:  90%|████████▉ | 473/526 [00:34<00:00, 64.10it/s, est. speed input: 8888.76 toks/s, output: 2230.76 toks/s]
Processed prompts:  91%|█████████▏| 481/526 [00:35<00:00, 50.88it/s, est. speed input: 9029.80 toks/s, output: 2258.96 toks/s]
Processed prompts:  93%|█████████▎| 487/526 [00:35<00:00, 44.73it/s, est. speed input: 9099.59 toks/s, output: 2281.93 toks/s]
Processed prompts:  94%|█████████▎| 493/526 [00:35<00:00, 38.22it/s, est. speed input: 9173.48 toks/s, output: 2300.14 toks/s]
Processed prompts:  95%|█████████▍| 499/526 [00:35<00:00, 41.86it/s, est. speed input: 9276.83 toks/s, output: 2325.28 toks/s]
Processed prompts:  96%|█████████▌| 504/526 [00:35<00:00, 37.13it/s, est. speed input: 9340.62 toks/s, output: 2338.92 toks/s]
Processed prompts:  97%|█████████▋| 509/526 [00:35<00:00, 31.29it/s, est. speed input: 9392.94 toks/s, output: 2353.20 toks/s]
Processed prompts:  98%|█████████▊| 513/526 [00:36<00:00, 25.67it/s, est. speed input: 9406.25 toks/s, output: 2371.21 toks/s]
Processed prompts:  98%|█████████▊| 516/526 [00:36<00:00, 25.63it/s, est. speed input: 9468.92 toks/s, output: 2383.99 toks/s]
Processed prompts:  99%|█████████▊| 519/526 [00:37<00:00, 12.96it/s, est. speed input: 9360.87 toks/s, output: 2369.48 toks/s]
Processed prompts:  99%|█████████▉| 522/526 [00:37<00:00, 11.13it/s, est. speed input: 9322.06 toks/s, output: 2372.38 toks/s]
Processed prompts: 100%|█████████▉| 524/526 [00:37<00:00, 10.91it/s, est. speed input: 9318.76 toks/s, output: 2382.06 toks/s]
Processed prompts: 100%|██████████| 526/526 [00:38<00:00,  7.60it/s, est. speed input: 9254.33 toks/s, output: 2369.73 toks/s]
Processed prompts: 100%|██████████| 526/526 [00:38<00:00, 13.78it/s, est. speed input: 9254.33 toks/s, output: 2369.73 toks/s]
[rank0]:[W708 16:50:33.359739860 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/lp_rag_full_profile_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-08 16:50:36.567275_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-08 16:50:36.567275_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-08 16:50:36.567275_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<03:01,  2.33it/s]
  0%|          | 2/424 [00:01<05:02,  1.40it/s]
  1%|          | 3/424 [00:01<03:03,  2.29it/s]
  1%|          | 4/424 [00:03<06:31,  1.07it/s]
  1%|          | 5/424 [00:03<04:49,  1.45it/s]
  2%|▏         | 7/424 [00:04<04:06,  1.69it/s]
  2%|▏         | 8/424 [00:05<04:09,  1.66it/s]
  2%|▏         | 9/424 [00:05<03:14,  2.14it/s]
  2%|▏         | 10/424 [00:05<02:51,  2.41it/s]
  3%|▎         | 11/424 [00:05<02:19,  2.96it/s]
  3%|▎         | 12/424 [00:05<02:14,  3.07it/s]
  3%|▎         | 13/424 [00:07<05:10,  1.33it/s]
  3%|▎         | 14/424 [00:07<03:58,  1.72it/s]
  4%|▎         | 15/424 [00:08<03:13,  2.11it/s]
  4%|▍         | 16/424 [00:08<03:26,  1.98it/s]
  4%|▍         | 17/424 [00:08<02:56,  2.30it/s]
  4%|▍         | 18/424 [00:09<02:32,  2.66it/s]
  4%|▍         | 19/424 [00:09<02:59,  2.25it/s]
  5%|▍         | 20/424 [00:09<02:26,  2.75it/s]
  5%|▍         | 21/424 [00:10<01:59,  3.37it/s]
  5%|▌         | 22/424 [00:10<02:40,  2.50it/s]
  5%|▌         | 23/424 [00:12<04:48,  1.39it/s]
  6%|▌         | 24/424 [00:12<04:36,  1.45it/s]
  6%|▌         | 25/424 [00:13<05:03,  1.31it/s]
  6%|▌         | 26/424 [00:14<04:44,  1.40it/s]
  6%|▋         | 27/424 [00:15<06:38,  1.00s/it]
  7%|▋         | 28/424 [00:16<05:50,  1.13it/s]
  7%|▋         | 29/424 [00:16<04:36,  1.43it/s]
  7%|▋         | 30/424 [00:17<03:34,  1.83it/s]
  7%|▋         | 31/424 [00:17<03:41,  1.77it/s]
  8%|▊         | 33/424 [00:17<02:11,  2.98it/s]
  8%|▊         | 34/424 [00:18<02:03,  3.15it/s]
  8%|▊         | 36/424 [00:18<01:22,  4.70it/s]
  9%|▊         | 37/424 [00:18<02:09,  2.99it/s]
  9%|▉         | 38/424 [00:19<02:03,  3.13it/s]
  9%|▉         | 40/424 [00:19<01:33,  4.11it/s]
 10%|▉         | 41/424 [00:19<01:33,  4.08it/s]
 10%|▉         | 42/424 [00:20<02:08,  2.97it/s]
 10%|█         | 43/424 [00:20<01:48,  3.50it/s]
 10%|█         | 44/424 [00:22<04:07,  1.53it/s]
 11%|█         | 45/424 [00:22<04:02,  1.56it/s]
 11%|█         | 46/424 [00:22<03:21,  1.88it/s]
 11%|█         | 47/424 [00:23<03:28,  1.81it/s]
 11%|█▏        | 48/424 [00:24<03:37,  1.73it/s]
 12%|█▏        | 49/424 [00:24<03:40,  1.70it/s]
 12%|█▏        | 51/424 [00:25<02:54,  2.14it/s]
 12%|█▏        | 52/424 [00:25<02:53,  2.14it/s]
 12%|█▎        | 53/424 [00:26<03:05,  1.99it/s]
 13%|█▎        | 54/424 [00:27<03:44,  1.65it/s]
 13%|█▎        | 55/424 [00:27<03:08,  1.96it/s]
 13%|█▎        | 56/424 [00:28<03:18,  1.86it/s]
 14%|█▎        | 58/424 [00:28<01:59,  3.07it/s]
 14%|█▍        | 59/424 [00:30<03:56,  1.54it/s]
 15%|█▍        | 62/424 [00:33<05:14,  1.15it/s]
 15%|█▍        | 63/424 [00:33<04:56,  1.22it/s]
 15%|█▌        | 64/424 [00:34<04:12,  1.43it/s]
 15%|█▌        | 65/424 [00:34<03:20,  1.79it/s]
 16%|█▌        | 66/424 [00:35<04:59,  1.20it/s]
 16%|█▌        | 67/424 [00:36<03:58,  1.49it/s]
 16%|█▌        | 68/424 [00:36<03:47,  1.56it/s]
 16%|█▋        | 69/424 [00:38<05:26,  1.09it/s]
 17%|█▋        | 70/424 [00:38<04:26,  1.33it/s]
 17%|█▋        | 71/424 [00:39<03:43,  1.58it/s]
 17%|█▋        | 72/424 [00:39<03:13,  1.82it/s]
 17%|█▋        | 73/424 [00:39<02:51,  2.05it/s]
 17%|█▋        | 74/424 [00:40<02:34,  2.27it/s]
 18%|█▊        | 75/424 [00:42<05:16,  1.10it/s]
 18%|█▊        | 77/424 [00:42<03:21,  1.72it/s]
 18%|█▊        | 78/424 [00:42<02:42,  2.13it/s]
 19%|█▉        | 80/424 [00:42<01:48,  3.16it/s]
 19%|█▉        | 81/424 [00:43<02:28,  2.31it/s]
 19%|█▉        | 82/424 [00:44<02:58,  1.92it/s]
 20%|█▉        | 83/424 [00:45<03:37,  1.57it/s]
 20%|█▉        | 84/424 [00:45<02:47,  2.03it/s]
 20%|██        | 85/424 [00:46<03:34,  1.58it/s]
 20%|██        | 86/424 [00:47<03:54,  1.44it/s]
 21%|██        | 87/424 [00:48<04:22,  1.29it/s]
 21%|██        | 88/424 [00:48<03:40,  1.52it/s]
 21%|██        | 89/424 [00:49<04:11,  1.33it/s]
 21%|██        | 90/424 [00:49<03:14,  1.71it/s]
 21%|██▏       | 91/424 [00:50<03:56,  1.41it/s]
 22%|██▏       | 92/424 [00:51<04:23,  1.26it/s]
 22%|██▏       | 93/424 [00:52<04:04,  1.36it/s]
 22%|██▏       | 94/424 [00:53<04:25,  1.24it/s]
 22%|██▏       | 95/424 [00:53<03:17,  1.66it/s]
 23%|██▎       | 96/424 [00:53<02:50,  1.92it/s]
 23%|██▎       | 98/424 [00:54<01:44,  3.12it/s]
 23%|██▎       | 99/424 [00:54<01:31,  3.57it/s]
 24%|██▎       | 100/424 [00:54<01:55,  2.81it/s]
 24%|██▍       | 101/424 [00:56<03:21,  1.61it/s]
 24%|██▍       | 102/424 [00:56<02:50,  1.89it/s]
 24%|██▍       | 103/424 [00:56<02:22,  2.25it/s]
 25%|██▍       | 104/424 [00:56<01:57,  2.73it/s]
 25%|██▍       | 105/424 [00:57<02:23,  2.22it/s]
 25%|██▌       | 106/424 [00:57<01:52,  2.84it/s]
 25%|██▌       | 107/424 [00:58<02:19,  2.27it/s]
 26%|██▌       | 109/424 [01:01<05:24,  1.03s/it]
 26%|██▌       | 110/424 [01:03<06:13,  1.19s/it]
 26%|██▌       | 111/424 [01:03<05:17,  1.01s/it]
 26%|██▋       | 112/424 [01:04<04:01,  1.29it/s]
 27%|██▋       | 114/424 [01:04<02:23,  2.16it/s]
 27%|██▋       | 116/424 [01:04<01:40,  3.07it/s]
 28%|██▊       | 118/424 [01:04<01:18,  3.88it/s]
 28%|██▊       | 119/424 [01:04<01:14,  4.10it/s]
 29%|██▊       | 121/424 [01:05<01:00,  4.99it/s]
 29%|██▉       | 122/424 [01:11<07:46,  1.54s/it]
 29%|██▉       | 123/424 [01:18<13:47,  2.75s/it]
 29%|██▉       | 124/424 [01:25<18:46,  3.75s/it]
 29%|██▉       | 125/424 [01:32<22:36,  4.54s/it]
 30%|██▉       | 126/424 [01:39<25:39,  5.17s/it]
 30%|██▉       | 127/424 [01:45<27:54,  5.64s/it]
 30%|███       | 128/424 [01:46<21:15,  4.31s/it]
 30%|███       | 129/424 [01:47<16:21,  3.33s/it]
 31%|███       | 130/424 [01:48<12:50,  2.62s/it]
 31%|███       | 131/424 [01:49<10:24,  2.13s/it]
 31%|███       | 132/424 [01:50<07:58,  1.64s/it]
 31%|███▏      | 133/424 [01:50<06:32,  1.35s/it]
 32%|███▏      | 134/424 [01:50<04:44,  1.02it/s]
 32%|███▏      | 135/424 [01:51<03:34,  1.35it/s]
 32%|███▏      | 136/424 [01:51<02:45,  1.74it/s]
 32%|███▏      | 137/424 [01:51<02:11,  2.18it/s]
 33%|███▎      | 138/424 [01:51<01:46,  2.68it/s]
 33%|███▎      | 139/424 [01:51<01:29,  3.18it/s]
 33%|███▎      | 140/424 [01:51<01:12,  3.93it/s]
 33%|███▎      | 141/424 [01:52<01:05,  4.34it/s]
 33%|███▎      | 142/424 [01:52<01:01,  4.59it/s]
 34%|███▎      | 143/424 [01:52<00:58,  4.81it/s]
 34%|███▍      | 144/424 [01:52<00:56,  4.97it/s]
 34%|███▍      | 145/424 [01:52<00:53,  5.22it/s]
 34%|███▍      | 146/424 [01:52<00:51,  5.36it/s]
 35%|███▍      | 147/424 [01:53<00:51,  5.43it/s]
 35%|███▍      | 148/424 [01:53<00:50,  5.45it/s]
 35%|███▌      | 149/424 [01:53<00:50,  5.47it/s]
 35%|███▌      | 150/424 [01:53<00:50,  5.44it/s]
 36%|███▌      | 151/424 [01:53<00:50,  5.41it/s]
 36%|███▌      | 152/424 [01:54<00:49,  5.48it/s]
 36%|███▌      | 153/424 [01:54<00:49,  5.48it/s]
 36%|███▋      | 154/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 155/424 [01:54<00:48,  5.54it/s]
 37%|███▋      | 156/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 157/424 [01:54<00:48,  5.51it/s]
 37%|███▋      | 158/424 [01:55<00:48,  5.50it/s]
 38%|███▊      | 159/424 [01:55<00:48,  5.48it/s]
 38%|███▊      | 160/424 [01:57<02:57,  1.48it/s]
 38%|███▊      | 161/424 [01:57<02:18,  1.90it/s]
 38%|███▊      | 162/424 [01:57<01:51,  2.35it/s]
 38%|███▊      | 163/424 [01:57<01:31,  2.86it/s]
 39%|███▊      | 164/424 [01:57<01:18,  3.32it/s]
 39%|███▉      | 165/424 [01:58<01:08,  3.77it/s]
 39%|███▉      | 166/424 [01:58<00:56,  4.53it/s]
 39%|███▉      | 167/424 [01:58<00:54,  4.74it/s]
 40%|███▉      | 168/424 [01:58<01:01,  4.18it/s]
 40%|███▉      | 169/424 [01:59<01:08,  3.71it/s]
 40%|████      | 170/424 [01:59<01:11,  3.53it/s]
 40%|████      | 171/424 [01:59<01:23,  3.05it/s]
 41%|████      | 172/424 [01:59<01:07,  3.75it/s]
 41%|████      | 174/424 [02:00<01:28,  2.84it/s]
 41%|████▏     | 175/424 [02:00<01:12,  3.42it/s]
 42%|████▏     | 176/424 [02:01<01:03,  3.89it/s]
 42%|████▏     | 177/424 [02:01<00:56,  4.36it/s]
 42%|████▏     | 178/424 [02:01<01:00,  4.04it/s]
 42%|████▏     | 179/424 [02:01<01:00,  4.08it/s]
 42%|████▏     | 180/424 [02:02<01:09,  3.49it/s]
 43%|████▎     | 181/424 [02:02<00:59,  4.07it/s]
 43%|████▎     | 182/424 [02:02<00:57,  4.22it/s]
 43%|████▎     | 183/424 [02:02<00:56,  4.28it/s]
 43%|████▎     | 184/424 [02:03<01:17,  3.10it/s]
 44%|████▎     | 185/424 [02:03<01:38,  2.44it/s]
 44%|████▍     | 186/424 [02:04<01:42,  2.33it/s]
 44%|████▍     | 187/424 [02:04<01:36,  2.46it/s]
 44%|████▍     | 188/424 [02:05<01:34,  2.49it/s]
 45%|████▍     | 189/424 [02:06<02:58,  1.32it/s]
 45%|████▍     | 190/424 [02:10<06:53,  1.77s/it]
 45%|████▌     | 191/424 [02:11<05:14,  1.35s/it]
 45%|████▌     | 192/424 [02:12<05:34,  1.44s/it]
 46%|████▌     | 194/424 [02:13<03:23,  1.13it/s]
 46%|████▌     | 196/424 [02:13<02:28,  1.53it/s]
 46%|████▋     | 197/424 [02:14<02:09,  1.76it/s]
 47%|████▋     | 198/424 [02:14<01:48,  2.08it/s]
 47%|████▋     | 199/424 [02:15<02:03,  1.82it/s]
 47%|████▋     | 200/424 [02:15<01:41,  2.20it/s]
 47%|████▋     | 201/424 [02:16<02:53,  1.28it/s]
 48%|████▊     | 202/424 [02:17<02:15,  1.64it/s]
 48%|████▊     | 203/424 [02:18<03:23,  1.09it/s]
 48%|████▊     | 204/424 [02:21<05:45,  1.57s/it]
 48%|████▊     | 205/424 [02:22<04:37,  1.27s/it]
 49%|████▊     | 206/424 [02:25<06:31,  1.79s/it]
 49%|████▉     | 207/424 [02:25<04:51,  1.34s/it]
 49%|████▉     | 208/424 [02:26<03:44,  1.04s/it]
 49%|████▉     | 209/424 [02:26<02:48,  1.28it/s]
 50%|████▉     | 210/424 [02:26<02:16,  1.57it/s]
 50%|█████     | 212/424 [02:26<01:21,  2.61it/s]
 50%|█████     | 213/424 [02:27<01:28,  2.38it/s]
 50%|█████     | 214/424 [02:27<01:35,  2.19it/s]
 51%|█████     | 215/424 [02:28<01:56,  1.79it/s]
 51%|█████     | 216/424 [02:28<01:33,  2.23it/s]
 51%|█████     | 217/424 [02:29<01:18,  2.64it/s]
 51%|█████▏    | 218/424 [02:29<01:12,  2.86it/s]
 52%|█████▏    | 219/424 [02:29<01:06,  3.07it/s]
 52%|█████▏    | 220/424 [02:30<01:37,  2.09it/s]
 52%|█████▏    | 221/424 [02:30<01:26,  2.34it/s]
 52%|█████▏    | 222/424 [02:31<01:19,  2.55it/s]
 53%|█████▎    | 223/424 [02:31<01:11,  2.80it/s]
 53%|█████▎    | 224/424 [02:31<01:08,  2.93it/s]
 53%|█████▎    | 225/424 [02:33<02:21,  1.40it/s]
 54%|█████▎    | 227/424 [02:33<01:32,  2.14it/s]
 54%|█████▍    | 229/424 [02:33<01:02,  3.11it/s]
 54%|█████▍    | 230/424 [02:37<03:05,  1.05it/s]
 54%|█████▍    | 231/424 [02:37<02:44,  1.17it/s]
 55%|█████▍    | 233/424 [02:39<02:44,  1.16it/s]
 55%|█████▌    | 234/424 [02:46<07:04,  2.24s/it]
 55%|█████▌    | 235/424 [02:47<05:57,  1.89s/it]
 56%|█████▌    | 236/424 [02:47<04:41,  1.50s/it]
 56%|█████▌    | 238/424 [02:47<02:46,  1.12it/s]
 57%|█████▋    | 240/424 [02:49<02:42,  1.13it/s]
 57%|█████▋    | 241/424 [02:50<02:39,  1.15it/s]
 57%|█████▋    | 242/424 [02:50<02:07,  1.43it/s]
 57%|█████▋    | 243/424 [02:50<01:52,  1.61it/s]
 58%|█████▊    | 244/424 [02:51<01:53,  1.58it/s]
 58%|█████▊    | 245/424 [02:51<01:28,  2.02it/s]
 58%|█████▊    | 246/424 [02:51<01:18,  2.26it/s]
 58%|█████▊    | 247/424 [02:53<02:19,  1.27it/s]
 58%|█████▊    | 248/424 [02:53<01:44,  1.68it/s]
 59%|█████▊    | 249/424 [02:53<01:19,  2.21it/s]
 59%|█████▉    | 250/424 [02:54<01:29,  1.94it/s]
 59%|█████▉    | 251/424 [02:54<01:11,  2.42it/s]
 59%|█████▉    | 252/424 [02:54<00:55,  3.09it/s]
 60%|█████▉    | 253/424 [02:54<00:44,  3.84it/s]
 60%|█████▉    | 254/424 [02:54<00:36,  4.62it/s]
 60%|██████    | 255/424 [02:54<00:31,  5.45it/s]
 60%|██████    | 256/424 [02:55<00:27,  6.19it/s]
 61%|██████    | 257/424 [02:55<00:24,  6.83it/s]
 61%|██████    | 258/424 [02:55<00:22,  7.29it/s]
 61%|██████    | 259/424 [02:55<00:29,  5.52it/s]
 61%|██████▏   | 260/424 [02:56<01:08,  2.41it/s]
 62%|██████▏   | 261/424 [02:56<00:52,  3.12it/s]
 62%|██████▏   | 263/424 [02:57<01:05,  2.44it/s]
 62%|██████▏   | 264/424 [02:57<00:53,  3.00it/s]
 63%|██████▎   | 266/424 [02:58<00:46,  3.40it/s]
 63%|██████▎   | 267/424 [02:58<00:39,  3.96it/s]
 63%|██████▎   | 268/424 [02:58<00:33,  4.59it/s]
 63%|██████▎   | 269/424 [02:59<00:57,  2.68it/s]
 64%|██████▎   | 270/424 [02:59<00:46,  3.31it/s]
 64%|██████▍   | 272/424 [02:59<00:30,  4.94it/s]
 64%|██████▍   | 273/424 [02:59<00:30,  4.97it/s]
 65%|██████▍   | 275/424 [02:59<00:21,  6.96it/s]
 65%|██████▌   | 277/424 [03:00<00:17,  8.27it/s]
 66%|██████▌   | 279/424 [03:01<00:40,  3.60it/s]
 66%|██████▌   | 280/424 [03:01<00:43,  3.30it/s]
 66%|██████▋   | 281/424 [03:01<00:46,  3.09it/s]
 67%|██████▋   | 283/424 [03:05<01:55,  1.22it/s]
 67%|██████▋   | 284/424 [03:05<01:33,  1.49it/s]
 67%|██████▋   | 285/424 [03:05<01:14,  1.86it/s]
 68%|██████▊   | 287/424 [03:05<00:56,  2.44it/s]
 68%|██████▊   | 288/424 [03:06<00:53,  2.52it/s]
 68%|██████▊   | 289/424 [03:06<00:49,  2.72it/s]
 69%|██████▊   | 291/424 [03:06<00:36,  3.67it/s]
 69%|██████▉   | 292/424 [03:06<00:30,  4.27it/s]
 69%|██████▉   | 293/424 [03:10<02:05,  1.04it/s]
 70%|██████▉   | 295/424 [03:10<01:35,  1.34it/s]
 70%|██████▉   | 296/424 [03:11<01:17,  1.66it/s]
 70%|███████   | 297/424 [03:11<01:09,  1.82it/s]
 70%|███████   | 298/424 [03:11<00:58,  2.14it/s]
 71%|███████   | 299/424 [03:11<00:48,  2.56it/s]
 71%|███████   | 301/424 [03:12<00:35,  3.46it/s]
 71%|███████   | 302/424 [03:19<03:45,  1.85s/it]
 71%|███████▏  | 303/424 [03:19<02:58,  1.48s/it]
 72%|███████▏  | 304/424 [03:19<02:15,  1.13s/it]
 72%|███████▏  | 305/424 [03:19<01:48,  1.10it/s]
 72%|███████▏  | 306/424 [03:20<01:30,  1.30it/s]
 72%|███████▏  | 307/424 [03:20<01:07,  1.73it/s]
 73%|███████▎  | 308/424 [03:20<00:55,  2.07it/s]
 73%|███████▎  | 309/424 [03:21<00:57,  2.01it/s]
 73%|███████▎  | 310/424 [03:22<01:13,  1.55it/s]
 74%|███████▎  | 312/424 [03:22<00:45,  2.45it/s]
 74%|███████▍  | 313/424 [03:22<00:40,  2.76it/s]
 74%|███████▍  | 314/424 [03:23<00:41,  2.68it/s]
 74%|███████▍  | 315/424 [03:24<01:07,  1.62it/s]
 75%|███████▍  | 316/424 [03:24<00:51,  2.10it/s]
 75%|███████▍  | 317/424 [03:25<01:17,  1.38it/s]
 75%|███████▌  | 318/424 [03:27<01:35,  1.11it/s]
 75%|███████▌  | 319/424 [03:27<01:17,  1.36it/s]
 75%|███████▌  | 320/424 [03:27<00:59,  1.74it/s]
 76%|███████▌  | 322/424 [03:27<00:35,  2.87it/s]
 76%|███████▌  | 323/424 [03:28<00:31,  3.23it/s]
 76%|███████▋  | 324/424 [03:28<00:27,  3.67it/s]
 77%|███████▋  | 325/424 [03:28<00:24,  4.06it/s]
 77%|███████▋  | 326/424 [03:35<03:23,  2.08s/it]
 77%|███████▋  | 327/424 [03:36<03:00,  1.86s/it]
 77%|███████▋  | 328/424 [03:37<02:28,  1.55s/it]
 78%|███████▊  | 329/424 [03:37<01:55,  1.22s/it]
 78%|███████▊  | 330/424 [03:39<01:57,  1.25s/it]
 78%|███████▊  | 331/424 [03:39<01:25,  1.09it/s]
 79%|███████▊  | 333/424 [03:40<01:16,  1.19it/s]
 79%|███████▉  | 334/424 [03:41<01:05,  1.37it/s]
 79%|███████▉  | 335/424 [03:41<01:02,  1.42it/s]
 79%|███████▉  | 336/424 [03:43<01:31,  1.04s/it]
 79%|███████▉  | 337/424 [03:50<03:49,  2.64s/it]
 80%|███████▉  | 338/424 [03:50<02:53,  2.01s/it]
 80%|███████▉  | 339/424 [03:51<02:24,  1.70s/it]
 80%|████████  | 340/424 [03:58<04:27,  3.19s/it]
 80%|████████  | 341/424 [04:00<03:47,  2.74s/it]
 81%|████████  | 342/424 [04:01<03:17,  2.41s/it]
 81%|████████  | 343/424 [04:02<02:20,  1.74s/it]
 81%|████████  | 344/424 [04:02<01:54,  1.43s/it]
 81%|████████▏ | 345/424 [04:02<01:22,  1.04s/it]
 82%|████████▏ | 346/424 [04:03<01:06,  1.18it/s]
 82%|████████▏ | 347/424 [04:03<01:02,  1.23it/s]
 83%|████████▎ | 350/424 [04:04<00:38,  1.91it/s]
 83%|████████▎ | 352/424 [04:11<01:49,  1.53s/it]
 83%|████████▎ | 353/424 [04:12<01:34,  1.33s/it]
 83%|████████▎ | 354/424 [04:13<01:27,  1.25s/it]
 84%|████████▎ | 355/424 [04:13<01:08,  1.01it/s]
 84%|████████▍ | 356/424 [04:14<01:18,  1.15s/it]
 84%|████████▍ | 357/424 [04:15<01:13,  1.09s/it]
 84%|████████▍ | 358/424 [04:16<01:11,  1.08s/it]
 85%|████████▍ | 359/424 [04:17<01:09,  1.06s/it]
 85%|████████▍ | 360/424 [04:18<00:52,  1.21it/s]
 85%|████████▌ | 361/424 [04:18<00:40,  1.55it/s]
 85%|████████▌ | 362/424 [04:18<00:34,  1.78it/s]
 86%|████████▌ | 363/424 [04:25<02:24,  2.37s/it]
 86%|████████▌ | 364/424 [04:25<01:47,  1.79s/it]
 86%|████████▌ | 365/424 [04:26<01:17,  1.31s/it]
 86%|████████▋ | 366/424 [04:26<00:55,  1.05it/s]
 87%|████████▋ | 367/424 [04:26<00:39,  1.43it/s]
 87%|████████▋ | 368/424 [04:33<02:22,  2.54s/it]
 87%|████████▋ | 369/424 [04:33<01:43,  1.88s/it]
 87%|████████▋ | 370/424 [04:33<01:12,  1.35s/it]
 88%|████████▊ | 372/424 [04:33<00:40,  1.29it/s]
 88%|████████▊ | 373/424 [04:33<00:32,  1.57it/s]
 88%|████████▊ | 374/424 [04:34<00:36,  1.39it/s]
 89%|████████▊ | 376/424 [04:35<00:27,  1.74it/s]
 89%|████████▉ | 377/424 [04:37<00:35,  1.34it/s]
 89%|████████▉ | 378/424 [04:37<00:27,  1.68it/s]
 89%|████████▉ | 379/424 [04:37<00:26,  1.70it/s]
 90%|████████▉ | 380/424 [04:39<00:37,  1.17it/s]
 90%|█████████ | 382/424 [04:40<00:33,  1.26it/s]
 91%|█████████ | 384/424 [04:41<00:21,  1.84it/s]
 91%|█████████ | 385/424 [04:41<00:18,  2.13it/s]
 91%|█████████▏| 387/424 [04:41<00:11,  3.22it/s]
 92%|█████████▏| 388/424 [04:41<00:13,  2.67it/s]
 92%|█████████▏| 389/424 [04:46<00:44,  1.28s/it]
 92%|█████████▏| 390/424 [04:46<00:34,  1.01s/it]
 92%|█████████▏| 391/424 [04:46<00:25,  1.28it/s]
 92%|█████████▏| 392/424 [04:46<00:19,  1.67it/s]
 93%|█████████▎| 393/424 [04:47<00:19,  1.59it/s]
 93%|█████████▎| 394/424 [04:47<00:19,  1.56it/s]
 93%|█████████▎| 395/424 [04:49<00:27,  1.06it/s]
 93%|█████████▎| 396/424 [04:50<00:26,  1.05it/s]
 94%|█████████▎| 397/424 [04:51<00:28,  1.06s/it]
 94%|█████████▍| 398/424 [04:53<00:29,  1.12s/it]
 94%|█████████▍| 399/424 [04:53<00:22,  1.11it/s]
 94%|█████████▍| 400/424 [04:54<00:19,  1.23it/s]
 95%|█████████▍| 401/424 [04:54<00:14,  1.56it/s]
 95%|█████████▍| 402/424 [04:57<00:30,  1.41s/it]
 95%|█████████▌| 403/424 [05:00<00:36,  1.76s/it]
 95%|█████████▌| 404/424 [05:00<00:25,  1.29s/it]
 96%|█████████▌| 405/424 [05:00<00:19,  1.03s/it]
 96%|█████████▌| 406/424 [05:00<00:13,  1.33it/s]
 96%|█████████▌| 407/424 [05:02<00:15,  1.09it/s]
 96%|█████████▌| 408/424 [05:03<00:15,  1.06it/s]
 96%|█████████▋| 409/424 [05:05<00:21,  1.44s/it]
 97%|█████████▋| 410/424 [05:06<00:15,  1.11s/it]
 97%|█████████▋| 411/424 [05:07<00:13,  1.05s/it]
 97%|█████████▋| 412/424 [05:07<00:09,  1.28it/s]
 97%|█████████▋| 413/424 [05:08<00:11,  1.04s/it]
 98%|█████████▊| 415/424 [05:10<00:08,  1.08it/s]
 98%|█████████▊| 416/424 [05:11<00:06,  1.16it/s]
 98%|█████████▊| 417/424 [05:11<00:05,  1.26it/s]
 99%|█████████▊| 418/424 [05:16<00:10,  1.73s/it]
 99%|█████████▉| 419/424 [05:16<00:07,  1.42s/it]
 99%|█████████▉| 420/424 [05:18<00:05,  1.49s/it]
 99%|█████████▉| 421/424 [05:19<00:04,  1.34s/it]
100%|█████████▉| 422/424 [05:19<00:01,  1.01it/s]
100%|█████████▉| 423/424 [05:23<00:01,  1.92s/it]
100%|██████████| 424/424 [05:24<00:00,  1.65s/it]
100%|██████████| 424/424 [05:24<00:00,  1.31it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-08 16:50:36.567275_sc_processed_test.json', '--output_addr', 'data/out/rag/full_profile/sc_rag_full_profile_test_2_output.json', '--temperature', '0.0', '--top_p', '0.95', '--max_tokens', '4096', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/work/pi_hzamani_umass_edu/ozel_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.54 examples/s]
Generating train split: 424 examples [00:00, 695.88 examples/s]
INFO 07-08 16:56:33 config.py:510] This model supports multiple tasks: {'classify', 'reward', 'score', 'embed', 'generate'}. Defaulting to 'generate'.
INFO 07-08 16:56:33 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/work/pi_hzamani_umass_edu/ozel_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-08 16:56:34 selector.py:120] Using Flash Attention backend.
INFO 07-08 16:56:42 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-08 16:56:42 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.62it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.52it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.48it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.50it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.51it/s]

INFO 07-08 16:56:45 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-08 16:56:47 worker.py:241] Memory profiling takes 2.22 seconds
INFO 07-08 16:56:47 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-08 16:56:47 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-08 16:56:48 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-08 16:56:48 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-08 16:56:51 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:17,  1.89it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:16,  2.00it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:15,  2.05it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:14,  2.07it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:02<00:14,  2.04it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:14,  2.06it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:03<00:13,  2.10it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:03<00:12,  2.09it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:04<00:11,  2.25it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:04<00:09,  2.52it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:04<00:08,  2.76it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:05<00:07,  2.95it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:05<00:08,  2.73it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:05<00:08,  2.54it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:06<00:08,  2.41it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:06<00:08,  2.33it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:07<00:07,  2.29it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:07<00:07,  2.26it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:08<00:07,  2.25it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:08<00:06,  2.26it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:09<00:06,  2.26it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:09<00:05,  2.24it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:10<00:05,  2.24it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:10<00:04,  2.24it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:10<00:04,  2.24it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:11<00:04,  2.24it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:11<00:03,  2.25it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:12<00:03,  2.25it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:12<00:02,  2.25it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:13<00:02,  2.26it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:13<00:01,  2.28it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:14<00:01,  2.31it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:14<00:00,  2.32it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:14<00:00,  2.37it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:15<00:00,  2.41it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:15<00:00,  2.30it/s]
INFO 07-08 16:57:06 model_runner.py:1535] Graph capturing finished in 15 secs, took 0.22 GiB
INFO 07-08 16:57:06 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 20.74 seconds
RAG ON
EXAMPLE PROMPT
<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
How open should I be with my PhD supervisor about the problems in my personal life? My marriage has been going through some problems in the last year which has affected my PhD. My supervisor has been very understanding and was keen for me not to interrupt and granted me a two month extension on my upgrade paper. Last week my wife walked out. She came back but this totally put me off my studies. I was supposed to hand in a paper - an optional paper since this was for a journal submission - but I haven't even drafted it and the draft was due tomorrow.My supervisor knows I have been having marriage problems but she doesn't know any details. Also she doesn't talk about her personal life much and I don't know if she's the kind of person who would be receptive to such details, so I have so far withheld them. Should I tell her my wife walked out? At the moment I have just said there was an incident. She also knows that I have been diagnosed with symptoms of moderate/severe depression, but I thought it best that she knew this since it could affect my work.Should I carry on being vague or should I test the water and treat her like an intelligent adult and give her more context and details of my issues? Or should I just keep the personal stuff as separate as possible?

My PhD seems daunting and overbearing. How shall I regain motivation and interest? EDIT: I should clarify this is not the first draft of my PhD, it's the first draft of my upgrade document to go from MPhil to PhD.I have been working on my PhD for about two years now, it is a six year part-time program. I have a very good relationship with all my supervisors and they are very supportive. I am fortunate to be part of a good university which is open-minded and free-thinking. I also have attracted the interest of a well-known external academic who is an authority within the field and who wants to be involved. I am very lucky.The problem is that I am just not that interested or convinced by my research [chiefly its significance]. I have to submit my upgrade document [MPhil > PhD] in about five week's time, and the viva is a week after that. I have written a draft document which is 12,000 words and my main supervisor has written a lot of comments which are suggestions for improvements. The issue is that I do not feel that interested or compelled to work through them. I am under the impression that my supervisor is not that convinced by my research, even though she keeps saying she has no concerns. I feel my research is too vague, too broad but also too overbearing. It incorporates three disciplines [at the advice of one of my supervisors], disciplines A B and C. Discipline A I am not that interested in - I was for my master's but now I find it quite tedious but it is quite an important part of the whole. It is a well-worn discipline and feels rather old and stale to me now. Discipline B is quite new and interesting, I have published within this discipline. Disipline C is very new and up-and-coming. I find it quite exciting and my supervisor has written the least amount of comments about it in my draft paper, which I take to mean she has the least amount of complaints about it [she has a lot of comments to make about dispclines A/B]. She has also said that discpline C is a 'key' part of the PhD. I do not know what to do. I am really not that interested and the whole thing seems so daunting. My PhD focuses on A and B mostly with C being only a feature, but I am wondering whether I should switch things round entirely and make it more about C. I feel I will not really be able to convince my panel about the significance of my research in the viva if I am not excited about it or convinced myself. In my master's I was always keen to research and write, now I am not, but I know I would be if the topic were carried out a bit differently. What shall I do, how shall I regain interest? My PhD seems rather fluffy and not sharp enough. Additionally, I am daunted by the scope of the whole thing: it seems too large to work through and 'bigger' than me. I am kind of at a loss for what to do.
# Current post question:
Bored with PhD - should I tell my supervisor?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Letting students grade their own homework I am going to teach a course in algorithms to 2nd-year undergraduates. The grade in this course is composed of 90% exam and 10% homework. The problem is, this year we do not have enough personnel to grade the homework. Theoretically, it may be possible to change the grade struture and make it 100% based on final exam, but, this will reduce the incentive of students to study and practice during the semester, which I think will harm their learning experience.So, I thought of the following scheme: the students will have to submit each assignment before the next TA session. The TA will explain the solutions during the session, and then each student will grade his/her own homework.Sure, some students might be tempted to give themselves 100 on all assignments, but I believe this will not be very harmful since:All assignments together compose only 10% of the grade, so every single assignment is less than 1%. Even if many students get 10% for free, the final exam is still sufficient to differentiate the good from the bad students. The group consists of excellent students (the top 20%, based on their 1st year mean grade). I believe most of them want to succeed in the exam, so they will take this as an opportunity to track their own progress during the course, rather than an opportunity to just get some points for free.What do you think about this scheme? 

Grades are too high for the department - what should I do? I recently taught an undergraduate seminar course, in which each student has to read a research paper, summarize it and present it to the class. In the first lesson I explained to the students the components of the grade: attendance, summary writing, and presentation quality. Most of the students did great jobs: attendance was near full, summaries were good, and presentations were great. Many of them did more than I expected - they contacted the paper's authors to get more information, presented movies and demos, engaged the class in discussions, etc. So, when I wrote the grades to myself, most of them were between 90 and 100. But then, when I told this to the department vice-chair, he told me "what have you done? You will cause a grade-inflation! The department policy is that the average grade on seminar courses should be at most 85!"I totally understand this policy - grades that are too high might show that the course was too easy, and they do not sufficiently distinguish between good and better students. Also, they might be unfair to students who took the course in previous years.However, I am not sure what I should do now. I haven't published the grades to the students yet. Should I just re-scale the grades so that 90 becomes 70? I feel this is somewhat unfair to the students who worked hard for their presentations. Are there better options?
# Current post question:
How can I motivate the teaching assistants to grade more strictly?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
What to do if ellipses are already in a text What should I do to let a reader know that in a quote the ellipses aren't mine and have been placed by the original author? This is the quote:  My home university did a study of its alumni a few years back, and they discovered that out of all the various degree subjects, the one that led to the highest average income was ... mathematics. (Stewart, Letters, 1)

What is the axiological basis of the preference of truth to falsity? Axiologically speaking, why is truth the preferred logical value by humans? In general, why do we prefer true statements to false ones? What about the value of true makes a statement "right," while false is "wrong?" Specifically, why do true statements seem to be valued higher than false statements and why does our day-to-day language seem to favor factual statements?
# Current post question:
How narrow or broad should I look for undergraduate research?
<|im_end|>
<|im_start|>assistant

None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:13<1:35:32, 13.55s/it, est. speed input: 30.40 toks/s, output: 7.08 toks/s]
Processed prompts:   1%|          | 3/424 [00:13<25:34,  3.65s/it, est. speed input: 127.04 toks/s, output: 21.28 toks/s]
Processed prompts:   1%|▏         | 6/424 [00:14<10:17,  1.48s/it, est. speed input: 290.52 toks/s, output: 43.05 toks/s]
Processed prompts:   2%|▏         | 7/424 [00:14<08:07,  1.17s/it, est. speed input: 331.68 toks/s, output: 50.43 toks/s]
Processed prompts:   2%|▏         | 9/424 [00:14<05:09,  1.34it/s, est. speed input: 411.48 toks/s, output: 65.26 toks/s]
Processed prompts:   3%|▎         | 11/424 [00:14<03:32,  1.94it/s, est. speed input: 487.06 toks/s, output: 80.09 toks/s]
Processed prompts:   3%|▎         | 13/424 [00:14<02:36,  2.63it/s, est. speed input: 554.46 toks/s, output: 94.80 toks/s]
Processed prompts:   3%|▎         | 14/424 [00:15<02:22,  2.89it/s, est. speed input: 589.96 toks/s, output: 101.73 toks/s]
Processed prompts:   4%|▍         | 17/424 [00:15<01:27,  4.65it/s, est. speed input: 690.54 toks/s, output: 125.13 toks/s]
Processed prompts:   5%|▌         | 23/424 [00:15<00:51,  7.79it/s, est. speed input: 933.10 toks/s, output: 171.00 toks/s]
Processed prompts:   6%|▌         | 25/424 [00:15<00:47,  8.39it/s, est. speed input: 990.05 toks/s, output: 185.58 toks/s]
Processed prompts:   7%|▋         | 28/424 [00:16<00:39,  9.92it/s, est. speed input: 1085.25 toks/s, output: 208.18 toks/s]
Processed prompts:   7%|▋         | 31/424 [00:16<00:38, 10.09it/s, est. speed input: 1163.38 toks/s, output: 229.22 toks/s]
Processed prompts:   8%|▊         | 34/424 [00:16<00:37, 10.37it/s, est. speed input: 1261.92 toks/s, output: 250.26 toks/s]
Processed prompts:   9%|▊         | 37/424 [00:16<00:30, 12.51it/s, est. speed input: 1380.34 toks/s, output: 273.29 toks/s]
Processed prompts:   9%|▉         | 39/424 [00:16<00:29, 13.19it/s, est. speed input: 1440.91 toks/s, output: 287.99 toks/s]
Processed prompts:  10%|▉         | 42/424 [00:17<00:29, 12.82it/s, est. speed input: 1540.36 toks/s, output: 308.75 toks/s]
Processed prompts:  11%|█         | 45/424 [00:17<00:26, 14.29it/s, est. speed input: 1614.24 toks/s, output: 330.79 toks/s]
Processed prompts:  11%|█         | 47/424 [00:17<00:27, 13.69it/s, est. speed input: 1663.54 toks/s, output: 344.18 toks/s]
Processed prompts:  12%|█▏        | 51/424 [00:17<00:22, 16.38it/s, est. speed input: 1763.20 toks/s, output: 373.78 toks/s]
Processed prompts:  12%|█▎        | 53/424 [00:17<00:23, 16.09it/s, est. speed input: 1822.14 toks/s, output: 387.55 toks/s]
Processed prompts:  13%|█▎        | 57/424 [00:18<00:23, 15.78it/s, est. speed input: 1911.63 toks/s, output: 414.83 toks/s]
Processed prompts:  15%|█▍        | 62/424 [00:18<00:21, 16.86it/s, est. speed input: 2039.44 toks/s, output: 449.77 toks/s]
Processed prompts:  16%|█▌        | 67/424 [00:18<00:21, 16.87it/s, est. speed input: 2150.59 toks/s, output: 483.49 toks/s]
Processed prompts:  17%|█▋        | 72/424 [00:18<00:17, 19.74it/s, est. speed input: 2294.42 toks/s, output: 519.90 toks/s]
Processed prompts:  18%|█▊        | 75/424 [00:18<00:18, 19.00it/s, est. speed input: 2355.86 toks/s, output: 539.52 toks/s]
Processed prompts:  18%|█▊        | 78/424 [00:19<00:17, 19.94it/s, est. speed input: 2428.74 toks/s, output: 560.35 toks/s]
Processed prompts:  19%|█▉        | 82/424 [00:19<00:19, 17.82it/s, est. speed input: 2500.04 toks/s, output: 584.68 toks/s]
Processed prompts:  21%|██        | 87/424 [00:19<00:21, 15.79it/s, est. speed input: 2623.17 toks/s, output: 613.48 toks/s]
Processed prompts:  22%|██▏       | 92/424 [00:19<00:19, 17.08it/s, est. speed input: 2714.93 toks/s, output: 645.92 toks/s]
Processed prompts:  23%|██▎       | 96/424 [00:20<00:16, 19.31it/s, est. speed input: 2812.80 toks/s, output: 673.57 toks/s]
Processed prompts:  23%|██▎       | 99/424 [00:20<00:16, 20.01it/s, est. speed input: 2881.29 toks/s, output: 693.34 toks/s]
Processed prompts:  24%|██▍       | 102/424 [00:20<00:15, 21.14it/s, est. speed input: 2965.37 toks/s, output: 713.50 toks/s]
Processed prompts:  25%|██▍       | 105/424 [00:20<00:19, 16.77it/s, est. speed input: 3044.93 toks/s, output: 727.75 toks/s]
Processed prompts:  25%|██▌       | 107/424 [00:20<00:19, 16.00it/s, est. speed input: 3106.35 toks/s, output: 738.63 toks/s]
Processed prompts:  26%|██▌       | 109/424 [00:20<00:19, 15.89it/s, est. speed input: 3142.87 toks/s, output: 750.15 toks/s]
Processed prompts:  27%|██▋       | 115/424 [00:21<00:17, 17.79it/s, est. speed input: 3280.35 toks/s, output: 787.28 toks/s]
Processed prompts:  28%|██▊       | 118/424 [00:21<00:17, 17.14it/s, est. speed input: 3323.28 toks/s, output: 804.00 toks/s]
Processed prompts:  29%|██▉       | 122/424 [00:21<00:18, 16.38it/s, est. speed input: 3423.07 toks/s, output: 825.87 toks/s]
Processed prompts:  29%|██▉       | 125/424 [00:21<00:16, 17.86it/s, est. speed input: 3551.51 toks/s, output: 844.99 toks/s]
Processed prompts:  30%|███       | 128/424 [00:21<00:16, 17.47it/s, est. speed input: 3610.82 toks/s, output: 861.80 toks/s]
Processed prompts:  31%|███       | 131/424 [00:22<00:17, 16.76it/s, est. speed input: 3667.05 toks/s, output: 877.92 toks/s]
Processed prompts:  32%|███▏      | 136/424 [00:22<00:15, 18.36it/s, est. speed input: 3759.40 toks/s, output: 908.33 toks/s]
Processed prompts:  33%|███▎      | 140/424 [00:22<00:18, 15.63it/s, est. speed input: 3798.33 toks/s, output: 926.12 toks/s]
Processed prompts:  33%|███▎      | 142/424 [00:22<00:19, 14.29it/s, est. speed input: 3830.69 toks/s, output: 934.03 toks/s]
Processed prompts:  34%|███▍      | 146/424 [00:23<00:16, 16.74it/s, est. speed input: 3930.42 toks/s, output: 958.93 toks/s]
Processed prompts:  37%|███▋      | 155/424 [00:23<00:14, 18.82it/s, est. speed input: 4067.82 toks/s, output: 1011.30 toks/s]
Processed prompts:  37%|███▋      | 158/424 [00:23<00:13, 20.15it/s, est. speed input: 4160.67 toks/s, output: 1030.01 toks/s]
Processed prompts:  38%|███▊      | 161/424 [00:23<00:12, 20.96it/s, est. speed input: 4256.57 toks/s, output: 1048.03 toks/s]
Processed prompts:  39%|███▊      | 164/424 [00:23<00:13, 19.15it/s, est. speed input: 4288.94 toks/s, output: 1062.56 toks/s]
Processed prompts:  39%|███▉      | 167/424 [00:24<00:15, 17.08it/s, est. speed input: 4354.98 toks/s, output: 1075.53 toks/s]
Processed prompts:  40%|████      | 170/424 [00:24<00:14, 17.15it/s, est. speed input: 4393.93 toks/s, output: 1091.09 toks/s]
Processed prompts:  43%|████▎     | 182/424 [00:24<00:07, 34.35it/s, est. speed input: 4822.47 toks/s, output: 1179.03 toks/s]
Processed prompts:  44%|████▍     | 187/424 [00:24<00:06, 36.16it/s, est. speed input: 4931.97 toks/s, output: 1212.89 toks/s]
Processed prompts:  45%|████▌     | 192/424 [00:24<00:06, 34.99it/s, est. speed input: 5022.77 toks/s, output: 1245.24 toks/s]
Processed prompts:  46%|████▌     | 196/424 [00:24<00:07, 32.31it/s, est. speed input: 5116.07 toks/s, output: 1270.06 toks/s]
Processed prompts:  47%|████▋     | 201/424 [00:25<00:06, 32.49it/s, est. speed input: 5205.17 toks/s, output: 1303.23 toks/s]
Processed prompts:  49%|████▉     | 209/424 [00:25<00:05, 41.73it/s, est. speed input: 5488.22 toks/s, output: 1363.54 toks/s]
Processed prompts:  50%|█████     | 214/424 [00:25<00:04, 42.79it/s, est. speed input: 5597.23 toks/s, output: 1399.49 toks/s]
Processed prompts:  52%|█████▏    | 219/424 [00:25<00:05, 37.27it/s, est. speed input: 5688.91 toks/s, output: 1432.15 toks/s]
Processed prompts:  53%|█████▎    | 224/424 [00:25<00:06, 30.09it/s, est. speed input: 5837.20 toks/s, output: 1461.43 toks/s]
Processed prompts:  54%|█████▍    | 228/424 [00:25<00:06, 31.68it/s, est. speed input: 5934.97 toks/s, output: 1490.55 toks/s]
Processed prompts:  55%|█████▍    | 232/424 [00:26<00:08, 21.80it/s, est. speed input: 5960.33 toks/s, output: 1498.18 toks/s]
Processed prompts:  55%|█████▌    | 235/424 [00:26<00:08, 23.07it/s, est. speed input: 6025.50 toks/s, output: 1515.45 toks/s]
Processed prompts:  56%|█████▌    | 238/424 [00:26<00:12, 15.42it/s, est. speed input: 6017.03 toks/s, output: 1516.74 toks/s]
Processed prompts:  57%|█████▋    | 241/424 [00:26<00:12, 14.67it/s, est. speed input: 6033.47 toks/s, output: 1532.24 toks/s]
Processed prompts:  57%|█████▋    | 243/424 [00:27<00:13, 13.46it/s, est. speed input: 6036.79 toks/s, output: 1529.97 toks/s]
Processed prompts:  58%|█████▊    | 245/424 [00:27<00:12, 13.77it/s, est. speed input: 6058.34 toks/s, output: 1532.55 toks/s]
Processed prompts:  58%|█████▊    | 247/424 [00:27<00:12, 14.07it/s, est. speed input: 6060.38 toks/s, output: 1537.29 toks/s]
Processed prompts:  59%|█████▉    | 252/424 [00:27<00:08, 19.82it/s, est. speed input: 6116.93 toks/s, output: 1558.48 toks/s]
Processed prompts:  61%|██████    | 257/424 [00:27<00:06, 24.61it/s, est. speed input: 6193.37 toks/s, output: 1577.20 toks/s]
Processed prompts:  62%|██████▏   | 263/424 [00:27<00:05, 28.54it/s, est. speed input: 6286.08 toks/s, output: 1600.44 toks/s]
Processed prompts:  64%|██████▍   | 273/424 [00:27<00:03, 39.23it/s, est. speed input: 6477.08 toks/s, output: 1660.42 toks/s]
Processed prompts:  66%|██████▌   | 278/424 [00:28<00:03, 37.34it/s, est. speed input: 6534.88 toks/s, output: 1679.65 toks/s]
Processed prompts:  67%|██████▋   | 286/424 [00:28<00:03, 44.58it/s, est. speed input: 6670.66 toks/s, output: 1714.67 toks/s]
Processed prompts:  70%|██████▉   | 295/424 [00:28<00:02, 49.61it/s, est. speed input: 6848.70 toks/s, output: 1756.87 toks/s]
Processed prompts:  71%|███████▏  | 303/424 [00:28<00:02, 56.22it/s, est. speed input: 6995.14 toks/s, output: 1799.00 toks/s]
Processed prompts:  73%|███████▎  | 310/424 [00:28<00:02, 56.22it/s, est. speed input: 7107.46 toks/s, output: 1827.44 toks/s]
Processed prompts:  75%|███████▍  | 316/424 [00:28<00:01, 54.25it/s, est. speed input: 7254.55 toks/s, output: 1853.00 toks/s]
Processed prompts:  76%|███████▌  | 322/424 [00:28<00:01, 53.17it/s, est. speed input: 7385.52 toks/s, output: 1878.21 toks/s]
Processed prompts:  77%|███████▋  | 328/424 [00:28<00:01, 49.91it/s, est. speed input: 7479.37 toks/s, output: 1904.74 toks/s]
Processed prompts:  80%|████████  | 340/424 [00:29<00:01, 65.43it/s, est. speed input: 7772.47 toks/s, output: 1968.67 toks/s]
Processed prompts:  82%|████████▏ | 348/424 [00:29<00:01, 64.50it/s, est. speed input: 7925.25 toks/s, output: 2014.23 toks/s]
Processed prompts:  84%|████████▎ | 355/424 [00:29<00:01, 65.10it/s, est. speed input: 8070.60 toks/s, output: 2055.54 toks/s]
Processed prompts:  86%|████████▋ | 366/424 [00:29<00:00, 73.39it/s, est. speed input: 8282.46 toks/s, output: 2138.94 toks/s]
Processed prompts:  89%|████████▉ | 377/424 [00:29<00:00, 80.47it/s, est. speed input: 8501.18 toks/s, output: 2212.83 toks/s]
Processed prompts:  92%|█████████▏| 389/424 [00:29<00:00, 90.60it/s, est. speed input: 8783.37 toks/s, output: 2280.78 toks/s]
Processed prompts:  94%|█████████▍| 400/424 [00:29<00:00, 93.87it/s, est. speed input: 9047.13 toks/s, output: 2357.17 toks/s]
Processed prompts:  97%|█████████▋| 410/424 [00:30<00:00, 62.52it/s, est. speed input: 9226.32 toks/s, output: 2403.46 toks/s]
Processed prompts:  99%|█████████▊| 418/424 [00:30<00:00, 28.64it/s, est. speed input: 9214.05 toks/s, output: 2430.54 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:33<00:00,  8.18it/s, est. speed input: 8655.65 toks/s, output: 2301.41 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:33<00:00, 12.67it/s, est. speed input: 8655.65 toks/s, output: 2301.41 toks/s]
{  "personalized_answer": "It seems like you're looking for guidance on how to properly reference or cite your own work, much like you would cite external sources. In academic writing, it's important to acknowledge your own contributions to maintain transparency and integrity. You can cite your own paper in a similar way you would cite another author. For example, you might write something like: 'As I previously discussed in my paper titled "The Impact of Digital Communication on Sleep Patterns" (2023), ...' This approach not only gives credit to your own work but also helps the reader understand the context and flow of your argument. If you're writing for a specific academic journal or publication, they may have specific guidelines on how to cite your own work, so it's a good idea to check their style guide."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.13s/it, est. speed input: 195.59 toks/s, output: 83.69 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.13s/it, est. speed input: 195.59 toks/s, output: 83.69 toks/s]
[rank0]:[W708 16:57:44.676037161 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/sc_rag_full_profile_test_2_output.json
Cleaned temporary files.
Keeping ['lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-08 16:57:48.251210_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-08 16:57:48.251210_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-08 16:57:48.251210_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<01:51,  3.57it/s]
  1%|          | 3/401 [00:00<01:46,  3.74it/s]
  1%|          | 4/401 [00:01<03:07,  2.11it/s]
  1%|          | 5/401 [00:02<04:02,  1.63it/s]
  1%|▏         | 6/401 [00:03<04:34,  1.44it/s]
  2%|▏         | 7/401 [00:04<04:56,  1.33it/s]
  2%|▏         | 8/401 [00:05<05:08,  1.27it/s]
  2%|▏         | 9/401 [00:06<05:13,  1.25it/s]
  2%|▏         | 10/401 [00:06<03:53,  1.67it/s]
  3%|▎         | 11/401 [00:07<05:16,  1.23it/s]
  3%|▎         | 13/401 [00:08<04:45,  1.36it/s]
  3%|▎         | 14/401 [00:09<04:22,  1.48it/s]
  4%|▍         | 17/401 [00:09<02:15,  2.84it/s]
  4%|▍         | 18/401 [00:10<03:25,  1.86it/s]
  5%|▍         | 19/401 [00:11<04:26,  1.43it/s]
  5%|▍         | 20/401 [00:14<07:17,  1.15s/it]
  5%|▌         | 22/401 [00:17<07:42,  1.22s/it]
  6%|▌         | 23/401 [00:18<07:43,  1.23s/it]
  6%|▌         | 24/401 [00:20<09:45,  1.55s/it]
  6%|▋         | 26/401 [00:21<05:53,  1.06it/s]
  7%|▋         | 27/401 [00:23<08:09,  1.31s/it]
  7%|▋         | 29/401 [00:23<05:03,  1.23it/s]
  7%|▋         | 30/401 [00:23<04:08,  1.49it/s]
  8%|▊         | 31/401 [00:24<04:08,  1.49it/s]
  8%|▊         | 33/401 [00:25<03:18,  1.86it/s]
  8%|▊         | 34/401 [00:25<02:47,  2.19it/s]
  9%|▉         | 36/401 [00:25<01:50,  3.31it/s]
  9%|▉         | 38/401 [00:25<01:19,  4.55it/s]
 10%|▉         | 40/401 [00:25<01:03,  5.69it/s]
 10%|█         | 42/401 [00:26<01:03,  5.69it/s]
 11%|█         | 43/401 [00:26<01:03,  5.60it/s]
 11%|█         | 44/401 [00:26<00:58,  6.13it/s]
 11%|█▏        | 46/401 [00:26<00:55,  6.43it/s]
 12%|█▏        | 47/401 [00:27<00:56,  6.31it/s]
 12%|█▏        | 48/401 [00:27<01:03,  5.52it/s]
 12%|█▏        | 49/401 [00:27<01:02,  5.64it/s]
 13%|█▎        | 52/401 [00:27<00:35,  9.71it/s]
 13%|█▎        | 54/401 [00:27<00:36,  9.60it/s]
 14%|█▍        | 56/401 [00:28<01:02,  5.52it/s]
 14%|█▍        | 57/401 [00:28<00:57,  5.98it/s]
 15%|█▍        | 59/401 [00:29<01:11,  4.77it/s]
 15%|█▍        | 60/401 [00:29<01:06,  5.12it/s]
 15%|█▌        | 62/401 [00:29<00:59,  5.67it/s]
 16%|█▌        | 63/401 [00:29<00:59,  5.70it/s]
 16%|█▌        | 64/401 [00:29<00:58,  5.77it/s]
 16%|█▌        | 65/401 [00:30<00:57,  5.80it/s]
 16%|█▋        | 66/401 [00:30<00:55,  6.05it/s]
 17%|█▋        | 68/401 [00:30<00:39,  8.49it/s]
 17%|█▋        | 70/401 [00:30<00:34,  9.60it/s]
 18%|█▊        | 72/401 [00:30<00:33,  9.80it/s]
 18%|█▊        | 74/401 [00:30<00:30, 10.62it/s]
 19%|█▉        | 76/401 [00:31<00:32, 10.11it/s]
 19%|█▉        | 78/401 [00:31<00:29, 10.89it/s]
 20%|█▉        | 80/401 [00:31<00:31, 10.32it/s]
 20%|██        | 82/401 [00:31<00:28, 11.02it/s]
 21%|██        | 84/401 [00:31<00:30, 10.50it/s]
 21%|██▏       | 86/401 [00:31<00:27, 11.25it/s]
 22%|██▏       | 88/401 [00:32<00:50,  6.24it/s]
 22%|██▏       | 89/401 [00:32<00:49,  6.33it/s]
 23%|██▎       | 91/401 [00:32<00:38,  8.03it/s]
 23%|██▎       | 93/401 [00:33<00:36,  8.52it/s]
 24%|██▎       | 95/401 [00:33<00:39,  7.70it/s]
 24%|██▍       | 96/401 [00:33<00:38,  7.94it/s]
 24%|██▍       | 97/401 [00:33<00:37,  8.18it/s]
 24%|██▍       | 98/401 [00:33<00:37,  8.14it/s]
 25%|██▍       | 100/401 [00:33<00:28, 10.51it/s]
 25%|██▌       | 102/401 [00:33<00:24, 12.32it/s]
 26%|██▌       | 104/401 [00:34<00:34,  8.53it/s]
 26%|██▋       | 106/401 [00:34<00:29,  9.89it/s]
 27%|██▋       | 108/401 [00:34<00:32,  9.07it/s]
 27%|██▋       | 110/401 [00:34<00:28, 10.32it/s]
 28%|██▊       | 112/401 [00:35<00:29,  9.96it/s]
 28%|██▊       | 114/401 [00:35<00:28,  9.98it/s]
 29%|██▉       | 116/401 [00:35<00:26, 10.88it/s]
 29%|██▉       | 118/401 [00:35<00:28,  9.97it/s]
 30%|██▉       | 120/401 [00:35<00:26, 10.65it/s]
 30%|███       | 122/401 [00:35<00:24, 11.17it/s]
 31%|███       | 124/401 [00:36<00:29,  9.29it/s]
 31%|███▏      | 126/401 [00:36<00:34,  7.97it/s]
 32%|███▏      | 127/401 [00:36<00:35,  7.74it/s]
 32%|███▏      | 128/401 [00:36<00:35,  7.58it/s]
 32%|███▏      | 129/401 [00:36<00:34,  7.93it/s]
 32%|███▏      | 130/401 [00:37<00:35,  7.59it/s]
 33%|███▎      | 133/401 [00:37<00:44,  6.05it/s]
 33%|███▎      | 134/401 [00:37<00:41,  6.49it/s]
 34%|███▎      | 135/401 [00:37<00:38,  6.94it/s]
 34%|███▍      | 136/401 [00:38<00:35,  7.40it/s]
 34%|███▍      | 138/401 [00:38<00:30,  8.63it/s]
 35%|███▍      | 140/401 [00:38<00:24, 10.73it/s]
 35%|███▌      | 142/401 [00:38<00:30,  8.49it/s]
 36%|███▌      | 144/401 [00:39<00:36,  7.13it/s]
 36%|███▋      | 146/401 [00:39<00:29,  8.70it/s]
 37%|███▋      | 148/401 [00:39<00:41,  6.16it/s]
 37%|███▋      | 149/401 [00:39<00:38,  6.57it/s]
 37%|███▋      | 150/401 [00:39<00:35,  6.98it/s]
 38%|███▊      | 151/401 [00:40<00:35,  6.97it/s]
 38%|███▊      | 152/401 [00:40<00:33,  7.44it/s]
 38%|███▊      | 153/401 [00:40<00:40,  6.06it/s]
 38%|███▊      | 154/401 [00:40<00:39,  6.30it/s]
 39%|███▊      | 155/401 [00:40<00:38,  6.42it/s]
 39%|███▉      | 156/401 [00:40<00:37,  6.53it/s]
 39%|███▉      | 157/401 [00:40<00:36,  6.63it/s]
 40%|███▉      | 159/401 [00:41<00:26,  9.02it/s]
 40%|███▉      | 160/401 [00:41<00:33,  7.10it/s]
 40%|████      | 162/401 [00:41<00:27,  8.75it/s]
 41%|████      | 164/401 [00:41<00:21, 10.78it/s]
 41%|████▏     | 166/401 [00:41<00:22, 10.25it/s]
 42%|████▏     | 168/401 [00:42<00:22, 10.19it/s]
 42%|████▏     | 170/401 [00:42<00:23,  9.95it/s]
 43%|████▎     | 172/401 [00:42<00:29,  7.79it/s]
 43%|████▎     | 173/401 [00:42<00:28,  8.04it/s]
 43%|████▎     | 174/401 [00:42<00:27,  8.26it/s]
 44%|████▎     | 175/401 [00:42<00:26,  8.45it/s]
 44%|████▍     | 176/401 [00:43<00:26,  8.61it/s]
 44%|████▍     | 177/401 [00:43<00:27,  8.01it/s]
 44%|████▍     | 178/401 [00:43<00:26,  8.28it/s]
 45%|████▍     | 179/401 [00:43<00:26,  8.51it/s]
 45%|████▍     | 180/401 [00:43<00:25,  8.83it/s]
 45%|████▌     | 181/401 [00:43<00:24,  9.06it/s]
 45%|████▌     | 182/401 [00:43<00:24,  9.06it/s]
 46%|████▌     | 184/401 [00:43<00:19, 10.94it/s]
 46%|████▋     | 186/401 [00:43<00:17, 12.18it/s]
 47%|████▋     | 188/401 [00:44<00:18, 11.28it/s]
 47%|████▋     | 190/401 [00:44<00:17, 12.26it/s]
 48%|████▊     | 192/401 [00:45<00:41,  5.06it/s]
 48%|████▊     | 193/401 [00:45<00:38,  5.39it/s]
 48%|████▊     | 194/401 [00:45<00:42,  4.92it/s]
 49%|████▉     | 196/401 [00:46<00:45,  4.46it/s]
 49%|████▉     | 197/401 [00:48<01:58,  1.72it/s]
 50%|████▉     | 199/401 [00:48<01:32,  2.17it/s]
 50%|████▉     | 200/401 [00:48<01:31,  2.20it/s]
 50%|█████     | 201/401 [00:49<01:31,  2.20it/s]
 50%|█████     | 202/401 [00:49<01:29,  2.23it/s]
 51%|█████     | 203/401 [00:50<01:28,  2.23it/s]
 51%|█████     | 204/401 [00:50<01:28,  2.22it/s]
 51%|█████▏    | 206/401 [00:51<01:10,  2.78it/s]
 52%|█████▏    | 207/401 [00:51<01:14,  2.62it/s]
 52%|█████▏    | 208/401 [00:52<01:17,  2.50it/s]
 52%|█████▏    | 209/401 [00:52<01:16,  2.51it/s]
 52%|█████▏    | 210/401 [00:52<01:18,  2.43it/s]
 53%|█████▎    | 211/401 [00:53<01:26,  2.19it/s]
 53%|█████▎    | 212/401 [00:53<01:16,  2.47it/s]
 53%|█████▎    | 213/401 [00:54<01:24,  2.21it/s]
 53%|█████▎    | 214/401 [00:55<02:17,  1.36it/s]
 54%|█████▎    | 215/401 [00:56<01:47,  1.73it/s]
 54%|█████▍    | 216/401 [00:56<01:58,  1.57it/s]
 54%|█████▍    | 218/401 [00:57<01:13,  2.50it/s]
 55%|█████▍    | 219/401 [00:57<01:04,  2.84it/s]
 55%|█████▍    | 220/401 [00:57<00:56,  3.19it/s]
 55%|█████▌    | 221/401 [00:57<01:07,  2.68it/s]
 55%|█████▌    | 222/401 [00:58<00:58,  3.07it/s]
 56%|█████▌    | 224/401 [00:58<00:45,  3.88it/s]
 56%|█████▌    | 225/401 [00:58<00:38,  4.54it/s]
 56%|█████▋    | 226/401 [00:58<00:33,  5.27it/s]
 57%|█████▋    | 228/401 [00:59<00:43,  3.93it/s]
 57%|█████▋    | 229/401 [00:59<00:40,  4.25it/s]
 57%|█████▋    | 230/401 [00:59<00:39,  4.37it/s]
 58%|█████▊    | 231/401 [00:59<00:35,  4.79it/s]
 58%|█████▊    | 232/401 [01:00<00:38,  4.42it/s]
 58%|█████▊    | 234/401 [01:03<02:15,  1.23it/s]
 59%|█████▊    | 235/401 [01:03<01:54,  1.45it/s]
 59%|█████▉    | 236/401 [01:03<01:29,  1.83it/s]
 59%|█████▉    | 237/401 [01:04<01:17,  2.12it/s]
 59%|█████▉    | 238/401 [01:04<01:03,  2.58it/s]
 60%|█████▉    | 239/401 [01:04<00:54,  2.97it/s]
 60%|██████    | 241/401 [01:04<00:33,  4.75it/s]
 61%|██████    | 243/401 [01:05<00:39,  3.96it/s]
 61%|██████    | 244/401 [01:05<00:42,  3.73it/s]
 61%|██████▏   | 246/401 [01:05<00:32,  4.79it/s]
 62%|██████▏   | 247/401 [01:05<00:32,  4.81it/s]
 62%|██████▏   | 248/401 [01:06<00:28,  5.45it/s]
 62%|██████▏   | 249/401 [01:06<00:54,  2.77it/s]
 63%|██████▎   | 254/401 [01:07<00:21,  6.96it/s]
 64%|██████▍   | 256/401 [01:08<00:39,  3.64it/s]
 65%|██████▍   | 260/401 [01:08<00:23,  5.92it/s]
 65%|██████▌   | 262/401 [01:08<00:25,  5.38it/s]
 66%|██████▌   | 265/401 [01:09<00:18,  7.39it/s]
 67%|██████▋   | 268/401 [01:09<00:14,  9.31it/s]
 67%|██████▋   | 270/401 [01:09<00:21,  5.97it/s]
 68%|██████▊   | 273/401 [01:10<00:16,  7.87it/s]
 69%|██████▊   | 275/401 [01:10<00:14,  8.71it/s]
 69%|██████▉   | 277/401 [01:10<00:16,  7.30it/s]
 70%|██████▉   | 279/401 [01:10<00:15,  8.05it/s]
 70%|███████   | 281/401 [01:11<00:15,  7.67it/s]
 71%|███████   | 283/401 [01:11<00:17,  6.82it/s]
 71%|███████   | 285/401 [01:11<00:15,  7.73it/s]
 72%|███████▏  | 288/401 [01:11<00:11, 10.20it/s]
 73%|███████▎  | 291/401 [01:12<00:13,  8.46it/s]
 73%|███████▎  | 293/401 [01:13<00:22,  4.85it/s]
 73%|███████▎  | 294/401 [01:13<00:27,  3.88it/s]
 74%|███████▍  | 296/401 [01:13<00:21,  4.87it/s]
 75%|███████▍  | 299/401 [01:14<00:24,  4.19it/s]
 75%|███████▌  | 301/401 [01:14<00:18,  5.27it/s]
 76%|███████▌  | 304/401 [01:15<00:19,  5.09it/s]
 76%|███████▋  | 306/401 [01:15<00:15,  6.16it/s]
 77%|███████▋  | 308/401 [01:15<00:14,  6.44it/s]
 77%|███████▋  | 309/401 [01:16<00:17,  5.36it/s]
 78%|███████▊  | 311/401 [01:16<00:14,  6.42it/s]
 78%|███████▊  | 312/401 [01:16<00:12,  6.86it/s]
 78%|███████▊  | 314/401 [01:16<00:10,  8.39it/s]
 79%|███████▉  | 317/401 [01:16<00:07, 11.55it/s]
 80%|███████▉  | 319/401 [01:17<00:07, 10.29it/s]
 80%|████████  | 321/401 [01:17<00:09,  8.02it/s]
 81%|████████  | 323/401 [01:18<00:14,  5.26it/s]
 81%|████████  | 324/401 [01:18<00:18,  4.10it/s]
 81%|████████  | 325/401 [01:19<00:22,  3.38it/s]
 81%|████████▏ | 326/401 [01:19<00:20,  3.72it/s]
 82%|████████▏ | 328/401 [01:19<00:14,  5.09it/s]
 82%|████████▏ | 329/401 [01:20<00:31,  2.31it/s]
 82%|████████▏ | 330/401 [01:21<00:31,  2.24it/s]
 83%|████████▎ | 331/401 [01:21<00:26,  2.67it/s]
 83%|████████▎ | 332/401 [01:21<00:28,  2.44it/s]
 83%|████████▎ | 333/401 [01:22<00:29,  2.29it/s]
 84%|████████▎ | 335/401 [01:22<00:24,  2.74it/s]
 84%|████████▍ | 336/401 [01:23<00:26,  2.50it/s]
 84%|████████▍ | 338/401 [01:23<00:16,  3.76it/s]
 85%|████████▌ | 341/401 [01:23<00:10,  5.86it/s]
 86%|████████▌ | 343/401 [01:23<00:08,  6.86it/s]
 86%|████████▌ | 344/401 [01:24<00:08,  6.42it/s]
 86%|████████▋ | 346/401 [01:24<00:08,  6.82it/s]
 87%|████████▋ | 348/401 [01:24<00:09,  5.61it/s]
 87%|████████▋ | 350/401 [01:25<00:11,  4.55it/s]
 88%|████████▊ | 351/401 [01:26<00:13,  3.69it/s]
 89%|████████▊ | 355/401 [01:26<00:06,  6.66it/s]
 89%|████████▉ | 357/401 [01:26<00:09,  4.51it/s]
 90%|████████▉ | 359/401 [01:27<00:11,  3.70it/s]
 90%|████████▉ | 360/401 [01:28<00:14,  2.87it/s]
 90%|█████████ | 361/401 [01:28<00:12,  3.18it/s]
 91%|█████████ | 363/401 [01:28<00:08,  4.39it/s]
 91%|█████████ | 365/401 [01:29<00:06,  5.19it/s]
 92%|█████████▏| 367/401 [01:29<00:05,  5.98it/s]
 92%|█████████▏| 369/401 [01:29<00:05,  6.01it/s]
 92%|█████████▏| 370/401 [01:29<00:05,  5.86it/s]
 93%|█████████▎| 371/401 [01:30<00:05,  5.80it/s]
 93%|█████████▎| 373/401 [01:30<00:04,  6.58it/s]
 93%|█████████▎| 374/401 [01:30<00:04,  6.30it/s]
 94%|█████████▎| 375/401 [01:30<00:04,  6.14it/s]
 94%|█████████▍| 376/401 [01:31<00:06,  3.87it/s]
 94%|█████████▍| 378/401 [01:31<00:06,  3.54it/s]
 95%|█████████▍| 379/401 [01:32<00:07,  2.99it/s]
 95%|█████████▍| 380/401 [01:32<00:06,  3.37it/s]
 95%|█████████▌| 382/401 [01:33<00:05,  3.42it/s]
 96%|█████████▌| 383/401 [01:33<00:06,  2.87it/s]
 96%|█████████▌| 384/401 [01:34<00:06,  2.71it/s]
 96%|█████████▌| 385/401 [01:34<00:06,  2.47it/s]
 97%|█████████▋| 387/401 [01:35<00:05,  2.40it/s]
 97%|█████████▋| 389/401 [01:35<00:03,  3.38it/s]
 97%|█████████▋| 390/401 [01:35<00:03,  3.25it/s]
 98%|█████████▊| 393/401 [01:36<00:01,  5.48it/s]
 98%|█████████▊| 394/401 [01:36<00:01,  5.18it/s]
 99%|█████████▊| 395/401 [01:36<00:01,  4.50it/s]
 99%|█████████▉| 397/401 [01:36<00:00,  5.07it/s]
100%|█████████▉| 399/401 [01:37<00:00,  4.57it/s]
100%|██████████| 401/401 [01:37<00:00,  5.74it/s]
100%|██████████| 401/401 [01:37<00:00,  4.11it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-08 16:57:48.251210_ae_processed_test.json', '--output_addr', 'data/out/rag/asym/ae_rag_lp_sc_test_2_output.json', '--temperature', '0.0', '--top_p', '0.95', '--max_tokens', '4096', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/work/pi_hzamani_umass_edu/ozel_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.77 examples/s]
Generating train split: 401 examples [00:00, 1657.75 examples/s]
INFO 07-08 16:59:58 config.py:510] This model supports multiple tasks: {'score', 'classify', 'embed', 'generate', 'reward'}. Defaulting to 'generate'.
INFO 07-08 16:59:58 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/work/pi_hzamani_umass_edu/ozel_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-08 17:00:00 selector.py:120] Using Flash Attention backend.
INFO 07-08 17:00:01 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-08 17:00:01 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.62it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.58it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.57it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.61it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.60it/s]

INFO 07-08 17:00:04 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-08 17:00:07 worker.py:241] Memory profiling takes 2.11 seconds
INFO 07-08 17:00:07 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-08 17:00:07 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-08 17:00:07 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-08 17:00:07 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-08 17:00:09 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  2.88it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:10,  3.23it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.36it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:09,  3.44it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.48it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.50it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:08,  3.49it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.44it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.41it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:07,  3.44it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:07,  3.35it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.33it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.42it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:05,  3.51it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.45it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:06,  2.98it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:05,  3.05it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:05<00:05,  3.08it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.24it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:04,  3.37it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:06<00:04,  3.41it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.51it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.58it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:07<00:03,  3.65it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:07<00:02,  3.66it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.61it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.67it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:08<00:01,  3.71it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:08<00:01,  3.76it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.77it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.74it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:09<00:00,  3.64it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:09<00:00,  3.64it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.71it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:10<00:00,  3.74it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:10<00:00,  3.49it/s]
INFO 07-08 17:00:20 model_runner.py:1535] Graph capturing finished in 10 secs, took 0.22 GiB
INFO 07-08 17:00:20 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 15.06 seconds
RAG ON
EXAMPLE PROMPT
<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Writing rule which states that two causes for the same superpower is bad writing I've read somewhere that there is this writing rule stating that, for some superpower, it would be less believable if two completely different settings are present in order to obtain the same superpower. In the article, I remember it mentioned in the movie Spiderman (which I've not watched), the protagonist and another character gain the power through different means.What's this rule and does it have a name?

Is 'Sold Count' a good term I am writing a technical document, and in it I want to refer to the number of units sold for each product. I want to make it concise, and 'sold count' comes to mind. Does this term sound right? Are there better alternatives?
# Current post question:
Are the two music notes a reference?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
How to trick the reader into thinking they're following a redshirt instead of the protagonist? I'm currently planning a "magical girl" story, and I thought of an interesting way to start it, rather than launching straight into the backstory. It opens with a woman in her mid-thirties, complete with ponytail of death, walking through a city market while being stalked by a shadowy monster.What I want readers to expect is that the woman is either going to be killed by the monster, or saved from it in the nick of time by the heroine. What actually happens is that when the monster finally attacks, the woman transforms into a magical girl, beats the everloving crap out of the monster, and then destroys it with a magical laser beam. Surprise! She is the heroine.I want to try and preserve this surprise as best I can, and make the readers think they're following a redshirt or one-off character instead of the protagonist. Not referring to her by name until after the reveal will help, but it's probably not enough. What else can I do to achieve this?(I'm aware of answers on other questions to the effect of "don't trick your readers". In my case, this is supposed to be a pleasant surprise, so I feel like it's okay.)

How should my script refer to a character who's currently disguised as another character? I've recently resumed writing a series of scripts for an anime I've been planning. One of the characters has the ability to shape-shift, and there are several scenes in which she initially appears disguised as another character, before shape-shifting back into her normal self.So far, when writing these scenes, I've referred to the character using the name of the person she's disguised as, and only switched back to her real name after she transforms back again. However, the top answers to these questions suggest that I shouldn't do that; scripts are production documents, and it's imperative that the crew know exactly who's supposed to be in each scene, hence I should always refer to characters by their real names.But in the case of a character who's disguised as another character, how do I do this while also making it clear that they're pretending to be someone else right now?
# Current post question:
How come Neiru hasn't revived her sister yet?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
are what we translate as "adjectives", "nouns", etc, the same kind of words in no indo-european languages? This question comes from questions in japanese SE. Keiyōshi 形容詞 are translated as adjectives. Meishi 名詞 are translated as nouns. But are they really the same kind of words that we mean with nouns, adjectives, etc. in English? I've already found 3 examples that arises a lot of doubts in me if they are the same thing. The first is a japanese word that I can't remember right now but that I've seen used as a noun, adjective or verb. May be there are words like these in English or Spanish, but I'm not sure if they are the same. For example the word paddle can be a verb, a noun or an adjective in English. The second is japanese words that they see as a noun and that we see as adjectives. The word "next" for japaneses is a clear noun. They know that it can be used as an adjective, but when giving an example of when it is used as a noun (what it really is according to japanese), I got this "when is the next?" that is a sentence that could come in a conversation between 2 persons about events , and one of them ask the other "when is the next (event)?" . wouldnt it be for english speakers, still an adjective because it modifies an implicit noun (event)? And the third is the word "suki" and similar words, that they see as a verb and it's translated as "to like" but it is used next to the verb desu (to be) So my question is, are what we translate as adjectives, verbs, etc, from other non indoeuropean languages, really what we understand as verbs, adjectives, etc?

Did Maradona ever score a goal with his right foot? I was hearing one of Pele's declaration stating Maradona couldn't score goals with his right foot. I thought he was talking in general, but then I started to think about goals made by him with his right foot and I couldn't remember any. I made a little research about this and I couldn't find any goal scored by him with his right foot, even though I clearly didn't watch all 300+ goals he made in his career (I'm not sure if all of them were recorded on TV by the way).I also remembered he used to kick the ball to the center of the field with his left foot even when he was in the right side of the field, giving the pass with a "Rabona" instead of with his right foot, because he was too much of a left-footed player. So, did he ever score a goal with his right foot, or did he never score one this way?
# Current post question:
Was Saitama sweating with worry when he saw Garou in this scene?
<|im_end|>
<|im_start|>assistant

None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:12<1:24:38, 12.70s/it, est. speed input: 63.80 toks/s, output: 6.54 toks/s]
Processed prompts:   0%|          | 2/401 [00:13<37:16,  5.60s/it, est. speed input: 90.43 toks/s, output: 13.57 toks/s] 
Processed prompts:   1%|          | 3/401 [00:13<20:55,  3.16s/it, est. speed input: 118.44 toks/s, output: 20.92 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:13<07:12,  1.10s/it, est. speed input: 229.63 toks/s, output: 43.34 toks/s]
Processed prompts:   2%|▏         | 8/401 [00:13<04:36,  1.42it/s, est. speed input: 285.04 toks/s, output: 58.06 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:14<03:10,  2.05it/s, est. speed input: 367.61 toks/s, output: 72.63 toks/s]
Processed prompts:   3%|▎         | 12/401 [00:14<02:22,  2.74it/s, est. speed input: 437.10 toks/s, output: 86.73 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:14<01:45,  3.66it/s, est. speed input: 491.21 toks/s, output: 101.28 toks/s]
Processed prompts:   4%|▍         | 16/401 [00:14<01:19,  4.83it/s, est. speed input: 546.00 toks/s, output: 116.14 toks/s]
Processed prompts:   4%|▍         | 18/401 [00:14<01:06,  5.80it/s, est. speed input: 635.94 toks/s, output: 130.39 toks/s]
Processed prompts:   6%|▌         | 25/401 [00:15<00:36, 10.42it/s, est. speed input: 944.47 toks/s, output: 182.18 toks/s]
Processed prompts:   8%|▊         | 31/401 [00:15<00:27, 13.22it/s, est. speed input: 1137.14 toks/s, output: 225.91 toks/s]
Processed prompts:   8%|▊         | 33/401 [00:15<00:27, 13.22it/s, est. speed input: 1189.50 toks/s, output: 239.52 toks/s]
Processed prompts:   9%|▊         | 35/401 [00:15<00:27, 13.50it/s, est. speed input: 1256.42 toks/s, output: 253.39 toks/s]
Processed prompts:   9%|▉         | 38/401 [00:15<00:24, 14.91it/s, est. speed input: 1377.95 toks/s, output: 274.88 toks/s]
Processed prompts:  10%|▉         | 40/401 [00:16<00:25, 14.41it/s, est. speed input: 1450.47 toks/s, output: 288.27 toks/s]
Processed prompts:  11%|█         | 44/401 [00:16<00:26, 13.35it/s, est. speed input: 1553.97 toks/s, output: 314.00 toks/s]
Processed prompts:  12%|█▏        | 49/401 [00:16<00:20, 17.15it/s, est. speed input: 1693.21 toks/s, output: 350.19 toks/s]
Processed prompts:  13%|█▎        | 51/401 [00:16<00:24, 14.29it/s, est. speed input: 1748.77 toks/s, output: 360.92 toks/s]
Processed prompts:  14%|█▎        | 55/401 [00:17<00:23, 14.42it/s, est. speed input: 1842.56 toks/s, output: 386.69 toks/s]
Processed prompts:  15%|█▍        | 60/401 [00:17<00:19, 17.68it/s, est. speed input: 1976.51 toks/s, output: 421.91 toks/s]
Processed prompts:  18%|█▊        | 71/401 [00:17<00:17, 19.22it/s, est. speed input: 2273.75 toks/s, output: 493.68 toks/s]
Processed prompts:  18%|█▊        | 74/401 [00:17<00:17, 19.11it/s, est. speed input: 2358.61 toks/s, output: 512.25 toks/s]
Processed prompts:  19%|█▉        | 77/401 [00:18<00:18, 17.89it/s, est. speed input: 2452.74 toks/s, output: 529.22 toks/s]
Processed prompts:  20%|█▉        | 80/401 [00:18<00:16, 18.97it/s, est. speed input: 2543.04 toks/s, output: 548.52 toks/s]
Processed prompts:  21%|██        | 83/401 [00:18<00:17, 18.13it/s, est. speed input: 2616.29 toks/s, output: 565.76 toks/s]
Processed prompts:  22%|██▏       | 90/401 [00:18<00:16, 18.47it/s, est. speed input: 2770.68 toks/s, output: 607.58 toks/s]
Processed prompts:  23%|██▎       | 94/401 [00:19<00:17, 17.91it/s, est. speed input: 2840.24 toks/s, output: 629.95 toks/s]
Processed prompts:  24%|██▍       | 97/401 [00:19<00:17, 17.63it/s, est. speed input: 2963.44 toks/s, output: 646.60 toks/s]
Processed prompts:  26%|██▌       | 103/401 [00:19<00:16, 18.08it/s, est. speed input: 3088.10 toks/s, output: 680.86 toks/s]
Processed prompts:  27%|██▋       | 108/401 [00:19<00:16, 17.47it/s, est. speed input: 3148.89 toks/s, output: 707.62 toks/s]
Processed prompts:  28%|██▊       | 113/401 [00:20<00:14, 19.44it/s, est. speed input: 3267.71 toks/s, output: 738.04 toks/s]
Processed prompts:  29%|██▉       | 116/401 [00:20<00:15, 17.82it/s, est. speed input: 3372.43 toks/s, output: 752.30 toks/s]
Processed prompts:  30%|██▉       | 120/401 [00:20<00:15, 18.31it/s, est. speed input: 3476.09 toks/s, output: 774.40 toks/s]
Processed prompts:  32%|███▏      | 128/401 [00:20<00:14, 19.00it/s, est. speed input: 3608.15 toks/s, output: 817.85 toks/s]
Processed prompts:  34%|███▎      | 135/401 [00:21<00:14, 18.10it/s, est. speed input: 3741.08 toks/s, output: 852.43 toks/s]
Processed prompts:  35%|███▌      | 141/401 [00:21<00:13, 18.67it/s, est. speed input: 3892.73 toks/s, output: 883.80 toks/s]
Processed prompts:  36%|███▌      | 143/401 [00:21<00:14, 17.86it/s, est. speed input: 3909.31 toks/s, output: 892.30 toks/s]
Processed prompts:  37%|███▋      | 148/401 [00:21<00:13, 19.30it/s, est. speed input: 4024.78 toks/s, output: 919.60 toks/s]
Processed prompts:  39%|███▉      | 157/401 [00:22<00:08, 28.83it/s, est. speed input: 4268.75 toks/s, output: 980.48 toks/s]
Processed prompts:  41%|████▏     | 166/401 [00:22<00:06, 38.01it/s, est. speed input: 4505.39 toks/s, output: 1042.04 toks/s]
Processed prompts:  44%|████▎     | 175/401 [00:22<00:04, 46.47it/s, est. speed input: 4765.17 toks/s, output: 1104.32 toks/s]
Processed prompts:  46%|████▌     | 183/401 [00:22<00:04, 51.93it/s, est. speed input: 4934.55 toks/s, output: 1159.62 toks/s]
Processed prompts:  48%|████▊     | 191/401 [00:22<00:03, 56.94it/s, est. speed input: 5153.20 toks/s, output: 1215.38 toks/s]
Processed prompts:  49%|████▉     | 198/401 [00:22<00:03, 58.80it/s, est. speed input: 5349.59 toks/s, output: 1264.21 toks/s]
Processed prompts:  52%|█████▏    | 209/401 [00:22<00:02, 70.38it/s, est. speed input: 5654.70 toks/s, output: 1345.20 toks/s]
Processed prompts:  55%|█████▍    | 220/401 [00:22<00:02, 80.24it/s, est. speed input: 6019.51 toks/s, output: 1426.83 toks/s]
Processed prompts:  57%|█████▋    | 229/401 [00:23<00:02, 65.56it/s, est. speed input: 6310.71 toks/s, output: 1487.66 toks/s]
Processed prompts:  59%|█████▉    | 237/401 [00:23<00:03, 50.48it/s, est. speed input: 6496.22 toks/s, output: 1538.01 toks/s]
Processed prompts:  62%|██████▏   | 248/401 [00:23<00:03, 50.46it/s, est. speed input: 6792.54 toks/s, output: 1607.81 toks/s]
Processed prompts:  63%|██████▎   | 254/401 [00:24<00:05, 26.02it/s, est. speed input: 6784.71 toks/s, output: 1614.48 toks/s]
Processed prompts:  65%|██████▍   | 259/401 [00:24<00:07, 18.99it/s, est. speed input: 6791.30 toks/s, output: 1611.48 toks/s]
Processed prompts:  66%|██████▌   | 263/401 [00:24<00:06, 20.09it/s, est. speed input: 6869.27 toks/s, output: 1625.39 toks/s]
Processed prompts:  67%|██████▋   | 267/401 [00:24<00:06, 21.97it/s, est. speed input: 6947.20 toks/s, output: 1638.11 toks/s]
Processed prompts:  68%|██████▊   | 271/401 [00:25<00:06, 21.34it/s, est. speed input: 7003.80 toks/s, output: 1644.09 toks/s]
Processed prompts:  69%|██████▉   | 278/401 [00:25<00:04, 28.37it/s, est. speed input: 7159.62 toks/s, output: 1675.70 toks/s]
Processed prompts:  70%|███████   | 282/401 [00:25<00:03, 30.35it/s, est. speed input: 7230.51 toks/s, output: 1690.63 toks/s]
Processed prompts:  71%|███████▏  | 286/401 [00:25<00:03, 32.24it/s, est. speed input: 7310.50 toks/s, output: 1704.95 toks/s]
Processed prompts:  73%|███████▎  | 292/401 [00:25<00:03, 34.73it/s, est. speed input: 7383.33 toks/s, output: 1729.05 toks/s]
Processed prompts:  74%|███████▍  | 298/401 [00:25<00:02, 38.60it/s, est. speed input: 7492.97 toks/s, output: 1753.67 toks/s]
Processed prompts:  76%|███████▌  | 305/401 [00:25<00:02, 38.10it/s, est. speed input: 7599.31 toks/s, output: 1782.37 toks/s]
Processed prompts:  78%|███████▊  | 312/401 [00:26<00:02, 43.53it/s, est. speed input: 7745.67 toks/s, output: 1816.46 toks/s]
Processed prompts:  80%|███████▉  | 320/401 [00:26<00:01, 50.41it/s, est. speed input: 7920.21 toks/s, output: 1856.71 toks/s]
Processed prompts:  82%|████████▏ | 330/401 [00:26<00:01, 61.03it/s, est. speed input: 8163.93 toks/s, output: 1911.03 toks/s]
Processed prompts:  84%|████████▍ | 337/401 [00:26<00:01, 62.66it/s, est. speed input: 8405.29 toks/s, output: 1947.40 toks/s]
Processed prompts:  87%|████████▋ | 348/401 [00:26<00:00, 68.21it/s, est. speed input: 8639.68 toks/s, output: 2009.96 toks/s]
Processed prompts:  90%|████████▉ | 360/401 [00:26<00:00, 79.04it/s, est. speed input: 8932.95 toks/s, output: 2084.02 toks/s]
Processed prompts:  92%|█████████▏| 370/401 [00:26<00:00, 84.46it/s, est. speed input: 9184.22 toks/s, output: 2148.55 toks/s]
Processed prompts:  95%|█████████▍| 379/401 [00:27<00:00, 55.86it/s, est. speed input: 9385.93 toks/s, output: 2196.98 toks/s]
Processed prompts:  96%|█████████▋| 386/401 [00:27<00:00, 58.55it/s, est. speed input: 9555.32 toks/s, output: 2244.08 toks/s]
Processed prompts:  98%|█████████▊| 393/401 [00:27<00:00, 48.52it/s, est. speed input: 9663.20 toks/s, output: 2285.91 toks/s]
Processed prompts: 100%|█████████▉| 399/401 [00:28<00:00, 13.37it/s, est. speed input: 9393.44 toks/s, output: 2232.19 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:30<00:00, 13.25it/s, est. speed input: 8993.32 toks/s, output: 2155.68 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts on Sefaria are often used to enhance readability and provide additional context. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is typically used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) are often references to other texts or sources. The quotes (like ' and ") are used to denote direct speech or specific references. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.) are used to include additional information or notes. The italics and hyphens are used for emphasis and to separate words, respectively. While these modern formatting elements can be removed to make the text more natural, they do provide important context and are part of the original source material. If you want to remove them, you can do so, but it's important to understand that these elements are there for a reason. As for the font, the earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which is a direct descendant of the Phoenician alphabet. Over time, this evolved into the Aramaic alphabet and eventually into the square script used in modern Hebrew. The font you see on Sefaria is likely the square script, which is the most common script used for Hebrew texts today. If you're interested in the original or earlier scripts, you might want to look into Paleo-Hebrew or Aramaic scripts."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.05s/it, est. speed input: 647.33 toks/s, output: 80.92 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.05s/it, est. speed input: 647.33 toks/s, output: 80.92 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are often used to enhance readability and provide additional context. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is typically used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) often indicate references to other texts or sources. The quotes (like ' and ") are used to denote direct speech or specific phrases. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּל חָכְמָה מֵיהוָה וִעָמְוָה הִיא לְעוֹלָמִים) are used to include additional information or to clarify the text. The italics and hyphens are used for stylistic or editorial purposes. While these modern formatting elements can be removed or changed to make the text more natural, they do not represent the original text's script or font. The earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which evolved into the modern Hebrew square script. The Samaritan script is a direct descendant of Paleo-Hebrew, and the Aramaic script developed later. The Torah, as we know it today, was likely written in the Paleo-Hebrew script, but over time, the square script became the standard. If you want to remove these modern elements, you can do so, but it's important to understand that they serve to clarify and enhance the text for modern readers."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.21s/it, est. speed input: 776.33 toks/s, output: 80.20 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.21s/it, est. speed input: 776.33 toks/s, output: 80.20 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts on Sefaria are primarily modern additions to make the texts more readable and accessible to contemporary readers. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is likely used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) and the brackets [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] are used to provide references or additional information. The quotes (like ' and ") are modern additions to denote speech or quotations. The use of parentheses and brackets is often to include additional commentary or references. The hyphens between words are likely used for clarity or to separate words that might otherwise run together. The italics are used for emphasis or to denote foreign words or names. While these modern additions can be helpful, if you want to remove them to make the text more 'natural' and closer to the original, you can do so. However, it's important to note that some of these elements, like the references and commentary, are part of the scholarly tradition and can provide valuable context. If you want to remove them, you can use a text editor or script to strip out these elements, but be aware that you might lose some of the scholarly insights and context."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.64s/it, est. speed input: 705.59 toks/s, output: 80.44 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.64s/it, est. speed input: 705.59 toks/s, output: 80.44 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in the Hebrew/Aramaic texts on Sefaria are modern additions that help with readability and provide context. The bold and italics are used to highlight specific names, phrases, or important sections. The large and small text sizes, such as <big><strong>ר' אהרן</strong></big>, are used to emphasize key figures or terms. Quotes, like ' and ", are used to denote speech or specific references. Parentheses and brackets, such as (תהלים ק\"ד, כ\"ד) and [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.], are used to provide additional information or references. Hyphens between words are used to clarify the meaning or pronunciation of certain terms. These modern additions are not part of the original texts and can be removed or changed to make the text more natural and closer to the original. For the earliest Hebrew texts, the script would have been Paleo-Hebrew, which is a direct descendant of the Phoenician alphabet. The Samaritan script and Aramaic script came later. The Torah, if written in its earliest form, would likely have been in Paleo-Hebrew. However, the exact script used for the Torah is a matter of tradition and interpretation, with some believing it to be Ktav Ashurith, the block script seen in modern Torah scrolls. To remove or change these modern additions, you can use text processing tools or scripts that identify and remove these formatting styles, making the text cleaner and more aligned with the original script."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.89s/it, est. speed input: 669.20 toks/s, output: 80.79 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.89s/it, est. speed input: 669.20 toks/s, output: 80.79 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts on Sefaria are modern additions meant to enhance readability and provide context. The bold and italics are used for emphasis, such as highlighting names or important phrases. The big text, like <big><strong>ר' אהרן</strong></big>, is often used to denote important figures or titles. The quotes, like ' and ", are used to indicate speech or quotations. The small parenthesized sections, like <small>(תהלים ק\"ד, כ\"ד)</small>, are references to other texts or passages. The brackets and parentheses, like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.), are used to include additional information or citations. The hyphens between words are used for clarity, especially in cases where words run together. These elements are not part of the original texts and can be removed or modified to make the text more natural. As for the script of the earliest Hebrew texts, they were likely written in Paleo-Hebrew, which is a direct descendant of the Phoenician alphabet. The square script you see in modern Torah scrolls, known as Ktav Ashurith, is a later development that evolved from Aramaic script. So, while the original texts would have been written in Paleo-Hebrew, the script you see on Sefaria is a more modern adaptation."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:07<00:00,  7.50s/it, est. speed input: 436.02 toks/s, output: 82.09 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:07<00:00,  7.50s/it, est. speed input: 436.02 toks/s, output: 82.09 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are primarily there for readability and to provide context. The small parentheses and quotes, like 'הקדמה:' and <small>(תהלים ק\"ד, כ\"ד)</small>, are used to denote footnotes, references, or additional information. The bold text, such as <big><strong>ר' אהרן</strong></big>, highlights important names or terms. The brackets and parentheses, like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (בן אריאל), are used to indicate editorial notes, translations, or clarifications. The italics and hyphens are often used for stylistic or typographical reasons. While these elements can be seen as 'modern' or 'English' additions, they are not part of the original texts and can be removed or changed to make the text more natural. If you want a cleaner version of the text, you can strip out these formatting elements, keeping only the core text. For example, the original text without these modern additions would look more like: \n\nהקדמה: ואמו\"ר הצדיקים הקדושים, כי מן זמן התגלות הבעל שם טוב הקדוש התחיל התנוצצות המשיח, והענין בודאי הוא אמת לאמתו, על פי מה דאיתא בספר הקדוש תולדות יעקב יוסף פ' וישב רל\"ג ע\"א, ומובא לקמן בספר זה בפרשת לך אות ב', כי סוד המשיח הוא סוד הדעת, וע\"ש בהגה ג', וזה מובן על פי פשוטו גם כן, כי כן כתב הרמב\"ם בפרק ט' מהלכות תשובה הלכה ב', וזה לשונו, ומפני זה נתאוו כל ישראל נביאיהם וחכמיהם לימות המשיח וכו', לפי שבאותן הימים תרבה הדעה והחכמה והאמת, שנאמר (ישעיהו י\"א:ט׳) כי מלאה האם דעה את ה' וכו' ע\"ש, ולקמן פ' שמות אות ט"ז העתקתי מס' תולדות יעקב יוסף סוף פ' וישלח, שזה היה ענין גאולת מצרים, מה שנתגלה הדעת על ידי משה רבינו עליו השלום, ובגאולה העתידה יתגלה הדעת ביתר שאת ויתר עוז, כי זה הדעת שנתגלה במצרים נקרא דעת דנוקבא, ובגאולה העתידה במהרה בימינו יתגלה דעת דדכורא ע\"ש היטב."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.26s/it, est. speed input: 522.72 toks/s, output: 81.64 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.26s/it, est. speed input: 522.72 toks/s, output: 81.64 toks/s]
[rank0]:[W708 17:01:24.105376689 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/ae_rag_lp_sc_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-08 17:01:28.189822_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-08 17:01:28.189822_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-08 17:01:28.189822_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:27,  3.56it/s]
  1%|          | 3/526 [00:00<00:58,  8.91it/s]
  1%|          | 6/526 [00:00<00:34, 15.28it/s]
  2%|▏         | 8/526 [00:00<00:33, 15.50it/s]
  2%|▏         | 11/526 [00:00<00:26, 19.15it/s]
  3%|▎         | 14/526 [00:01<00:35, 14.39it/s]
  3%|▎         | 16/526 [00:01<00:38, 13.12it/s]
  4%|▎         | 19/526 [00:01<00:31, 16.22it/s]
  4%|▍         | 21/526 [00:01<00:45, 11.10it/s]
  4%|▍         | 23/526 [00:01<00:54,  9.18it/s]
  5%|▍         | 25/526 [00:02<01:40,  4.98it/s]
  5%|▍         | 26/526 [00:03<01:47,  4.65it/s]
  5%|▌         | 28/526 [00:03<01:25,  5.82it/s]
  6%|▌         | 30/526 [00:04<02:34,  3.20it/s]
  6%|▌         | 31/526 [00:05<02:47,  2.95it/s]
  6%|▌         | 32/526 [00:05<02:34,  3.20it/s]
  6%|▋         | 33/526 [00:06<04:12,  1.95it/s]
  6%|▋         | 34/526 [00:07<04:25,  1.85it/s]
  7%|▋         | 35/526 [00:07<05:03,  1.62it/s]
  7%|▋         | 36/526 [00:08<03:59,  2.04it/s]
  7%|▋         | 37/526 [00:08<03:21,  2.42it/s]
  8%|▊         | 40/526 [00:08<01:48,  4.48it/s]
  8%|▊         | 43/526 [00:08<01:33,  5.19it/s]
  9%|▊         | 45/526 [00:09<01:15,  6.40it/s]
  9%|▊         | 46/526 [00:09<01:22,  5.83it/s]
  9%|▉         | 47/526 [00:09<01:20,  5.92it/s]
  9%|▉         | 48/526 [00:09<01:32,  5.18it/s]
 10%|▉         | 50/526 [00:09<01:15,  6.29it/s]
 10%|▉         | 52/526 [00:10<01:02,  7.64it/s]
 10%|█         | 53/526 [00:11<02:42,  2.90it/s]
 10%|█         | 54/526 [00:14<07:57,  1.01s/it]
 11%|█         | 57/526 [00:14<04:09,  1.88it/s]
 11%|█         | 59/526 [00:15<04:10,  1.87it/s]
 11%|█▏        | 60/526 [00:16<04:16,  1.82it/s]
 12%|█▏        | 61/526 [00:16<04:20,  1.78it/s]
 12%|█▏        | 62/526 [00:17<04:30,  1.72it/s]
 12%|█▏        | 63/526 [00:18<05:05,  1.52it/s]
 12%|█▏        | 65/526 [00:18<03:11,  2.41it/s]
 13%|█▎        | 66/526 [00:18<02:47,  2.75it/s]
 13%|█▎        | 67/526 [00:18<02:19,  3.29it/s]
 13%|█▎        | 68/526 [00:19<03:35,  2.12it/s]
 13%|█▎        | 70/526 [00:20<03:34,  2.13it/s]
 13%|█▎        | 71/526 [00:21<03:26,  2.20it/s]
 14%|█▍        | 73/526 [00:21<02:58,  2.54it/s]
 14%|█▍        | 74/526 [00:22<03:47,  1.99it/s]
 14%|█▍        | 76/526 [00:22<02:32,  2.95it/s]
 15%|█▍        | 78/526 [00:23<02:51,  2.62it/s]
 15%|█▌        | 80/526 [00:24<02:16,  3.27it/s]
 16%|█▌        | 84/526 [00:24<01:17,  5.69it/s]
 16%|█▋        | 86/526 [00:25<02:28,  2.96it/s]
 17%|█▋        | 87/526 [00:26<02:12,  3.31it/s]
 17%|█▋        | 88/526 [00:26<02:02,  3.58it/s]
 17%|█▋        | 89/526 [00:26<02:06,  3.45it/s]
 17%|█▋        | 91/526 [00:26<01:33,  4.66it/s]
 17%|█▋        | 92/526 [00:26<01:25,  5.10it/s]
 18%|█▊        | 94/526 [00:26<01:04,  6.69it/s]
 18%|█▊        | 96/526 [00:27<00:59,  7.21it/s]
 18%|█▊        | 97/526 [00:27<01:39,  4.32it/s]
 19%|█▊        | 98/526 [00:30<05:25,  1.31it/s]
 19%|█▉        | 99/526 [00:32<07:16,  1.02s/it]
 19%|█▉        | 101/526 [00:32<04:33,  1.55it/s]
 20%|█▉        | 103/526 [00:32<03:22,  2.09it/s]
 20%|█▉        | 104/526 [00:34<04:24,  1.60it/s]
 20%|██        | 106/526 [00:34<03:00,  2.33it/s]
 21%|██        | 108/526 [00:34<02:16,  3.06it/s]
 21%|██        | 109/526 [00:34<02:04,  3.34it/s]
 21%|██        | 110/526 [00:35<02:17,  3.02it/s]
 21%|██        | 111/526 [00:35<02:27,  2.81it/s]
 21%|██▏       | 112/526 [00:35<02:33,  2.69it/s]
 22%|██▏       | 114/526 [00:36<01:43,  4.00it/s]
 22%|██▏       | 116/526 [00:36<01:14,  5.53it/s]
 23%|██▎       | 119/526 [00:36<00:58,  6.99it/s]
 23%|██▎       | 120/526 [00:36<00:55,  7.30it/s]
 23%|██▎       | 121/526 [00:36<01:00,  6.68it/s]
 24%|██▎       | 124/526 [00:38<01:49,  3.67it/s]
 24%|██▍       | 126/526 [00:38<01:22,  4.83it/s]
 24%|██▍       | 127/526 [00:38<01:17,  5.14it/s]
 24%|██▍       | 128/526 [00:38<01:10,  5.61it/s]
 25%|██▍       | 129/526 [00:38<01:09,  5.73it/s]
 25%|██▍       | 130/526 [00:38<01:07,  5.87it/s]
 25%|██▍       | 131/526 [00:39<01:10,  5.64it/s]
 25%|██▌       | 133/526 [00:39<00:54,  7.26it/s]
 26%|██▌       | 135/526 [00:39<00:44,  8.84it/s]
 26%|██▌       | 136/526 [00:39<00:55,  7.04it/s]
 26%|██▌       | 138/526 [00:39<00:53,  7.22it/s]
 27%|██▋       | 141/526 [00:39<00:37, 10.28it/s]
 27%|██▋       | 143/526 [00:40<00:39,  9.72it/s]
 28%|██▊       | 145/526 [00:40<00:35, 10.76it/s]
 28%|██▊       | 147/526 [00:40<00:41,  9.02it/s]
 28%|██▊       | 149/526 [00:40<00:39,  9.56it/s]
 29%|██▊       | 151/526 [00:40<00:33, 11.28it/s]
 29%|██▉       | 153/526 [00:41<00:29, 12.54it/s]
 29%|██▉       | 155/526 [00:41<01:02,  5.90it/s]
 30%|██▉       | 157/526 [00:42<00:56,  6.59it/s]
 30%|███       | 160/526 [00:42<01:05,  5.61it/s]
 31%|███       | 161/526 [00:42<01:05,  5.53it/s]
 31%|███       | 162/526 [00:44<02:59,  2.03it/s]
 31%|███▏      | 165/526 [00:44<01:46,  3.40it/s]
 32%|███▏      | 167/526 [00:45<01:21,  4.40it/s]
 32%|███▏      | 170/526 [00:45<00:54,  6.53it/s]
 33%|███▎      | 172/526 [00:47<02:14,  2.64it/s]
 33%|███▎      | 174/526 [00:47<01:53,  3.11it/s]
 33%|███▎      | 176/526 [00:47<01:34,  3.71it/s]
 34%|███▍      | 178/526 [00:47<01:14,  4.66it/s]
 34%|███▍      | 180/526 [00:48<01:00,  5.74it/s]
 35%|███▍      | 182/526 [00:49<01:31,  3.74it/s]
 35%|███▍      | 184/526 [00:49<01:27,  3.90it/s]
 35%|███▌      | 186/526 [00:50<02:13,  2.54it/s]
 36%|███▌      | 187/526 [00:51<02:00,  2.81it/s]
 36%|███▌      | 188/526 [00:51<01:48,  3.12it/s]
 36%|███▌      | 190/526 [00:51<01:16,  4.38it/s]
 36%|███▋      | 191/526 [00:51<01:11,  4.70it/s]
 37%|███▋      | 192/526 [00:51<01:04,  5.19it/s]
 37%|███▋      | 196/526 [00:51<00:32, 10.11it/s]
 38%|███▊      | 198/526 [00:52<00:34,  9.52it/s]
 38%|███▊      | 200/526 [00:53<01:56,  2.80it/s]
 38%|███▊      | 202/526 [00:54<01:50,  2.93it/s]
 39%|███▊      | 203/526 [00:55<02:00,  2.68it/s]
 39%|███▉      | 205/526 [00:55<01:25,  3.75it/s]
 39%|███▉      | 207/526 [00:55<01:05,  4.88it/s]
 40%|███▉      | 210/526 [00:55<00:43,  7.29it/s]
 40%|████      | 212/526 [00:56<01:11,  4.40it/s]
 41%|████      | 215/526 [00:56<00:51,  6.08it/s]
 41%|████▏     | 217/526 [00:57<01:16,  4.05it/s]
 41%|████▏     | 218/526 [00:58<01:36,  3.21it/s]
 42%|████▏     | 219/526 [00:58<01:45,  2.91it/s]
 42%|████▏     | 222/526 [00:58<01:04,  4.69it/s]
 43%|████▎     | 224/526 [00:59<00:55,  5.45it/s]
 43%|████▎     | 228/526 [00:59<00:33,  9.00it/s]
 44%|████▎     | 230/526 [00:59<00:29,  9.88it/s]
 44%|████▍     | 232/526 [00:59<00:48,  6.11it/s]
 44%|████▍     | 234/526 [01:00<00:40,  7.27it/s]
 45%|████▍     | 236/526 [01:00<00:36,  7.85it/s]
 45%|████▌     | 238/526 [01:00<00:40,  7.05it/s]
 46%|████▌     | 241/526 [01:00<00:31,  8.93it/s]
 46%|████▌     | 243/526 [01:01<00:28,  9.82it/s]
 47%|████▋     | 245/526 [01:02<01:01,  4.58it/s]
 47%|████▋     | 247/526 [01:02<00:53,  5.22it/s]
 47%|████▋     | 248/526 [01:02<01:01,  4.50it/s]
 47%|████▋     | 249/526 [01:03<01:24,  3.26it/s]
 48%|████▊     | 250/526 [01:03<01:12,  3.78it/s]
 48%|████▊     | 251/526 [01:03<01:06,  4.14it/s]
 48%|████▊     | 252/526 [01:03<01:02,  4.36it/s]
 48%|████▊     | 253/526 [01:03<00:58,  4.68it/s]
 48%|████▊     | 255/526 [01:04<01:24,  3.22it/s]
 49%|████▊     | 256/526 [01:05<01:14,  3.64it/s]
 49%|████▉     | 258/526 [01:05<00:54,  4.89it/s]
 49%|████▉     | 260/526 [01:05<00:42,  6.33it/s]
 50%|████▉     | 261/526 [01:05<00:40,  6.60it/s]
 50%|█████     | 263/526 [01:06<01:03,  4.14it/s]
 50%|█████     | 264/526 [01:07<01:29,  2.91it/s]
 50%|█████     | 265/526 [01:07<01:17,  3.36it/s]
 51%|█████     | 266/526 [01:07<01:26,  2.99it/s]
 51%|█████     | 267/526 [01:08<01:34,  2.75it/s]
 51%|█████     | 268/526 [01:08<01:17,  3.31it/s]
 51%|█████▏    | 270/526 [01:08<00:52,  4.87it/s]
 52%|█████▏    | 271/526 [01:08<00:49,  5.13it/s]
 52%|█████▏    | 272/526 [01:08<01:06,  3.80it/s]
 52%|█████▏    | 273/526 [01:09<01:17,  3.26it/s]
 52%|█████▏    | 274/526 [01:09<01:22,  3.05it/s]
 52%|█████▏    | 275/526 [01:11<03:08,  1.33it/s]
 52%|█████▏    | 276/526 [01:11<02:25,  1.72it/s]
 53%|█████▎    | 277/526 [01:11<01:55,  2.16it/s]
 53%|█████▎    | 279/526 [01:13<02:49,  1.46it/s]
 53%|█████▎    | 280/526 [01:15<03:57,  1.04it/s]
 53%|█████▎    | 281/526 [01:17<04:52,  1.20s/it]
 54%|█████▎    | 282/526 [01:19<05:34,  1.37s/it]
 54%|█████▍    | 283/526 [01:21<06:05,  1.51s/it]
 54%|█████▍    | 284/526 [01:23<06:29,  1.61s/it]
 54%|█████▍    | 285/526 [01:23<04:57,  1.23s/it]
 54%|█████▍    | 286/526 [01:24<04:26,  1.11s/it]
 55%|█████▍    | 287/526 [01:24<03:17,  1.21it/s]
 55%|█████▍    | 289/526 [01:24<01:53,  2.10it/s]
 55%|█████▌    | 291/526 [01:24<01:29,  2.63it/s]
 56%|█████▌    | 292/526 [01:25<01:18,  2.97it/s]
 56%|█████▌    | 294/526 [01:25<00:56,  4.13it/s]
 56%|█████▌    | 295/526 [01:25<00:49,  4.69it/s]
 56%|█████▋    | 296/526 [01:25<00:43,  5.29it/s]
 57%|█████▋    | 298/526 [01:28<02:29,  1.53it/s]
 57%|█████▋    | 299/526 [01:30<04:08,  1.09s/it]
 57%|█████▋    | 300/526 [01:32<04:13,  1.12s/it]
 57%|█████▋    | 301/526 [01:33<04:03,  1.08s/it]
 57%|█████▋    | 302/526 [01:34<04:08,  1.11s/it]
 58%|█████▊    | 303/526 [01:35<04:12,  1.13s/it]
 58%|█████▊    | 304/526 [01:35<03:06,  1.19it/s]
 58%|█████▊    | 305/526 [01:36<03:28,  1.06it/s]
 58%|█████▊    | 306/526 [01:37<03:43,  1.02s/it]
 58%|█████▊    | 307/526 [01:39<03:55,  1.08s/it]
 59%|█████▊    | 308/526 [01:40<04:11,  1.16s/it]
 59%|█████▊    | 309/526 [01:40<03:05,  1.17it/s]
 59%|█████▉    | 310/526 [01:41<02:51,  1.26it/s]
 59%|█████▉    | 311/526 [01:41<02:07,  1.69it/s]
 59%|█████▉    | 312/526 [01:42<02:46,  1.28it/s]
 60%|█████▉    | 313/526 [01:43<03:12,  1.11it/s]
 60%|█████▉    | 314/526 [01:45<03:37,  1.03s/it]
 60%|█████▉    | 315/526 [01:48<05:46,  1.64s/it]
 60%|██████    | 317/526 [01:48<03:27,  1.01it/s]
 60%|██████    | 318/526 [01:49<02:56,  1.18it/s]
 61%|██████    | 319/526 [01:49<02:24,  1.43it/s]
 61%|██████    | 321/526 [01:50<02:23,  1.43it/s]
 61%|██████    | 322/526 [01:51<02:02,  1.66it/s]
 62%|██████▏   | 324/526 [01:51<01:20,  2.52it/s]
 62%|██████▏   | 326/526 [01:51<00:57,  3.49it/s]
 62%|██████▏   | 327/526 [01:51<00:53,  3.74it/s]
 62%|██████▏   | 328/526 [01:51<00:46,  4.21it/s]
 63%|██████▎   | 330/526 [01:51<00:32,  6.03it/s]
 63%|██████▎   | 332/526 [01:52<00:41,  4.72it/s]
 63%|██████▎   | 334/526 [01:53<01:05,  2.91it/s]
 64%|██████▎   | 335/526 [01:53<01:02,  3.04it/s]
 64%|██████▍   | 336/526 [01:55<01:38,  1.94it/s]
 64%|██████▍   | 337/526 [01:55<01:36,  1.97it/s]
 64%|██████▍   | 339/526 [01:56<01:14,  2.53it/s]
 65%|██████▍   | 340/526 [01:57<02:15,  1.38it/s]
 65%|██████▌   | 342/526 [01:58<01:28,  2.07it/s]
 65%|██████▌   | 343/526 [01:58<01:34,  1.93it/s]
 66%|██████▌   | 345/526 [02:01<02:49,  1.07it/s]
 66%|██████▌   | 346/526 [02:03<03:22,  1.12s/it]
 66%|██████▌   | 347/526 [02:06<04:49,  1.62s/it]
 66%|██████▌   | 348/526 [02:07<03:54,  1.32s/it]
 66%|██████▋   | 349/526 [02:07<03:07,  1.06s/it]
 67%|██████▋   | 350/526 [02:11<04:53,  1.67s/it]
 67%|██████▋   | 351/526 [02:12<05:00,  1.71s/it]
 67%|██████▋   | 352/526 [02:13<03:39,  1.26s/it]
 67%|██████▋   | 354/526 [02:13<02:04,  1.38it/s]
 67%|██████▋   | 355/526 [02:13<01:47,  1.59it/s]
 68%|██████▊   | 357/526 [02:13<01:15,  2.25it/s]
 68%|██████▊   | 358/526 [02:14<01:08,  2.46it/s]
 68%|██████▊   | 360/526 [02:14<00:46,  3.58it/s]
 69%|██████▊   | 361/526 [02:14<00:41,  3.98it/s]
 69%|██████▉   | 363/526 [02:15<00:44,  3.67it/s]
 69%|██████▉   | 364/526 [02:15<00:41,  3.87it/s]
 69%|██████▉   | 365/526 [02:15<00:45,  3.50it/s]
 70%|██████▉   | 366/526 [02:17<01:36,  1.66it/s]
 70%|██████▉   | 368/526 [02:17<01:01,  2.56it/s]
 70%|███████   | 369/526 [02:17<00:56,  2.79it/s]
 70%|███████   | 370/526 [02:20<02:49,  1.09s/it]
 71%|███████   | 371/526 [02:24<04:15,  1.65s/it]
 71%|███████   | 372/526 [02:27<05:21,  2.09s/it]
 71%|███████▏  | 375/526 [02:30<03:54,  1.56s/it]
 71%|███████▏  | 376/526 [02:30<03:09,  1.26s/it]
 72%|███████▏  | 378/526 [02:30<02:01,  1.21it/s]
 72%|███████▏  | 379/526 [02:31<01:46,  1.38it/s]
 72%|███████▏  | 381/526 [02:34<02:35,  1.07s/it]
 73%|███████▎  | 382/526 [02:34<02:07,  1.13it/s]
 73%|███████▎  | 383/526 [02:35<01:48,  1.31it/s]
 73%|███████▎  | 384/526 [02:38<03:13,  1.36s/it]
 73%|███████▎  | 385/526 [02:41<04:21,  1.85s/it]
 73%|███████▎  | 386/526 [02:41<03:24,  1.46s/it]
 74%|███████▍  | 388/526 [02:42<01:59,  1.16it/s]
 74%|███████▍  | 389/526 [02:42<01:50,  1.24it/s]
 74%|███████▍  | 390/526 [02:43<01:42,  1.32it/s]
 75%|███████▍  | 393/526 [02:43<00:52,  2.54it/s]
 75%|███████▌  | 396/526 [02:43<00:32,  4.03it/s]
 76%|███████▌  | 398/526 [02:43<00:26,  4.87it/s]
 76%|███████▌  | 400/526 [02:47<01:20,  1.57it/s]
 76%|███████▌  | 401/526 [02:50<02:15,  1.09s/it]
 76%|███████▋  | 402/526 [02:50<01:52,  1.10it/s]
 77%|███████▋  | 403/526 [02:50<01:32,  1.34it/s]
 77%|███████▋  | 404/526 [02:51<01:14,  1.63it/s]
 77%|███████▋  | 406/526 [02:53<01:52,  1.07it/s]
 78%|███████▊  | 408/526 [02:54<01:14,  1.58it/s]
 78%|███████▊  | 409/526 [02:54<01:13,  1.60it/s]
 78%|███████▊  | 411/526 [02:58<01:57,  1.02s/it]
 79%|███████▊  | 413/526 [02:58<01:17,  1.46it/s]
 79%|███████▉  | 415/526 [02:58<00:57,  1.94it/s]
 79%|███████▉  | 417/526 [02:58<00:44,  2.47it/s]
 79%|███████▉  | 418/526 [03:00<01:02,  1.72it/s]
 80%|███████▉  | 420/526 [03:00<00:42,  2.48it/s]
 80%|████████  | 421/526 [03:02<01:18,  1.34it/s]
 80%|████████  | 423/526 [03:02<00:55,  1.86it/s]
 81%|████████  | 425/526 [03:02<00:37,  2.69it/s]
 81%|████████  | 426/526 [03:03<00:33,  3.02it/s]
 81%|████████▏ | 428/526 [03:03<00:23,  4.17it/s]
 82%|████████▏ | 430/526 [03:03<00:17,  5.44it/s]
 82%|████████▏ | 432/526 [03:03<00:19,  4.93it/s]
 82%|████████▏ | 433/526 [03:04<00:18,  5.13it/s]
 83%|████████▎ | 435/526 [03:06<00:48,  1.89it/s]
 83%|████████▎ | 436/526 [03:06<00:45,  1.99it/s]
 83%|████████▎ | 438/526 [03:07<00:35,  2.47it/s]
 83%|████████▎ | 439/526 [03:07<00:39,  2.20it/s]
 84%|████████▎ | 440/526 [03:08<00:41,  2.09it/s]
 84%|████████▍ | 442/526 [03:08<00:29,  2.87it/s]
 84%|████████▍ | 444/526 [03:10<00:41,  1.98it/s]
 85%|████████▍ | 445/526 [03:11<00:58,  1.38it/s]
 85%|████████▍ | 447/526 [03:12<00:41,  1.91it/s]
 85%|████████▌ | 448/526 [03:12<00:35,  2.21it/s]
 86%|████████▌ | 450/526 [03:12<00:23,  3.30it/s]
 86%|████████▌ | 453/526 [03:12<00:13,  5.43it/s]
 87%|████████▋ | 455/526 [03:12<00:12,  5.60it/s]
 87%|████████▋ | 457/526 [03:13<00:09,  7.03it/s]
 87%|████████▋ | 459/526 [03:13<00:08,  7.76it/s]
 88%|████████▊ | 461/526 [03:13<00:08,  7.48it/s]
 88%|████████▊ | 463/526 [03:13<00:08,  7.66it/s]
 88%|████████▊ | 465/526 [03:14<00:08,  7.59it/s]
 89%|████████▊ | 466/526 [03:14<00:08,  7.01it/s]
 89%|████████▉ | 467/526 [03:14<00:09,  6.24it/s]
 89%|████████▉ | 468/526 [03:14<00:08,  6.69it/s]
 89%|████████▉ | 470/526 [03:14<00:06,  8.44it/s]
 90%|████████▉ | 472/526 [03:15<00:08,  6.42it/s]
 90%|█████████ | 475/526 [03:15<00:09,  5.21it/s]
 90%|█████████ | 476/526 [03:16<00:09,  5.18it/s]
 91%|█████████ | 479/526 [03:16<00:09,  5.09it/s]
 91%|█████████▏| 480/526 [03:16<00:09,  4.93it/s]
 91%|█████████▏| 481/526 [03:18<00:17,  2.53it/s]
 92%|█████████▏| 482/526 [03:18<00:16,  2.71it/s]
 92%|█████████▏| 484/526 [03:18<00:12,  3.47it/s]
 92%|█████████▏| 486/526 [03:18<00:08,  4.53it/s]
 93%|█████████▎| 488/526 [03:19<00:06,  6.07it/s]
 93%|█████████▎| 490/526 [03:19<00:04,  7.80it/s]
 94%|█████████▎| 492/526 [03:19<00:03,  9.12it/s]
 94%|█████████▍| 494/526 [03:21<00:13,  2.36it/s]
 94%|█████████▍| 495/526 [03:21<00:11,  2.62it/s]
 94%|█████████▍| 496/526 [03:21<00:09,  3.04it/s]
 94%|█████████▍| 497/526 [03:22<00:08,  3.22it/s]
 95%|█████████▍| 498/526 [03:23<00:17,  1.60it/s]
 95%|█████████▍| 499/526 [03:25<00:24,  1.10it/s]
 95%|█████████▌| 501/526 [03:25<00:14,  1.76it/s]
 96%|█████████▌| 504/526 [03:25<00:07,  3.00it/s]
 96%|█████████▌| 505/526 [03:26<00:06,  3.09it/s]
 96%|█████████▌| 506/526 [03:26<00:05,  3.37it/s]
 97%|█████████▋| 508/526 [03:26<00:04,  3.65it/s]
 97%|█████████▋| 510/526 [03:27<00:04,  3.87it/s]
 97%|█████████▋| 511/526 [03:27<00:04,  3.43it/s]
 97%|█████████▋| 512/526 [03:27<00:03,  3.85it/s]
 98%|█████████▊| 513/526 [03:28<00:04,  2.86it/s]
 98%|█████████▊| 514/526 [03:28<00:04,  2.97it/s]
 98%|█████████▊| 515/526 [03:29<00:03,  3.21it/s]
 98%|█████████▊| 516/526 [03:29<00:02,  3.76it/s]
 98%|█████████▊| 517/526 [03:29<00:02,  3.83it/s]
 98%|█████████▊| 518/526 [03:29<00:01,  4.31it/s]
 99%|█████████▊| 519/526 [03:29<00:01,  4.77it/s]
 99%|█████████▉| 520/526 [03:30<00:02,  2.92it/s]
 99%|█████████▉| 522/526 [03:33<00:03,  1.05it/s]
 99%|█████████▉| 523/526 [03:36<00:04,  1.51s/it]
100%|█████████▉| 524/526 [03:40<00:03,  1.99s/it]
100%|█████████▉| 525/526 [03:40<00:01,  1.50s/it]
100%|██████████| 526/526 [03:43<00:00,  2.00s/it]
100%|██████████| 526/526 [03:43<00:00,  2.35it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-08 17:01:28.189822_lp_processed_test.json', '--output_addr', 'data/out/rag/asym/lp_rag_ae_sc_test_2_output.json', '--temperature', '0.0', '--top_p', '0.95', '--max_tokens', '4096', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/work/pi_hzamani_umass_edu/ozel_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  5.04 examples/s]
Generating train split: 526 examples [00:00, 1312.35 examples/s]
INFO 07-08 17:05:41 config.py:510] This model supports multiple tasks: {'reward', 'classify', 'embed', 'score', 'generate'}. Defaulting to 'generate'.
INFO 07-08 17:05:41 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/work/pi_hzamani_umass_edu/ozel_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-08 17:05:42 selector.py:120] Using Flash Attention backend.
INFO 07-08 17:05:43 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-08 17:05:43 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.63it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.59it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.57it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.61it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.60it/s]

INFO 07-08 17:05:46 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-08 17:05:48 worker.py:241] Memory profiling takes 2.13 seconds
INFO 07-08 17:05:48 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-08 17:05:48 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-08 17:05:48 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-08 17:05:48 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-08 17:05:51 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.76it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:10,  3.14it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.27it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:09,  3.34it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.37it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.41it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:08,  3.41it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.43it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.42it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:07,  3.44it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.46it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.47it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.47it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:06,  3.49it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.50it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.49it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:05,  3.52it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:05<00:04,  3.56it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.57it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:04,  3.59it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:06<00:03,  3.60it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.62it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.64it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:03,  3.64it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:07<00:02,  3.63it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.63it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.65it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.65it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:08<00:01,  3.66it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.67it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.67it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:09<00:00,  3.63it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:09<00:00,  3.57it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.61it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.64it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.53it/s]
INFO 07-08 17:06:01 model_runner.py:1535] Graph capturing finished in 10 secs, took 0.22 GiB
INFO 07-08 17:06:01 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.88 seconds
RAG ON
EXAMPLE PROMPT
<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Is investing all your savings into a small number of individual stocks risky? I want to invest 90% of my savings into stock market and split between 4-6 stocks.  How risky is this and is it a bad idea.  I feel like the stock market goes up over time so unless something like 2008 depression happens again there is actually not that much risk?Note that I'm trying to turn this into a form of income and not simply getting decent returns for retirement etc.  I am okay with reasonable risk so I can work less hopefully.

What causes a stock to make an EXTREMELY big move in a short period? Today (8/19/20) I was paper trading a stock REDU.  I was in a short position without a stop loss and stock went from 6.74 to 7.48 or over 10% in a span of less than 30 seconds, faster than I could react to get out.  Is this due to low trade volume and the bid and ask became so wide?  or someone manipulating the market?My question is how can I avoid this scenario in the future.  Would a stop loss work to get me out? or avoid these types of stocks in general.
# Current post question:
Is cycling on this 35mph road too dangerous?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
How to tackle the bibliographic work as an entering PhD student? I'll be starting my PhD in the next fall. I already looked over the internet for advice for a beginner, even read two books on the subjects. Still, there is one point I haven't seen discussed as I wanted, it's the time and the way the student should be investing in catching up on his field and his specific topic, I'm speaking about the bibliographic part. For sure a student needs a lot of (continuous) input, but at the end he'll be solely judged on his output. From my previous research project, I'm not really confident in my way of balancing between going through articles/textbook material and trying to solve my own problematics. To be honest, it sometimes feels like a sneaky way of procrastinating: I'd tell myself that I'm still not ready to tackle my problem and that I need to make a little "detour" by existing works; and when it's done I don't feel more at ease to answer my questions. Or is it a normal aspect of research?In my specific case, I'll be working on a quite new subject (string theory) when I only had advanced lecture of quantum field theory and general relativity; so I'm thinking about going through the canonical textbook on the subject during the summer, do most of the exercises and derivations in there (which already represents hundreds of hours invested), maybe revising some mathematical tools I need to be really familiar with. Once I'll have a general idea of the topic I'll jump to the main articles in relation to my thesis. I also know that I will be using numerical tools (Monte Carlo methods) and will need to get conformable with that. So far I only have a superficial knowledge and use of the tool.Does it seem like a good use of my time? I already know that time and willpower are limited resources in grad school and I really don't want my desire to do well to burn me out from the beginning.

Why does the minor pentatonic scale sounds "oriental" to me? I've been training my minor pentatonic scale on guitar for a while (mostly playing it in A with the first position) and it always sounded somewhat oriental to me, in the sense of the musical airs you'd find in music to set the plot in Orient, musical clichés. I am not sure to be really clear in trying to share this impression, but I, then, read that in Orient they used to split the octave in 5 tones, and not 7 as we did in Europe, would it be because the pentatonic as only five notes (by definition) that my sub
# Current post question:
Shimano crankset is near end of life, can I use a Tiagra 4700 replacement?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
How to improve finger style guitar playing I am a competent, but not amazing, guitar player who is very comfortable with the usual chords as well as basic fingerpicking patterns. I would like to take it to the next level and be able to improvise and play something along the lines of (though not initially as complicated as) this by James Taylor: 
                
             - starting at about 2:40. Another example of something that I would love to do is 
                
            . As opposed to learning a particular song, which is fine, I am more interested in learning general techniques that I can improvise with when I am playing around on the guitar.What resources/tutorials/lessons would you recommend that can help me play interesting things like in these videos? 

What does "her mama leaned hard" in this Emmylou Harris Song mean? I was listening to the song "Red Dirt Girl" by Emmylou Harris, and didn't understand one of the lyrics: "her mama leaned hard." What does this mean?Her daddy turned mean and her mama leaned hardGot in trouble with a boy from townI did find one definition from this blog, but it doesn't seem to be what I am looking for: "To lean hard you must get under God’s feet and submit to His plans and purposes, even if you do not see them fully or understand them at all. Leaning means shifting all the weight of the burden from your shoulders to His."
# Current post question:
Repair Marin Hawk Hill (cracked frame) or get new bike?
<|im_end|>
<|im_start|>assistant

None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:12<1:47:28, 12.28s/it, est. speed input: 60.98 toks/s, output: 7.90 toks/s]
Processed prompts:   0%|          | 2/526 [00:12<45:22,  5.20s/it, est. speed input: 88.20 toks/s, output: 15.90 toks/s] 
Processed prompts:   1%|          | 4/526 [00:12<17:19,  1.99s/it, est. speed input: 151.39 toks/s, output: 32.00 toks/s]
Processed prompts:   1%|          | 5/526 [00:12<12:24,  1.43s/it, est. speed input: 202.32 toks/s, output: 39.81 toks/s]
Processed prompts:   1%|          | 6/526 [00:12<08:55,  1.03s/it, est. speed input: 225.95 toks/s, output: 47.75 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:13<05:02,  1.71it/s, est. speed input: 299.51 toks/s, output: 63.80 toks/s]
Processed prompts:   2%|▏         | 13/526 [00:13<02:09,  3.96it/s, est. speed input: 546.22 toks/s, output: 103.93 toks/s]
Processed prompts:   3%|▎         | 17/526 [00:13<01:30,  5.64it/s, est. speed input: 684.57 toks/s, output: 134.67 toks/s]
Processed prompts:   4%|▍         | 20/526 [00:13<01:11,  7.08it/s, est. speed input: 757.42 toks/s, output: 157.98 toks/s]
Processed prompts:   4%|▍         | 22/526 [00:14<01:02,  8.09it/s, est. speed input: 845.73 toks/s, output: 173.56 toks/s]
Processed prompts:   5%|▍         | 24/526 [00:14<00:54,  9.28it/s, est. speed input: 903.57 toks/s, output: 189.03 toks/s]
Processed prompts:   5%|▌         | 27/526 [00:14<00:46, 10.72it/s, est. speed input: 983.05 toks/s, output: 211.64 toks/s]
Processed prompts:   6%|▌         | 29/526 [00:14<00:44, 11.22it/s, est. speed input: 1038.18 toks/s, output: 226.27 toks/s]
Processed prompts:   7%|▋         | 35/526 [00:14<00:33, 14.81it/s, est. speed input: 1226.66 toks/s, output: 272.37 toks/s]
Processed prompts:   8%|▊         | 40/526 [00:15<00:30, 15.74it/s, est. speed input: 1400.56 toks/s, output: 309.17 toks/s]
Processed prompts:   8%|▊         | 43/526 [00:15<00:28, 16.67it/s, est. speed input: 1493.39 toks/s, output: 331.33 toks/s]
Processed prompts:   9%|▉         | 47/526 [00:15<00:28, 16.73it/s, est. speed input: 1617.72 toks/s, output: 359.49 toks/s]
Processed prompts:  10%|▉         | 50/526 [00:15<00:29, 16.24it/s, est. speed input: 1699.67 toks/s, output: 379.84 toks/s]
Processed prompts:  10%|█         | 53/526 [00:15<00:26, 17.93it/s, est. speed input: 1789.15 toks/s, output: 401.99 toks/s]
Processed prompts:  10%|█         | 55/526 [00:15<00:26, 17.87it/s, est. speed input: 1848.12 toks/s, output: 415.89 toks/s]
Processed prompts:  11%|█         | 57/526 [00:15<00:27, 16.96it/s, est. speed input: 1903.75 toks/s, output: 428.98 toks/s]
Processed prompts:  12%|█▏        | 61/526 [00:16<00:29, 15.95it/s, est. speed input: 1994.50 toks/s, output: 454.76 toks/s]
Processed prompts:  13%|█▎        | 66/526 [00:16<00:24, 18.73it/s, est. speed input: 2111.29 toks/s, output: 490.28 toks/s]
Processed prompts:  13%|█▎        | 70/526 [00:16<00:26, 17.22it/s, est. speed input: 2197.30 toks/s, output: 514.87 toks/s]
Processed prompts:  14%|█▍        | 76/526 [00:17<00:24, 18.48it/s, est. speed input: 2357.34 toks/s, output: 554.48 toks/s]
Processed prompts:  15%|█▌        | 80/526 [00:17<00:24, 18.22it/s, est. speed input: 2452.76 toks/s, output: 579.51 toks/s]
Processed prompts:  16%|█▌        | 83/526 [00:17<00:24, 17.90it/s, est. speed input: 2566.93 toks/s, output: 597.98 toks/s]
Processed prompts:  17%|█▋        | 88/526 [00:17<00:20, 21.54it/s, est. speed input: 2690.78 toks/s, output: 633.75 toks/s]
Processed prompts:  17%|█▋        | 91/526 [00:17<00:21, 20.05it/s, est. speed input: 2760.25 toks/s, output: 651.56 toks/s]
Processed prompts:  18%|█▊        | 96/526 [00:17<00:18, 23.35it/s, est. speed input: 2907.55 toks/s, output: 686.62 toks/s]
Processed prompts:  20%|█▉        | 103/526 [00:18<00:18, 22.29it/s, est. speed input: 3111.87 toks/s, output: 730.10 toks/s]
Processed prompts:  21%|██        | 109/526 [00:18<00:17, 24.06it/s, est. speed input: 3254.34 toks/s, output: 769.61 toks/s]
Processed prompts:  21%|██▏       | 113/526 [00:18<00:19, 21.65it/s, est. speed input: 3363.04 toks/s, output: 791.34 toks/s]
Processed prompts:  23%|██▎       | 119/526 [00:18<00:16, 24.84it/s, est. speed input: 3528.63 toks/s, output: 831.50 toks/s]
Processed prompts:  23%|██▎       | 122/526 [00:19<00:18, 22.07it/s, est. speed input: 3585.61 toks/s, output: 846.52 toks/s]
Processed prompts:  25%|██▍       | 129/526 [00:19<00:18, 20.93it/s, est. speed input: 3764.84 toks/s, output: 885.60 toks/s]
Processed prompts:  26%|██▌       | 136/526 [00:19<00:19, 20.33it/s, est. speed input: 3892.42 toks/s, output: 923.88 toks/s]
Processed prompts:  27%|██▋       | 140/526 [00:19<00:17, 22.06it/s, est. speed input: 3963.01 toks/s, output: 949.06 toks/s]
Processed prompts:  27%|██▋       | 143/526 [00:20<00:18, 20.23it/s, est. speed input: 3999.54 toks/s, output: 963.00 toks/s]
Processed prompts:  28%|██▊       | 147/526 [00:20<00:16, 22.48it/s, est. speed input: 4088.14 toks/s, output: 988.12 toks/s]
Processed prompts:  29%|██▊       | 150/526 [00:20<00:18, 20.75it/s, est. speed input: 4156.66 toks/s, output: 1002.52 toks/s]
Processed prompts:  30%|██▉       | 156/526 [00:20<00:16, 22.12it/s, est. speed input: 4268.79 toks/s, output: 1036.91 toks/s]
Processed prompts:  30%|███       | 159/526 [00:20<00:17, 20.54it/s, est. speed input: 4325.87 toks/s, output: 1050.85 toks/s]
Processed prompts:  31%|███       | 163/526 [00:21<00:17, 20.67it/s, est. speed input: 4396.43 toks/s, output: 1071.99 toks/s]
Processed prompts:  32%|███▏      | 166/526 [00:21<00:18, 19.64it/s, est. speed input: 4442.76 toks/s, output: 1086.00 toks/s]
Processed prompts:  32%|███▏      | 169/526 [00:21<00:16, 21.38it/s, est. speed input: 4498.56 toks/s, output: 1103.67 toks/s]
Processed prompts:  33%|███▎      | 173/526 [00:21<00:16, 21.76it/s, est. speed input: 4572.25 toks/s, output: 1125.14 toks/s]
Processed prompts:  34%|███▍      | 178/526 [00:21<00:14, 23.23it/s, est. speed input: 4667.93 toks/s, output: 1153.34 toks/s]
Processed prompts:  34%|███▍      | 181/526 [00:21<00:14, 23.70it/s, est. speed input: 4722.51 toks/s, output: 1170.04 toks/s]
Processed prompts:  35%|███▌      | 185/526 [00:22<00:16, 20.53it/s, est. speed input: 4763.22 toks/s, output: 1187.01 toks/s]
Processed prompts:  36%|███▌      | 189/526 [00:22<00:18, 18.07it/s, est. speed input: 4816.34 toks/s, output: 1202.22 toks/s]
Processed prompts:  37%|███▋      | 192/526 [00:22<00:17, 19.24it/s, est. speed input: 4882.12 toks/s, output: 1218.11 toks/s]
Processed prompts:  37%|███▋      | 195/526 [00:22<00:18, 17.45it/s, est. speed input: 4918.57 toks/s, output: 1228.99 toks/s]
Processed prompts:  38%|███▊      | 198/526 [00:22<00:18, 18.04it/s, est. speed input: 4979.95 toks/s, output: 1243.35 toks/s]
Processed prompts:  39%|███▉      | 206/526 [00:23<00:16, 19.53it/s, est. speed input: 5146.48 toks/s, output: 1282.46 toks/s]
Processed prompts:  40%|███▉      | 210/526 [00:23<00:17, 17.97it/s, est. speed input: 5204.30 toks/s, output: 1297.27 toks/s]
Processed prompts:  40%|████      | 212/526 [00:23<00:19, 16.29it/s, est. speed input: 5227.35 toks/s, output: 1302.16 toks/s]
Processed prompts:  41%|████▏     | 218/526 [00:23<00:14, 20.55it/s, est. speed input: 5335.46 toks/s, output: 1336.86 toks/s]
Processed prompts:  42%|████▏     | 221/526 [00:24<00:16, 18.48it/s, est. speed input: 5383.25 toks/s, output: 1346.95 toks/s]
Processed prompts:  43%|████▎     | 225/526 [00:24<00:14, 21.04it/s, est. speed input: 5437.95 toks/s, output: 1369.41 toks/s]
Processed prompts:  43%|████▎     | 228/526 [00:24<00:14, 20.01it/s, est. speed input: 5481.83 toks/s, output: 1382.07 toks/s]
Processed prompts:  44%|████▍     | 231/526 [00:24<00:19, 15.48it/s, est. speed input: 5485.95 toks/s, output: 1386.68 toks/s]
Processed prompts:  44%|████▍     | 233/526 [00:24<00:20, 14.41it/s, est. speed input: 5511.04 toks/s, output: 1391.76 toks/s]
Processed prompts:  45%|████▍     | 235/526 [00:25<00:21, 13.61it/s, est. speed input: 5512.20 toks/s, output: 1397.08 toks/s]
Processed prompts:  45%|████▌     | 238/526 [00:25<00:23, 12.10it/s, est. speed input: 5533.92 toks/s, output: 1402.95 toks/s]
Processed prompts:  46%|████▌     | 240/526 [00:25<00:23, 11.98it/s, est. speed input: 5537.09 toks/s, output: 1408.95 toks/s]
Processed prompts:  46%|████▌     | 242/526 [00:25<00:25, 11.23it/s, est. speed input: 5541.52 toks/s, output: 1412.88 toks/s]
Processed prompts:  46%|████▋     | 244/526 [00:26<00:28,  9.79it/s, est. speed input: 5535.73 toks/s, output: 1413.44 toks/s]
Processed prompts:  47%|████▋     | 246/526 [00:26<00:36,  7.75it/s, est. speed input: 5498.80 toks/s, output: 1407.75 toks/s]
Processed prompts:  47%|████▋     | 247/526 [00:26<00:39,  7.07it/s, est. speed input: 5486.88 toks/s, output: 1405.02 toks/s]
Processed prompts:  47%|████▋     | 248/526 [00:26<00:40,  6.92it/s, est. speed input: 5483.25 toks/s, output: 1404.89 toks/s]
Processed prompts:  48%|████▊     | 250/526 [00:27<00:38,  7.13it/s, est. speed input: 5487.12 toks/s, output: 1407.46 toks/s]
Processed prompts:  48%|████▊     | 251/526 [00:27<00:37,  7.28it/s, est. speed input: 5491.12 toks/s, output: 1404.83 toks/s]
Processed prompts:  48%|████▊     | 252/526 [00:27<00:50,  5.38it/s, est. speed input: 5446.24 toks/s, output: 1390.37 toks/s]
Processed prompts:  48%|████▊     | 254/526 [00:27<00:40,  6.79it/s, est. speed input: 5448.05 toks/s, output: 1393.86 toks/s]
Processed prompts:  49%|████▊     | 256/526 [00:27<00:34,  7.73it/s, est. speed input: 5446.84 toks/s, output: 1393.35 toks/s]
Processed prompts:  49%|████▉     | 257/526 [00:28<00:36,  7.32it/s, est. speed input: 5437.64 toks/s, output: 1389.95 toks/s]
Processed prompts:  49%|████▉     | 259/526 [00:28<00:33,  8.04it/s, est. speed input: 5448.96 toks/s, output: 1387.47 toks/s]
Processed prompts:  49%|████▉     | 260/526 [00:28<00:37,  7.01it/s, est. speed input: 5431.30 toks/s, output: 1381.65 toks/s]
Processed prompts:  50%|████▉     | 261/526 [00:28<00:42,  6.22it/s, est. speed input: 5405.33 toks/s, output: 1375.05 toks/s]
Processed prompts:  50%|█████     | 263/526 [00:28<00:31,  8.44it/s, est. speed input: 5410.61 toks/s, output: 1376.55 toks/s]
Processed prompts:  50%|█████     | 265/526 [00:28<00:27,  9.56it/s, est. speed input: 5413.72 toks/s, output: 1378.13 toks/s]
Processed prompts:  51%|█████     | 267/526 [00:29<00:27,  9.48it/s, est. speed input: 5419.20 toks/s, output: 1377.35 toks/s]
Processed prompts:  51%|█████▏    | 270/526 [00:29<00:23, 10.89it/s, est. speed input: 5439.44 toks/s, output: 1378.72 toks/s]
Processed prompts:  52%|█████▏    | 274/526 [00:29<00:17, 14.39it/s, est. speed input: 5513.39 toks/s, output: 1390.62 toks/s]
Processed prompts:  53%|█████▎    | 281/526 [00:29<00:10, 22.38it/s, est. speed input: 5623.23 toks/s, output: 1413.37 toks/s]
Processed prompts:  55%|█████▍    | 288/526 [00:29<00:07, 30.66it/s, est. speed input: 5737.95 toks/s, output: 1445.34 toks/s]
Processed prompts:  56%|█████▌    | 292/526 [00:29<00:07, 31.65it/s, est. speed input: 5785.89 toks/s, output: 1457.80 toks/s]
Processed prompts:  57%|█████▋    | 298/526 [00:30<00:06, 36.93it/s, est. speed input: 5896.46 toks/s, output: 1480.55 toks/s]
Processed prompts:  58%|█████▊    | 304/526 [00:30<00:05, 41.21it/s, est. speed input: 5991.11 toks/s, output: 1504.49 toks/s]
Processed prompts:  59%|█████▊    | 309/526 [00:30<00:05, 38.77it/s, est. speed input: 6060.25 toks/s, output: 1520.63 toks/s]
Processed prompts:  61%|██████    | 322/526 [00:30<00:03, 59.78it/s, est. speed input: 6300.37 toks/s, output: 1573.11 toks/s]
Processed prompts:  63%|██████▎   | 329/526 [00:30<00:03, 52.39it/s, est. speed input: 6426.52 toks/s, output: 1600.08 toks/s]
Processed prompts:  64%|██████▎   | 335/526 [00:30<00:03, 53.71it/s, est. speed input: 6557.57 toks/s, output: 1629.26 toks/s]
Processed prompts:  65%|██████▌   | 343/526 [00:30<00:03, 60.18it/s, est. speed input: 6693.90 toks/s, output: 1660.98 toks/s]
Processed prompts:  68%|██████▊   | 356/526 [00:30<00:02, 72.99it/s, est. speed input: 6951.65 toks/s, output: 1719.94 toks/s]
Processed prompts:  70%|██████▉   | 368/526 [00:31<00:01, 80.11it/s, est. speed input: 7135.01 toks/s, output: 1776.64 toks/s]
Processed prompts:  72%|███████▏  | 379/526 [00:31<00:01, 83.36it/s, est. speed input: 7357.62 toks/s, output: 1822.57 toks/s]
Processed prompts:  74%|███████▍  | 388/526 [00:31<00:03, 43.29it/s, est. speed input: 7413.03 toks/s, output: 1840.39 toks/s]
Processed prompts:  76%|███████▌  | 398/526 [00:31<00:02, 51.05it/s, est. speed input: 7587.45 toks/s, output: 1883.98 toks/s]
Processed prompts:  77%|███████▋  | 407/526 [00:31<00:02, 55.72it/s, est. speed input: 7740.22 toks/s, output: 1920.63 toks/s]
Processed prompts:  79%|███████▉  | 417/526 [00:32<00:01, 62.04it/s, est. speed input: 7919.50 toks/s, output: 1963.46 toks/s]
Processed prompts:  83%|████████▎ | 434/526 [00:32<00:01, 82.94it/s, est. speed input: 8234.54 toks/s, output: 2046.86 toks/s]
Processed prompts:  84%|████████▍ | 444/526 [00:32<00:00, 85.47it/s, est. speed input: 8405.09 toks/s, output: 2095.96 toks/s]
Processed prompts:  86%|████████▋ | 454/526 [00:32<00:00, 84.16it/s, est. speed input: 8606.90 toks/s, output: 2140.88 toks/s]
Processed prompts:  88%|████████▊ | 464/526 [00:32<00:00, 83.99it/s, est. speed input: 8811.20 toks/s, output: 2185.61 toks/s]
Processed prompts:  90%|████████▉ | 473/526 [00:32<00:00, 70.69it/s, est. speed input: 8971.14 toks/s, output: 2229.97 toks/s]
Processed prompts:  91%|█████████▏| 481/526 [00:32<00:00, 51.81it/s, est. speed input: 9064.87 toks/s, output: 2257.57 toks/s]
Processed prompts:  93%|█████████▎| 488/526 [00:33<00:00, 49.00it/s, est. speed input: 9149.57 toks/s, output: 2288.38 toks/s]
Processed prompts:  94%|█████████▍| 494/526 [00:33<00:00, 45.71it/s, est. speed input: 9216.23 toks/s, output: 2310.17 toks/s]
Processed prompts:  95%|█████████▌| 500/526 [00:33<00:00, 42.18it/s, est. speed input: 9303.10 toks/s, output: 2327.87 toks/s]
Processed prompts:  96%|█████████▌| 505/526 [00:33<00:00, 40.42it/s, est. speed input: 9383.03 toks/s, output: 2352.61 toks/s]
Processed prompts:  97%|█████████▋| 510/526 [00:34<00:00, 22.31it/s, est. speed input: 9320.30 toks/s, output: 2348.29 toks/s]
Processed prompts:  98%|█████████▊| 514/526 [00:34<00:00, 17.01it/s, est. speed input: 9290.94 toks/s, output: 2350.17 toks/s]
Processed prompts:  98%|█████████▊| 517/526 [00:34<00:00, 14.90it/s, est. speed input: 9292.85 toks/s, output: 2358.93 toks/s]
Processed prompts:  99%|█████████▉| 520/526 [00:35<00:00, 12.84it/s, est. speed input: 9257.07 toks/s, output: 2363.80 toks/s]
Processed prompts:  99%|█████████▉| 522/526 [00:35<00:00, 10.68it/s, est. speed input: 9223.29 toks/s, output: 2361.05 toks/s]
Processed prompts: 100%|█████████▉| 524/526 [00:36<00:00,  7.29it/s, est. speed input: 9118.40 toks/s, output: 2338.77 toks/s]
Processed prompts: 100%|█████████▉| 525/526 [00:48<00:00,  7.29it/s, est. speed input: 8862.38 toks/s, output: 2278.38 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:19<00:00,  4.79s/it, est. speed input: 4180.17 toks/s, output: 1124.79 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:19<00:00,  6.63it/s, est. speed input: 4180.17 toks/s, output: 1124.79 toks/s]
{  "personalized_answer": "Starting the conversation about rules at your house versus others' can be a delicate balance. You might begin by explaining that different families have different rules, just like how different TV shows have different ways of showing stories. For example, you could say, 'At our house, we have a rule that we don't use big words like "sob" or "screw you," but other families might have different rules. It's important to follow our family's rules because they help keep us safe and happy.' As your toddler grows, you can gradually introduce more complex concepts, such as why certain behaviors are acceptable in one setting but not in another. This approach helps build their understanding of context and respect for different environments, while also reinforcing the importance of following your family's specific rules."}
Invalid JSON
{  "personalized_answer": "To change scenes without changing chapters in your writing, consider using a technique called 'scene breaks.' These can be indicated by using a line of asterisks (*) or a double line break to signify a shift in time, place, or perspective. This method allows you to maintain the flow of your narrative while clearly separating different segments of the story. For example, you could write: 'The sun began to set, casting long shadows across the room. * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
Invalid JSON
None

Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  50%|█████     | 1/2 [00:01<00:01,  1.77s/it, est. speed input: 261.87 toks/s, output: 78.62 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:02<00:00,  1.09s/it, est. speed input: 470.23 toks/s, output: 138.80 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:02<00:00,  1.19s/it, est. speed input: 470.23 toks/s, output: 138.80 toks/s]
[rank0]:[W708 17:07:25.701650152 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/lp_rag_ae_sc_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp'] in profile
Temp data file saved at data/processed/TEMP_2025-07-08 17:07:28.892536_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-08 17:07:28.892536_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-08 17:07:28.892536_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<02:18,  3.05it/s]
  0%|          | 2/424 [00:00<02:12,  3.19it/s]
  1%|          | 4/424 [00:01<02:03,  3.40it/s]
  2%|▏         | 7/424 [00:01<01:19,  5.24it/s]
  2%|▏         | 10/424 [00:01<00:59,  6.96it/s]
  3%|▎         | 12/424 [00:01<00:50,  8.19it/s]
  3%|▎         | 13/424 [00:03<02:25,  2.82it/s]
  4%|▎         | 15/424 [00:03<01:50,  3.70it/s]
  4%|▍         | 16/424 [00:03<01:52,  3.63it/s]
  4%|▍         | 17/424 [00:04<01:41,  4.01it/s]
  5%|▍         | 20/424 [00:04<01:02,  6.44it/s]
  5%|▌         | 22/424 [00:04<01:00,  6.67it/s]
  5%|▌         | 23/424 [00:05<01:37,  4.12it/s]
  6%|▌         | 25/424 [00:05<01:25,  4.66it/s]
  6%|▋         | 27/424 [00:05<01:32,  4.31it/s]
  7%|▋         | 30/424 [00:06<01:01,  6.37it/s]
  8%|▊         | 34/424 [00:06<00:38, 10.02it/s]
  9%|▊         | 37/424 [00:06<00:57,  6.78it/s]
  9%|▉         | 40/424 [00:07<00:45,  8.36it/s]
 10%|█         | 44/424 [00:07<00:49,  7.73it/s]
 12%|█▏        | 49/424 [00:07<00:32, 11.49it/s]
 12%|█▏        | 52/424 [00:08<00:38,  9.72it/s]
 13%|█▎        | 54/424 [00:08<00:41,  8.85it/s]
 14%|█▎        | 58/424 [00:08<00:30, 12.06it/s]
 14%|█▍        | 61/424 [00:09<00:40,  8.96it/s]
 15%|█▍        | 63/424 [00:10<01:27,  4.11it/s]
 15%|█▌        | 65/424 [00:11<01:19,  4.52it/s]
 16%|█▌        | 66/424 [00:11<01:33,  3.83it/s]
 16%|█▌        | 67/424 [00:11<01:27,  4.06it/s]
 16%|█▌        | 68/424 [00:12<01:31,  3.91it/s]
 16%|█▋        | 69/424 [00:12<01:48,  3.26it/s]
 17%|█▋        | 70/424 [00:12<01:35,  3.70it/s]
 17%|█▋        | 71/424 [00:12<01:24,  4.16it/s]
 17%|█▋        | 72/424 [00:13<01:16,  4.60it/s]
 17%|█▋        | 73/424 [00:13<01:09,  5.04it/s]
 17%|█▋        | 74/424 [00:13<01:04,  5.40it/s]
 18%|█▊        | 76/424 [00:13<00:45,  7.59it/s]
 18%|█▊        | 77/424 [00:13<00:46,  7.52it/s]
 19%|█▉        | 80/424 [00:13<00:29, 11.64it/s]
 19%|█▉        | 82/424 [00:14<00:52,  6.54it/s]
 20%|█▉        | 84/424 [00:14<00:47,  7.12it/s]
 20%|██        | 85/424 [00:14<00:49,  6.90it/s]
 20%|██        | 86/424 [00:15<01:13,  4.62it/s]
 21%|██        | 87/424 [00:15<01:08,  4.92it/s]
 21%|██        | 89/424 [00:15<00:54,  6.12it/s]
 21%|██        | 90/424 [00:15<00:54,  6.11it/s]
 21%|██▏       | 91/424 [00:15<00:54,  6.10it/s]
 22%|██▏       | 92/424 [00:16<00:54,  6.10it/s]
 22%|██▏       | 93/424 [00:16<01:01,  5.37it/s]
 22%|██▏       | 94/424 [00:16<00:59,  5.59it/s]
 23%|██▎       | 96/424 [00:16<00:43,  7.47it/s]
 23%|██▎       | 98/424 [00:16<00:33,  9.60it/s]
 24%|██▎       | 100/424 [00:17<00:54,  5.97it/s]
 24%|██▍       | 101/424 [00:18<01:55,  2.80it/s]
 24%|██▍       | 103/424 [00:18<01:26,  3.71it/s]
 25%|██▍       | 105/424 [00:18<01:05,  4.84it/s]
 25%|██▌       | 107/424 [00:19<01:10,  4.48it/s]
 26%|██▌       | 109/424 [00:22<03:23,  1.55it/s]
 26%|██▌       | 110/424 [00:22<03:15,  1.61it/s]
 26%|██▌       | 111/424 [00:23<02:41,  1.93it/s]
 27%|██▋       | 114/424 [00:23<01:31,  3.39it/s]
 27%|██▋       | 116/424 [00:23<01:08,  4.47it/s]
 28%|██▊       | 118/424 [00:23<00:56,  5.37it/s]
 28%|██▊       | 120/424 [00:23<00:50,  6.03it/s]
 29%|██▉       | 122/424 [00:27<03:26,  1.46it/s]
 29%|██▉       | 123/424 [00:31<06:09,  1.23s/it]
 29%|██▉       | 124/424 [00:34<08:43,  1.75s/it]
 29%|██▉       | 125/424 [00:38<10:56,  2.20s/it]
 30%|██▉       | 126/424 [00:42<12:49,  2.58s/it]
 30%|██▉       | 127/424 [00:46<14:18,  2.89s/it]
 30%|███       | 128/424 [00:46<10:38,  2.16s/it]
 30%|███       | 129/424 [00:46<07:51,  1.60s/it]
 31%|███       | 130/424 [00:46<05:47,  1.18s/it]
 31%|███       | 131/424 [00:46<04:19,  1.13it/s]
 31%|███▏      | 133/424 [00:47<02:48,  1.72it/s]
 32%|███▏      | 137/424 [00:47<01:18,  3.68it/s]
 33%|███▎      | 140/424 [00:47<00:51,  5.49it/s]
 34%|███▍      | 144/424 [00:47<00:33,  8.35it/s]
 35%|███▍      | 147/424 [00:47<00:25, 10.73it/s]
 36%|███▌      | 151/424 [00:47<00:19, 14.12it/s]
 37%|███▋      | 155/424 [00:48<00:15, 17.39it/s]
 38%|███▊      | 159/424 [00:48<00:13, 20.23it/s]
 38%|███▊      | 162/424 [00:49<00:44,  5.86it/s]
 39%|███▉      | 166/424 [00:49<00:32,  7.98it/s]
 40%|███▉      | 169/424 [00:50<00:29,  8.70it/s]
 40%|████      | 171/424 [00:50<00:36,  6.97it/s]
 41%|████      | 173/424 [00:50<00:30,  8.14it/s]
 41%|████▏     | 175/424 [00:51<00:51,  4.86it/s]
 42%|████▏     | 178/424 [00:51<00:42,  5.82it/s]
 42%|████▏     | 180/424 [00:52<00:42,  5.75it/s]
 43%|████▎     | 183/424 [00:52<00:30,  7.81it/s]
 44%|████▎     | 185/424 [00:52<00:26,  8.91it/s]
 44%|████▍     | 188/424 [00:52<00:20, 11.58it/s]
 45%|████▍     | 190/424 [00:55<01:43,  2.27it/s]
 45%|████▌     | 192/424 [00:56<01:32,  2.51it/s]
 46%|████▌     | 194/424 [00:56<01:10,  3.28it/s]
 46%|████▌     | 196/424 [00:56<01:08,  3.35it/s]
 46%|████▋     | 197/424 [00:57<01:04,  3.51it/s]
 47%|████▋     | 198/424 [00:57<00:58,  3.87it/s]
 47%|████▋     | 199/424 [00:57<01:09,  3.24it/s]
 47%|████▋     | 200/424 [00:57<01:00,  3.72it/s]
 47%|████▋     | 201/424 [00:58<01:07,  3.28it/s]
 48%|████▊     | 202/424 [00:58<01:00,  3.70it/s]
 48%|████▊     | 203/424 [00:58<01:06,  3.33it/s]
 48%|████▊     | 204/424 [01:00<02:19,  1.57it/s]
 48%|████▊     | 205/424 [01:00<01:50,  1.98it/s]
 49%|████▊     | 206/424 [01:03<04:23,  1.21s/it]
 49%|████▉     | 207/424 [01:03<03:19,  1.09it/s]
 49%|████▉     | 209/424 [01:03<01:56,  1.84it/s]
 50%|█████     | 212/424 [01:04<01:03,  3.36it/s]
 50%|█████     | 214/424 [01:05<01:14,  2.81it/s]
 51%|█████     | 215/424 [01:05<01:19,  2.63it/s]
 51%|█████     | 217/424 [01:05<00:59,  3.45it/s]
 51%|█████▏    | 218/424 [01:05<00:56,  3.62it/s]
 52%|█████▏    | 219/424 [01:06<00:53,  3.87it/s]
 52%|█████▏    | 220/424 [01:06<01:04,  3.18it/s]
 52%|█████▏    | 222/424 [01:07<00:54,  3.73it/s]
 53%|█████▎    | 223/424 [01:07<00:49,  4.07it/s]
 53%|█████▎    | 225/424 [01:07<00:53,  3.69it/s]
 54%|█████▎    | 227/424 [01:07<00:38,  5.12it/s]
 54%|█████▍    | 229/424 [01:08<00:29,  6.64it/s]
 54%|█████▍    | 231/424 [01:10<01:19,  2.42it/s]
 55%|█████▍    | 233/424 [01:10<01:06,  2.88it/s]
 55%|█████▌    | 234/424 [01:14<03:04,  1.03it/s]
 55%|█████▌    | 235/424 [01:14<02:44,  1.15it/s]
 56%|█████▌    | 236/424 [01:14<02:16,  1.38it/s]
 56%|█████▋    | 239/424 [01:15<01:11,  2.58it/s]
 57%|█████▋    | 240/424 [01:15<01:14,  2.46it/s]
 57%|█████▋    | 241/424 [01:15<01:17,  2.37it/s]
 57%|█████▋    | 243/424 [01:16<00:56,  3.18it/s]
 58%|█████▊    | 244/424 [01:16<00:48,  3.72it/s]
 58%|█████▊    | 246/424 [01:16<00:35,  4.99it/s]
 58%|█████▊    | 247/424 [01:16<00:43,  4.09it/s]
 58%|█████▊    | 248/424 [01:17<00:37,  4.73it/s]
 59%|█████▉    | 250/424 [01:17<00:28,  6.05it/s]
 59%|█████▉    | 252/424 [01:17<00:23,  7.32it/s]
 60%|█████▉    | 254/424 [01:17<00:20,  8.43it/s]
 60%|██████    | 256/424 [01:17<00:17,  9.37it/s]
 61%|██████    | 258/424 [01:17<00:16,  9.96it/s]
 61%|██████▏   | 260/424 [01:18<00:20,  7.85it/s]
 62%|██████▏   | 263/424 [01:19<00:34,  4.64it/s]
 62%|██████▎   | 265/424 [01:19<00:28,  5.60it/s]
 63%|██████▎   | 266/424 [01:19<00:26,  5.85it/s]
 63%|██████▎   | 268/424 [01:19<00:22,  6.95it/s]
 63%|██████▎   | 269/424 [01:20<00:31,  4.84it/s]
 64%|██████▍   | 272/424 [01:20<00:20,  7.34it/s]
 65%|██████▍   | 274/424 [01:20<00:18,  8.03it/s]
 66%|██████▌   | 278/424 [01:20<00:11, 12.49it/s]
 66%|██████▌   | 280/424 [01:21<00:17,  8.37it/s]
 67%|██████▋   | 282/424 [01:21<00:18,  7.51it/s]
 67%|██████▋   | 284/424 [01:23<00:43,  3.25it/s]
 68%|██████▊   | 287/424 [01:23<00:32,  4.16it/s]
 68%|██████▊   | 288/424 [01:23<00:31,  4.37it/s]
 68%|██████▊   | 290/424 [01:23<00:24,  5.49it/s]
 69%|██████▊   | 291/424 [01:23<00:24,  5.54it/s]
 69%|██████▉   | 293/424 [01:25<00:49,  2.62it/s]
 70%|██████▉   | 295/424 [01:25<00:43,  2.99it/s]
 70%|██████▉   | 296/424 [01:26<00:37,  3.42it/s]
 70%|███████   | 297/424 [01:26<00:37,  3.41it/s]
 70%|███████   | 298/424 [01:26<00:33,  3.77it/s]
 71%|███████   | 301/424 [01:26<00:19,  6.18it/s]
 71%|███████   | 302/424 [01:30<01:43,  1.18it/s]
 72%|███████▏  | 304/424 [01:30<01:08,  1.75it/s]
 72%|███████▏  | 305/424 [01:30<00:58,  2.04it/s]
 72%|███████▏  | 306/424 [01:31<00:53,  2.22it/s]
 73%|███████▎  | 308/424 [01:31<00:39,  2.94it/s]
 73%|███████▎  | 309/424 [01:31<00:33,  3.42it/s]
 73%|███████▎  | 310/424 [01:32<00:46,  2.44it/s]
 74%|███████▍  | 313/424 [01:32<00:26,  4.17it/s]
 74%|███████▍  | 314/424 [01:32<00:27,  3.98it/s]
 74%|███████▍  | 315/424 [01:33<00:25,  4.29it/s]
 75%|███████▍  | 317/424 [01:33<00:19,  5.50it/s]
 75%|███████▌  | 318/424 [01:33<00:18,  5.61it/s]
 75%|███████▌  | 319/424 [01:33<00:18,  5.71it/s]
 75%|███████▌  | 320/424 [01:33<00:17,  5.97it/s]
 76%|███████▌  | 322/424 [01:33<00:12,  7.89it/s]
 76%|███████▌  | 323/424 [01:33<00:13,  7.44it/s]
 77%|███████▋  | 326/424 [01:37<01:08,  1.43it/s]
 77%|███████▋  | 327/424 [01:37<00:57,  1.67it/s]
 77%|███████▋  | 328/424 [01:38<00:53,  1.80it/s]
 78%|███████▊  | 329/424 [01:38<00:47,  2.02it/s]
 78%|███████▊  | 330/424 [01:38<00:38,  2.42it/s]
 79%|███████▊  | 333/424 [01:39<00:29,  3.04it/s]
 79%|███████▉  | 334/424 [01:39<00:27,  3.30it/s]
 79%|███████▉  | 336/424 [01:39<00:18,  4.64it/s]
 79%|███████▉  | 337/424 [01:43<01:22,  1.06it/s]
 80%|███████▉  | 338/424 [01:43<01:06,  1.29it/s]
 80%|███████▉  | 339/424 [01:44<00:55,  1.53it/s]
 80%|████████  | 340/424 [01:47<02:02,  1.46s/it]
 80%|████████  | 341/424 [01:48<01:39,  1.20s/it]
 81%|████████  | 342/424 [01:48<01:19,  1.03it/s]
 81%|████████  | 344/424 [01:49<00:48,  1.65it/s]
 82%|████████▏ | 346/424 [01:49<00:33,  2.30it/s]
 82%|████████▏ | 347/424 [01:50<00:37,  2.06it/s]
 83%|████████▎ | 350/424 [01:50<00:28,  2.63it/s]
 83%|████████▎ | 352/424 [01:54<01:01,  1.17it/s]
 83%|████████▎ | 353/424 [01:54<00:53,  1.34it/s]
 83%|████████▎ | 354/424 [01:55<00:52,  1.33it/s]
 84%|████████▍ | 356/424 [01:56<00:39,  1.73it/s]
 84%|████████▍ | 357/424 [01:56<00:34,  1.94it/s]
 84%|████████▍ | 358/424 [01:57<00:37,  1.76it/s]
 85%|████████▍ | 359/424 [01:58<00:39,  1.65it/s]
 85%|████████▍ | 360/424 [01:58<00:30,  2.11it/s]
 85%|████████▌ | 361/424 [01:58<00:24,  2.60it/s]
 85%|████████▌ | 362/424 [01:58<00:22,  2.81it/s]
 86%|████████▌ | 363/424 [02:02<01:19,  1.31s/it]
 86%|████████▌ | 364/424 [02:02<01:01,  1.02s/it]
 86%|████████▌ | 365/424 [02:02<00:45,  1.30it/s]
 87%|████████▋ | 368/424 [02:06<00:58,  1.05s/it]
 87%|████████▋ | 369/424 [02:06<00:48,  1.14it/s]
 88%|████████▊ | 372/424 [02:06<00:25,  2.05it/s]
 88%|████████▊ | 373/424 [02:07<00:21,  2.39it/s]
 88%|████████▊ | 374/424 [02:07<00:18,  2.75it/s]
 89%|████████▊ | 376/424 [02:07<00:15,  3.14it/s]
 89%|████████▉ | 377/424 [02:07<00:13,  3.48it/s]
 89%|████████▉ | 379/424 [02:08<00:11,  4.08it/s]
 90%|████████▉ | 380/424 [02:08<00:13,  3.29it/s]
 90%|█████████ | 382/424 [02:08<00:09,  4.36it/s]
 91%|█████████ | 384/424 [02:09<00:07,  5.61it/s]
 91%|█████████ | 385/424 [02:09<00:06,  5.92it/s]
 92%|█████████▏| 388/424 [02:09<00:05,  6.71it/s]
 92%|█████████▏| 389/424 [02:10<00:06,  5.11it/s]
 92%|█████████▏| 391/424 [02:10<00:04,  6.75it/s]
 93%|█████████▎| 393/424 [02:10<00:04,  6.90it/s]
 93%|█████████▎| 394/424 [02:10<00:05,  5.86it/s]
 93%|█████████▎| 395/424 [02:11<00:06,  4.57it/s]
 93%|█████████▎| 396/424 [02:11<00:10,  2.64it/s]
 94%|█████████▎| 397/424 [02:12<00:11,  2.29it/s]
 94%|█████████▍| 398/424 [02:13<00:12,  2.06it/s]
 95%|█████████▍| 401/424 [02:13<00:06,  3.54it/s]
 95%|█████████▍| 402/424 [02:14<00:11,  1.92it/s]
 95%|█████████▌| 403/424 [02:15<00:09,  2.15it/s]
 95%|█████████▌| 404/424 [02:15<00:07,  2.58it/s]
 96%|█████████▌| 405/424 [02:15<00:06,  3.09it/s]
 96%|█████████▌| 407/424 [02:16<00:05,  2.92it/s]
 96%|█████████▌| 408/424 [02:16<00:04,  3.33it/s]
 96%|█████████▋| 409/424 [02:16<00:04,  3.39it/s]
 97%|█████████▋| 410/424 [02:16<00:03,  3.90it/s]
 97%|█████████▋| 411/424 [02:17<00:03,  3.80it/s]
 97%|█████████▋| 413/424 [02:17<00:02,  3.76it/s]
 98%|█████████▊| 415/424 [02:18<00:02,  3.27it/s]
 98%|█████████▊| 416/424 [02:18<00:02,  2.87it/s]
 99%|█████████▊| 418/424 [02:19<00:01,  3.40it/s]
 99%|█████████▉| 420/424 [02:19<00:01,  3.75it/s]
100%|█████████▉| 422/424 [02:19<00:00,  4.99it/s]
100%|█████████▉| 423/424 [02:20<00:00,  4.20it/s]
100%|██████████| 424/424 [02:20<00:00,  4.52it/s]
100%|██████████| 424/424 [02:20<00:00,  3.02it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-08 17:07:28.892536_sc_processed_test.json', '--output_addr', 'data/out/rag/asym/sc_rag_ae_lp_test_2_output.json', '--temperature', '0.0', '--top_p', '0.95', '--max_tokens', '4096', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/work/pi_hzamani_umass_edu/ozel_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.46 examples/s]
Generating train split: 424 examples [00:00, 1571.93 examples/s]
INFO 07-08 17:10:20 config.py:510] This model supports multiple tasks: {'score', 'generate', 'reward', 'embed', 'classify'}. Defaulting to 'generate'.
INFO 07-08 17:10:20 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/work/pi_hzamani_umass_edu/ozel_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-08 17:10:21 selector.py:120] Using Flash Attention backend.
INFO 07-08 17:10:22 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-08 17:10:24 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.63it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.58it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.56it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.60it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.59it/s]

INFO 07-08 17:10:27 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-08 17:10:29 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-08 17:10:29 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-08 17:10:29 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-08 17:10:29 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-08 17:10:29 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-08 17:10:32 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.81it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:10,  3.18it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.34it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:09,  3.42it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.45it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.47it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:07,  3.51it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.53it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.52it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:07,  3.53it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.53it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.52it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.49it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:06,  3.47it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.50it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.53it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:05,  3.59it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:05<00:04,  3.61it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.63it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:04,  3.66it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.69it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.71it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.71it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.72it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:07<00:02,  3.72it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.74it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.75it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.74it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:08<00:01,  3.77it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.79it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.79it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.74it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:09<00:00,  3.69it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.74it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.78it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.61it/s]
INFO 07-08 17:10:42 model_runner.py:1535] Graph capturing finished in 10 secs, took 0.22 GiB
INFO 07-08 17:10:42 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.63 seconds
RAG ON
EXAMPLE PROMPT
<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Shall I ask my agency to overturn negative client feedback? I work for a writing agency. A few days ago, a client asked us to do some work for his website. The client said it was 'proofreading'. I did the work, the agency approved it. It was sent to the client for final approval.The client wrote back to say that what he actually wanted was his text rewritten so the site sold better. I wrote back to the agency to say this pretty much constituted a new job. The agency agreed so I got on with the work.I resubmitted and the agency approved it - again! It was sent to the client for final approval. I waited a few days and the client rejected it. He wrote back to say that the work was low quality and he could have done a better job himself. My agency were very nice about it, I got paid regardless, but it left a blemish on my stats, it's the first time a client has rejected a piece of my work.I am considering writing to my agency and asking them to overturn the negative feedback because1 - the client was vague about what they wanted - and in the first place, they described what they wanted incorrectly;2 - it was a new client, so we had no previous examples of what the client liked to work from3 - it's clear that the client had something very specific in mind, but they were not able to articulate their needs or show us the kind of thing they had in mind.I kept to the description as much as I could - short, concise, selling the site, a bit humorous. There was nothing I could do save getting inside the client's head. Because of this one negative piece of feedback I am now nearly halfway down my agency's ladder of writers, whereas before I was at the top.Should I write to my agency about this or just swallow it? I could do the latter, but I still feel an injustice is being done somewhere. 

Article I wrote has been published under another name - should I raise this with the publisher? I do part-time copywriting work and over the weekend I wrote a ~1500 word paid article for an online publication. It was a lot of research and toil, I had half a day to do it and I finally submitted the thing at 2am on Sunday. It was a very tricky piece.Now I notice the article has been published, with some minor edits, but under a different name. The client has used one of their own employees as the author. I wasn't aware that I was ghostwriting. Should I raise this with the publisher? Should credit not be given where it is due - or should I remain quiet unless I irritate them? I'm quite new to this but should they not at least have said it would be credited to someone else?
# Current post question:
Bored with PhD - should I tell my supervisor?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Grades vs. projects in job application I am teaching computer science undergraduates, who will most likely go to work in the software industry. They often ask me for career advice and I want to know what advice to give them. Specifically, suppose a student can choose between two elective courses:Course A has a relatively low average grade (60-70/100), but during the homework assignments, the students build an industry-level project.Course B has a relatively high average grade (80-90/100), the homework assignments are simple and not industry-level.On one hand, course A lowers the student's average grade, so there is more chance the student will be filtered out based on a low average, even before the interview.On the other hand, if the student does get to the interview stage, having a strong project to show is a big advantage.I know that each work-place is different, but I would still be happy if there is a general rule-of-thumb to help the student decide: what is more helpful for getting a job in the software industry - a high average grade, or a strong project?

Pandemic - reduced rule-set for beginners I have recently started playing pandemic, and was overwhelmed by the amount of rules.Is there a reduced set of rules, easier to learn and remember but still fun, that can be used by beginners until they get used to the game?EDIT: My goal is not to make the game easier to win - it is to make the game easier to learn how to play. Instead of learning all rules at once, the team can learn the rules one by one. For example, suppose there are 10 rules (just an arbitrary number). Then instead of remembering all these rules at once, we can start with 5 rules, then add a new rule each play, until we remember and play by all rules.
# Current post question:
How can I motivate the teaching assistants to grade more strictly?
<|im_end|>
<|im_start|>assistant

<|im_start|>system
You are a helpful assistant designed to generate personalized responses to user questions. Your task is to answer a user's question from a post in a personalized way by considering this user's past post questions and detailed descriptions of these questions.
# Your input:
    - The user's current question from a post.
    - The user's past post questions and detailed descriptions of these questions.
# Your task: Answer the user's current question in a personalized way by considering this user's past post questions and detailed descriptions of these questions, to learn about the user's preferences.
# Your output: You should generate personalized answer to the user's current question by considering this user's past post questions and detailed descriptions of these questions to learn about user's preferences. Your output should be a valid json object in ```json ``` block that contains the following fields:
    - personalized_answer: contains the personalized answer to the user's current question considering the this user's past post questions and detailed descriptions of these questions to learn about user's preferences.
<|im_end|>
<|im_start|>user

# Past post questions and detailed descriptions of these questions:
Tofu as a growing medium? I just had a strange idea of no actual significance, but I was just staring at a block of tofu and wondered if you could plant things in it. Has anyone tried this? How does/would tofu fair as a growing medium. How would plants grow differently in hard, medium, and soft tofu?

What is the functional role of the subtonic chord? In this chartthe subtonic major chord can come before the mediant and submedian chords. Does this imply that it has a tonic functionality? If so that seems counter-intuitive; it seems to share more in common with the dominant chord than the tonic. On the other hand, if it's a dominant function, why would you have a i-VII-III... progression? Wouldn't it make more sense for the VII to fall later, towards the end of the phrase.(Also I'm assuming that the VII actually refers to the bVII chord, but if I'm wrong please correct me on that)
# Current post question:
How narrow or broad should I look for undergraduate research?
<|im_end|>
<|im_start|>assistant

None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:11<1:22:39, 11.72s/it, est. speed input: 66.70 toks/s, output: 5.97 toks/s]
Processed prompts:   1%|          | 3/424 [00:12<23:56,  3.41s/it, est. speed input: 122.84 toks/s, output: 18.46 toks/s]
Processed prompts:   1%|          | 4/424 [00:12<15:53,  2.27s/it, est. speed input: 153.82 toks/s, output: 25.77 toks/s]
Processed prompts:   1%|▏         | 6/424 [00:13<08:33,  1.23s/it, est. speed input: 231.78 toks/s, output: 40.26 toks/s]
Processed prompts:   3%|▎         | 11/424 [00:13<03:17,  2.09it/s, est. speed input: 434.36 toks/s, output: 78.07 toks/s]
Processed prompts:   3%|▎         | 13/424 [00:13<02:34,  2.67it/s, est. speed input: 588.43 toks/s, output: 92.69 toks/s]
Processed prompts:   4%|▎         | 15/424 [00:14<02:12,  3.09it/s, est. speed input: 622.59 toks/s, output: 106.35 toks/s]
Processed prompts:   4%|▍         | 18/424 [00:14<01:33,  4.35it/s, est. speed input: 692.24 toks/s, output: 129.45 toks/s]
Processed prompts:   5%|▍         | 20/424 [00:14<01:18,  5.15it/s, est. speed input: 757.75 toks/s, output: 144.33 toks/s]
Processed prompts:   5%|▌         | 23/424 [00:14<00:59,  6.75it/s, est. speed input: 858.22 toks/s, output: 167.26 toks/s]
Processed prompts:   6%|▌         | 25/424 [00:14<00:52,  7.59it/s, est. speed input: 925.98 toks/s, output: 182.04 toks/s]
Processed prompts:   7%|▋         | 30/424 [00:15<00:36, 10.66it/s, est. speed input: 1084.33 toks/s, output: 220.37 toks/s]
Processed prompts:   8%|▊         | 34/424 [00:15<00:29, 13.15it/s, est. speed input: 1215.64 toks/s, output: 251.00 toks/s]
Processed prompts:   9%|▉         | 38/424 [00:15<00:27, 14.13it/s, est. speed input: 1367.30 toks/s, output: 279.97 toks/s]
Processed prompts:  10%|▉         | 41/424 [00:15<00:24, 15.57it/s, est. speed input: 1441.04 toks/s, output: 302.15 toks/s]
Processed prompts:  10%|█         | 43/424 [00:15<00:25, 15.05it/s, est. speed input: 1491.94 toks/s, output: 315.69 toks/s]
Processed prompts:  12%|█▏        | 49/424 [00:16<00:21, 17.06it/s, est. speed input: 1689.63 toks/s, output: 358.78 toks/s]
Processed prompts:  12%|█▎        | 53/424 [00:16<00:19, 19.12it/s, est. speed input: 1825.10 toks/s, output: 388.03 toks/s]
Processed prompts:  13%|█▎        | 56/424 [00:16<00:20, 18.35it/s, est. speed input: 1904.74 toks/s, output: 408.08 toks/s]
Processed prompts:  14%|█▍        | 60/424 [00:16<00:17, 20.79it/s, est. speed input: 1986.38 toks/s, output: 437.14 toks/s]
Processed prompts:  15%|█▌        | 65/424 [00:16<00:18, 19.57it/s, est. speed input: 2100.06 toks/s, output: 470.01 toks/s]
Processed prompts:  16%|█▌        | 68/424 [00:17<00:21, 16.53it/s, est. speed input: 2138.66 toks/s, output: 486.63 toks/s]
Processed prompts:  17%|█▋        | 72/424 [00:17<00:18, 19.49it/s, est. speed input: 2297.91 toks/s, output: 515.25 toks/s]
Processed prompts:  18%|█▊        | 75/424 [00:17<00:18, 18.39it/s, est. speed input: 2388.76 toks/s, output: 533.78 toks/s]
Processed prompts:  18%|█▊        | 78/424 [00:17<00:17, 19.52it/s, est. speed input: 2508.57 toks/s, output: 554.09 toks/s]
Processed prompts:  19%|█▉        | 81/424 [00:17<00:18, 18.51it/s, est. speed input: 2611.20 toks/s, output: 572.42 toks/s]
Processed prompts:  21%|██        | 87/424 [00:18<00:18, 17.81it/s, est. speed input: 2763.46 toks/s, output: 609.04 toks/s]
Processed prompts:  22%|██▏       | 92/424 [00:18<00:18, 17.53it/s, est. speed input: 2863.25 toks/s, output: 639.04 toks/s]
Processed prompts:  22%|██▏       | 95/424 [00:18<00:17, 19.15it/s, est. speed input: 2915.72 toks/s, output: 659.41 toks/s]
Processed prompts:  23%|██▎       | 98/424 [00:18<00:17, 18.51it/s, est. speed input: 2971.25 toks/s, output: 677.11 toks/s]
Processed prompts:  25%|██▍       | 104/424 [00:18<00:17, 18.78it/s, est. speed input: 3073.65 toks/s, output: 713.51 toks/s]
Processed prompts:  25%|██▌       | 108/424 [00:19<00:15, 20.16it/s, est. speed input: 3161.61 toks/s, output: 739.33 toks/s]
Processed prompts:  26%|██▌       | 111/424 [00:19<00:16, 19.56it/s, est. speed input: 3300.69 toks/s, output: 756.71 toks/s]
Processed prompts:  27%|██▋       | 114/424 [00:19<00:16, 18.83it/s, est. speed input: 3365.97 toks/s, output: 773.76 toks/s]
Processed prompts:  28%|██▊       | 117/424 [00:19<00:16, 18.27it/s, est. speed input: 3420.08 toks/s, output: 790.77 toks/s]
Processed prompts:  29%|██▉       | 122/424 [00:19<00:15, 19.18it/s, est. speed input: 3512.85 toks/s, output: 821.25 toks/s]
Processed prompts:  30%|██▉       | 126/424 [00:20<00:16, 18.06it/s, est. speed input: 3593.65 toks/s, output: 842.99 toks/s]
Processed prompts:  31%|███       | 131/424 [00:20<00:15, 19.32it/s, est. speed input: 3707.09 toks/s, output: 873.67 toks/s]
Processed prompts:  32%|███▏      | 135/424 [00:20<00:13, 20.91it/s, est. speed input: 3791.71 toks/s, output: 899.20 toks/s]
Processed prompts:  33%|███▎      | 141/424 [00:20<00:16, 17.69it/s, est. speed input: 3954.81 toks/s, output: 928.31 toks/s]
Processed prompts:  35%|███▌      | 149/424 [00:21<00:14, 18.79it/s, est. speed input: 4130.77 toks/s, output: 974.00 toks/s]
Processed prompts:  36%|███▌      | 153/424 [00:21<00:13, 20.70it/s, est. speed input: 4218.95 toks/s, output: 999.56 toks/s]
Processed prompts:  37%|███▋      | 156/424 [00:21<00:14, 18.77it/s, est. speed input: 4260.15 toks/s, output: 1012.89 toks/s]
Processed prompts:  38%|███▊      | 159/424 [00:21<00:13, 19.64it/s, est. speed input: 4356.42 toks/s, output: 1030.39 toks/s]
Processed prompts:  38%|███▊      | 162/424 [00:22<00:14, 17.55it/s, est. speed input: 4417.63 toks/s, output: 1043.03 toks/s]
Processed prompts:  39%|███▉      | 165/424 [00:22<00:16, 15.40it/s, est. speed input: 4441.83 toks/s, output: 1053.94 toks/s]
Processed prompts:  40%|███▉      | 168/424 [00:22<00:15, 16.10it/s, est. speed input: 4491.72 toks/s, output: 1069.56 toks/s]
Processed prompts:  40%|████      | 170/424 [00:22<00:15, 16.50it/s, est. speed input: 4512.61 toks/s, output: 1079.92 toks/s]
Processed prompts:  42%|████▏     | 179/424 [00:22<00:08, 29.62it/s, est. speed input: 4699.21 toks/s, output: 1144.75 toks/s]
Processed prompts:  44%|████▍     | 186/424 [00:22<00:06, 36.81it/s, est. speed input: 4860.44 toks/s, output: 1194.39 toks/s]
Processed prompts:  46%|████▌     | 193/424 [00:22<00:05, 42.91it/s, est. speed input: 5022.83 toks/s, output: 1244.33 toks/s]
Processed prompts:  47%|████▋     | 199/424 [00:23<00:04, 45.59it/s, est. speed input: 5197.32 toks/s, output: 1286.69 toks/s]
Processed prompts:  48%|████▊     | 204/424 [00:23<00:04, 45.34it/s, est. speed input: 5333.41 toks/s, output: 1321.50 toks/s]
Processed prompts:  50%|█████     | 214/424 [00:23<00:03, 58.11it/s, est. speed input: 5595.50 toks/s, output: 1397.92 toks/s]
Processed prompts:  52%|█████▏    | 221/424 [00:23<00:03, 55.24it/s, est. speed input: 5771.32 toks/s, output: 1448.08 toks/s]
Processed prompts:  54%|█████▎    | 227/424 [00:23<00:04, 41.29it/s, est. speed input: 5848.82 toks/s, output: 1484.81 toks/s]
Processed prompts:  55%|█████▍    | 232/424 [00:23<00:04, 39.96it/s, est. speed input: 5973.19 toks/s, output: 1519.74 toks/s]
Processed prompts:  56%|█████▌    | 237/424 [00:23<00:04, 39.23it/s, est. speed input: 6068.87 toks/s, output: 1552.57 toks/s]
Processed prompts:  57%|█████▋    | 242/424 [00:24<00:05, 32.21it/s, est. speed input: 6225.02 toks/s, output: 1582.75 toks/s]
Processed prompts:  58%|█████▊    | 246/424 [00:24<00:06, 28.40it/s, est. speed input: 6285.08 toks/s, output: 1604.09 toks/s]
Processed prompts:  59%|█████▉    | 250/424 [00:24<00:07, 24.68it/s, est. speed input: 6310.94 toks/s, output: 1617.56 toks/s]
Processed prompts:  60%|█████▉    | 253/424 [00:24<00:07, 23.22it/s, est. speed input: 6324.96 toks/s, output: 1627.11 toks/s]
Processed prompts:  60%|██████    | 256/424 [00:24<00:07, 23.38it/s, est. speed input: 6372.79 toks/s, output: 1637.08 toks/s]
Processed prompts:  61%|██████    | 259/424 [00:25<00:07, 20.98it/s, est. speed input: 6398.54 toks/s, output: 1645.33 toks/s]
Processed prompts:  62%|██████▏   | 262/424 [00:25<00:07, 21.74it/s, est. speed input: 6434.78 toks/s, output: 1652.34 toks/s]
Processed prompts:  63%|██████▎   | 266/424 [00:25<00:06, 24.43it/s, est. speed input: 6533.57 toks/s, output: 1663.74 toks/s]
Processed prompts:  64%|██████▍   | 272/424 [00:25<00:04, 30.94it/s, est. speed input: 6632.27 toks/s, output: 1685.37 toks/s]
Processed prompts:  66%|██████▌   | 279/424 [00:25<00:03, 38.32it/s, est. speed input: 6768.61 toks/s, output: 1716.12 toks/s]
Processed prompts:  67%|██████▋   | 284/424 [00:25<00:03, 36.90it/s, est. speed input: 6836.33 toks/s, output: 1734.23 toks/s]
Processed prompts:  68%|██████▊   | 288/424 [00:25<00:04, 33.96it/s, est. speed input: 6881.21 toks/s, output: 1745.90 toks/s]
Processed prompts:  69%|██████▉   | 292/424 [00:25<00:03, 34.15it/s, est. speed input: 6942.73 toks/s, output: 1760.16 toks/s]
Processed prompts:  70%|███████   | 298/424 [00:26<00:03, 35.75it/s, est. speed input: 7048.84 toks/s, output: 1782.89 toks/s]
Processed prompts:  72%|███████▏  | 306/424 [00:26<00:02, 43.70it/s, est. speed input: 7211.59 toks/s, output: 1821.04 toks/s]
Processed prompts:  75%|███████▍  | 316/424 [00:26<00:01, 54.51it/s, est. speed input: 7406.11 toks/s, output: 1869.51 toks/s]
Processed prompts:  77%|███████▋  | 325/424 [00:26<00:01, 60.75it/s, est. speed input: 7568.79 toks/s, output: 1913.73 toks/s]
Processed prompts:  79%|███████▉  | 336/424 [00:26<00:01, 71.07it/s, est. speed input: 7784.11 toks/s, output: 1975.51 toks/s]
Processed prompts:  82%|████████▏ | 348/424 [00:26<00:00, 82.30it/s, est. speed input: 8023.56 toks/s, output: 2043.26 toks/s]
Processed prompts:  84%|████████▍ | 358/424 [00:26<00:00, 86.37it/s, est. speed input: 8172.90 toks/s, output: 2094.43 toks/s]
Processed prompts:  87%|████████▋ | 367/424 [00:26<00:00, 83.54it/s, est. speed input: 8310.22 toks/s, output: 2140.57 toks/s]
Processed prompts:  89%|████████▉ | 379/424 [00:26<00:00, 91.20it/s, est. speed input: 8594.81 toks/s, output: 2205.74 toks/s]
Processed prompts:  92%|█████████▏| 389/424 [00:27<00:00, 75.52it/s, est. speed input: 8841.50 toks/s, output: 2255.97 toks/s]
Processed prompts:  94%|█████████▍| 399/424 [00:27<00:00, 80.12it/s, est. speed input: 9111.58 toks/s, output: 2321.35 toks/s]
Processed prompts:  96%|█████████▌| 408/424 [00:27<00:00, 70.01it/s, est. speed input: 9267.58 toks/s, output: 2378.62 toks/s]
Processed prompts:  98%|█████████▊| 416/424 [00:27<00:00, 46.06it/s, est. speed input: 9443.21 toks/s, output: 2419.98 toks/s]
Processed prompts: 100%|█████████▉| 422/424 [00:28<00:00, 21.60it/s, est. speed input: 9380.87 toks/s, output: 2412.34 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:29<00:00, 14.54it/s, est. speed input: 9274.82 toks/s, output: 2390.26 toks/s]
[rank0]:[W708 17:11:13.655080557 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/sc_rag_ae_lp_test_2_output.json
Cleaned temporary files.
