Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:31:49.115344_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:31:49.115344_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:31:49.115344_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<02:10,  3.06it/s]
  0%|          | 2/401 [00:00<01:51,  3.57it/s]
  1%|          | 3/401 [00:03<08:29,  1.28s/it]
  1%|          | 4/401 [00:04<09:01,  1.36s/it]
  1%|          | 5/401 [00:06<09:16,  1.41s/it]
  1%|▏         | 6/401 [00:07<09:31,  1.45s/it]
  2%|▏         | 7/401 [00:09<09:44,  1.48s/it]
  2%|▏         | 8/401 [00:10<09:41,  1.48s/it]
  2%|▏         | 9/401 [00:12<09:41,  1.48s/it]
  2%|▏         | 10/401 [00:12<07:41,  1.18s/it]
  3%|▎         | 11/401 [00:14<08:45,  1.35s/it]
  3%|▎         | 13/401 [00:16<07:16,  1.12s/it]
  3%|▎         | 14/401 [00:19<11:03,  1.72s/it]
  4%|▎         | 15/401 [00:19<08:21,  1.30s/it]
  4%|▍         | 17/401 [00:19<05:08,  1.25it/s]
  4%|▍         | 18/401 [00:21<06:31,  1.02s/it]
  5%|▍         | 19/401 [00:23<07:37,  1.20s/it]
  5%|▍         | 20/401 [00:27<12:43,  2.00s/it]
  5%|▌         | 21/401 [00:27<09:38,  1.52s/it]
  5%|▌         | 22/401 [00:32<14:20,  2.27s/it]
  6%|▌         | 23/401 [00:33<13:17,  2.11s/it]
  6%|▌         | 24/401 [00:38<17:13,  2.74s/it]
  6%|▌         | 25/401 [00:38<12:21,  1.97s/it]
  6%|▋         | 26/401 [00:38<09:05,  1.46s/it]
  7%|▋         | 27/401 [00:42<14:14,  2.29s/it]
  7%|▋         | 28/401 [00:42<10:30,  1.69s/it]
  7%|▋         | 29/401 [00:43<07:33,  1.22s/it]
  7%|▋         | 30/401 [00:44<07:50,  1.27s/it]
  8%|▊         | 31/401 [00:45<07:37,  1.24s/it]
  8%|▊         | 32/401 [00:45<05:42,  1.08it/s]
  8%|▊         | 33/401 [00:46<06:08,  1.00s/it]
  8%|▊         | 34/401 [00:49<08:03,  1.32s/it]
  9%|▊         | 35/401 [00:49<05:49,  1.05it/s]
  9%|▉         | 37/401 [00:49<03:44,  1.62it/s]
 10%|▉         | 39/401 [00:50<03:45,  1.60it/s]
 10%|▉         | 40/401 [00:50<03:03,  1.97it/s]
 10%|█         | 41/401 [00:52<04:18,  1.39it/s]
 10%|█         | 42/401 [00:52<03:37,  1.65it/s]
 11%|█         | 43/401 [00:52<03:08,  1.90it/s]
 11%|█         | 44/401 [00:53<03:57,  1.50it/s]
 11%|█▏        | 46/401 [00:54<02:52,  2.06it/s]
 12%|█▏        | 47/401 [00:56<05:05,  1.16it/s]
 12%|█▏        | 48/401 [00:56<04:26,  1.32it/s]
 12%|█▏        | 49/401 [00:57<03:51,  1.52it/s]
 12%|█▏        | 50/401 [00:58<04:05,  1.43it/s]
 13%|█▎        | 51/401 [00:58<03:37,  1.61it/s]
 13%|█▎        | 53/401 [00:59<02:42,  2.14it/s]
 13%|█▎        | 54/401 [00:59<02:19,  2.49it/s]
 14%|█▎        | 55/401 [01:02<05:54,  1.02s/it]
 14%|█▍        | 56/401 [01:03<06:25,  1.12s/it]
 14%|█▍        | 57/401 [01:04<06:13,  1.09s/it]
 14%|█▍        | 58/401 [01:04<04:39,  1.23it/s]
 15%|█▍        | 59/401 [01:07<07:55,  1.39s/it]
 15%|█▍        | 60/401 [01:08<06:43,  1.18s/it]
 15%|█▌        | 61/401 [01:08<05:29,  1.03it/s]
 15%|█▌        | 62/401 [01:08<04:23,  1.29it/s]
 16%|█▌        | 63/401 [01:09<03:54,  1.44it/s]
 16%|█▌        | 64/401 [01:09<03:33,  1.58it/s]
 16%|█▌        | 65/401 [01:10<03:21,  1.67it/s]
 16%|█▋        | 66/401 [01:11<04:36,  1.21it/s]
 17%|█▋        | 67/401 [01:12<03:40,  1.51it/s]
 17%|█▋        | 68/401 [01:12<02:57,  1.88it/s]
 17%|█▋        | 69/401 [01:12<02:15,  2.45it/s]
 17%|█▋        | 70/401 [01:13<03:27,  1.59it/s]
 18%|█▊        | 71/401 [01:13<03:00,  1.83it/s]
 18%|█▊        | 72/401 [01:14<03:46,  1.45it/s]
 18%|█▊        | 73/401 [01:15<03:12,  1.71it/s]
 18%|█▊        | 74/401 [01:16<03:53,  1.40it/s]
 19%|█▊        | 75/401 [01:17<04:22,  1.24it/s]
 19%|█▉        | 76/401 [01:18<04:41,  1.16it/s]
 19%|█▉        | 77/401 [01:19<04:55,  1.10it/s]
 19%|█▉        | 78/401 [01:19<03:41,  1.46it/s]
 20%|█▉        | 79/401 [01:20<04:12,  1.28it/s]
 20%|█▉        | 80/401 [01:21<04:32,  1.18it/s]
 20%|██        | 81/401 [01:22<04:25,  1.21it/s]
 20%|██        | 82/401 [01:23<04:42,  1.13it/s]
 21%|██        | 83/401 [01:24<04:55,  1.08it/s]
 21%|██        | 84/401 [01:25<05:02,  1.05it/s]
 21%|██        | 85/401 [01:25<04:07,  1.28it/s]
 21%|██▏       | 86/401 [01:26<04:30,  1.16it/s]
 22%|██▏       | 87/401 [01:29<07:37,  1.46s/it]
 22%|██▏       | 88/401 [01:30<06:54,  1.33s/it]
 22%|██▏       | 89/401 [01:32<06:58,  1.34s/it]
 22%|██▏       | 90/401 [01:32<05:12,  1.00s/it]
 23%|██▎       | 91/401 [01:32<03:52,  1.33it/s]
 23%|██▎       | 92/401 [01:33<04:16,  1.21it/s]
 23%|██▎       | 93/401 [01:33<03:18,  1.55it/s]
 23%|██▎       | 94/401 [01:35<05:27,  1.07s/it]
 24%|██▎       | 95/401 [01:37<05:54,  1.16s/it]
 24%|██▍       | 96/401 [01:38<05:40,  1.12s/it]
 24%|██▍       | 97/401 [01:39<05:31,  1.09s/it]
 24%|██▍       | 98/401 [01:39<04:28,  1.13it/s]
 25%|██▍       | 99/401 [01:39<03:24,  1.48it/s]
 25%|██▍       | 100/401 [01:40<02:49,  1.77it/s]
 25%|██▌       | 101/401 [01:40<03:11,  1.57it/s]
 25%|██▌       | 102/401 [01:40<02:25,  2.05it/s]
 26%|██▌       | 103/401 [01:41<02:20,  2.12it/s]
 26%|██▌       | 104/401 [01:42<03:07,  1.58it/s]
 26%|██▌       | 105/401 [01:43<03:39,  1.35it/s]
 27%|██▋       | 107/401 [01:43<02:35,  1.88it/s]
 27%|██▋       | 108/401 [01:44<02:08,  2.28it/s]
 27%|██▋       | 109/401 [01:45<02:52,  1.70it/s]
 27%|██▋       | 110/401 [01:45<02:14,  2.17it/s]
 28%|██▊       | 111/401 [01:46<02:57,  1.64it/s]
 28%|██▊       | 112/401 [01:47<03:28,  1.38it/s]
 28%|██▊       | 113/401 [01:47<03:24,  1.41it/s]
 28%|██▊       | 114/401 [01:48<03:16,  1.46it/s]
 29%|██▊       | 115/401 [01:48<02:39,  1.80it/s]
 29%|██▉       | 116/401 [01:49<03:15,  1.45it/s]
 29%|██▉       | 117/401 [01:50<02:59,  1.58it/s]
 29%|██▉       | 118/401 [01:50<02:22,  1.99it/s]
 30%|██▉       | 119/401 [01:51<03:21,  1.40it/s]
 30%|██▉       | 120/401 [01:51<02:38,  1.78it/s]
 30%|███       | 121/401 [01:52<02:08,  2.18it/s]
 30%|███       | 122/401 [01:52<02:22,  1.96it/s]
 31%|███       | 123/401 [01:54<03:33,  1.30it/s]
 31%|███       | 124/401 [01:55<04:22,  1.05it/s]
 31%|███       | 125/401 [01:56<04:56,  1.08s/it]
 31%|███▏      | 126/401 [01:57<03:46,  1.21it/s]
 32%|███▏      | 127/401 [01:58<04:30,  1.01it/s]
 32%|███▏      | 128/401 [01:59<05:01,  1.10s/it]
 32%|███▏      | 129/401 [02:00<04:51,  1.07s/it]
 32%|███▏      | 130/401 [02:02<05:14,  1.16s/it]
 33%|███▎      | 131/401 [02:03<04:44,  1.05s/it]
 33%|███▎      | 132/401 [02:03<03:40,  1.22it/s]
 33%|███▎      | 133/401 [02:06<06:22,  1.43s/it]
 33%|███▎      | 134/401 [02:07<05:48,  1.30s/it]
 34%|███▎      | 135/401 [02:08<05:27,  1.23s/it]
 34%|███▍      | 136/401 [02:09<05:08,  1.16s/it]
 34%|███▍      | 137/401 [02:09<03:47,  1.16it/s]
 34%|███▍      | 138/401 [02:10<03:57,  1.11it/s]
 35%|███▍      | 139/401 [02:11<03:48,  1.15it/s]
 35%|███▍      | 140/401 [02:11<02:57,  1.47it/s]
 35%|███▌      | 141/401 [02:13<04:24,  1.02s/it]
 35%|███▌      | 142/401 [02:14<04:52,  1.13s/it]
 36%|███▌      | 143/401 [02:15<03:58,  1.08it/s]
 36%|███▌      | 144/401 [02:16<04:03,  1.06it/s]
 36%|███▌      | 145/401 [02:16<03:11,  1.34it/s]
 36%|███▋      | 146/401 [02:17<03:34,  1.19it/s]
 37%|███▋      | 147/401 [02:18<03:45,  1.13it/s]
 37%|███▋      | 148/401 [02:18<03:09,  1.34it/s]
 37%|███▋      | 149/401 [02:19<03:26,  1.22it/s]
 37%|███▋      | 150/401 [02:20<03:40,  1.14it/s]
 38%|███▊      | 151/401 [02:22<04:16,  1.03s/it]
 38%|███▊      | 152/401 [02:23<04:15,  1.02s/it]
 38%|███▊      | 153/401 [02:23<03:31,  1.17it/s]
 38%|███▊      | 154/401 [02:24<03:03,  1.34it/s]
 39%|███▊      | 155/401 [02:25<03:49,  1.07it/s]
 39%|███▉      | 156/401 [02:26<04:20,  1.06s/it]
 39%|███▉      | 157/401 [02:28<04:41,  1.15s/it]
 40%|███▉      | 159/401 [02:29<03:28,  1.16it/s]
 40%|███▉      | 160/401 [02:29<03:01,  1.33it/s]
 40%|████      | 162/401 [02:30<02:48,  1.42it/s]
 41%|████      | 163/401 [02:31<02:55,  1.36it/s]
 41%|████      | 164/401 [02:32<02:58,  1.33it/s]
 41%|████      | 165/401 [02:33<03:13,  1.22it/s]
 41%|████▏     | 166/401 [02:34<03:25,  1.14it/s]
 42%|████▏     | 167/401 [02:34<02:37,  1.48it/s]
 42%|████▏     | 168/401 [02:35<02:59,  1.30it/s]
 42%|████▏     | 169/401 [02:36<03:14,  1.19it/s]
 42%|████▏     | 170/401 [02:37<03:24,  1.13it/s]
 43%|████▎     | 171/401 [02:38<03:32,  1.08it/s]
 43%|████▎     | 172/401 [02:39<02:59,  1.28it/s]
 43%|████▎     | 173/401 [02:40<03:14,  1.17it/s]
 43%|████▎     | 174/401 [02:41<03:27,  1.09it/s]
 44%|████▎     | 175/401 [02:42<03:32,  1.06it/s]
 44%|████▍     | 176/401 [02:43<03:36,  1.04it/s]
 44%|████▍     | 177/401 [02:44<04:03,  1.09s/it]
 44%|████▍     | 178/401 [02:45<03:57,  1.06s/it]
 45%|████▍     | 179/401 [02:46<03:52,  1.05s/it]
 45%|████▍     | 180/401 [02:47<03:50,  1.04s/it]
 45%|████▌     | 181/401 [02:48<03:47,  1.03s/it]
 45%|████▌     | 182/401 [02:49<03:46,  1.03s/it]
 46%|████▌     | 183/401 [02:53<06:42,  1.85s/it]
 46%|████▌     | 184/401 [02:57<08:38,  2.39s/it]
 46%|████▌     | 185/401 [03:01<10:03,  2.79s/it]
 46%|████▋     | 186/401 [03:04<10:58,  3.06s/it]
 47%|████▋     | 187/401 [03:08<11:37,  3.26s/it]
 47%|████▋     | 188/401 [03:08<08:20,  2.35s/it]
 47%|████▋     | 189/401 [03:12<09:46,  2.77s/it]
 47%|████▋     | 190/401 [03:16<10:41,  3.04s/it]
 48%|████▊     | 191/401 [03:17<09:23,  2.68s/it]
 48%|████▊     | 192/401 [03:19<08:27,  2.43s/it]
 48%|████▊     | 193/401 [03:19<06:05,  1.76s/it]
 48%|████▊     | 194/401 [03:20<04:32,  1.32s/it]
 49%|████▊     | 195/401 [03:23<06:59,  2.03s/it]
 49%|████▉     | 196/401 [03:25<06:44,  1.97s/it]
 49%|████▉     | 197/401 [03:27<06:49,  2.01s/it]
 49%|████▉     | 198/401 [03:31<08:28,  2.51s/it]
 50%|████▉     | 199/401 [03:33<07:47,  2.31s/it]
 50%|████▉     | 200/401 [03:35<07:17,  2.18s/it]
 50%|█████     | 201/401 [03:37<06:57,  2.09s/it]
 50%|█████     | 202/401 [03:39<06:41,  2.02s/it]
 51%|█████     | 203/401 [03:40<06:30,  1.97s/it]
 51%|█████     | 204/401 [03:42<06:23,  1.95s/it]
 51%|█████     | 205/401 [03:42<04:35,  1.41s/it]
 51%|█████▏    | 206/401 [03:44<05:02,  1.55s/it]
 52%|█████▏    | 207/401 [03:46<05:20,  1.65s/it]
 52%|█████▏    | 208/401 [03:48<05:29,  1.71s/it]
 52%|█████▏    | 209/401 [03:48<04:13,  1.32s/it]
 52%|█████▏    | 210/401 [03:50<04:45,  1.49s/it]
 53%|█████▎    | 211/401 [03:51<04:04,  1.28s/it]
 53%|█████▎    | 212/401 [03:52<03:24,  1.08s/it]
 53%|█████▎    | 213/401 [03:53<03:08,  1.00s/it]
 53%|█████▎    | 214/401 [03:54<03:55,  1.26s/it]
 54%|█████▎    | 215/401 [03:55<03:21,  1.08s/it]
 54%|█████▍    | 216/401 [03:56<03:38,  1.18s/it]
 54%|█████▍    | 218/401 [03:57<02:27,  1.24it/s]
 55%|█████▍    | 219/401 [03:58<02:20,  1.30it/s]
 55%|█████▍    | 220/401 [03:59<02:14,  1.34it/s]
 55%|█████▌    | 221/401 [04:01<03:59,  1.33s/it]
 55%|█████▌    | 222/401 [04:02<03:24,  1.14s/it]
 56%|█████▌    | 223/401 [04:02<02:31,  1.17it/s]
 56%|█████▌    | 224/401 [04:03<02:05,  1.41it/s]
 56%|█████▌    | 225/401 [04:03<01:36,  1.82it/s]
 56%|█████▋    | 226/401 [04:03<01:14,  2.35it/s]
 57%|█████▋    | 227/401 [04:03<01:03,  2.73it/s]
 57%|█████▋    | 228/401 [04:04<01:19,  2.18it/s]
 57%|█████▋    | 229/401 [04:04<01:05,  2.63it/s]
 57%|█████▋    | 230/401 [04:06<02:10,  1.31it/s]
 58%|█████▊    | 231/401 [04:06<01:40,  1.69it/s]
 58%|█████▊    | 232/401 [04:06<01:39,  1.70it/s]
 58%|█████▊    | 234/401 [04:10<03:22,  1.21s/it]
 59%|█████▊    | 235/401 [04:11<02:46,  1.00s/it]
 59%|█████▉    | 236/401 [04:11<02:08,  1.29it/s]
 59%|█████▉    | 237/401 [04:11<01:59,  1.38it/s]
 59%|█████▉    | 238/401 [04:12<01:48,  1.51it/s]
 60%|█████▉    | 239/401 [04:13<01:46,  1.52it/s]
 60%|█████▉    | 240/401 [04:13<01:25,  1.89it/s]
 60%|██████    | 242/401 [04:13<00:55,  2.88it/s]
 61%|██████    | 243/401 [04:14<01:11,  2.20it/s]
 61%|██████    | 244/401 [04:14<01:08,  2.29it/s]
 61%|██████    | 245/401 [04:14<00:55,  2.80it/s]
 61%|██████▏   | 246/401 [04:15<01:07,  2.29it/s]
 62%|██████▏   | 247/401 [04:16<01:16,  2.01it/s]
 62%|██████▏   | 248/401 [04:16<00:59,  2.58it/s]
 62%|██████▏   | 249/401 [04:17<01:47,  1.41it/s]
 63%|██████▎   | 251/401 [04:18<01:10,  2.13it/s]
 63%|██████▎   | 252/401 [04:18<00:57,  2.59it/s]
 63%|██████▎   | 254/401 [04:18<00:45,  3.26it/s]
 64%|██████▎   | 255/401 [04:20<01:31,  1.60it/s]
 64%|██████▍   | 256/401 [04:20<01:19,  1.81it/s]
 64%|██████▍   | 257/401 [04:21<01:11,  2.00it/s]
 64%|██████▍   | 258/401 [04:21<01:06,  2.17it/s]
 65%|██████▍   | 259/401 [04:21<01:00,  2.36it/s]
 65%|██████▌   | 261/401 [04:22<00:55,  2.53it/s]
 65%|██████▌   | 262/401 [04:22<00:52,  2.63it/s]
 66%|██████▌   | 263/401 [04:23<00:51,  2.70it/s]
 66%|██████▌   | 264/401 [04:23<00:44,  3.06it/s]
 66%|██████▌   | 265/401 [04:23<00:45,  2.98it/s]
 66%|██████▋   | 266/401 [04:23<00:45,  2.96it/s]
 67%|██████▋   | 267/401 [04:24<00:38,  3.46it/s]
 67%|██████▋   | 268/401 [04:24<00:34,  3.81it/s]
 67%|██████▋   | 269/401 [04:24<00:47,  2.75it/s]
 67%|██████▋   | 270/401 [04:25<00:57,  2.27it/s]
 68%|██████▊   | 272/401 [04:25<00:36,  3.50it/s]
 68%|██████▊   | 273/401 [04:25<00:32,  3.94it/s]
 68%|██████▊   | 274/401 [04:26<00:28,  4.51it/s]
 69%|██████▊   | 275/401 [04:26<00:24,  5.04it/s]
 69%|██████▉   | 276/401 [04:26<00:23,  5.27it/s]
 69%|██████▉   | 277/401 [04:26<00:35,  3.48it/s]
 69%|██████▉   | 278/401 [04:27<00:30,  4.02it/s]
 70%|██████▉   | 279/401 [04:27<00:26,  4.67it/s]
 70%|██████▉   | 280/401 [04:27<00:33,  3.64it/s]
 70%|███████   | 281/401 [04:27<00:28,  4.26it/s]
 70%|███████   | 282/401 [04:27<00:23,  5.02it/s]
 71%|███████   | 283/401 [04:28<00:36,  3.21it/s]
 71%|███████   | 284/401 [04:28<00:37,  3.16it/s]
 71%|███████   | 285/401 [04:28<00:33,  3.50it/s]
 71%|███████▏  | 286/401 [04:29<00:34,  3.34it/s]
 72%|███████▏  | 287/401 [04:29<00:34,  3.28it/s]
 72%|███████▏  | 288/401 [04:29<00:29,  3.86it/s]
 72%|███████▏  | 289/401 [04:30<00:27,  4.06it/s]
 73%|███████▎  | 291/401 [04:30<00:26,  4.10it/s]
 73%|███████▎  | 292/401 [04:31<00:59,  1.82it/s]
 73%|███████▎  | 293/401 [04:32<01:11,  1.50it/s]
 73%|███████▎  | 294/401 [04:36<02:22,  1.33s/it]
 74%|███████▎  | 295/401 [04:36<01:45,  1.01it/s]
 74%|███████▍  | 296/401 [04:37<01:43,  1.01it/s]
 74%|███████▍  | 297/401 [04:37<01:18,  1.33it/s]
 74%|███████▍  | 298/401 [04:37<01:06,  1.56it/s]
 75%|███████▍  | 299/401 [04:39<01:31,  1.12it/s]
 75%|███████▍  | 300/401 [04:40<01:29,  1.13it/s]
 75%|███████▌  | 301/401 [04:40<01:06,  1.50it/s]
 75%|███████▌  | 302/401 [04:40<00:49,  1.98it/s]
 76%|███████▌  | 303/401 [04:41<01:00,  1.63it/s]
 76%|███████▌  | 304/401 [04:41<01:01,  1.57it/s]
 76%|███████▌  | 305/401 [04:43<01:16,  1.25it/s]
 76%|███████▋  | 306/401 [04:43<01:17,  1.23it/s]
 77%|███████▋  | 307/401 [04:44<01:21,  1.15it/s]
 77%|███████▋  | 308/401 [04:45<01:09,  1.35it/s]
 77%|███████▋  | 309/401 [04:46<01:05,  1.41it/s]
 77%|███████▋  | 310/401 [04:46<00:56,  1.61it/s]
 78%|███████▊  | 311/401 [04:47<01:02,  1.45it/s]
 78%|███████▊  | 312/401 [04:47<00:53,  1.65it/s]
 78%|███████▊  | 313/401 [04:47<00:42,  2.07it/s]
 78%|███████▊  | 314/401 [04:48<00:40,  2.16it/s]
 79%|███████▊  | 315/401 [04:48<00:34,  2.51it/s]
 79%|███████▉  | 316/401 [04:48<00:28,  3.03it/s]
 79%|███████▉  | 317/401 [04:50<00:56,  1.49it/s]
 79%|███████▉  | 318/401 [04:50<00:52,  1.59it/s]
 80%|███████▉  | 319/401 [04:51<00:42,  1.91it/s]
 80%|███████▉  | 320/401 [04:51<00:41,  1.94it/s]
 80%|████████  | 321/401 [04:51<00:40,  1.97it/s]
 80%|████████  | 322/401 [04:52<00:40,  1.97it/s]
 81%|████████  | 323/401 [04:56<01:50,  1.41s/it]
 81%|████████  | 324/401 [04:59<02:35,  2.02s/it]
 81%|████████  | 325/401 [05:02<03:06,  2.46s/it]
 81%|████████▏ | 326/401 [05:03<02:31,  2.01s/it]
 82%|████████▏ | 327/401 [05:04<02:03,  1.67s/it]
 82%|████████▏ | 328/401 [05:05<01:36,  1.33s/it]
 82%|████████▏ | 329/401 [05:07<01:43,  1.44s/it]
 82%|████████▏ | 330/401 [05:10<02:26,  2.07s/it]
 83%|████████▎ | 331/401 [05:11<02:01,  1.74s/it]
 83%|████████▎ | 332/401 [05:15<02:37,  2.28s/it]
 83%|████████▎ | 333/401 [05:18<02:59,  2.64s/it]
 83%|████████▎ | 334/401 [05:18<02:10,  1.96s/it]
 84%|████████▎ | 335/401 [05:22<02:39,  2.41s/it]
 84%|████████▍ | 336/401 [05:25<02:57,  2.73s/it]
 84%|████████▍ | 337/401 [05:27<02:24,  2.26s/it]
 84%|████████▍ | 338/401 [05:27<01:49,  1.75s/it]
 85%|████████▍ | 339/401 [05:28<01:25,  1.39s/it]
 85%|████████▍ | 340/401 [05:28<01:02,  1.02s/it]
 85%|████████▌ | 341/401 [05:28<00:44,  1.33it/s]
 85%|████████▌ | 342/401 [05:28<00:36,  1.61it/s]
 86%|████████▌ | 343/401 [05:29<00:34,  1.68it/s]
 86%|████████▌ | 344/401 [05:29<00:29,  1.94it/s]
 86%|████████▌ | 345/401 [05:31<00:45,  1.24it/s]
 86%|████████▋ | 346/401 [05:31<00:37,  1.45it/s]
 87%|████████▋ | 347/401 [05:31<00:31,  1.69it/s]
 87%|████████▋ | 348/401 [05:32<00:28,  1.84it/s]
 87%|████████▋ | 349/401 [05:32<00:23,  2.18it/s]
 87%|████████▋ | 350/401 [05:35<01:04,  1.26s/it]
 88%|████████▊ | 351/401 [05:39<01:37,  1.94s/it]
 88%|████████▊ | 352/401 [05:39<01:09,  1.43s/it]
 88%|████████▊ | 353/401 [05:43<01:39,  2.08s/it]
 89%|████████▊ | 355/401 [05:43<00:56,  1.23s/it]
 89%|████████▉ | 356/401 [05:46<01:16,  1.71s/it]
 89%|████████▉ | 357/401 [05:47<01:03,  1.45s/it]
 89%|████████▉ | 358/401 [05:48<00:58,  1.37s/it]
 90%|████████▉ | 359/401 [05:49<00:52,  1.26s/it]
 90%|████████▉ | 360/401 [05:50<00:48,  1.17s/it]
 90%|█████████ | 361/401 [05:50<00:38,  1.03it/s]
 90%|█████████ | 362/401 [05:51<00:30,  1.29it/s]
 91%|█████████ | 363/401 [05:51<00:24,  1.58it/s]
 91%|█████████ | 364/401 [05:51<00:18,  1.98it/s]
 91%|█████████ | 365/401 [05:53<00:31,  1.13it/s]
 91%|█████████▏| 366/401 [05:53<00:24,  1.45it/s]
 92%|█████████▏| 367/401 [05:54<00:21,  1.56it/s]
 92%|█████████▏| 368/401 [05:54<00:15,  2.07it/s]
 92%|█████████▏| 369/401 [05:54<00:13,  2.37it/s]
 92%|█████████▏| 370/401 [05:56<00:25,  1.22it/s]
 93%|█████████▎| 371/401 [05:58<00:33,  1.10s/it]
 93%|█████████▎| 372/401 [05:58<00:23,  1.22it/s]
 93%|█████████▎| 373/401 [06:00<00:31,  1.11s/it]
 93%|█████████▎| 374/401 [06:01<00:35,  1.31s/it]
 94%|█████████▎| 375/401 [06:03<00:37,  1.45s/it]
 94%|█████████▍| 376/401 [06:06<00:48,  1.95s/it]
 94%|█████████▍| 377/401 [06:07<00:35,  1.49s/it]
 94%|█████████▍| 378/401 [06:10<00:46,  2.00s/it]
 95%|█████████▍| 379/401 [06:13<00:53,  2.45s/it]
 95%|█████████▍| 380/401 [06:15<00:47,  2.25s/it]
 95%|█████████▌| 382/401 [06:18<00:36,  1.94s/it]
 96%|█████████▌| 383/401 [06:22<00:40,  2.25s/it]
 96%|█████████▌| 384/401 [06:24<00:38,  2.29s/it]
 96%|█████████▌| 385/401 [06:27<00:41,  2.62s/it]
 96%|█████████▋| 386/401 [06:28<00:32,  2.13s/it]
 97%|█████████▋| 387/401 [06:30<00:26,  1.90s/it]
 97%|█████████▋| 388/401 [06:31<00:21,  1.68s/it]
 97%|█████████▋| 389/401 [06:31<00:16,  1.33s/it]
 97%|█████████▋| 390/401 [06:32<00:12,  1.11s/it]
 98%|█████████▊| 391/401 [06:32<00:08,  1.18it/s]
 98%|█████████▊| 392/401 [06:33<00:08,  1.06it/s]
 98%|█████████▊| 393/401 [06:33<00:05,  1.39it/s]
 98%|█████████▊| 394/401 [06:34<00:04,  1.70it/s]
 99%|█████████▊| 395/401 [06:34<00:03,  1.94it/s]
 99%|█████████▉| 396/401 [06:38<00:07,  1.44s/it]
 99%|█████████▉| 397/401 [06:38<00:04,  1.10s/it]
 99%|█████████▉| 398/401 [06:42<00:05,  1.87s/it]
100%|█████████▉| 399/401 [06:45<00:04,  2.36s/it]
100%|█████████▉| 400/401 [06:45<00:01,  1.71s/it]
100%|██████████| 401/401 [06:46<00:00,  1.25s/it]
100%|██████████| 401/401 [06:46<00:00,  1.01s/it]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:31:49.115344_ae_processed_test.json', '--output_addr', 'data/out/rag/full_profile/ae_rag_full_profile_test_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  2.67 examples/s]
Generating train split: 401 examples [00:00, 511.85 examples/s]
INFO 07-09 15:39:21 config.py:510] This model supports multiple tasks: {'generate', 'score', 'reward', 'classify', 'embed'}. Defaulting to 'generate'.
INFO 07-09 15:39:21 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:39:22 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:39:23 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:39:23 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:05<00:16,  5.51s/it]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:11<00:11,  5.58s/it]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:16<00:05,  5.37s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:21<00:00,  5.45s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:21<00:00,  5.46s/it]

INFO 07-09 15:39:46 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 15:39:48 worker.py:241] Memory profiling takes 2.11 seconds
INFO 07-09 15:39:48 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 15:39:48 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 15:39:48 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 15:39:48 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 15:39:52 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:20,  1.69it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:18,  1.79it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:17,  1.80it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:02<00:17,  1.82it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:02<00:15,  1.94it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:03<00:13,  2.09it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:03<00:12,  2.23it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:03<00:11,  2.42it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:04<00:10,  2.55it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:04<00:09,  2.66it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:04<00:08,  2.75it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:05<00:08,  2.81it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:05<00:07,  2.85it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:05<00:07,  2.88it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:06<00:06,  2.90it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:06<00:06,  2.92it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:06<00:06,  2.96it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:07<00:05,  2.98it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:07<00:05,  3.00it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:07<00:04,  3.01it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:08<00:04,  3.02it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:08<00:04,  3.02it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:08<00:03,  3.03it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:09<00:03,  3.04it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:09<00:03,  3.05it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:09<00:02,  3.05it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:10<00:02,  3.05it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:10<00:02,  3.05it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:10<00:01,  3.06it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:11<00:01,  3.07it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:11<00:01,  3.07it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:11<00:00,  3.08it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:12<00:00,  3.03it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:12<00:00,  3.05it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  3.06it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  2.75it/s]
INFO 07-09 15:40:05 model_runner.py:1535] Graph capturing finished in 13 secs, took 0.22 GiB
INFO 07-09 15:40:05 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 18.94 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:13<1:28:59, 13.35s/it, est. speed input: 34.31 toks/s, output: 6.52 toks/s]
Processed prompts:   0%|          | 2/401 [00:13<38:29,  5.79s/it, est. speed input: 57.13 toks/s, output: 13.14 toks/s] 
Processed prompts:   1%|          | 3/401 [00:14<22:06,  3.33s/it, est. speed input: 79.48 toks/s, output: 19.92 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:14<07:52,  1.20s/it, est. speed input: 171.63 toks/s, output: 40.83 toks/s]
Processed prompts:   2%|▏         | 8/401 [00:14<05:17,  1.24it/s, est. speed input: 250.27 toks/s, output: 54.19 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:15<03:32,  1.84it/s, est. speed input: 298.11 toks/s, output: 68.20 toks/s]
Processed prompts:   3%|▎         | 12/401 [00:15<02:34,  2.52it/s, est. speed input: 369.57 toks/s, output: 81.68 toks/s]
Processed prompts:   4%|▍         | 16/401 [00:15<01:30,  4.24it/s, est. speed input: 473.10 toks/s, output: 109.01 toks/s]
Processed prompts:   4%|▍         | 18/401 [00:15<01:19,  4.83it/s, est. speed input: 526.46 toks/s, output: 121.84 toks/s]
Processed prompts:   5%|▍         | 20/401 [00:16<01:06,  5.71it/s, est. speed input: 565.24 toks/s, output: 135.09 toks/s]
Processed prompts:   6%|▌         | 24/401 [00:16<00:48,  7.74it/s, est. speed input: 658.08 toks/s, output: 162.08 toks/s]
Processed prompts:   6%|▋         | 26/401 [00:16<00:46,  8.11it/s, est. speed input: 701.87 toks/s, output: 174.76 toks/s]
Processed prompts:   7%|▋         | 29/401 [00:16<00:39,  9.52it/s, est. speed input: 790.90 toks/s, output: 194.63 toks/s]
Processed prompts:   8%|▊         | 32/401 [00:16<00:37,  9.85it/s, est. speed input: 847.11 toks/s, output: 213.53 toks/s]
Processed prompts:   9%|▊         | 35/401 [00:17<00:36, 10.03it/s, est. speed input: 908.10 toks/s, output: 232.03 toks/s]
Processed prompts:  10%|▉         | 39/401 [00:17<00:29, 12.47it/s, est. speed input: 1013.78 toks/s, output: 259.10 toks/s]
Processed prompts:  10%|█         | 42/401 [00:17<00:29, 12.31it/s, est. speed input: 1154.21 toks/s, output: 277.50 toks/s]
Processed prompts:  11%|█         | 45/401 [00:17<00:25, 13.89it/s, est. speed input: 1220.30 toks/s, output: 297.25 toks/s]
Processed prompts:  12%|█▏        | 47/401 [00:18<00:28, 12.58it/s, est. speed input: 1245.71 toks/s, output: 308.41 toks/s]
Processed prompts:  13%|█▎        | 51/401 [00:18<00:26, 13.43it/s, est. speed input: 1329.71 toks/s, output: 333.18 toks/s]
Processed prompts:  14%|█▍        | 56/401 [00:18<00:20, 17.18it/s, est. speed input: 1562.07 toks/s, output: 366.60 toks/s]
Processed prompts:  15%|█▍        | 59/401 [00:18<00:22, 15.50it/s, est. speed input: 1605.21 toks/s, output: 383.55 toks/s]
Processed prompts:  15%|█▌        | 62/401 [00:18<00:23, 14.63it/s, est. speed input: 1664.43 toks/s, output: 400.63 toks/s]
Processed prompts:  16%|█▌        | 64/401 [00:19<00:22, 14.85it/s, est. speed input: 1721.80 toks/s, output: 412.56 toks/s]
Processed prompts:  17%|█▋        | 70/401 [00:19<00:20, 16.53it/s, est. speed input: 1894.94 toks/s, output: 449.12 toks/s]
Processed prompts:  18%|█▊        | 73/401 [00:19<00:20, 15.81it/s, est. speed input: 1942.80 toks/s, output: 465.79 toks/s]
Processed prompts:  19%|█▉        | 76/401 [00:19<00:23, 13.79it/s, est. speed input: 1981.64 toks/s, output: 480.31 toks/s]
Processed prompts:  20%|█▉        | 80/401 [00:20<00:19, 16.28it/s, est. speed input: 2068.52 toks/s, output: 505.04 toks/s]
Processed prompts:  21%|██        | 85/401 [00:20<00:21, 14.99it/s, est. speed input: 2158.08 toks/s, output: 530.93 toks/s]
Processed prompts:  23%|██▎       | 91/401 [00:20<00:19, 15.67it/s, est. speed input: 2293.47 toks/s, output: 563.66 toks/s]
Processed prompts:  24%|██▍       | 96/401 [00:21<00:20, 15.12it/s, est. speed input: 2359.66 toks/s, output: 588.70 toks/s]
Processed prompts:  25%|██▌       | 101/401 [00:21<00:18, 16.66it/s, est. speed input: 2482.20 toks/s, output: 616.65 toks/s]
Processed prompts:  26%|██▌       | 104/401 [00:21<00:19, 15.28it/s, est. speed input: 2539.42 toks/s, output: 629.86 toks/s]
Processed prompts:  27%|██▋       | 110/401 [00:22<00:19, 15.17it/s, est. speed input: 2629.57 toks/s, output: 658.98 toks/s]
Processed prompts:  29%|██▉       | 117/401 [00:22<00:17, 15.89it/s, est. speed input: 2725.61 toks/s, output: 693.76 toks/s]
Processed prompts:  30%|███       | 121/401 [00:22<00:16, 17.15it/s, est. speed input: 2779.11 toks/s, output: 715.13 toks/s]
Processed prompts:  31%|███       | 125/401 [00:22<00:17, 16.09it/s, est. speed input: 2831.18 toks/s, output: 732.51 toks/s]
Processed prompts:  32%|███▏      | 130/401 [00:23<00:14, 18.90it/s, est. speed input: 2939.83 toks/s, output: 760.47 toks/s]
Processed prompts:  33%|███▎      | 133/401 [00:23<00:15, 17.13it/s, est. speed input: 2994.97 toks/s, output: 772.81 toks/s]
Processed prompts:  34%|███▎      | 135/401 [00:23<00:17, 15.61it/s, est. speed input: 3013.23 toks/s, output: 780.10 toks/s]
Processed prompts:  34%|███▍      | 137/401 [00:23<00:18, 14.22it/s, est. speed input: 3026.84 toks/s, output: 787.06 toks/s]
Processed prompts:  35%|███▍      | 139/401 [00:23<00:17, 15.08it/s, est. speed input: 3087.12 toks/s, output: 796.94 toks/s]
Processed prompts:  35%|███▌      | 142/401 [00:24<00:20, 12.82it/s, est. speed input: 3125.46 toks/s, output: 806.52 toks/s]
Processed prompts:  36%|███▋      | 146/401 [00:24<00:15, 16.44it/s, est. speed input: 3212.30 toks/s, output: 828.62 toks/s]
Processed prompts:  37%|███▋      | 148/401 [00:24<00:16, 15.27it/s, est. speed input: 3236.18 toks/s, output: 836.30 toks/s]
Processed prompts:  38%|███▊      | 153/401 [00:24<00:11, 21.48it/s, est. speed input: 3398.24 toks/s, output: 866.03 toks/s]
Processed prompts:  39%|███▉      | 157/401 [00:24<00:09, 25.00it/s, est. speed input: 3463.02 toks/s, output: 889.17 toks/s]
Processed prompts:  40%|████      | 162/401 [00:24<00:07, 30.29it/s, est. speed input: 3577.68 toks/s, output: 919.29 toks/s]
Processed prompts:  42%|████▏     | 170/401 [00:24<00:05, 41.94it/s, est. speed input: 3722.42 toks/s, output: 970.05 toks/s]
Processed prompts:  44%|████▍     | 178/401 [00:24<00:04, 51.38it/s, est. speed input: 3937.97 toks/s, output: 1021.10 toks/s]
Processed prompts:  46%|████▌     | 184/401 [00:25<00:05, 42.28it/s, est. speed input: 4084.91 toks/s, output: 1054.70 toks/s]
Processed prompts:  48%|████▊     | 191/401 [00:25<00:04, 44.44it/s, est. speed input: 4208.91 toks/s, output: 1098.07 toks/s]
Processed prompts:  49%|████▉     | 197/401 [00:25<00:04, 44.06it/s, est. speed input: 4353.71 toks/s, output: 1134.90 toks/s]
Processed prompts:  51%|█████     | 205/401 [00:25<00:04, 44.08it/s, est. speed input: 4520.67 toks/s, output: 1184.29 toks/s]
Processed prompts:  52%|█████▏    | 210/401 [00:25<00:04, 42.23it/s, est. speed input: 4640.03 toks/s, output: 1214.69 toks/s]
Processed prompts:  54%|█████▎    | 215/401 [00:25<00:04, 37.66it/s, est. speed input: 4731.24 toks/s, output: 1243.71 toks/s]
Processed prompts:  55%|█████▍    | 220/401 [00:26<00:04, 37.90it/s, est. speed input: 4862.77 toks/s, output: 1275.08 toks/s]
Processed prompts:  56%|█████▌    | 224/401 [00:26<00:05, 33.09it/s, est. speed input: 4964.47 toks/s, output: 1297.14 toks/s]
Processed prompts:  57%|█████▋    | 228/401 [00:26<00:09, 18.55it/s, est. speed input: 5007.56 toks/s, output: 1303.98 toks/s]
Processed prompts:  58%|█████▊    | 231/401 [00:26<00:09, 17.53it/s, est. speed input: 5051.55 toks/s, output: 1318.09 toks/s]
Processed prompts:  58%|█████▊    | 234/401 [00:27<00:10, 15.92it/s, est. speed input: 5068.55 toks/s, output: 1330.68 toks/s]
Processed prompts:  59%|█████▉    | 237/401 [00:27<00:10, 15.63it/s, est. speed input: 5133.87 toks/s, output: 1345.69 toks/s]
Processed prompts:  60%|█████▉    | 240/401 [00:27<00:09, 16.33it/s, est. speed input: 5195.79 toks/s, output: 1358.42 toks/s]
Processed prompts:  60%|██████    | 242/401 [00:27<00:10, 14.50it/s, est. speed input: 5221.89 toks/s, output: 1365.68 toks/s]
Processed prompts:  61%|██████▏   | 246/401 [00:27<00:08, 18.27it/s, est. speed input: 5279.39 toks/s, output: 1390.59 toks/s]
Processed prompts:  62%|██████▏   | 249/401 [00:28<00:09, 16.29it/s, est. speed input: 5291.18 toks/s, output: 1396.72 toks/s]
Processed prompts:  63%|██████▎   | 251/401 [00:28<00:10, 13.67it/s, est. speed input: 5293.54 toks/s, output: 1402.82 toks/s]
Processed prompts:  63%|██████▎   | 254/401 [00:28<00:10, 13.44it/s, est. speed input: 5325.92 toks/s, output: 1410.18 toks/s]
Processed prompts:  64%|██████▍   | 257/401 [00:28<00:09, 15.78it/s, est. speed input: 5381.21 toks/s, output: 1423.84 toks/s]
Processed prompts:  65%|██████▍   | 260/401 [00:28<00:08, 16.79it/s, est. speed input: 5413.97 toks/s, output: 1436.42 toks/s]
Processed prompts:  66%|██████▌   | 264/401 [00:28<00:06, 20.80it/s, est. speed input: 5482.34 toks/s, output: 1449.23 toks/s]
Processed prompts:  67%|██████▋   | 267/401 [00:29<00:06, 22.17it/s, est. speed input: 5517.30 toks/s, output: 1459.44 toks/s]
Processed prompts:  67%|██████▋   | 270/401 [00:29<00:07, 17.57it/s, est. speed input: 5534.02 toks/s, output: 1460.72 toks/s]
Processed prompts:  68%|██████▊   | 273/401 [00:29<00:06, 19.58it/s, est. speed input: 5586.38 toks/s, output: 1470.62 toks/s]
Processed prompts:  69%|██████▉   | 277/401 [00:29<00:05, 22.36it/s, est. speed input: 5659.20 toks/s, output: 1483.01 toks/s]
Processed prompts:  71%|███████   | 285/401 [00:29<00:03, 32.94it/s, est. speed input: 5808.60 toks/s, output: 1517.92 toks/s]
Processed prompts:  72%|███████▏  | 289/401 [00:29<00:03, 32.57it/s, est. speed input: 5859.19 toks/s, output: 1532.29 toks/s]
Processed prompts:  73%|███████▎  | 293/401 [00:29<00:03, 32.44it/s, est. speed input: 5998.35 toks/s, output: 1551.16 toks/s]
Processed prompts:  74%|███████▍  | 297/401 [00:30<00:03, 30.45it/s, est. speed input: 6059.95 toks/s, output: 1573.55 toks/s]
Processed prompts:  76%|███████▌  | 303/401 [00:30<00:03, 31.65it/s, est. speed input: 6172.64 toks/s, output: 1596.97 toks/s]
Processed prompts:  78%|███████▊  | 312/401 [00:30<00:02, 43.07it/s, est. speed input: 6366.36 toks/s, output: 1646.99 toks/s]
Processed prompts:  81%|████████  | 323/401 [00:30<00:01, 57.31it/s, est. speed input: 6637.36 toks/s, output: 1702.74 toks/s]
Processed prompts:  82%|████████▏ | 330/401 [00:30<00:01, 59.64it/s, est. speed input: 6768.12 toks/s, output: 1736.40 toks/s]
Processed prompts:  84%|████████▍ | 337/401 [00:30<00:01, 58.51it/s, est. speed input: 6917.28 toks/s, output: 1769.44 toks/s]
Processed prompts:  86%|████████▌ | 344/401 [00:30<00:00, 58.61it/s, est. speed input: 7048.89 toks/s, output: 1805.33 toks/s]
Processed prompts:  88%|████████▊ | 351/401 [00:30<00:00, 56.33it/s, est. speed input: 7197.48 toks/s, output: 1840.29 toks/s]
Processed prompts:  89%|████████▉ | 358/401 [00:31<00:00, 52.78it/s, est. speed input: 7343.08 toks/s, output: 1876.94 toks/s]
Processed prompts:  91%|█████████ | 364/401 [00:31<00:00, 49.48it/s, est. speed input: 7484.98 toks/s, output: 1908.48 toks/s]
Processed prompts:  93%|█████████▎| 372/401 [00:31<00:00, 55.36it/s, est. speed input: 7669.60 toks/s, output: 1954.79 toks/s]
Processed prompts:  94%|█████████▍| 378/401 [00:31<00:00, 39.52it/s, est. speed input: 7878.87 toks/s, output: 1980.73 toks/s]
Processed prompts:  96%|█████████▌| 383/401 [00:31<00:00, 33.97it/s, est. speed input: 7959.23 toks/s, output: 2009.48 toks/s]
Processed prompts:  97%|█████████▋| 387/401 [00:33<00:01, 10.81it/s, est. speed input: 7811.93 toks/s, output: 1970.52 toks/s]
Processed prompts:  97%|█████████▋| 390/401 [00:33<00:01, 10.04it/s, est. speed input: 7808.01 toks/s, output: 1979.36 toks/s]
Processed prompts:  98%|█████████▊| 393/401 [00:33<00:00, 10.36it/s, est. speed input: 7862.29 toks/s, output: 1998.78 toks/s]
Processed prompts:  99%|█████████▊| 395/401 [00:34<00:00,  9.60it/s, est. speed input: 7869.08 toks/s, output: 2007.62 toks/s]
Processed prompts:  99%|█████████▉| 397/401 [00:34<00:00,  7.92it/s, est. speed input: 7807.74 toks/s, output: 2006.56 toks/s]
Processed prompts: 100%|█████████▉| 400/401 [00:34<00:00,  8.99it/s, est. speed input: 7844.13 toks/s, output: 2031.03 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:35<00:00, 11.41it/s, est. speed input: 7799.43 toks/s, output: 2023.20 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are often used to denote various elements that were added for clarity and readability, rather than being part of the original text. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is likely used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) are typically references to other texts or sources. The quotes (like ' and ") are used to denote speech or specific phrases. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּל חָכְמָה מֵיהוָה, וִעַמּוֹ הִיא לְעוֹלָמִים.) are used to include additional information or to clarify the text. The italics and hyphens are also used for emphasis or to separate words. While these elements are not part of the original text, they are important for understanding and interpreting the text. The earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which is a direct descendant of the Phoenician alphabet. Over time, this evolved into the Aramaic alphabet and eventually into the square script used in modern Hebrew texts. The font style you see in Sefaria is the square script, which is the most common script used for Hebrew texts today. If you want to remove these modern additions and get closer to the original text, you can use tools or scripts to strip out these formatting elements, but be aware that you may lose some context and clarity."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.52s/it, est. speed input: 930.79 toks/s, output: 78.51 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.52s/it, est. speed input: 930.79 toks/s, output: 78.51 toks/s]
[rank0]:[W709 15:40:45.501480930 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/ae_rag_full_profile_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:40:49.772730_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:40:49.772730_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:40:49.772730_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:49,  3.09it/s]
  1%|          | 3/526 [00:00<01:25,  6.14it/s]
  1%|          | 5/526 [00:00<00:59,  8.76it/s]
  1%|▏         | 7/526 [00:00<00:48, 10.64it/s]
  2%|▏         | 9/526 [00:01<02:02,  4.23it/s]
  2%|▏         | 11/526 [00:01<01:32,  5.60it/s]
  2%|▏         | 13/526 [00:02<01:45,  4.87it/s]
  3%|▎         | 15/526 [00:02<01:26,  5.90it/s]
  3%|▎         | 16/526 [00:02<01:27,  5.81it/s]
  3%|▎         | 18/526 [00:02<01:09,  7.31it/s]
  4%|▎         | 19/526 [00:03<01:09,  7.25it/s]
  4%|▍         | 20/526 [00:03<01:27,  5.75it/s]
  4%|▍         | 21/526 [00:04<03:27,  2.44it/s]
  4%|▍         | 22/526 [00:04<03:28,  2.42it/s]
  4%|▍         | 23/526 [00:05<04:12,  1.99it/s]
  5%|▍         | 24/526 [00:06<04:52,  1.72it/s]
  5%|▍         | 25/526 [00:07<06:02,  1.38it/s]
  5%|▍         | 26/526 [00:07<05:02,  1.65it/s]
  5%|▌         | 27/526 [00:08<03:56,  2.11it/s]
  5%|▌         | 28/526 [00:08<03:47,  2.19it/s]
  6%|▌         | 30/526 [00:10<05:00,  1.65it/s]
  6%|▌         | 31/526 [00:10<04:52,  1.69it/s]
  6%|▌         | 32/526 [00:10<04:08,  1.99it/s]
  6%|▋         | 33/526 [00:12<06:02,  1.36it/s]
  6%|▋         | 34/526 [00:13<06:16,  1.31it/s]
  7%|▋         | 35/526 [00:14<06:53,  1.19it/s]
  7%|▋         | 36/526 [00:14<05:20,  1.53it/s]
  7%|▋         | 37/526 [00:14<04:36,  1.77it/s]
  7%|▋         | 39/526 [00:14<02:42,  3.00it/s]
  8%|▊         | 40/526 [00:14<02:25,  3.34it/s]
  8%|▊         | 42/526 [00:15<01:51,  4.35it/s]
  8%|▊         | 43/526 [00:15<02:30,  3.20it/s]
  9%|▊         | 45/526 [00:15<01:47,  4.47it/s]
  9%|▊         | 46/526 [00:16<01:54,  4.19it/s]
  9%|▉         | 47/526 [00:16<02:12,  3.61it/s]
  9%|▉         | 48/526 [00:17<02:47,  2.86it/s]
 10%|▉         | 50/526 [00:17<02:11,  3.63it/s]
 10%|▉         | 52/526 [00:17<01:40,  4.71it/s]
 10%|█         | 53/526 [00:19<03:35,  2.20it/s]
 10%|█         | 54/526 [00:22<09:08,  1.16s/it]
 11%|█         | 56/526 [00:22<05:40,  1.38it/s]
 11%|█         | 58/526 [00:23<04:36,  1.69it/s]
 11%|█         | 59/526 [00:24<04:54,  1.59it/s]
 11%|█▏        | 60/526 [00:25<05:18,  1.46it/s]
 12%|█▏        | 61/526 [00:25<05:12,  1.49it/s]
 12%|█▏        | 62/526 [00:26<06:14,  1.24it/s]
 12%|█▏        | 63/526 [00:28<07:38,  1.01it/s]
 12%|█▏        | 64/526 [00:28<06:12,  1.24it/s]
 12%|█▏        | 65/526 [00:28<04:43,  1.62it/s]
 13%|█▎        | 66/526 [00:29<03:59,  1.92it/s]
 13%|█▎        | 67/526 [00:29<03:49,  2.00it/s]
 13%|█▎        | 68/526 [00:30<04:53,  1.56it/s]
 13%|█▎        | 69/526 [00:30<03:44,  2.03it/s]
 13%|█▎        | 70/526 [00:32<06:00,  1.27it/s]
 13%|█▎        | 71/526 [00:33<06:11,  1.23it/s]
 14%|█▎        | 72/526 [00:33<05:43,  1.32it/s]
 14%|█▍        | 73/526 [00:34<06:31,  1.16it/s]
 14%|█▍        | 74/526 [00:36<07:55,  1.05s/it]
 14%|█▍        | 75/526 [00:36<05:54,  1.27it/s]
 14%|█▍        | 76/526 [00:36<04:25,  1.69it/s]
 15%|█▍        | 77/526 [00:37<05:33,  1.35it/s]
 15%|█▍        | 78/526 [00:39<07:12,  1.04it/s]
 15%|█▌        | 79/526 [00:39<05:19,  1.40it/s]
 15%|█▌        | 80/526 [00:39<04:20,  1.71it/s]
 16%|█▌        | 82/526 [00:40<04:33,  1.62it/s]
 16%|█▌        | 84/526 [00:42<04:21,  1.69it/s]
 16%|█▌        | 85/526 [00:43<06:20,  1.16it/s]
 16%|█▋        | 86/526 [00:44<05:23,  1.36it/s]
 17%|█▋        | 87/526 [00:45<05:54,  1.24it/s]
 17%|█▋        | 88/526 [00:45<04:56,  1.48it/s]
 17%|█▋        | 89/526 [00:45<04:16,  1.71it/s]
 17%|█▋        | 90/526 [00:46<03:51,  1.88it/s]
 17%|█▋        | 91/526 [00:46<03:39,  1.98it/s]
 17%|█▋        | 92/526 [00:46<02:52,  2.51it/s]
 18%|█▊        | 93/526 [00:46<02:15,  3.19it/s]
 18%|█▊        | 95/526 [00:47<01:31,  4.71it/s]
 18%|█▊        | 96/526 [00:47<02:02,  3.51it/s]
 18%|█▊        | 97/526 [00:48<02:48,  2.55it/s]
 19%|█▊        | 98/526 [00:51<08:09,  1.14s/it]
 19%|█▉        | 99/526 [00:54<12:27,  1.75s/it]
 19%|█▉        | 101/526 [00:55<07:39,  1.08s/it]
 19%|█▉        | 102/526 [00:55<06:33,  1.08it/s]
 20%|█▉        | 103/526 [00:56<06:03,  1.16it/s]
 20%|█▉        | 104/526 [00:57<07:00,  1.00it/s]
 20%|██        | 106/526 [00:58<04:49,  1.45it/s]
 21%|██        | 108/526 [00:58<03:35,  1.94it/s]
 21%|██        | 109/526 [00:59<03:19,  2.09it/s]
 21%|██        | 110/526 [01:00<04:16,  1.62it/s]
 21%|██        | 111/526 [01:00<03:56,  1.75it/s]
 21%|██▏       | 112/526 [01:01<03:43,  1.85it/s]
 21%|██▏       | 113/526 [01:01<02:54,  2.37it/s]
 22%|██▏       | 114/526 [01:01<02:23,  2.87it/s]
 22%|██▏       | 115/526 [01:01<01:58,  3.46it/s]
 22%|██▏       | 116/526 [01:01<01:36,  4.25it/s]
 22%|██▏       | 117/526 [01:02<03:42,  1.84it/s]
 22%|██▏       | 118/526 [01:04<05:12,  1.31it/s]
 23%|██▎       | 119/526 [01:04<04:21,  1.56it/s]
 23%|██▎       | 120/526 [01:05<05:15,  1.29it/s]
 23%|██▎       | 121/526 [01:05<04:09,  1.63it/s]
 23%|██▎       | 122/526 [01:07<05:32,  1.22it/s]
 23%|██▎       | 123/526 [01:08<06:08,  1.09it/s]
 24%|██▎       | 124/526 [01:09<07:02,  1.05s/it]
 24%|██▍       | 125/526 [01:09<05:11,  1.29it/s]
 24%|██▍       | 127/526 [01:10<03:15,  2.04it/s]
 24%|██▍       | 128/526 [01:10<02:44,  2.42it/s]
 25%|██▍       | 129/526 [01:10<02:42,  2.44it/s]
 25%|██▍       | 130/526 [01:11<02:40,  2.46it/s]
 25%|██▍       | 131/526 [01:11<02:22,  2.78it/s]
 25%|██▌       | 132/526 [01:11<01:58,  3.33it/s]
 25%|██▌       | 133/526 [01:11<01:43,  3.81it/s]
 26%|██▌       | 135/526 [01:12<01:32,  4.24it/s]
 26%|██▌       | 136/526 [01:12<01:41,  3.86it/s]
 26%|██▌       | 138/526 [01:12<01:22,  4.70it/s]
 26%|██▋       | 139/526 [01:13<01:33,  4.13it/s]
 27%|██▋       | 140/526 [01:13<01:26,  4.45it/s]
 27%|██▋       | 141/526 [01:13<01:24,  4.54it/s]
 27%|██▋       | 142/526 [01:13<01:18,  4.90it/s]
 27%|██▋       | 143/526 [01:14<02:01,  3.14it/s]
 27%|██▋       | 144/526 [01:14<01:43,  3.70it/s]
 28%|██▊       | 145/526 [01:15<03:34,  1.78it/s]
 28%|██▊       | 146/526 [01:15<03:11,  1.99it/s]
 28%|██▊       | 147/526 [01:16<02:59,  2.11it/s]
 28%|██▊       | 149/526 [01:16<02:14,  2.80it/s]
 29%|██▊       | 150/526 [01:16<01:54,  3.30it/s]
 29%|██▊       | 151/526 [01:17<01:39,  3.77it/s]
 29%|██▉       | 152/526 [01:17<01:29,  4.19it/s]
 29%|██▉       | 154/526 [01:18<02:20,  2.64it/s]
 29%|██▉       | 155/526 [01:19<03:09,  1.96it/s]
 30%|██▉       | 156/526 [01:20<03:59,  1.55it/s]
 30%|██▉       | 157/526 [01:20<03:37,  1.70it/s]
 30%|███       | 159/526 [01:20<02:12,  2.78it/s]
 30%|███       | 160/526 [01:22<03:47,  1.61it/s]
 31%|███       | 161/526 [01:22<03:16,  1.86it/s]
 31%|███       | 162/526 [01:24<05:39,  1.07it/s]
 31%|███       | 164/526 [01:25<03:44,  1.61it/s]
 32%|███▏      | 166/526 [01:25<02:33,  2.35it/s]
 32%|███▏      | 167/526 [01:25<02:25,  2.47it/s]
 32%|███▏      | 168/526 [01:26<03:36,  1.65it/s]
 32%|███▏      | 169/526 [01:27<03:10,  1.87it/s]
 33%|███▎      | 171/526 [01:29<04:25,  1.34it/s]
 33%|███▎      | 172/526 [01:29<03:38,  1.62it/s]
 33%|███▎      | 173/526 [01:29<03:11,  1.84it/s]
 33%|███▎      | 174/526 [01:30<02:57,  1.99it/s]
 33%|███▎      | 175/526 [01:30<02:21,  2.48it/s]
 33%|███▎      | 176/526 [01:31<03:14,  1.80it/s]
 34%|███▎      | 177/526 [01:31<02:31,  2.30it/s]
 34%|███▍      | 178/526 [01:31<02:01,  2.86it/s]
 34%|███▍      | 179/526 [01:31<01:41,  3.42it/s]
 34%|███▍      | 180/526 [01:33<03:24,  1.69it/s]
 34%|███▍      | 181/526 [01:33<02:39,  2.17it/s]
 35%|███▍      | 182/526 [01:34<04:24,  1.30it/s]
 35%|███▍      | 183/526 [01:34<03:17,  1.74it/s]
 35%|███▍      | 184/526 [01:35<03:17,  1.73it/s]
 35%|███▌      | 186/526 [01:37<04:17,  1.32it/s]
 36%|███▌      | 187/526 [01:37<03:48,  1.48it/s]
 36%|███▌      | 188/526 [01:38<03:31,  1.60it/s]
 36%|███▌      | 190/526 [01:38<02:15,  2.48it/s]
 36%|███▋      | 191/526 [01:38<01:57,  2.86it/s]
 37%|███▋      | 192/526 [01:38<01:41,  3.30it/s]
 37%|███▋      | 193/526 [01:38<01:24,  3.96it/s]
 37%|███▋      | 194/526 [01:39<01:12,  4.56it/s]
 37%|███▋      | 195/526 [01:40<02:51,  1.93it/s]
 37%|███▋      | 196/526 [01:41<03:59,  1.38it/s]
 37%|███▋      | 197/526 [01:41<03:14,  1.69it/s]
 38%|███▊      | 198/526 [01:42<02:55,  1.87it/s]
 38%|███▊      | 199/526 [01:44<05:18,  1.03it/s]
 38%|███▊      | 200/526 [01:44<04:07,  1.32it/s]
 38%|███▊      | 201/526 [01:45<04:19,  1.25it/s]
 38%|███▊      | 202/526 [01:45<03:24,  1.58it/s]
 39%|███▊      | 203/526 [01:46<03:44,  1.44it/s]
 39%|███▉      | 205/526 [01:46<02:10,  2.45it/s]
 39%|███▉      | 206/526 [01:46<01:50,  2.88it/s]
 39%|███▉      | 207/526 [01:47<01:40,  3.16it/s]
 40%|███▉      | 210/526 [01:47<00:55,  5.68it/s]
 40%|████      | 211/526 [01:48<01:47,  2.92it/s]
 40%|████      | 212/526 [01:48<01:41,  3.09it/s]
 41%|████      | 214/526 [01:48<01:17,  4.03it/s]
 41%|████      | 215/526 [01:49<01:45,  2.95it/s]
 41%|████      | 216/526 [01:49<01:45,  2.93it/s]
 41%|████▏     | 217/526 [01:50<02:39,  1.94it/s]
 41%|████▏     | 218/526 [01:51<03:26,  1.49it/s]
 42%|████▏     | 219/526 [01:52<03:35,  1.42it/s]
 42%|████▏     | 220/526 [01:52<02:44,  1.87it/s]
 42%|████▏     | 222/526 [01:52<01:41,  3.01it/s]
 42%|████▏     | 223/526 [01:53<02:35,  1.94it/s]
 43%|████▎     | 224/526 [01:54<02:09,  2.34it/s]
 43%|████▎     | 225/526 [01:54<02:06,  2.38it/s]
 43%|████▎     | 227/526 [01:55<01:42,  2.91it/s]
 43%|████▎     | 228/526 [01:55<01:27,  3.40it/s]
 44%|████▎     | 229/526 [01:55<01:36,  3.08it/s]
 44%|████▎     | 230/526 [01:55<01:26,  3.41it/s]
 44%|████▍     | 231/526 [01:56<02:24,  2.04it/s]
 44%|████▍     | 232/526 [01:56<01:53,  2.59it/s]
 44%|████▍     | 233/526 [01:57<01:36,  3.05it/s]
 44%|████▍     | 234/526 [01:58<02:57,  1.65it/s]
 45%|████▍     | 235/526 [01:58<02:47,  1.74it/s]
 45%|████▍     | 236/526 [01:59<02:11,  2.21it/s]
 45%|████▌     | 237/526 [01:59<02:03,  2.34it/s]
 45%|████▌     | 238/526 [01:59<01:44,  2.77it/s]
 46%|████▌     | 240/526 [01:59<01:06,  4.32it/s]
 46%|████▌     | 241/526 [02:00<02:03,  2.30it/s]
 46%|████▌     | 243/526 [02:01<01:45,  2.69it/s]
 46%|████▋     | 244/526 [02:01<01:48,  2.60it/s]
 47%|████▋     | 245/526 [02:02<02:32,  1.85it/s]
 47%|████▋     | 246/526 [02:03<02:14,  2.08it/s]
 47%|████▋     | 247/526 [02:03<01:51,  2.50it/s]
 47%|████▋     | 248/526 [02:04<02:10,  2.14it/s]
 47%|████▋     | 249/526 [02:05<02:51,  1.62it/s]
 48%|████▊     | 250/526 [02:05<02:14,  2.06it/s]
 48%|████▊     | 251/526 [02:06<02:51,  1.61it/s]
 48%|████▊     | 252/526 [02:06<02:27,  1.85it/s]
 48%|████▊     | 253/526 [02:06<01:58,  2.30it/s]
 48%|████▊     | 255/526 [02:07<02:12,  2.05it/s]
 49%|████▊     | 256/526 [02:08<01:56,  2.31it/s]
 49%|████▉     | 257/526 [02:09<02:57,  1.52it/s]
 49%|████▉     | 258/526 [02:10<03:20,  1.33it/s]
 49%|████▉     | 259/526 [02:10<02:34,  1.73it/s]
 49%|████▉     | 260/526 [02:10<02:01,  2.19it/s]
 50%|████▉     | 261/526 [02:11<02:05,  2.11it/s]
 50%|████▉     | 262/526 [02:11<01:37,  2.70it/s]
 50%|█████     | 263/526 [02:12<02:25,  1.81it/s]
 50%|█████     | 264/526 [02:13<02:47,  1.56it/s]
 50%|█████     | 265/526 [02:13<02:08,  2.03it/s]
 51%|█████     | 266/526 [02:13<02:19,  1.87it/s]
 51%|█████     | 267/526 [02:14<02:28,  1.75it/s]
 51%|█████     | 268/526 [02:14<01:54,  2.24it/s]
 51%|█████     | 269/526 [02:14<01:37,  2.63it/s]
 51%|█████▏    | 270/526 [02:15<01:50,  2.32it/s]
 52%|█████▏    | 271/526 [02:15<01:31,  2.78it/s]
 52%|█████▏    | 272/526 [02:16<01:45,  2.41it/s]
 52%|█████▏    | 273/526 [02:17<02:32,  1.66it/s]
 52%|█████▏    | 274/526 [02:17<02:17,  1.83it/s]
 52%|█████▏    | 275/526 [02:20<05:44,  1.37s/it]
 52%|█████▏    | 276/526 [02:21<04:15,  1.02s/it]
 53%|█████▎    | 277/526 [02:21<03:13,  1.29it/s]
 53%|█████▎    | 278/526 [02:22<03:09,  1.31it/s]
 53%|█████▎    | 279/526 [02:25<06:18,  1.53s/it]
 53%|█████▎    | 280/526 [02:28<08:36,  2.10s/it]
 53%|█████▎    | 281/526 [02:32<10:08,  2.48s/it]
 54%|█████▎    | 282/526 [02:35<11:13,  2.76s/it]
 54%|█████▍    | 283/526 [02:38<11:47,  2.91s/it]
 54%|█████▍    | 284/526 [02:42<12:11,  3.02s/it]
 54%|█████▍    | 285/526 [02:42<09:04,  2.26s/it]
 54%|█████▍    | 286/526 [02:43<07:21,  1.84s/it]
 55%|█████▍    | 287/526 [02:43<05:21,  1.34s/it]
 55%|█████▍    | 288/526 [02:43<04:02,  1.02s/it]
 55%|█████▍    | 289/526 [02:44<03:01,  1.30it/s]
 55%|█████▌    | 291/526 [02:45<02:37,  1.49it/s]
 56%|█████▌    | 292/526 [02:45<02:10,  1.80it/s]
 56%|█████▌    | 293/526 [02:46<02:20,  1.66it/s]
 56%|█████▌    | 294/526 [02:46<02:02,  1.89it/s]
 56%|█████▌    | 295/526 [02:46<01:48,  2.13it/s]
 56%|█████▋    | 296/526 [02:47<01:39,  2.32it/s]
 57%|█████▋    | 298/526 [02:50<03:43,  1.02it/s]
 57%|█████▋    | 299/526 [02:53<05:44,  1.52s/it]
 57%|█████▋    | 300/526 [02:55<05:42,  1.51s/it]
 57%|█████▋    | 301/526 [02:56<05:13,  1.39s/it]
 57%|█████▋    | 302/526 [02:57<05:17,  1.42s/it]
 58%|█████▊    | 303/526 [02:59<05:21,  1.44s/it]
 58%|█████▊    | 304/526 [02:59<04:08,  1.12s/it]
 58%|█████▊    | 305/526 [03:01<04:35,  1.25s/it]
 58%|█████▊    | 306/526 [03:02<04:47,  1.31s/it]
 58%|█████▊    | 307/526 [03:04<05:00,  1.37s/it]
 59%|█████▊    | 308/526 [03:05<05:07,  1.41s/it]
 59%|█████▊    | 309/526 [03:05<03:56,  1.09s/it]
 59%|█████▉    | 310/526 [03:06<03:44,  1.04s/it]
 59%|█████▉    | 311/526 [03:07<02:51,  1.25it/s]
 59%|█████▉    | 312/526 [03:08<03:40,  1.03s/it]
 60%|█████▉    | 313/526 [03:10<04:12,  1.18s/it]
 60%|█████▉    | 314/526 [03:11<04:44,  1.34s/it]
 60%|█████▉    | 315/526 [03:15<06:41,  1.90s/it]
 60%|██████    | 316/526 [03:15<04:46,  1.37s/it]
 60%|██████    | 317/526 [03:16<04:16,  1.23s/it]
 60%|██████    | 318/526 [03:16<03:53,  1.12s/it]
 61%|██████    | 319/526 [03:17<03:06,  1.11it/s]
 61%|██████    | 320/526 [03:17<02:19,  1.48it/s]
 61%|██████    | 321/526 [03:19<03:23,  1.01it/s]
 61%|██████    | 322/526 [03:19<02:44,  1.24it/s]
 61%|██████▏   | 323/526 [03:19<02:09,  1.57it/s]
 62%|██████▏   | 324/526 [03:20<01:46,  1.90it/s]
 62%|██████▏   | 325/526 [03:20<01:30,  2.22it/s]
 62%|██████▏   | 326/526 [03:20<01:11,  2.81it/s]
 62%|██████▏   | 327/526 [03:20<01:10,  2.83it/s]
 62%|██████▏   | 328/526 [03:21<00:59,  3.35it/s]
 63%|██████▎   | 329/526 [03:21<00:47,  4.17it/s]
 63%|██████▎   | 331/526 [03:21<00:39,  4.93it/s]
 63%|██████▎   | 332/526 [03:22<00:56,  3.41it/s]
 63%|██████▎   | 333/526 [03:22<00:52,  3.66it/s]
 63%|██████▎   | 334/526 [03:23<01:50,  1.73it/s]
 64%|██████▎   | 335/526 [03:24<01:49,  1.74it/s]
 64%|██████▍   | 336/526 [03:25<02:31,  1.25it/s]
 64%|██████▍   | 337/526 [03:26<02:29,  1.27it/s]
 64%|██████▍   | 338/526 [03:26<02:20,  1.34it/s]
 64%|██████▍   | 339/526 [03:27<02:02,  1.53it/s]
 65%|██████▍   | 340/526 [03:30<04:27,  1.44s/it]
 65%|██████▍   | 341/526 [03:30<03:14,  1.05s/it]
 65%|██████▌   | 342/526 [03:31<02:44,  1.12it/s]
 65%|██████▌   | 343/526 [03:32<02:42,  1.13it/s]
 66%|██████▌   | 345/526 [03:39<06:19,  2.10s/it]
 66%|██████▌   | 346/526 [03:42<07:11,  2.40s/it]
 66%|██████▌   | 347/526 [03:49<10:42,  3.59s/it]
 66%|██████▌   | 348/526 [03:50<08:35,  2.90s/it]
 66%|██████▋   | 349/526 [03:51<06:33,  2.22s/it]
 67%|██████▋   | 350/526 [03:58<10:32,  3.60s/it]
 67%|██████▋   | 351/526 [04:01<10:13,  3.51s/it]
 67%|██████▋   | 352/526 [04:01<07:24,  2.55s/it]
 67%|██████▋   | 353/526 [04:01<05:20,  1.85s/it]
 67%|██████▋   | 355/526 [04:02<03:14,  1.14s/it]
 68%|██████▊   | 356/526 [04:02<02:30,  1.13it/s]
 68%|██████▊   | 357/526 [04:03<02:17,  1.23it/s]
 68%|██████▊   | 358/526 [04:03<02:08,  1.31it/s]
 68%|██████▊   | 359/526 [04:04<01:44,  1.59it/s]
 68%|██████▊   | 360/526 [04:04<01:20,  2.06it/s]
 69%|██████▊   | 361/526 [04:04<01:08,  2.40it/s]
 69%|██████▉   | 363/526 [04:05<01:04,  2.53it/s]
 69%|██████▉   | 364/526 [04:05<00:56,  2.86it/s]
 69%|██████▉   | 365/526 [04:06<01:08,  2.36it/s]
 70%|██████▉   | 366/526 [04:07<02:04,  1.29it/s]
 70%|██████▉   | 367/526 [04:07<01:35,  1.67it/s]
 70%|██████▉   | 368/526 [04:08<01:14,  2.11it/s]
 70%|███████   | 369/526 [04:08<01:12,  2.15it/s]
 70%|███████   | 370/526 [04:15<06:04,  2.34s/it]
 71%|███████   | 371/526 [04:22<09:32,  3.69s/it]
 71%|███████   | 372/526 [04:29<12:00,  4.68s/it]
 71%|███████   | 373/526 [04:29<08:27,  3.32s/it]
 71%|███████   | 374/526 [04:29<05:58,  2.36s/it]
 71%|███████▏  | 375/526 [04:36<09:23,  3.73s/it]
 71%|███████▏  | 376/526 [04:36<06:37,  2.65s/it]
 72%|███████▏  | 377/526 [04:37<05:04,  2.04s/it]
 72%|███████▏  | 379/526 [04:37<02:59,  1.22s/it]
 72%|███████▏  | 380/526 [04:37<02:23,  1.02it/s]
 72%|███████▏  | 381/526 [04:44<06:03,  2.51s/it]
 73%|███████▎  | 382/526 [04:45<04:42,  1.96s/it]
 73%|███████▎  | 383/526 [04:45<03:39,  1.54s/it]
 73%|███████▎  | 384/526 [04:52<07:15,  3.07s/it]
 73%|███████▎  | 385/526 [04:59<09:50,  4.19s/it]
 73%|███████▎  | 386/526 [05:00<07:35,  3.26s/it]
 74%|███████▎  | 387/526 [05:00<05:29,  2.37s/it]
 74%|███████▍  | 388/526 [05:01<04:06,  1.79s/it]
 74%|███████▍  | 389/526 [05:01<03:17,  1.44s/it]
 74%|███████▍  | 390/526 [05:02<02:43,  1.20s/it]
 74%|███████▍  | 391/526 [05:02<02:00,  1.12it/s]
 75%|███████▍  | 392/526 [05:02<01:28,  1.51it/s]
 75%|███████▍  | 393/526 [05:03<01:27,  1.53it/s]
 75%|███████▍  | 394/526 [05:03<01:05,  2.01it/s]
 75%|███████▌  | 396/526 [05:03<00:41,  3.15it/s]
 75%|███████▌  | 397/526 [05:03<00:35,  3.64it/s]
 76%|███████▌  | 398/526 [05:04<00:35,  3.61it/s]
 76%|███████▌  | 399/526 [05:11<04:27,  2.11s/it]
 76%|███████▌  | 400/526 [05:11<03:15,  1.55s/it]
 76%|███████▌  | 401/526 [05:18<06:29,  3.11s/it]
 76%|███████▋  | 402/526 [05:18<04:52,  2.36s/it]
 77%|███████▋  | 403/526 [05:19<03:38,  1.77s/it]
 77%|███████▋  | 404/526 [05:19<02:39,  1.31s/it]
 77%|███████▋  | 405/526 [05:19<01:59,  1.01it/s]
 77%|███████▋  | 406/526 [05:24<04:24,  2.21s/it]
 78%|███████▊  | 408/526 [05:24<02:27,  1.25s/it]
 78%|███████▊  | 409/526 [05:25<02:08,  1.10s/it]
 78%|███████▊  | 410/526 [05:25<01:39,  1.17it/s]
 78%|███████▊  | 411/526 [05:32<04:50,  2.53s/it]
 78%|███████▊  | 412/526 [05:32<03:34,  1.88s/it]
 79%|███████▊  | 414/526 [05:33<02:02,  1.10s/it]
 79%|███████▉  | 415/526 [05:33<01:41,  1.09it/s]
 79%|███████▉  | 417/526 [05:34<01:10,  1.54it/s]
 79%|███████▉  | 418/526 [05:35<01:37,  1.10it/s]
 80%|███████▉  | 419/526 [05:36<01:17,  1.38it/s]
 80%|████████  | 421/526 [05:39<02:07,  1.22s/it]
 80%|████████  | 422/526 [05:39<01:40,  1.04it/s]
 80%|████████  | 423/526 [05:40<01:23,  1.24it/s]
 81%|████████  | 424/526 [05:40<01:05,  1.57it/s]
 81%|████████  | 425/526 [05:40<00:50,  2.00it/s]
 81%|████████  | 426/526 [05:40<00:42,  2.33it/s]
 81%|████████  | 427/526 [05:40<00:34,  2.86it/s]
 81%|████████▏ | 428/526 [05:41<00:27,  3.53it/s]
 82%|████████▏ | 429/526 [05:41<00:23,  4.09it/s]
 82%|████████▏ | 431/526 [05:42<00:36,  2.59it/s]
 82%|████████▏ | 433/526 [05:42<00:26,  3.46it/s]
 83%|████████▎ | 435/526 [05:45<01:01,  1.48it/s]
 83%|████████▎ | 436/526 [05:46<01:06,  1.36it/s]
 83%|████████▎ | 438/526 [05:47<00:57,  1.52it/s]
 83%|████████▎ | 439/526 [05:48<01:00,  1.43it/s]
 84%|████████▎ | 440/526 [05:48<01:00,  1.43it/s]
 84%|████████▍ | 442/526 [05:49<00:44,  1.90it/s]
 84%|████████▍ | 444/526 [05:51<00:54,  1.51it/s]
 85%|████████▍ | 445/526 [05:52<01:11,  1.14it/s]
 85%|████████▍ | 446/526 [05:53<00:58,  1.36it/s]
 85%|████████▍ | 447/526 [05:53<00:51,  1.54it/s]
 85%|████████▌ | 448/526 [05:53<00:41,  1.88it/s]
 85%|████████▌ | 449/526 [05:53<00:32,  2.40it/s]
 86%|████████▌ | 451/526 [05:54<00:20,  3.58it/s]
 86%|████████▌ | 453/526 [05:54<00:14,  4.92it/s]
 86%|████████▋ | 454/526 [05:54<00:20,  3.52it/s]
 87%|████████▋ | 456/526 [05:55<00:15,  4.39it/s]
 87%|████████▋ | 458/526 [05:55<00:13,  5.07it/s]
 87%|████████▋ | 459/526 [05:55<00:13,  4.87it/s]
 87%|████████▋ | 460/526 [05:56<00:18,  3.51it/s]
 88%|████████▊ | 461/526 [05:56<00:16,  4.05it/s]
 88%|████████▊ | 462/526 [05:56<00:15,  4.19it/s]
 88%|████████▊ | 463/526 [05:56<00:17,  3.58it/s]
 88%|████████▊ | 465/526 [05:57<00:14,  4.29it/s]
 89%|████████▊ | 466/526 [05:57<00:16,  3.73it/s]
 89%|████████▉ | 467/526 [05:58<00:18,  3.19it/s]
 89%|████████▉ | 468/526 [05:58<00:15,  3.74it/s]
 89%|████████▉ | 470/526 [05:58<00:10,  5.21it/s]
 90%|████████▉ | 471/526 [05:58<00:09,  5.78it/s]
 90%|████████▉ | 472/526 [05:59<00:13,  4.12it/s]
 90%|█████████ | 474/526 [05:59<00:09,  5.77it/s]
 90%|█████████ | 475/526 [06:00<00:17,  2.99it/s]
 90%|█████████ | 476/526 [06:00<00:17,  2.85it/s]
 91%|█████████ | 478/526 [06:00<00:10,  4.37it/s]
 91%|█████████ | 479/526 [06:01<00:17,  2.65it/s]
 91%|█████████▏| 480/526 [06:01<00:17,  2.58it/s]
 91%|█████████▏| 481/526 [06:03<00:30,  1.47it/s]
 92%|█████████▏| 482/526 [06:03<00:25,  1.72it/s]
 92%|█████████▏| 483/526 [06:03<00:20,  2.05it/s]
 92%|█████████▏| 484/526 [06:04<00:17,  2.39it/s]
 92%|█████████▏| 485/526 [06:04<00:15,  2.68it/s]
 92%|█████████▏| 486/526 [06:04<00:12,  3.22it/s]
 93%|█████████▎| 487/526 [06:04<00:10,  3.57it/s]
 93%|█████████▎| 489/526 [06:05<00:07,  4.63it/s]
 93%|█████████▎| 490/526 [06:05<00:07,  4.68it/s]
 93%|█████████▎| 491/526 [06:05<00:11,  2.99it/s]
 94%|█████████▎| 493/526 [06:09<00:33,  1.01s/it]
 94%|█████████▍| 495/526 [06:10<00:21,  1.45it/s]
 94%|█████████▍| 496/526 [06:10<00:17,  1.73it/s]
 94%|█████████▍| 497/526 [06:11<00:20,  1.41it/s]
 95%|█████████▍| 498/526 [06:13<00:26,  1.05it/s]
 95%|█████████▍| 499/526 [06:15<00:32,  1.20s/it]
 95%|█████████▌| 500/526 [06:15<00:23,  1.09it/s]
 95%|█████████▌| 501/526 [06:15<00:18,  1.37it/s]
 96%|█████████▌| 503/526 [06:15<00:10,  2.18it/s]
 96%|█████████▌| 504/526 [06:15<00:09,  2.40it/s]
 96%|█████████▌| 505/526 [06:16<00:09,  2.29it/s]
 96%|█████████▌| 506/526 [06:16<00:07,  2.60it/s]
 96%|█████████▋| 507/526 [06:16<00:06,  3.13it/s]
 97%|█████████▋| 508/526 [06:17<00:06,  2.78it/s]
 97%|█████████▋| 510/526 [06:18<00:07,  2.22it/s]
 97%|█████████▋| 511/526 [06:19<00:07,  2.09it/s]
 97%|█████████▋| 512/526 [06:19<00:05,  2.48it/s]
 98%|█████████▊| 513/526 [06:20<00:06,  1.89it/s]
 98%|█████████▊| 514/526 [06:20<00:05,  2.07it/s]
 98%|█████████▊| 515/526 [06:20<00:05,  2.16it/s]
 98%|█████████▊| 516/526 [06:20<00:03,  2.68it/s]
 98%|█████████▊| 517/526 [06:21<00:03,  2.59it/s]
 98%|█████████▊| 518/526 [06:21<00:02,  2.80it/s]
 99%|█████████▊| 519/526 [06:21<00:02,  3.36it/s]
 99%|█████████▉| 520/526 [06:22<00:03,  1.93it/s]
 99%|█████████▉| 521/526 [06:23<00:01,  2.52it/s]
 99%|█████████▉| 522/526 [06:26<00:05,  1.32s/it]
 99%|█████████▉| 523/526 [06:29<00:05,  1.97s/it]
100%|█████████▉| 524/526 [06:33<00:04,  2.43s/it]
100%|█████████▉| 525/526 [06:33<00:01,  1.81s/it]
100%|██████████| 526/526 [06:37<00:00,  2.33s/it]
100%|██████████| 526/526 [06:37<00:00,  1.32it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:40:49.772730_lp_processed_test.json', '--output_addr', 'data/out/rag/full_profile/lp_rag_full_profile_test_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  2.87 examples/s]
Generating train split: 526 examples [00:00, 705.86 examples/s]
INFO 07-09 15:48:00 config.py:510] This model supports multiple tasks: {'reward', 'generate', 'score', 'embed', 'classify'}. Defaulting to 'generate'.
INFO 07-09 15:48:00 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:48:02 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:48:02 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:48:03 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.73it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.45it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.43it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.36it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.41it/s]

INFO 07-09 15:48:06 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 15:48:08 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-09 15:48:08 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 15:48:08 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 15:48:08 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 15:48:08 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 15:48:11 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.76it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.85it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:11,  2.88it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:10,  2.91it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.91it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:09,  2.92it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.93it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.94it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:08,  2.92it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.90it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.92it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  2.94it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:07,  2.95it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  2.96it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.96it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:06,  2.98it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  3.00it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  2.92it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:05,  2.96it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:04,  2.99it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  3.01it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:03,  3.02it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:03,  3.03it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  3.03it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:02,  3.04it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:09<00:02,  3.05it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  3.04it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:01,  3.04it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:10<00:01,  3.00it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  3.01it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:00,  3.03it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:11<00:00,  2.99it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  3.02it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  3.04it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  2.98it/s]
INFO 07-09 15:48:23 model_runner.py:1535] Graph capturing finished in 12 secs, took 0.22 GiB
INFO 07-09 15:48:23 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 17.13 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:13<2:01:05, 13.84s/it, est. speed input: 36.35 toks/s, output: 6.65 toks/s]
Processed prompts:   0%|          | 2/526 [00:14<52:10,  5.97s/it, est. speed input: 62.77 toks/s, output: 13.42 toks/s] 
Processed prompts:   1%|          | 3/526 [00:14<29:06,  3.34s/it, est. speed input: 103.08 toks/s, output: 20.33 toks/s]
Processed prompts:   1%|          | 5/526 [00:14<13:13,  1.52s/it, est. speed input: 150.34 toks/s, output: 34.05 toks/s]
Processed prompts:   1%|          | 6/526 [00:14<09:53,  1.14s/it, est. speed input: 171.57 toks/s, output: 40.82 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:15<06:05,  1.42it/s, est. speed input: 226.13 toks/s, output: 54.38 toks/s]
Processed prompts:   2%|▏         | 9/526 [00:15<05:00,  1.72it/s, est. speed input: 262.93 toks/s, output: 61.16 toks/s]
Processed prompts:   2%|▏         | 13/526 [00:15<02:23,  3.57it/s, est. speed input: 403.94 toks/s, output: 89.84 toks/s]
Processed prompts:   3%|▎         | 14/526 [00:15<02:16,  3.76it/s, est. speed input: 433.68 toks/s, output: 96.30 toks/s]
Processed prompts:   3%|▎         | 17/526 [00:16<01:27,  5.84it/s, est. speed input: 539.45 toks/s, output: 118.14 toks/s]
Processed prompts:   4%|▎         | 19/526 [00:16<01:14,  6.77it/s, est. speed input: 582.18 toks/s, output: 131.89 toks/s]
Processed prompts:   4%|▍         | 23/526 [00:16<00:54,  9.26it/s, est. speed input: 684.39 toks/s, output: 159.96 toks/s]
Processed prompts:   5%|▌         | 28/526 [00:16<00:42, 11.82it/s, est. speed input: 829.38 toks/s, output: 194.77 toks/s]
Processed prompts:   6%|▌         | 31/526 [00:17<00:40, 12.18it/s, est. speed input: 898.06 toks/s, output: 214.73 toks/s]
Processed prompts:   7%|▋         | 36/526 [00:17<00:37, 12.98it/s, est. speed input: 1017.46 toks/s, output: 247.87 toks/s]
Processed prompts:   8%|▊         | 40/526 [00:17<00:37, 12.88it/s, est. speed input: 1108.85 toks/s, output: 273.52 toks/s]
Processed prompts:   8%|▊         | 42/526 [00:17<00:36, 13.33it/s, est. speed input: 1145.90 toks/s, output: 286.68 toks/s]
Processed prompts:   9%|▊         | 45/526 [00:18<00:36, 13.14it/s, est. speed input: 1219.64 toks/s, output: 305.42 toks/s]
Processed prompts:   9%|▉         | 48/526 [00:18<00:37, 12.84it/s, est. speed input: 1301.06 toks/s, output: 323.76 toks/s]
Processed prompts:  10%|█         | 53/526 [00:18<00:31, 14.94it/s, est. speed input: 1452.56 toks/s, output: 356.58 toks/s]
Processed prompts:  10%|█         | 55/526 [00:18<00:32, 14.67it/s, est. speed input: 1495.49 toks/s, output: 368.75 toks/s]
Processed prompts:  11%|█         | 57/526 [00:18<00:30, 15.33it/s, est. speed input: 1546.90 toks/s, output: 381.62 toks/s]
Processed prompts:  11%|█         | 59/526 [00:19<00:37, 12.43it/s, est. speed input: 1575.89 toks/s, output: 391.23 toks/s]
Processed prompts:  12%|█▏        | 64/526 [00:19<00:28, 16.20it/s, est. speed input: 1747.86 toks/s, output: 424.17 toks/s]
Processed prompts:  13%|█▎        | 69/526 [00:19<00:28, 16.31it/s, est. speed input: 1859.49 toks/s, output: 454.19 toks/s]
Processed prompts:  14%|█▍        | 73/526 [00:19<00:28, 16.13it/s, est. speed input: 1992.57 toks/s, output: 477.68 toks/s]
Processed prompts:  15%|█▍        | 78/526 [00:20<00:27, 16.42it/s, est. speed input: 2106.21 toks/s, output: 507.27 toks/s]
Processed prompts:  16%|█▌        | 83/526 [00:20<00:25, 17.17it/s, est. speed input: 2206.48 toks/s, output: 537.09 toks/s]
Processed prompts:  17%|█▋        | 91/526 [00:20<00:23, 18.81it/s, est. speed input: 2352.45 toks/s, output: 585.61 toks/s]
Processed prompts:  18%|█▊        | 94/526 [00:20<00:21, 19.75it/s, est. speed input: 2422.22 toks/s, output: 604.15 toks/s]
Processed prompts:  18%|█▊        | 97/526 [00:21<00:23, 18.20it/s, est. speed input: 2486.85 toks/s, output: 619.87 toks/s]
Processed prompts:  19%|█▉        | 100/526 [00:21<00:25, 16.75it/s, est. speed input: 2542.54 toks/s, output: 635.13 toks/s]
Processed prompts:  21%|██        | 109/526 [00:21<00:22, 18.33it/s, est. speed input: 2754.78 toks/s, output: 687.10 toks/s]
Processed prompts:  21%|██▏       | 112/526 [00:21<00:21, 18.88it/s, est. speed input: 2810.40 toks/s, output: 704.44 toks/s]
Processed prompts:  22%|██▏       | 118/526 [00:22<00:22, 18.39it/s, est. speed input: 2944.56 toks/s, output: 736.56 toks/s]
Processed prompts:  24%|██▎       | 124/526 [00:22<00:19, 21.10it/s, est. speed input: 3089.75 toks/s, output: 772.77 toks/s]
Processed prompts:  24%|██▍       | 128/526 [00:22<00:20, 19.21it/s, est. speed input: 3139.66 toks/s, output: 792.12 toks/s]
Processed prompts:  26%|██▌       | 135/526 [00:23<00:19, 19.63it/s, est. speed input: 3274.88 toks/s, output: 829.82 toks/s]
Processed prompts:  26%|██▋       | 139/526 [00:23<00:21, 18.40it/s, est. speed input: 3342.34 toks/s, output: 848.74 toks/s]
Processed prompts:  28%|██▊       | 146/526 [00:23<00:18, 20.95it/s, est. speed input: 3491.95 toks/s, output: 888.89 toks/s]
Processed prompts:  29%|██▊       | 151/526 [00:23<00:19, 19.17it/s, est. speed input: 3582.38 toks/s, output: 912.00 toks/s]
Processed prompts:  29%|██▉       | 154/526 [00:24<00:18, 19.88it/s, est. speed input: 3649.43 toks/s, output: 928.21 toks/s]
Processed prompts:  30%|██▉       | 157/526 [00:24<00:20, 18.18it/s, est. speed input: 3683.07 toks/s, output: 940.87 toks/s]
Processed prompts:  30%|███       | 159/526 [00:24<00:22, 16.37it/s, est. speed input: 3717.38 toks/s, output: 947.91 toks/s]
Processed prompts:  31%|███       | 162/526 [00:24<00:21, 17.21it/s, est. speed input: 3795.47 toks/s, output: 963.18 toks/s]
Processed prompts:  31%|███▏      | 165/526 [00:24<00:22, 16.37it/s, est. speed input: 3846.28 toks/s, output: 976.15 toks/s]
Processed prompts:  32%|███▏      | 168/526 [00:24<00:19, 17.92it/s, est. speed input: 3890.93 toks/s, output: 992.17 toks/s]
Processed prompts:  32%|███▏      | 170/526 [00:25<00:22, 16.10it/s, est. speed input: 3927.58 toks/s, output: 999.39 toks/s]
Processed prompts:  34%|███▎      | 177/526 [00:25<00:19, 17.68it/s, est. speed input: 4077.95 toks/s, output: 1033.96 toks/s]
Processed prompts:  34%|███▍      | 181/526 [00:25<00:19, 17.97it/s, est. speed input: 4150.34 toks/s, output: 1053.15 toks/s]
Processed prompts:  35%|███▍      | 183/526 [00:25<00:22, 15.11it/s, est. speed input: 4171.13 toks/s, output: 1057.63 toks/s]
Processed prompts:  36%|███▌      | 187/526 [00:26<00:24, 14.10it/s, est. speed input: 4199.63 toks/s, output: 1072.47 toks/s]
Processed prompts:  37%|███▋      | 192/526 [00:26<00:24, 13.61it/s, est. speed input: 4248.79 toks/s, output: 1091.46 toks/s]
Processed prompts:  37%|███▋      | 197/526 [00:26<00:23, 13.78it/s, est. speed input: 4368.59 toks/s, output: 1111.85 toks/s]
Processed prompts:  38%|███▊      | 200/526 [00:27<00:21, 15.24it/s, est. speed input: 4421.52 toks/s, output: 1127.52 toks/s]
Processed prompts:  38%|███▊      | 202/526 [00:27<00:23, 13.94it/s, est. speed input: 4440.90 toks/s, output: 1133.27 toks/s]
Processed prompts:  39%|███▉      | 205/526 [00:27<00:27, 11.64it/s, est. speed input: 4448.59 toks/s, output: 1139.07 toks/s]
Processed prompts:  39%|███▉      | 207/526 [00:27<00:31, 10.23it/s, est. speed input: 4449.14 toks/s, output: 1141.41 toks/s]
Processed prompts:  40%|████      | 211/526 [00:28<00:26, 12.02it/s, est. speed input: 4540.52 toks/s, output: 1159.73 toks/s]
Processed prompts:  41%|████      | 215/526 [00:28<00:24, 12.84it/s, est. speed input: 4588.05 toks/s, output: 1176.42 toks/s]
Processed prompts:  41%|████▏     | 218/526 [00:28<00:24, 12.81it/s, est. speed input: 4612.61 toks/s, output: 1187.59 toks/s]
Processed prompts:  42%|████▏     | 220/526 [00:28<00:23, 13.09it/s, est. speed input: 4635.02 toks/s, output: 1195.73 toks/s]
Processed prompts:  42%|████▏     | 222/526 [00:29<00:26, 11.51it/s, est. speed input: 4641.87 toks/s, output: 1199.54 toks/s]
Processed prompts:  43%|████▎     | 224/526 [00:29<00:23, 12.65it/s, est. speed input: 4674.01 toks/s, output: 1209.00 toks/s]
Processed prompts:  43%|████▎     | 228/526 [00:29<00:22, 13.43it/s, est. speed input: 4712.72 toks/s, output: 1225.61 toks/s]
Processed prompts:  44%|████▎     | 230/526 [00:29<00:23, 12.68it/s, est. speed input: 4741.96 toks/s, output: 1231.78 toks/s]
Processed prompts:  44%|████▍     | 233/526 [00:29<00:26, 10.90it/s, est. speed input: 4803.54 toks/s, output: 1238.12 toks/s]
Processed prompts:  45%|████▍     | 235/526 [00:30<00:29,  9.97it/s, est. speed input: 4801.55 toks/s, output: 1241.86 toks/s]
Processed prompts:  45%|████▌     | 237/526 [00:30<00:27, 10.70it/s, est. speed input: 4823.26 toks/s, output: 1250.08 toks/s]
Processed prompts:  45%|████▌     | 239/526 [00:30<00:30,  9.55it/s, est. speed input: 4827.86 toks/s, output: 1253.34 toks/s]
Processed prompts:  46%|████▌     | 241/526 [00:30<00:34,  8.22it/s, est. speed input: 4814.56 toks/s, output: 1254.22 toks/s]
Processed prompts:  46%|████▌     | 242/526 [00:31<00:36,  7.83it/s, est. speed input: 4812.75 toks/s, output: 1255.08 toks/s]
Processed prompts:  46%|████▌     | 243/526 [00:31<00:38,  7.36it/s, est. speed input: 4799.16 toks/s, output: 1255.46 toks/s]
Processed prompts:  46%|████▋     | 244/526 [00:31<00:45,  6.21it/s, est. speed input: 4786.89 toks/s, output: 1252.68 toks/s]
Processed prompts:  47%|████▋     | 245/526 [00:32<01:06,  4.25it/s, est. speed input: 4731.88 toks/s, output: 1241.39 toks/s]
Processed prompts:  47%|████▋     | 246/526 [00:32<01:03,  4.41it/s, est. speed input: 4715.59 toks/s, output: 1237.19 toks/s]
Processed prompts:  47%|████▋     | 247/526 [00:32<01:09,  4.01it/s, est. speed input: 4687.07 toks/s, output: 1229.56 toks/s]
Processed prompts:  47%|████▋     | 248/526 [00:32<01:14,  3.75it/s, est. speed input: 4661.70 toks/s, output: 1220.75 toks/s]
Processed prompts:  47%|████▋     | 249/526 [00:33<01:08,  4.05it/s, est. speed input: 4644.98 toks/s, output: 1217.33 toks/s]
Processed prompts:  48%|████▊     | 251/526 [00:33<00:54,  5.00it/s, est. speed input: 4665.39 toks/s, output: 1218.78 toks/s]
Processed prompts:  48%|████▊     | 255/526 [00:33<00:42,  6.42it/s, est. speed input: 4673.31 toks/s, output: 1217.03 toks/s]
Processed prompts:  49%|████▉     | 258/526 [00:33<00:29,  9.05it/s, est. speed input: 4699.48 toks/s, output: 1224.56 toks/s]
Processed prompts:  49%|████▉     | 260/526 [00:34<00:28,  9.47it/s, est. speed input: 4730.20 toks/s, output: 1226.93 toks/s]
Processed prompts:  50%|████▉     | 262/526 [00:34<00:27,  9.68it/s, est. speed input: 4737.70 toks/s, output: 1227.63 toks/s]
Processed prompts:  50%|█████     | 264/526 [00:34<00:29,  8.89it/s, est. speed input: 4731.56 toks/s, output: 1226.31 toks/s]
Processed prompts:  51%|█████     | 266/526 [00:34<00:33,  7.87it/s, est. speed input: 4725.47 toks/s, output: 1223.07 toks/s]
Processed prompts:  51%|█████     | 268/526 [00:35<00:33,  7.80it/s, est. speed input: 4726.21 toks/s, output: 1225.63 toks/s]
Processed prompts:  51%|█████▏    | 270/526 [00:35<00:30,  8.42it/s, est. speed input: 4753.04 toks/s, output: 1226.33 toks/s]
Processed prompts:  52%|█████▏    | 272/526 [00:35<00:27,  9.28it/s, est. speed input: 4761.76 toks/s, output: 1229.18 toks/s]
Processed prompts:  52%|█████▏    | 275/526 [00:35<00:20, 12.54it/s, est. speed input: 4803.78 toks/s, output: 1238.41 toks/s]
Processed prompts:  53%|█████▎    | 279/526 [00:35<00:16, 14.65it/s, est. speed input: 4854.85 toks/s, output: 1246.68 toks/s]
Processed prompts:  53%|█████▎    | 281/526 [00:35<00:17, 14.14it/s, est. speed input: 4870.26 toks/s, output: 1248.41 toks/s]
Processed prompts:  54%|█████▍    | 285/526 [00:36<00:12, 18.89it/s, est. speed input: 4921.50 toks/s, output: 1265.26 toks/s]
Processed prompts:  55%|█████▍    | 289/526 [00:36<00:10, 23.19it/s, est. speed input: 4990.40 toks/s, output: 1276.43 toks/s]
Processed prompts:  56%|█████▌    | 293/526 [00:36<00:08, 26.90it/s, est. speed input: 5054.44 toks/s, output: 1288.80 toks/s]
Processed prompts:  57%|█████▋    | 300/526 [00:36<00:06, 37.41it/s, est. speed input: 5158.91 toks/s, output: 1313.25 toks/s]
Processed prompts:  58%|█████▊    | 305/526 [00:36<00:10, 20.69it/s, est. speed input: 5179.10 toks/s, output: 1317.31 toks/s]
Processed prompts:  59%|█████▊    | 309/526 [00:37<00:10, 20.54it/s, est. speed input: 5239.28 toks/s, output: 1335.56 toks/s]
Processed prompts:  61%|██████    | 321/526 [00:37<00:05, 34.55it/s, est. speed input: 5416.86 toks/s, output: 1380.74 toks/s]
Processed prompts:  62%|██████▏   | 328/526 [00:37<00:05, 38.53it/s, est. speed input: 5515.00 toks/s, output: 1410.17 toks/s]
Processed prompts:  64%|██████▎   | 335/526 [00:37<00:04, 42.05it/s, est. speed input: 5612.92 toks/s, output: 1434.79 toks/s]
Processed prompts:  65%|██████▌   | 343/526 [00:37<00:03, 47.17it/s, est. speed input: 5719.93 toks/s, output: 1467.43 toks/s]
Processed prompts:  68%|██████▊   | 356/526 [00:37<00:02, 62.17it/s, est. speed input: 5903.05 toks/s, output: 1517.71 toks/s]
Processed prompts:  70%|██████▉   | 366/526 [00:37<00:02, 67.85it/s, est. speed input: 6053.90 toks/s, output: 1553.08 toks/s]
Processed prompts:  71%|███████   | 374/526 [00:37<00:02, 68.05it/s, est. speed input: 6182.20 toks/s, output: 1582.89 toks/s]
Processed prompts:  73%|███████▎  | 383/526 [00:38<00:02, 65.22it/s, est. speed input: 6309.81 toks/s, output: 1613.78 toks/s]
Processed prompts:  74%|███████▍  | 390/526 [00:38<00:02, 59.50it/s, est. speed input: 6432.09 toks/s, output: 1636.74 toks/s]
Processed prompts:  76%|███████▌  | 398/526 [00:38<00:02, 62.99it/s, est. speed input: 6556.80 toks/s, output: 1665.47 toks/s]
Processed prompts:  77%|███████▋  | 405/526 [00:38<00:01, 60.59it/s, est. speed input: 6668.44 toks/s, output: 1690.72 toks/s]
Processed prompts:  79%|███████▉  | 417/526 [00:38<00:01, 71.02it/s, est. speed input: 6856.28 toks/s, output: 1739.19 toks/s]
Processed prompts:  81%|████████  | 425/526 [00:38<00:01, 70.18it/s, est. speed input: 6976.27 toks/s, output: 1769.63 toks/s]
Processed prompts:  82%|████████▏ | 433/526 [00:38<00:01, 70.31it/s, est. speed input: 7111.53 toks/s, output: 1807.03 toks/s]
Processed prompts:  84%|████████▍ | 441/526 [00:39<00:01, 53.03it/s, est. speed input: 7219.45 toks/s, output: 1831.23 toks/s]
Processed prompts:  85%|████████▍ | 447/526 [00:39<00:01, 46.31it/s, est. speed input: 7325.73 toks/s, output: 1851.86 toks/s]
Processed prompts:  87%|████████▋ | 455/526 [00:39<00:01, 50.57it/s, est. speed input: 7459.65 toks/s, output: 1881.83 toks/s]
Processed prompts:  88%|████████▊ | 462/526 [00:39<00:01, 52.58it/s, est. speed input: 7582.73 toks/s, output: 1907.11 toks/s]
Processed prompts:  89%|████████▉ | 468/526 [00:39<00:01, 52.59it/s, est. speed input: 7659.98 toks/s, output: 1934.11 toks/s]
Processed prompts:  90%|█████████ | 474/526 [00:39<00:01, 48.20it/s, est. speed input: 7741.44 toks/s, output: 1962.29 toks/s]
Processed prompts:  91%|█████████▏| 481/526 [00:39<00:00, 50.46it/s, est. speed input: 7900.15 toks/s, output: 1993.94 toks/s]
Processed prompts:  93%|█████████▎| 487/526 [00:40<00:01, 31.69it/s, est. speed input: 7955.85 toks/s, output: 2002.22 toks/s]
Processed prompts:  94%|█████████▎| 492/526 [00:40<00:01, 30.18it/s, est. speed input: 7985.81 toks/s, output: 2024.16 toks/s]
Processed prompts:  94%|█████████▍| 496/526 [00:40<00:01, 29.00it/s, est. speed input: 8046.41 toks/s, output: 2034.70 toks/s]
Processed prompts:  95%|█████████▌| 500/526 [00:40<00:00, 28.38it/s, est. speed input: 8090.85 toks/s, output: 2044.97 toks/s]
Processed prompts:  97%|█████████▋| 508/526 [00:40<00:00, 32.74it/s, est. speed input: 8211.48 toks/s, output: 2076.50 toks/s]
Processed prompts:  97%|█████████▋| 512/526 [00:41<00:00, 25.26it/s, est. speed input: 8236.40 toks/s, output: 2084.27 toks/s]
Processed prompts:  98%|█████████▊| 515/526 [00:41<00:00, 22.25it/s, est. speed input: 8264.00 toks/s, output: 2093.88 toks/s]
Processed prompts:  98%|█████████▊| 518/526 [00:41<00:00, 20.26it/s, est. speed input: 8280.92 toks/s, output: 2103.11 toks/s]
Processed prompts:  99%|█████████▉| 521/526 [00:42<00:00,  9.96it/s, est. speed input: 8199.40 toks/s, output: 2088.51 toks/s]
Processed prompts:  99%|█████████▉| 523/526 [00:42<00:00,  8.81it/s, est. speed input: 8181.77 toks/s, output: 2089.30 toks/s]
Processed prompts: 100%|█████████▉| 525/526 [00:43<00:00,  6.93it/s, est. speed input: 8123.22 toks/s, output: 2084.92 toks/s]
Processed prompts: 100%|██████████| 526/526 [00:43<00:00, 12.02it/s, est. speed input: 8072.98 toks/s, output: 2074.90 toks/s]
{  "personalized_answer": "It sounds like you've been quite the inquisitive gardener, always seeking answers and solutions for your plants. Given your interest in understanding the nuances of plant care and health, it seems like you're looking for a detailed approach to revive your overwatered Duranta plants. While it's challenging to revive plants that have been overwatered, especially if they've been "rain soaked," there are steps you can take. First, ensure the soil is well-draining and remove any standing water. Allow the soil to dry out slightly before watering again. Pruning any damaged or dead parts of the plant can also help. Additionally, consider repotting the plant into a larger pot with fresh soil to give it more room to grow. Keep an eye on the plant's health and adjust your care routine based on its response. Remember, patience is key in this process, as it may take some time to see improvement. If the plant shows no signs of recovery, it might be best to let it go and focus on nurturing new plants. "}
Invalid JSON
{  "personalized_answer": "When conveying a character's race or ethnicity, it's important to do so in a way that feels natural and appropriate for the context. Here are a few suggestions based on your previous questions and preferences:\n\n1. **Direct Description**: You can directly describe the character's appearance or background. For example, 'John, with his dark skin and curly hair, walked into the room.' This approach is clear and straightforward.\n\n2. **Contextual Clues**: Use the context of the story to hint at the character's background. For example, 'John, known for his vibrant cultural festivals, was the first to arrive at the celebration.' This method adds depth without being overly explicit.\n\n3. **Character Dialogue**: Have the character mention their background in dialogue. For example, 'John said, "I'm from the Caribbean, so I love these kinds of events." ' This can be a subtle way to reveal information.\n\n4. **Avoid Stereotypes**: Be mindful of avoiding stereotypes or clichés. Instead, focus on unique traits or experiences that are specific to the character.\n\n5. **Consistency**: Ensure that the character's race or ethnicity is consistent throughout the story, unless there's a specific reason for it to change.\n\nBy using these methods, you can convey a character's race or ethnicity clearly and appropriately, enhancing the richness of your narrative."}
Invalid JSON
None

Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  50%|█████     | 1/2 [00:01<00:01,  1.93s/it, est. speed input: 472.41 toks/s, output: 76.66 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:01<00:00,  1.00it/s, est. speed input: 812.41 toks/s, output: 151.23 toks/s]
[rank0]:[W709 15:49:11.209526237 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/lp_rag_full_profile_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:49:15.772078_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:49:15.772078_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:49:15.772078_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<03:04,  2.30it/s]
  0%|          | 2/424 [00:01<05:08,  1.37it/s]
  1%|          | 3/424 [00:01<03:09,  2.23it/s]
  1%|          | 4/424 [00:03<06:41,  1.05it/s]
  1%|          | 5/424 [00:03<04:56,  1.41it/s]
  2%|▏         | 7/424 [00:04<04:12,  1.65it/s]
  2%|▏         | 8/424 [00:05<04:15,  1.63it/s]
  2%|▏         | 9/424 [00:05<03:18,  2.09it/s]
  2%|▏         | 10/424 [00:05<02:56,  2.35it/s]
  3%|▎         | 11/424 [00:05<02:24,  2.86it/s]
  3%|▎         | 12/424 [00:06<02:18,  2.98it/s]
  3%|▎         | 13/424 [00:07<05:15,  1.30it/s]
  3%|▎         | 14/424 [00:07<04:03,  1.68it/s]
  4%|▎         | 15/424 [00:08<03:17,  2.07it/s]
  4%|▍         | 16/424 [00:08<03:29,  1.94it/s]
  4%|▍         | 17/424 [00:09<03:01,  2.25it/s]
  4%|▍         | 18/424 [00:09<02:36,  2.60it/s]
  4%|▍         | 19/424 [00:09<03:03,  2.20it/s]
  5%|▍         | 20/424 [00:10<02:30,  2.68it/s]
  5%|▍         | 21/424 [00:10<02:02,  3.29it/s]
  5%|▌         | 22/424 [00:10<02:44,  2.45it/s]
  5%|▌         | 23/424 [00:12<04:55,  1.36it/s]
  6%|▌         | 24/424 [00:13<04:42,  1.42it/s]
  6%|▌         | 25/424 [00:14<05:12,  1.28it/s]
  6%|▌         | 26/424 [00:14<04:52,  1.36it/s]
  6%|▋         | 27/424 [00:16<06:52,  1.04s/it]
  7%|▋         | 28/424 [00:17<06:03,  1.09it/s]
  7%|▋         | 29/424 [00:17<04:46,  1.38it/s]
  7%|▋         | 30/424 [00:17<03:43,  1.77it/s]
  7%|▋         | 31/424 [00:18<03:49,  1.71it/s]
  8%|▊         | 33/424 [00:18<02:16,  2.87it/s]
  8%|▊         | 34/424 [00:18<02:08,  3.03it/s]
  8%|▊         | 36/424 [00:18<01:26,  4.51it/s]
  9%|▊         | 37/424 [00:19<02:13,  2.91it/s]
  9%|▉         | 38/424 [00:19<02:07,  3.04it/s]
  9%|▉         | 40/424 [00:20<01:36,  3.99it/s]
 10%|▉         | 41/424 [00:20<01:36,  3.96it/s]
 10%|▉         | 42/424 [00:20<02:13,  2.87it/s]
 10%|█         | 43/424 [00:21<01:52,  3.37it/s]
 10%|█         | 44/424 [00:22<04:16,  1.48it/s]
 11%|█         | 45/424 [00:23<04:11,  1.50it/s]
 11%|█         | 46/424 [00:23<03:29,  1.81it/s]
 11%|█         | 47/424 [00:24<03:37,  1.74it/s]
 11%|█▏        | 48/424 [00:24<03:46,  1.66it/s]
 12%|█▏        | 49/424 [00:25<03:48,  1.64it/s]
 12%|█▏        | 51/424 [00:26<03:00,  2.06it/s]
 12%|█▏        | 52/424 [00:26<02:59,  2.07it/s]
 12%|█▎        | 53/424 [00:27<03:12,  1.93it/s]
 13%|█▎        | 54/424 [00:28<03:51,  1.60it/s]
 13%|█▎        | 55/424 [00:28<03:13,  1.90it/s]
 13%|█▎        | 56/424 [00:29<03:24,  1.80it/s]
 14%|█▎        | 58/424 [00:29<02:03,  2.96it/s]
 14%|█▍        | 59/424 [00:31<04:04,  1.50it/s]
 15%|█▍        | 62/424 [00:34<05:26,  1.11it/s]
 15%|█▍        | 63/424 [00:35<05:07,  1.18it/s]
 15%|█▌        | 64/424 [00:35<04:21,  1.38it/s]
 15%|█▌        | 65/424 [00:35<03:27,  1.73it/s]
 16%|█▌        | 66/424 [00:37<05:08,  1.16it/s]
 16%|█▌        | 67/424 [00:37<04:06,  1.45it/s]
 16%|█▌        | 68/424 [00:37<03:55,  1.51it/s]
 16%|█▋        | 69/424 [00:39<05:36,  1.05it/s]
 17%|█▋        | 70/424 [00:39<04:34,  1.29it/s]
 17%|█▋        | 71/424 [00:40<03:50,  1.53it/s]
 17%|█▋        | 72/424 [00:40<03:19,  1.77it/s]
 17%|█▋        | 73/424 [00:41<02:56,  1.99it/s]
 17%|█▋        | 74/424 [00:41<02:38,  2.20it/s]
 18%|█▊        | 75/424 [00:43<05:25,  1.07it/s]
 18%|█▊        | 77/424 [00:43<03:27,  1.67it/s]
 18%|█▊        | 78/424 [00:43<02:48,  2.06it/s]
 19%|█▊        | 79/424 [00:44<02:12,  2.60it/s]
 19%|█▉        | 80/424 [00:44<01:45,  3.25it/s]
 19%|█▉        | 81/424 [00:45<02:39,  2.15it/s]
 19%|█▉        | 82/424 [00:45<03:13,  1.77it/s]
 20%|█▉        | 83/424 [00:46<03:57,  1.44it/s]
 20%|█▉        | 84/424 [00:46<02:58,  1.91it/s]
 20%|██        | 85/424 [00:48<03:48,  1.48it/s]
 20%|██        | 86/424 [00:48<04:09,  1.35it/s]
 21%|██        | 87/424 [00:49<04:36,  1.22it/s]
 21%|██        | 88/424 [00:50<03:51,  1.45it/s]
 21%|██        | 89/424 [00:51<04:23,  1.27it/s]
 21%|██        | 90/424 [00:51<03:23,  1.64it/s]
 21%|██▏       | 91/424 [00:52<04:06,  1.35it/s]
 22%|██▏       | 92/424 [00:53<04:34,  1.21it/s]
 22%|██▏       | 93/424 [00:54<04:13,  1.31it/s]
 22%|██▏       | 94/424 [00:55<04:35,  1.20it/s]
 22%|██▏       | 95/424 [00:55<03:25,  1.60it/s]
 23%|██▎       | 96/424 [00:55<02:57,  1.85it/s]
 23%|██▎       | 98/424 [00:55<01:48,  3.01it/s]
 23%|██▎       | 99/424 [00:56<01:34,  3.45it/s]
 24%|██▎       | 100/424 [00:56<01:58,  2.73it/s]
 24%|██▍       | 101/424 [00:57<03:26,  1.57it/s]
 24%|██▍       | 102/424 [00:58<02:55,  1.84it/s]
 24%|██▍       | 103/424 [00:58<02:26,  2.19it/s]
 25%|██▍       | 104/424 [00:58<02:01,  2.64it/s]
 25%|██▍       | 105/424 [00:59<02:28,  2.15it/s]
 25%|██▌       | 106/424 [00:59<01:55,  2.75it/s]
 25%|██▌       | 107/424 [01:00<02:24,  2.20it/s]
 26%|██▌       | 109/424 [01:03<05:33,  1.06s/it]
 26%|██▌       | 110/424 [01:05<06:23,  1.22s/it]
 26%|██▌       | 111/424 [01:05<05:26,  1.04s/it]
 26%|██▋       | 112/424 [01:06<04:07,  1.26it/s]
 27%|██▋       | 114/424 [01:06<02:27,  2.10it/s]
 27%|██▋       | 116/424 [01:06<01:43,  2.97it/s]
 28%|██▊       | 117/424 [01:06<01:28,  3.49it/s]
 28%|██▊       | 118/424 [01:06<01:20,  3.81it/s]
 28%|██▊       | 119/424 [01:06<01:15,  4.05it/s]
 29%|██▊       | 121/424 [01:07<01:00,  5.01it/s]
 29%|██▉       | 122/424 [01:14<08:44,  1.74s/it]
 29%|██▉       | 123/424 [01:21<15:13,  3.03s/it]
 29%|██▉       | 124/424 [01:28<20:19,  4.07s/it]
 29%|██▉       | 125/424 [01:34<24:08,  4.84s/it]
 30%|██▉       | 126/424 [01:42<27:06,  5.46s/it]
 30%|██▉       | 127/424 [01:49<29:14,  5.91s/it]
 30%|███       | 128/424 [01:50<22:06,  4.48s/it]
 30%|███       | 129/424 [01:50<16:55,  3.44s/it]
 31%|███       | 130/424 [01:51<13:14,  2.70s/it]
 31%|███       | 131/424 [01:52<10:43,  2.20s/it]
 31%|███       | 132/424 [01:53<08:12,  1.69s/it]
 31%|███▏      | 133/424 [01:54<06:42,  1.38s/it]
 32%|███▏      | 134/424 [01:54<04:51,  1.01s/it]
 32%|███▏      | 135/424 [01:54<03:39,  1.32it/s]
 32%|███▏      | 136/424 [01:54<02:49,  1.70it/s]
 32%|███▏      | 137/424 [01:54<02:15,  2.12it/s]
 33%|███▎      | 138/424 [01:54<01:50,  2.60it/s]
 33%|███▎      | 139/424 [01:55<01:32,  3.07it/s]
 33%|███▎      | 140/424 [01:55<01:14,  3.80it/s]
 33%|███▎      | 141/424 [01:55<01:07,  4.21it/s]
 33%|███▎      | 142/424 [01:55<01:03,  4.44it/s]
 34%|███▎      | 143/424 [01:55<01:00,  4.65it/s]
 34%|███▍      | 144/424 [01:55<00:58,  4.81it/s]
 34%|███▍      | 145/424 [01:56<00:55,  5.06it/s]
 34%|███▍      | 146/424 [01:56<00:53,  5.20it/s]
 35%|███▍      | 147/424 [01:56<00:52,  5.26it/s]
 35%|███▍      | 148/424 [01:56<00:52,  5.30it/s]
 35%|███▌      | 149/424 [01:56<00:51,  5.32it/s]
 35%|███▌      | 150/424 [01:57<00:51,  5.29it/s]
 36%|███▌      | 151/424 [01:57<00:51,  5.26it/s]
 36%|███▌      | 152/424 [01:57<00:51,  5.30it/s]
 36%|███▌      | 153/424 [01:57<00:51,  5.30it/s]
 36%|███▋      | 154/424 [01:57<00:50,  5.33it/s]
 37%|███▋      | 155/424 [01:58<00:50,  5.31it/s]
 37%|███▋      | 156/424 [01:58<00:50,  5.31it/s]
 37%|███▋      | 157/424 [01:58<00:50,  5.29it/s]
 37%|███▋      | 158/424 [01:58<00:50,  5.31it/s]
 38%|███▊      | 159/424 [01:58<00:49,  5.30it/s]
 38%|███▊      | 160/424 [02:00<03:06,  1.42it/s]
 38%|███▊      | 161/424 [02:00<02:24,  1.82it/s]
 38%|███▊      | 162/424 [02:01<01:56,  2.25it/s]
 38%|███▊      | 163/424 [02:01<01:35,  2.73it/s]
 39%|███▊      | 164/424 [02:01<01:21,  3.17it/s]
 39%|███▉      | 165/424 [02:01<01:11,  3.61it/s]
 39%|███▉      | 166/424 [02:01<00:59,  4.33it/s]
 39%|███▉      | 167/424 [02:01<00:56,  4.54it/s]
 40%|███▉      | 168/424 [02:02<01:04,  3.96it/s]
 40%|███▉      | 169/424 [02:02<01:11,  3.55it/s]
 40%|████      | 170/424 [02:02<01:14,  3.41it/s]
 40%|████      | 171/424 [02:03<01:25,  2.96it/s]
 41%|████      | 172/424 [02:03<01:09,  3.63it/s]
 41%|████      | 174/424 [02:04<01:30,  2.76it/s]
 41%|████▏     | 175/424 [02:04<01:15,  3.31it/s]
 42%|████▏     | 176/424 [02:04<01:05,  3.77it/s]
 42%|████▏     | 177/424 [02:04<00:58,  4.22it/s]
 42%|████▏     | 178/424 [02:05<01:04,  3.80it/s]
 42%|████▏     | 179/424 [02:05<01:03,  3.85it/s]
 42%|████▏     | 180/424 [02:05<01:13,  3.33it/s]
 43%|████▎     | 181/424 [02:06<01:02,  3.89it/s]
 43%|████▎     | 182/424 [02:06<00:59,  4.04it/s]
 43%|████▎     | 183/424 [02:06<00:58,  4.10it/s]
 43%|████▎     | 184/424 [02:07<01:20,  2.99it/s]
 44%|████▎     | 185/424 [02:07<01:41,  2.36it/s]
 44%|████▍     | 186/424 [02:08<01:45,  2.25it/s]
 44%|████▍     | 187/424 [02:08<01:39,  2.37it/s]
 44%|████▍     | 188/424 [02:08<01:37,  2.41it/s]
 45%|████▍     | 189/424 [02:10<03:04,  1.28it/s]
 45%|████▍     | 190/424 [02:14<07:06,  1.82s/it]
 45%|████▌     | 191/424 [02:15<05:25,  1.40s/it]
 45%|████▌     | 192/424 [02:16<05:46,  1.50s/it]
 46%|████▌     | 194/424 [02:17<03:31,  1.09it/s]
 46%|████▌     | 196/424 [02:18<02:34,  1.47it/s]
 46%|████▋     | 197/424 [02:18<02:14,  1.69it/s]
 47%|████▋     | 198/424 [02:18<01:53,  2.00it/s]
 47%|████▋     | 199/424 [02:19<02:09,  1.73it/s]
 47%|████▋     | 200/424 [02:19<01:48,  2.06it/s]
 47%|████▋     | 201/424 [02:21<03:03,  1.21it/s]
 48%|████▊     | 202/424 [02:21<02:23,  1.55it/s]
 48%|████▊     | 203/424 [02:23<03:33,  1.03it/s]
 48%|████▊     | 204/424 [02:26<06:03,  1.65s/it]
 48%|████▊     | 205/424 [02:27<04:51,  1.33s/it]
 49%|████▊     | 206/424 [02:30<06:48,  1.87s/it]
 49%|████▉     | 207/424 [02:30<05:05,  1.41s/it]
 49%|████▉     | 208/424 [02:30<03:55,  1.09s/it]
 49%|████▉     | 209/424 [02:31<02:56,  1.22it/s]
 50%|████▉     | 210/424 [02:31<02:23,  1.49it/s]
 50%|█████     | 212/424 [02:31<01:25,  2.49it/s]
 50%|█████     | 213/424 [02:32<01:32,  2.27it/s]
 50%|█████     | 214/424 [02:32<01:40,  2.09it/s]
 51%|█████     | 215/424 [02:33<02:02,  1.71it/s]
 51%|█████     | 216/424 [02:33<01:37,  2.14it/s]
 51%|█████     | 217/424 [02:34<01:21,  2.52it/s]
 51%|█████▏    | 218/424 [02:34<01:15,  2.73it/s]
 52%|█████▏    | 219/424 [02:34<01:09,  2.94it/s]
 52%|█████▏    | 220/424 [02:35<01:42,  2.00it/s]
 52%|█████▏    | 221/424 [02:35<01:31,  2.23it/s]
 52%|█████▏    | 222/424 [02:36<01:23,  2.43it/s]
 53%|█████▎    | 223/424 [02:36<01:15,  2.68it/s]
 53%|█████▎    | 224/424 [02:36<01:11,  2.80it/s]
 53%|█████▎    | 225/424 [02:38<02:26,  1.36it/s]
 54%|█████▎    | 227/424 [02:38<01:35,  2.06it/s]
 54%|█████▍    | 229/424 [02:38<01:05,  2.98it/s]
 54%|█████▍    | 230/424 [02:42<03:13,  1.00it/s]
 54%|█████▍    | 231/424 [02:42<02:52,  1.12it/s]
 55%|█████▍    | 232/424 [02:42<02:12,  1.45it/s]
 55%|█████▍    | 233/424 [02:44<03:04,  1.03it/s]
 55%|█████▌    | 234/424 [02:51<08:31,  2.69s/it]
 55%|█████▌    | 235/424 [02:52<06:50,  2.17s/it]
 56%|█████▌    | 236/424 [02:53<05:11,  1.65s/it]
 56%|█████▌    | 238/424 [02:53<02:55,  1.06it/s]
 57%|█████▋    | 240/424 [02:55<02:49,  1.08it/s]
 57%|█████▋    | 241/424 [02:55<02:46,  1.10it/s]
 57%|█████▋    | 242/424 [02:56<02:12,  1.37it/s]
 57%|█████▋    | 243/424 [02:56<01:56,  1.55it/s]
 58%|█████▊    | 244/424 [02:57<01:57,  1.53it/s]
 58%|█████▊    | 245/424 [02:57<01:30,  1.97it/s]
 58%|█████▊    | 246/424 [02:57<01:21,  2.19it/s]
 58%|█████▊    | 247/424 [02:59<02:23,  1.24it/s]
 58%|█████▊    | 248/424 [02:59<01:47,  1.64it/s]
 59%|█████▊    | 249/424 [02:59<01:21,  2.15it/s]
 59%|█████▉    | 250/424 [03:00<01:31,  1.90it/s]
 59%|█████▉    | 251/424 [03:00<01:13,  2.36it/s]
 59%|█████▉    | 252/424 [03:00<00:57,  3.00it/s]
 60%|█████▉    | 253/424 [03:00<00:46,  3.71it/s]
 60%|█████▉    | 254/424 [03:00<00:37,  4.48it/s]
 60%|██████    | 255/424 [03:00<00:31,  5.28it/s]
 60%|██████    | 256/424 [03:00<00:28,  5.91it/s]
 61%|██████    | 257/424 [03:01<00:25,  6.50it/s]
 61%|██████    | 258/424 [03:01<00:23,  6.93it/s]
 61%|██████    | 259/424 [03:01<00:31,  5.24it/s]
 61%|██████▏   | 260/424 [03:02<01:09,  2.36it/s]
 62%|██████▏   | 261/424 [03:02<00:53,  3.04it/s]
 62%|██████▏   | 263/424 [03:03<01:07,  2.37it/s]
 62%|██████▏   | 264/424 [03:03<00:55,  2.89it/s]
 62%|██████▎   | 265/424 [03:03<00:44,  3.54it/s]
 63%|██████▎   | 266/424 [03:04<00:49,  3.21it/s]
 63%|██████▎   | 267/424 [03:04<00:40,  3.88it/s]
 63%|██████▎   | 268/424 [03:04<00:34,  4.57it/s]
 63%|██████▎   | 269/424 [03:05<01:07,  2.31it/s]
 64%|██████▎   | 270/424 [03:05<00:52,  2.93it/s]
 64%|██████▍   | 272/424 [03:05<00:33,  4.53it/s]
 64%|██████▍   | 273/424 [03:05<00:32,  4.62it/s]
 65%|██████▍   | 275/424 [03:06<00:22,  6.52it/s]
 65%|██████▌   | 277/424 [03:06<00:18,  7.81it/s]
 66%|██████▌   | 279/424 [03:07<00:42,  3.45it/s]
 66%|██████▌   | 280/424 [03:07<00:45,  3.18it/s]
 66%|██████▋   | 281/424 [03:08<00:47,  2.98it/s]
 67%|██████▋   | 283/424 [03:11<02:00,  1.17it/s]
 67%|██████▋   | 284/424 [03:11<01:37,  1.43it/s]
 67%|██████▋   | 285/424 [03:11<01:17,  1.78it/s]
 68%|██████▊   | 287/424 [03:12<00:58,  2.34it/s]
 68%|██████▊   | 288/424 [03:12<00:56,  2.42it/s]
 68%|██████▊   | 289/424 [03:12<00:51,  2.60it/s]
 69%|██████▊   | 291/424 [03:13<00:37,  3.52it/s]
 69%|██████▉   | 292/424 [03:13<00:32,  4.11it/s]
 69%|██████▉   | 293/424 [03:16<02:11,  1.00s/it]
 70%|██████▉   | 295/424 [03:17<01:39,  1.29it/s]
 70%|██████▉   | 296/424 [03:17<01:20,  1.60it/s]
 70%|███████   | 297/424 [03:18<01:12,  1.74it/s]
 70%|███████   | 298/424 [03:18<01:01,  2.05it/s]
 71%|███████   | 299/424 [03:18<00:50,  2.46it/s]
 71%|███████   | 301/424 [03:18<00:37,  3.29it/s]
 71%|███████   | 302/424 [03:25<03:50,  1.89s/it]
 71%|███████▏  | 303/424 [03:26<03:03,  1.51s/it]
 72%|███████▏  | 304/424 [03:26<02:18,  1.16s/it]
 72%|███████▏  | 305/424 [03:26<01:51,  1.07it/s]
 72%|███████▏  | 306/424 [03:27<01:33,  1.26it/s]
 72%|███████▏  | 307/424 [03:27<01:09,  1.68it/s]
 73%|███████▎  | 308/424 [03:27<00:57,  2.01it/s]
 73%|███████▎  | 309/424 [03:28<00:59,  1.95it/s]
 73%|███████▎  | 310/424 [03:29<01:16,  1.49it/s]
 74%|███████▎  | 312/424 [03:29<00:47,  2.36it/s]
 74%|███████▍  | 313/424 [03:29<00:41,  2.66it/s]
 74%|███████▍  | 314/424 [03:30<00:42,  2.57it/s]
 74%|███████▍  | 315/424 [03:31<01:10,  1.56it/s]
 75%|███████▍  | 316/424 [03:31<00:53,  2.02it/s]
 75%|███████▍  | 317/424 [03:32<01:20,  1.33it/s]
 75%|███████▌  | 318/424 [03:34<01:38,  1.08it/s]
 75%|███████▌  | 319/424 [03:34<01:19,  1.32it/s]
 75%|███████▌  | 320/424 [03:34<01:01,  1.68it/s]
 76%|███████▌  | 321/424 [03:34<00:46,  2.23it/s]
 76%|███████▌  | 323/424 [03:35<00:30,  3.30it/s]
 76%|███████▋  | 324/424 [03:35<00:27,  3.68it/s]
 77%|███████▋  | 325/424 [03:35<00:24,  4.05it/s]
 77%|███████▋  | 326/424 [03:42<03:23,  2.08s/it]
 77%|███████▋  | 327/424 [03:43<03:01,  1.87s/it]
 77%|███████▋  | 328/424 [03:44<02:30,  1.57s/it]
 78%|███████▊  | 329/424 [03:45<01:57,  1.24s/it]
 78%|███████▊  | 330/424 [03:46<01:59,  1.28s/it]
 78%|███████▊  | 331/424 [03:46<01:27,  1.07it/s]
 79%|███████▊  | 333/424 [03:48<01:18,  1.15it/s]
 79%|███████▉  | 334/424 [03:48<01:07,  1.33it/s]
 79%|███████▉  | 335/424 [03:49<01:04,  1.38it/s]
 79%|███████▉  | 336/424 [03:51<01:34,  1.07s/it]
 79%|███████▉  | 337/424 [03:58<03:55,  2.71s/it]
 80%|███████▉  | 338/424 [03:58<02:57,  2.07s/it]
 80%|███████▉  | 339/424 [03:59<02:28,  1.74s/it]
 80%|████████  | 340/424 [04:06<04:36,  3.29s/it]
 80%|████████  | 341/424 [04:08<03:53,  2.82s/it]
 81%|████████  | 342/424 [04:10<03:23,  2.48s/it]
 81%|████████  | 343/424 [04:10<02:25,  1.80s/it]
 81%|████████  | 344/424 [04:10<01:58,  1.48s/it]
 81%|████████▏ | 345/424 [04:11<01:25,  1.09s/it]
 82%|████████▏ | 346/424 [04:11<01:09,  1.13it/s]
 82%|████████▏ | 347/424 [04:12<01:05,  1.18it/s]
 82%|████████▏ | 349/424 [04:12<00:36,  2.08it/s]
 83%|████████▎ | 350/424 [04:13<00:41,  1.77it/s]
 83%|████████▎ | 351/424 [04:13<00:32,  2.26it/s]
 83%|████████▎ | 352/424 [04:20<02:37,  2.19s/it]
 83%|████████▎ | 353/424 [04:20<02:03,  1.74s/it]
 83%|████████▎ | 354/424 [04:21<01:46,  1.53s/it]
 84%|████████▎ | 355/424 [04:21<01:17,  1.13s/it]
 84%|████████▍ | 356/424 [04:23<01:27,  1.29s/it]
 84%|████████▍ | 357/424 [04:24<01:19,  1.19s/it]
 84%|████████▍ | 358/424 [04:25<01:16,  1.15s/it]
 85%|████████▍ | 359/424 [04:26<01:13,  1.12s/it]
 85%|████████▍ | 360/424 [04:26<00:55,  1.16it/s]
 85%|████████▌ | 361/424 [04:27<00:41,  1.50it/s]
 85%|████████▌ | 362/424 [04:27<00:35,  1.73it/s]
 86%|████████▌ | 363/424 [04:34<02:30,  2.46s/it]
 86%|████████▌ | 364/424 [04:34<01:51,  1.85s/it]
 86%|████████▌ | 365/424 [04:34<01:20,  1.36s/it]
 86%|████████▋ | 366/424 [04:35<00:57,  1.02it/s]
 87%|████████▋ | 367/424 [04:35<00:41,  1.39it/s]
 87%|████████▋ | 368/424 [04:42<02:25,  2.61s/it]
 87%|████████▋ | 369/424 [04:42<01:46,  1.93s/it]
 87%|████████▋ | 370/424 [04:42<01:14,  1.39s/it]
 88%|████████▊ | 372/424 [04:42<00:41,  1.26it/s]
 88%|████████▊ | 373/424 [04:43<00:33,  1.53it/s]
 88%|████████▊ | 374/424 [04:44<00:37,  1.34it/s]
 89%|████████▊ | 376/424 [04:44<00:28,  1.68it/s]
 89%|████████▉ | 377/424 [04:46<00:36,  1.30it/s]
 89%|████████▉ | 378/424 [04:46<00:28,  1.62it/s]
 89%|████████▉ | 379/424 [04:46<00:27,  1.64it/s]
 90%|████████▉ | 380/424 [04:48<00:38,  1.13it/s]
 90%|████████▉ | 381/424 [04:48<00:28,  1.50it/s]
 90%|█████████ | 382/424 [04:50<00:36,  1.15it/s]
 91%|█████████ | 384/424 [04:50<00:21,  1.84it/s]
 91%|█████████ | 385/424 [04:50<00:18,  2.16it/s]
 91%|█████████▏| 387/424 [04:50<00:11,  3.36it/s]
 92%|█████████▏| 388/424 [04:51<00:13,  2.69it/s]
 92%|█████████▏| 389/424 [04:55<00:47,  1.35s/it]
 92%|█████████▏| 390/424 [04:55<00:35,  1.05s/it]
 92%|█████████▏| 391/424 [04:56<00:26,  1.24it/s]
 92%|█████████▏| 392/424 [04:56<00:19,  1.62it/s]
 93%|█████████▎| 393/424 [04:56<00:20,  1.54it/s]
 93%|█████████▎| 394/424 [04:57<00:19,  1.50it/s]
 93%|█████████▎| 395/424 [04:59<00:28,  1.03it/s]
 93%|█████████▎| 396/424 [05:00<00:27,  1.01it/s]
 94%|█████████▎| 397/424 [05:01<00:29,  1.09s/it]
 94%|█████████▍| 398/424 [05:03<00:30,  1.16s/it]
 94%|█████████▍| 399/424 [05:03<00:23,  1.08it/s]
 94%|█████████▍| 400/424 [05:04<00:20,  1.19it/s]
 95%|█████████▍| 401/424 [05:04<00:15,  1.51it/s]
 95%|█████████▍| 402/424 [05:07<00:31,  1.45s/it]
 95%|█████████▌| 403/424 [05:10<00:37,  1.80s/it]
 95%|█████████▌| 404/424 [05:10<00:26,  1.33s/it]
 96%|█████████▌| 405/424 [05:10<00:20,  1.06s/it]
 96%|█████████▌| 406/424 [05:10<00:13,  1.29it/s]
 96%|█████████▌| 407/424 [05:12<00:16,  1.06it/s]
 96%|█████████▌| 408/424 [05:13<00:15,  1.02it/s]
 96%|█████████▋| 409/424 [05:16<00:22,  1.48s/it]
 97%|█████████▋| 410/424 [05:16<00:15,  1.14s/it]
 97%|█████████▋| 411/424 [05:17<00:14,  1.09s/it]
 97%|█████████▋| 412/424 [05:17<00:09,  1.24it/s]
 97%|█████████▋| 413/424 [05:19<00:11,  1.08s/it]
 98%|█████████▊| 415/424 [05:20<00:08,  1.04it/s]
 98%|█████████▊| 416/424 [05:21<00:07,  1.12it/s]
 98%|█████████▊| 417/424 [05:22<00:05,  1.22it/s]
 99%|█████████▊| 418/424 [05:26<00:10,  1.78s/it]
 99%|█████████▉| 419/424 [05:27<00:07,  1.46s/it]
 99%|█████████▉| 420/424 [05:28<00:06,  1.53s/it]
 99%|█████████▉| 421/424 [05:29<00:04,  1.38s/it]
100%|█████████▉| 422/424 [05:29<00:02,  1.02s/it]
100%|█████████▉| 423/424 [05:34<00:01,  1.98s/it]
100%|██████████| 424/424 [05:35<00:00,  1.71s/it]
100%|██████████| 424/424 [05:35<00:00,  1.26it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:49:15.772078_sc_processed_test.json', '--output_addr', 'data/out/rag/full_profile/sc_rag_full_profile_test_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.34 examples/s]
Generating train split: 424 examples [00:00, 662.52 examples/s]
INFO 07-09 15:55:27 config.py:510] This model supports multiple tasks: {'score', 'reward', 'generate', 'classify', 'embed'}. Defaulting to 'generate'.
INFO 07-09 15:55:27 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:55:29 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:55:29 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:55:29 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.71it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.45it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.43it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.35it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.40it/s]

INFO 07-09 15:55:33 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 15:55:35 worker.py:241] Memory profiling takes 2.08 seconds
INFO 07-09 15:55:35 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 15:55:35 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 15:55:35 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 15:55:35 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 15:55:38 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.74it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.83it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:11,  2.87it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:10,  2.89it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.90it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:09,  2.91it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.92it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.92it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:09,  2.88it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.90it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.91it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  2.94it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.94it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:06,  2.96it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  2.89it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  2.92it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:05,  2.93it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:04,  2.95it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  2.97it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:04,  2.99it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:03,  3.00it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  3.01it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:02,  3.02it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:09<00:02,  3.02it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  3.03it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:01,  3.04it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:10<00:01,  3.05it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  3.05it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:00,  3.06it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:11<00:00,  3.01it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  3.03it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  3.03it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  2.96it/s]
INFO 07-09 15:55:50 model_runner.py:1535] Graph capturing finished in 12 secs, took 0.22 GiB
INFO 07-09 15:55:50 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 17.23 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:14<1:40:02, 14.19s/it, est. speed input: 29.03 toks/s, output: 5.99 toks/s]
Processed prompts:   0%|          | 2/424 [00:15<44:32,  6.33s/it, est. speed input: 62.84 toks/s, output: 12.32 toks/s] 
Processed prompts:   1%|          | 4/424 [00:15<17:09,  2.45s/it, est. speed input: 152.36 toks/s, output: 25.48 toks/s]
Processed prompts:   1%|▏         | 6/424 [00:15<09:28,  1.36s/it, est. speed input: 248.45 toks/s, output: 38.68 toks/s]
Processed prompts:   2%|▏         | 8/424 [00:15<05:53,  1.18it/s, est. speed input: 318.88 toks/s, output: 52.12 toks/s]
Processed prompts:   2%|▏         | 10/424 [00:16<04:12,  1.64it/s, est. speed input: 394.88 toks/s, output: 64.92 toks/s]
Processed prompts:   3%|▎         | 13/424 [00:16<02:33,  2.67it/s, est. speed input: 486.88 toks/s, output: 85.48 toks/s]
Processed prompts:   4%|▎         | 15/424 [00:16<02:02,  3.34it/s, est. speed input: 550.32 toks/s, output: 98.68 toks/s]
Processed prompts:   4%|▍         | 17/424 [00:16<01:39,  4.08it/s, est. speed input: 596.22 toks/s, output: 111.86 toks/s]
Processed prompts:   5%|▍         | 21/424 [00:17<01:10,  5.70it/s, est. speed input: 736.02 toks/s, output: 138.59 toks/s]
Processed prompts:   6%|▌         | 24/424 [00:17<00:57,  6.96it/s, est. speed input: 799.38 toks/s, output: 158.75 toks/s]
Processed prompts:   6%|▋         | 27/424 [00:17<00:47,  8.31it/s, est. speed input: 861.30 toks/s, output: 178.91 toks/s]
Processed prompts:   7%|▋         | 30/424 [00:18<00:48,  8.18it/s, est. speed input: 945.50 toks/s, output: 197.25 toks/s]
Processed prompts:   8%|▊         | 33/424 [00:18<00:42,  9.27it/s, est. speed input: 1027.81 toks/s, output: 217.11 toks/s]
Processed prompts:   8%|▊         | 36/424 [00:18<00:34, 11.24it/s, est. speed input: 1089.19 toks/s, output: 237.85 toks/s]
Processed prompts:   9%|▉         | 38/424 [00:18<00:34, 11.04it/s, est. speed input: 1133.46 toks/s, output: 250.28 toks/s]
Processed prompts:  10%|▉         | 41/424 [00:18<00:33, 11.39it/s, est. speed input: 1192.53 toks/s, output: 269.28 toks/s]
Processed prompts:  11%|█         | 46/424 [00:19<00:26, 14.13it/s, est. speed input: 1342.33 toks/s, output: 302.80 toks/s]
Processed prompts:  11%|█▏        | 48/424 [00:19<00:26, 13.99it/s, est. speed input: 1396.97 toks/s, output: 315.32 toks/s]
Processed prompts:  12%|█▏        | 50/424 [00:19<00:29, 12.83it/s, est. speed input: 1445.10 toks/s, output: 326.97 toks/s]
Processed prompts:  13%|█▎        | 54/424 [00:19<00:24, 14.87it/s, est. speed input: 1544.81 toks/s, output: 353.18 toks/s]
Processed prompts:  13%|█▎        | 56/424 [00:19<00:26, 14.00it/s, est. speed input: 1604.92 toks/s, output: 364.88 toks/s]
Processed prompts:  14%|█▍        | 59/424 [00:19<00:22, 16.00it/s, est. speed input: 1666.14 toks/s, output: 384.65 toks/s]
Processed prompts:  15%|█▍        | 63/424 [00:20<00:22, 16.39it/s, est. speed input: 1784.60 toks/s, output: 409.56 toks/s]
Processed prompts:  17%|█▋        | 71/424 [00:20<00:20, 17.38it/s, est. speed input: 1971.02 toks/s, output: 459.12 toks/s]
Processed prompts:  19%|█▊        | 79/424 [00:20<00:16, 20.73it/s, est. speed input: 2191.10 toks/s, output: 510.66 toks/s]
Processed prompts:  19%|█▉        | 82/424 [00:21<00:19, 17.92it/s, est. speed input: 2332.54 toks/s, output: 525.90 toks/s]
Processed prompts:  20%|██        | 85/424 [00:21<00:22, 15.35it/s, est. speed input: 2392.56 toks/s, output: 540.13 toks/s]
Processed prompts:  21%|██        | 88/424 [00:21<00:21, 15.70it/s, est. speed input: 2488.26 toks/s, output: 557.39 toks/s]
Processed prompts:  21%|██        | 90/424 [00:21<00:22, 14.62it/s, est. speed input: 2512.22 toks/s, output: 567.22 toks/s]
Processed prompts:  23%|██▎       | 97/424 [00:22<00:19, 16.51it/s, est. speed input: 2709.75 toks/s, output: 608.08 toks/s]
Processed prompts:  24%|██▍       | 103/424 [00:22<00:17, 18.77it/s, est. speed input: 2852.70 toks/s, output: 644.28 toks/s]
Processed prompts:  25%|██▍       | 105/424 [00:22<00:18, 16.94it/s, est. speed input: 2883.78 toks/s, output: 653.41 toks/s]
Processed prompts:  25%|██▌       | 107/424 [00:22<00:20, 15.67it/s, est. speed input: 2910.33 toks/s, output: 662.85 toks/s]
Processed prompts:  26%|██▌       | 109/424 [00:22<00:21, 14.84it/s, est. speed input: 2964.83 toks/s, output: 672.46 toks/s]
Processed prompts:  27%|██▋       | 114/424 [00:23<00:19, 16.25it/s, est. speed input: 3094.00 toks/s, output: 700.30 toks/s]
Processed prompts:  28%|██▊       | 120/424 [00:23<00:17, 17.40it/s, est. speed input: 3231.81 toks/s, output: 733.63 toks/s]
Processed prompts:  30%|██▉       | 126/424 [00:23<00:15, 19.25it/s, est. speed input: 3346.43 toks/s, output: 768.14 toks/s]
Processed prompts:  30%|███       | 128/424 [00:23<00:17, 17.33it/s, est. speed input: 3402.16 toks/s, output: 776.50 toks/s]
Processed prompts:  31%|███▏      | 133/424 [00:24<00:17, 16.61it/s, est. speed input: 3481.98 toks/s, output: 801.34 toks/s]
Processed prompts:  33%|███▎      | 138/424 [00:24<00:18, 15.12it/s, est. speed input: 3536.08 toks/s, output: 823.78 toks/s]
Processed prompts:  33%|███▎      | 142/424 [00:24<00:18, 15.24it/s, est. speed input: 3633.14 toks/s, output: 843.41 toks/s]
Processed prompts:  34%|███▍      | 145/424 [00:25<00:18, 15.03it/s, est. speed input: 3692.62 toks/s, output: 857.43 toks/s]
Processed prompts:  35%|███▌      | 150/424 [00:25<00:15, 17.20it/s, est. speed input: 3805.44 toks/s, output: 885.15 toks/s]
Processed prompts:  36%|███▌      | 153/424 [00:25<00:16, 16.01it/s, est. speed input: 3822.07 toks/s, output: 898.08 toks/s]
Processed prompts:  37%|███▋      | 156/424 [00:25<00:19, 14.06it/s, est. speed input: 3833.62 toks/s, output: 908.90 toks/s]
Processed prompts:  38%|███▊      | 159/424 [00:26<00:19, 13.93it/s, est. speed input: 3867.59 toks/s, output: 922.27 toks/s]
Processed prompts:  38%|███▊      | 163/424 [00:26<00:19, 13.57it/s, est. speed input: 3924.04 toks/s, output: 939.37 toks/s]
Processed prompts:  39%|███▉      | 166/424 [00:26<00:18, 13.69it/s, est. speed input: 3993.99 toks/s, output: 952.90 toks/s]
Processed prompts:  40%|███▉      | 169/424 [00:26<00:16, 15.20it/s, est. speed input: 4043.88 toks/s, output: 969.04 toks/s]
Processed prompts:  41%|████      | 172/424 [00:26<00:14, 17.32it/s, est. speed input: 4124.54 toks/s, output: 986.15 toks/s]
Processed prompts:  41%|████▏     | 175/424 [00:26<00:12, 19.50it/s, est. speed input: 4164.25 toks/s, output: 1003.52 toks/s]
Processed prompts:  42%|████▏     | 178/424 [00:27<00:11, 21.45it/s, est. speed input: 4233.78 toks/s, output: 1020.98 toks/s]
Processed prompts:  43%|████▎     | 184/424 [00:27<00:08, 26.87it/s, est. speed input: 4425.33 toks/s, output: 1058.05 toks/s]
Processed prompts:  44%|████▍     | 188/424 [00:27<00:07, 29.62it/s, est. speed input: 4504.23 toks/s, output: 1083.02 toks/s]
Processed prompts:  45%|████▌     | 192/424 [00:27<00:07, 31.98it/s, est. speed input: 4586.46 toks/s, output: 1108.17 toks/s]
Processed prompts:  46%|████▌     | 196/424 [00:27<00:06, 33.90it/s, est. speed input: 4682.52 toks/s, output: 1133.52 toks/s]
Processed prompts:  47%|████▋     | 200/424 [00:27<00:07, 31.32it/s, est. speed input: 4736.47 toks/s, output: 1156.96 toks/s]
Processed prompts:  49%|████▊     | 206/424 [00:27<00:06, 34.37it/s, est. speed input: 4906.89 toks/s, output: 1195.54 toks/s]
Processed prompts:  50%|████▉     | 211/424 [00:27<00:06, 34.92it/s, est. speed input: 5055.71 toks/s, output: 1227.17 toks/s]
Processed prompts:  51%|█████     | 215/424 [00:28<00:06, 30.13it/s, est. speed input: 5096.87 toks/s, output: 1249.69 toks/s]
Processed prompts:  52%|█████▏    | 219/424 [00:28<00:08, 23.42it/s, est. speed input: 5136.15 toks/s, output: 1268.56 toks/s]
Processed prompts:  53%|█████▎    | 223/424 [00:28<00:08, 24.94it/s, est. speed input: 5215.97 toks/s, output: 1293.85 toks/s]
Processed prompts:  53%|█████▎    | 226/424 [00:28<00:08, 22.24it/s, est. speed input: 5268.55 toks/s, output: 1309.36 toks/s]
Processed prompts:  54%|█████▍    | 229/424 [00:28<00:10, 19.14it/s, est. speed input: 5292.89 toks/s, output: 1319.01 toks/s]
Processed prompts:  55%|█████▍    | 233/424 [00:29<00:09, 20.15it/s, est. speed input: 5347.18 toks/s, output: 1339.93 toks/s]
Processed prompts:  56%|█████▌    | 236/424 [00:29<00:08, 20.92it/s, est. speed input: 5387.27 toks/s, output: 1358.65 toks/s]
Processed prompts:  56%|█████▋    | 239/424 [00:29<00:12, 14.51it/s, est. speed input: 5373.54 toks/s, output: 1362.27 toks/s]
Processed prompts:  57%|█████▋    | 241/424 [00:29<00:13, 13.11it/s, est. speed input: 5394.39 toks/s, output: 1364.79 toks/s]
Processed prompts:  58%|█████▊    | 245/424 [00:30<00:10, 16.75it/s, est. speed input: 5443.68 toks/s, output: 1377.42 toks/s]
Processed prompts:  59%|█████▊    | 249/424 [00:30<00:09, 18.79it/s, est. speed input: 5509.69 toks/s, output: 1394.87 toks/s]
Processed prompts:  59%|█████▉    | 252/424 [00:30<00:09, 18.73it/s, est. speed input: 5535.25 toks/s, output: 1401.48 toks/s]
Processed prompts:  60%|██████    | 255/424 [00:30<00:09, 18.69it/s, est. speed input: 5557.94 toks/s, output: 1409.75 toks/s]
Processed prompts:  61%|██████    | 258/424 [00:30<00:08, 18.73it/s, est. speed input: 5579.81 toks/s, output: 1416.16 toks/s]
Processed prompts:  61%|██████▏   | 260/424 [00:30<00:08, 18.31it/s, est. speed input: 5600.26 toks/s, output: 1420.00 toks/s]
Processed prompts:  63%|██████▎   | 266/424 [00:30<00:05, 26.38it/s, est. speed input: 5672.33 toks/s, output: 1446.06 toks/s]
Processed prompts:  63%|██████▎   | 269/424 [00:31<00:05, 26.24it/s, est. speed input: 5720.57 toks/s, output: 1455.42 toks/s]
Processed prompts:  65%|██████▍   | 274/424 [00:31<00:04, 30.85it/s, est. speed input: 5823.46 toks/s, output: 1478.51 toks/s]
Processed prompts:  66%|██████▌   | 278/424 [00:31<00:04, 32.07it/s, est. speed input: 5866.08 toks/s, output: 1492.71 toks/s]
Processed prompts:  67%|██████▋   | 282/424 [00:31<00:06, 22.62it/s, est. speed input: 5886.08 toks/s, output: 1497.72 toks/s]
Processed prompts:  68%|██████▊   | 287/424 [00:31<00:04, 27.40it/s, est. speed input: 5977.63 toks/s, output: 1516.57 toks/s]
Processed prompts:  69%|██████▊   | 291/424 [00:31<00:04, 29.53it/s, est. speed input: 6043.79 toks/s, output: 1532.93 toks/s]
Processed prompts:  70%|███████   | 297/424 [00:31<00:03, 36.17it/s, est. speed input: 6147.86 toks/s, output: 1558.24 toks/s]
Processed prompts:  71%|███████▏  | 303/424 [00:31<00:03, 39.42it/s, est. speed input: 6226.68 toks/s, output: 1580.66 toks/s]
Processed prompts:  73%|███████▎  | 309/424 [00:32<00:02, 41.96it/s, est. speed input: 6357.76 toks/s, output: 1601.68 toks/s]
Processed prompts:  75%|███████▍  | 317/424 [00:32<00:02, 48.94it/s, est. speed input: 6486.20 toks/s, output: 1636.54 toks/s]
Processed prompts:  76%|███████▌  | 323/424 [00:32<00:02, 49.63it/s, est. speed input: 6596.24 toks/s, output: 1664.49 toks/s]
Processed prompts:  79%|███████▉  | 335/424 [00:32<00:01, 65.74it/s, est. speed input: 6833.69 toks/s, output: 1721.01 toks/s]
Processed prompts:  81%|████████  | 343/424 [00:32<00:01, 68.41it/s, est. speed input: 6992.56 toks/s, output: 1757.97 toks/s]
Processed prompts:  83%|████████▎ | 351/424 [00:32<00:01, 71.09it/s, est. speed input: 7155.09 toks/s, output: 1795.35 toks/s]
Processed prompts:  85%|████████▍ | 359/424 [00:32<00:00, 69.24it/s, est. speed input: 7278.69 toks/s, output: 1846.19 toks/s]
Processed prompts:  87%|████████▋ | 367/424 [00:33<00:01, 53.66it/s, est. speed input: 7378.52 toks/s, output: 1882.26 toks/s]
Processed prompts:  89%|████████▊ | 376/424 [00:33<00:00, 60.57it/s, est. speed input: 7589.91 toks/s, output: 1927.78 toks/s]
Processed prompts:  91%|█████████ | 386/424 [00:33<00:00, 69.70it/s, est. speed input: 7768.43 toks/s, output: 1982.62 toks/s]
Processed prompts:  93%|█████████▎| 394/424 [00:33<00:00, 67.17it/s, est. speed input: 7904.72 toks/s, output: 2024.25 toks/s]
Processed prompts:  95%|█████████▍| 402/424 [00:33<00:00, 56.45it/s, est. speed input: 8072.89 toks/s, output: 2069.93 toks/s]
Processed prompts:  96%|█████████▋| 409/424 [00:33<00:00, 54.58it/s, est. speed input: 8219.09 toks/s, output: 2110.80 toks/s]
Processed prompts:  98%|█████████▊| 415/424 [00:33<00:00, 44.15it/s, est. speed input: 8310.16 toks/s, output: 2152.65 toks/s]
Processed prompts:  99%|█████████▉| 420/424 [00:34<00:00, 18.36it/s, est. speed input: 8254.49 toks/s, output: 2143.09 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:36<00:00,  6.61it/s, est. speed input: 7863.02 toks/s, output: 2065.37 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:36<00:00, 11.51it/s, est. speed input: 7863.02 toks/s, output: 2065.37 toks/s]
[rank0]:[W709 15:56:29.148644411 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/sc_rag_full_profile_test_2_output.json
Cleaned temporary files.
Keeping ['lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:56:33.364054_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:56:33.364054_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:56:33.364054_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<01:39,  4.03it/s]
  1%|          | 3/401 [00:00<01:44,  3.83it/s]
  1%|          | 4/401 [00:01<03:08,  2.10it/s]
  1%|          | 5/401 [00:02<04:04,  1.62it/s]
  1%|▏         | 6/401 [00:03<04:35,  1.44it/s]
  2%|▏         | 7/401 [00:04<04:59,  1.31it/s]
  2%|▏         | 8/401 [00:05<05:12,  1.26it/s]
  2%|▏         | 9/401 [00:06<05:19,  1.23it/s]
  2%|▏         | 10/401 [00:06<03:58,  1.64it/s]
  3%|▎         | 11/401 [00:07<05:20,  1.22it/s]
  3%|▎         | 13/401 [00:08<04:50,  1.34it/s]
  3%|▎         | 14/401 [00:09<04:27,  1.45it/s]
  4%|▍         | 17/401 [00:09<02:18,  2.77it/s]
  4%|▍         | 18/401 [00:10<03:32,  1.80it/s]
  5%|▍         | 19/401 [00:12<04:33,  1.40it/s]
  5%|▍         | 20/401 [00:14<07:29,  1.18s/it]
  5%|▌         | 22/401 [00:17<07:52,  1.25s/it]
  6%|▌         | 23/401 [00:18<07:55,  1.26s/it]
  6%|▌         | 24/401 [00:21<09:58,  1.59s/it]
  6%|▋         | 26/401 [00:21<06:01,  1.04it/s]
  7%|▋         | 27/401 [00:24<08:20,  1.34s/it]
  7%|▋         | 29/401 [00:24<05:09,  1.20it/s]
  7%|▋         | 30/401 [00:24<04:14,  1.46it/s]
  8%|▊         | 31/401 [00:25<04:12,  1.47it/s]
  8%|▊         | 33/401 [00:25<03:21,  1.83it/s]
  8%|▊         | 34/401 [00:25<02:50,  2.15it/s]
  9%|▉         | 36/401 [00:26<01:52,  3.24it/s]
  9%|▉         | 38/401 [00:26<01:21,  4.44it/s]
 10%|▉         | 39/401 [00:26<01:14,  4.89it/s]
 10%|█         | 41/401 [00:26<01:01,  5.89it/s]
 10%|█         | 42/401 [00:26<01:03,  5.65it/s]
 11%|█         | 43/401 [00:26<01:05,  5.50it/s]
 11%|█         | 44/401 [00:27<00:58,  6.08it/s]
 11%|█▏        | 46/401 [00:27<00:55,  6.37it/s]
 12%|█▏        | 47/401 [00:27<00:56,  6.29it/s]
 12%|█▏        | 48/401 [00:27<01:05,  5.41it/s]
 12%|█▏        | 49/401 [00:27<01:03,  5.52it/s]
 13%|█▎        | 52/401 [00:28<00:36,  9.52it/s]
 13%|█▎        | 54/401 [00:28<00:37,  9.24it/s]
 14%|█▍        | 56/401 [00:29<01:04,  5.31it/s]
 14%|█▍        | 57/401 [00:29<00:59,  5.75it/s]
 15%|█▍        | 59/401 [00:29<01:13,  4.62it/s]
 15%|█▍        | 60/401 [00:29<01:08,  4.97it/s]
 15%|█▌        | 62/401 [00:30<01:01,  5.51it/s]
 16%|█▌        | 63/401 [00:30<01:01,  5.53it/s]
 16%|█▌        | 64/401 [00:30<01:00,  5.59it/s]
 16%|█▌        | 65/401 [00:30<00:59,  5.63it/s]
 16%|█▋        | 66/401 [00:30<00:57,  5.86it/s]
 17%|█▋        | 68/401 [00:30<00:40,  8.14it/s]
 17%|█▋        | 70/401 [00:31<00:35,  9.20it/s]
 18%|█▊        | 72/401 [00:31<00:34,  9.42it/s]
 18%|█▊        | 74/401 [00:31<00:32, 10.21it/s]
 19%|█▉        | 76/401 [00:31<00:33,  9.74it/s]
 19%|█▉        | 78/401 [00:31<00:30, 10.47it/s]
 20%|█▉        | 80/401 [00:32<00:32,  9.96it/s]
 20%|██        | 82/401 [00:32<00:29, 10.65it/s]
 21%|██        | 84/401 [00:32<00:31, 10.08it/s]
 21%|██▏       | 86/401 [00:32<00:29, 10.77it/s]
 22%|██▏       | 88/401 [00:33<00:51,  6.03it/s]
 22%|██▏       | 89/401 [00:33<00:50,  6.13it/s]
 23%|██▎       | 91/401 [00:33<00:40,  7.74it/s]
 23%|██▎       | 93/401 [00:33<00:37,  8.24it/s]
 24%|██▎       | 95/401 [00:34<00:41,  7.46it/s]
 24%|██▍       | 96/401 [00:34<00:39,  7.69it/s]
 24%|██▍       | 97/401 [00:34<00:38,  7.89it/s]
 24%|██▍       | 98/401 [00:34<00:38,  7.86it/s]
 25%|██▍       | 100/401 [00:34<00:29, 10.11it/s]
 25%|██▌       | 102/401 [00:34<00:25, 11.79it/s]
 26%|██▌       | 104/401 [00:35<00:35,  8.31it/s]
 26%|██▋       | 106/401 [00:35<00:30,  9.55it/s]
 27%|██▋       | 108/401 [00:35<00:33,  8.80it/s]
 27%|██▋       | 110/401 [00:35<00:29,  9.75it/s]
 28%|██▊       | 112/401 [00:35<00:30,  9.48it/s]
 28%|██▊       | 114/401 [00:36<00:30,  9.54it/s]
 29%|██▉       | 116/401 [00:36<00:27, 10.43it/s]
 29%|██▉       | 118/401 [00:36<00:29,  9.55it/s]
 30%|██▉       | 120/401 [00:36<00:27, 10.18it/s]
 30%|███       | 122/401 [00:36<00:26, 10.68it/s]
 31%|███       | 124/401 [00:37<00:31,  8.90it/s]
 31%|███       | 125/401 [00:37<00:33,  8.30it/s]
 31%|███▏      | 126/401 [00:37<00:36,  7.50it/s]
 32%|███▏      | 127/401 [00:37<00:37,  7.23it/s]
 32%|███▏      | 128/401 [00:37<00:38,  7.07it/s]
 32%|███▏      | 129/401 [00:37<00:36,  7.48it/s]
 32%|███▏      | 130/401 [00:38<00:37,  7.16it/s]
 33%|███▎      | 133/401 [00:38<00:46,  5.76it/s]
 33%|███▎      | 134/401 [00:38<00:43,  6.21it/s]
 34%|███▎      | 135/401 [00:38<00:39,  6.66it/s]
 34%|███▍      | 136/401 [00:38<00:37,  7.11it/s]
 34%|███▍      | 138/401 [00:39<00:31,  8.32it/s]
 35%|███▍      | 140/401 [00:39<00:25, 10.32it/s]
 35%|███▌      | 142/401 [00:39<00:31,  8.18it/s]
 36%|███▌      | 143/401 [00:39<00:38,  6.66it/s]
 36%|███▌      | 144/401 [00:40<00:36,  6.99it/s]
 36%|███▋      | 146/401 [00:40<00:28,  8.85it/s]
 37%|███▋      | 148/401 [00:40<00:42,  5.89it/s]
 37%|███▋      | 149/401 [00:40<00:39,  6.35it/s]
 37%|███▋      | 150/401 [00:40<00:37,  6.78it/s]
 38%|███▊      | 151/401 [00:41<00:37,  6.73it/s]
 38%|███▊      | 152/401 [00:41<00:34,  7.21it/s]
 38%|███▊      | 153/401 [00:41<00:42,  5.80it/s]
 38%|███▊      | 154/401 [00:41<00:41,  6.00it/s]
 39%|███▊      | 155/401 [00:41<00:40,  6.11it/s]
 39%|███▉      | 156/401 [00:41<00:39,  6.23it/s]
 39%|███▉      | 157/401 [00:42<00:38,  6.29it/s]
 40%|███▉      | 159/401 [00:42<00:28,  8.57it/s]
 40%|███▉      | 160/401 [00:42<00:35,  6.79it/s]
 40%|████      | 162/401 [00:42<00:28,  8.36it/s]
 41%|████      | 164/401 [00:42<00:23, 10.22it/s]
 41%|████▏     | 166/401 [00:42<00:24,  9.73it/s]
 42%|████▏     | 168/401 [00:43<00:24,  9.69it/s]
 42%|████▏     | 170/401 [00:43<00:24,  9.46it/s]
 43%|████▎     | 171/401 [00:43<00:24,  9.36it/s]
 43%|████▎     | 172/401 [00:43<00:32,  7.02it/s]
 43%|████▎     | 173/401 [00:43<00:30,  7.41it/s]
 43%|████▎     | 174/401 [00:43<00:29,  7.76it/s]
 44%|████▎     | 175/401 [00:44<00:28,  8.00it/s]
 44%|████▍     | 176/401 [00:44<00:27,  8.21it/s]
 44%|████▍     | 177/401 [00:44<00:29,  7.62it/s]
 44%|████▍     | 178/401 [00:44<00:28,  7.94it/s]
 45%|████▍     | 179/401 [00:44<00:27,  8.14it/s]
 45%|████▍     | 180/401 [00:44<00:26,  8.48it/s]
 45%|████▌     | 181/401 [00:44<00:25,  8.71it/s]
 45%|████▌     | 182/401 [00:44<00:25,  8.74it/s]
 46%|████▌     | 184/401 [00:45<00:20, 10.59it/s]
 46%|████▋     | 186/401 [00:45<00:18, 11.66it/s]
 47%|████▋     | 188/401 [00:45<00:19, 10.75it/s]
 47%|████▋     | 190/401 [00:45<00:18, 11.64it/s]
 48%|████▊     | 192/401 [00:46<00:42,  4.88it/s]
 48%|████▊     | 193/401 [00:46<00:39,  5.22it/s]
 48%|████▊     | 194/401 [00:46<00:43,  4.78it/s]
 49%|████▉     | 196/401 [00:47<00:47,  4.33it/s]
 49%|████▉     | 197/401 [00:49<02:01,  1.68it/s]
 50%|████▉     | 199/401 [00:49<01:36,  2.10it/s]
 50%|████▉     | 200/401 [00:50<01:35,  2.11it/s]
 50%|█████     | 201/401 [00:50<01:34,  2.13it/s]
 50%|█████     | 202/401 [00:51<01:32,  2.16it/s]
 51%|█████     | 203/401 [00:51<01:31,  2.15it/s]
 51%|█████     | 204/401 [00:52<01:31,  2.16it/s]
 51%|█████▏    | 206/401 [00:52<01:11,  2.72it/s]
 52%|█████▏    | 207/401 [00:53<01:15,  2.57it/s]
 52%|█████▏    | 208/401 [00:53<01:18,  2.45it/s]
 52%|█████▏    | 209/401 [00:54<01:18,  2.45it/s]
 52%|█████▏    | 210/401 [00:54<01:19,  2.39it/s]
 53%|█████▎    | 211/401 [00:55<01:28,  2.15it/s]
 53%|█████▎    | 212/401 [00:55<01:18,  2.42it/s]
 53%|█████▎    | 213/401 [00:55<01:26,  2.18it/s]
 53%|█████▎    | 214/401 [00:57<02:19,  1.34it/s]
 54%|█████▎    | 215/401 [00:57<01:49,  1.70it/s]
 54%|█████▍    | 216/401 [00:58<02:00,  1.53it/s]
 54%|█████▍    | 218/401 [00:58<01:15,  2.43it/s]
 55%|█████▍    | 219/401 [00:58<01:05,  2.76it/s]
 55%|█████▍    | 220/401 [00:59<00:58,  3.08it/s]
 55%|█████▌    | 221/401 [00:59<01:09,  2.59it/s]
 55%|█████▌    | 222/401 [00:59<01:00,  2.97it/s]
 56%|█████▌    | 224/401 [01:00<00:47,  3.74it/s]
 56%|█████▌    | 225/401 [01:00<00:40,  4.37it/s]
 56%|█████▋    | 226/401 [01:00<00:34,  5.07it/s]
 57%|█████▋    | 228/401 [01:01<00:45,  3.82it/s]
 57%|█████▋    | 229/401 [01:01<00:41,  4.11it/s]
 57%|█████▋    | 230/401 [01:01<00:40,  4.23it/s]
 58%|█████▊    | 231/401 [01:01<00:36,  4.66it/s]
 58%|█████▊    | 232/401 [01:01<00:39,  4.30it/s]
 58%|█████▊    | 234/401 [01:05<02:20,  1.19it/s]
 59%|█████▊    | 235/401 [01:05<01:58,  1.40it/s]
 59%|█████▉    | 236/401 [01:05<01:32,  1.78it/s]
 59%|█████▉    | 237/401 [01:05<01:19,  2.05it/s]
 59%|█████▉    | 238/401 [01:06<01:05,  2.51it/s]
 60%|█████▉    | 239/401 [01:06<00:56,  2.89it/s]
 60%|██████    | 241/401 [01:06<00:34,  4.58it/s]
 61%|██████    | 243/401 [01:07<00:41,  3.81it/s]
 61%|██████    | 244/401 [01:07<00:43,  3.58it/s]
 61%|██████▏   | 246/401 [01:07<00:33,  4.58it/s]
 62%|██████▏   | 247/401 [01:07<00:33,  4.59it/s]
 62%|██████▏   | 248/401 [01:07<00:29,  5.16it/s]
 62%|██████▏   | 249/401 [01:08<00:57,  2.65it/s]
 63%|██████▎   | 253/401 [01:08<00:25,  5.87it/s]
 64%|██████▎   | 255/401 [01:10<00:45,  3.20it/s]
 65%|██████▍   | 260/401 [01:10<00:23,  5.96it/s]
 65%|██████▌   | 262/401 [01:10<00:25,  5.40it/s]
 66%|██████▌   | 265/401 [01:11<00:18,  7.28it/s]
 67%|██████▋   | 268/401 [01:11<00:14,  9.09it/s]
 67%|██████▋   | 270/401 [01:11<00:22,  5.80it/s]
 68%|██████▊   | 273/401 [01:12<00:16,  7.56it/s]
 69%|██████▊   | 275/401 [01:12<00:15,  8.34it/s]
 69%|██████▉   | 277/401 [01:12<00:17,  7.02it/s]
 70%|██████▉   | 279/401 [01:12<00:15,  7.74it/s]
 70%|███████   | 281/401 [01:13<00:16,  7.40it/s]
 70%|███████   | 282/401 [01:13<00:15,  7.65it/s]
 71%|███████   | 283/401 [01:13<00:18,  6.25it/s]
 71%|███████   | 285/401 [01:13<00:15,  7.36it/s]
 72%|███████▏  | 288/401 [01:13<00:11, 10.03it/s]
 73%|███████▎  | 291/401 [01:14<00:13,  8.15it/s]
 73%|███████▎  | 293/401 [01:15<00:23,  4.54it/s]
 73%|███████▎  | 294/401 [01:15<00:29,  3.62it/s]
 74%|███████▍  | 296/401 [01:16<00:22,  4.60it/s]
 75%|███████▍  | 299/401 [01:16<00:25,  3.97it/s]
 75%|███████▌  | 301/401 [01:17<00:20,  4.98it/s]
 76%|███████▌  | 303/401 [01:17<00:15,  6.30it/s]
 76%|███████▌  | 305/401 [01:17<00:19,  4.97it/s]
 77%|███████▋  | 307/401 [01:18<00:16,  5.62it/s]
 77%|███████▋  | 308/401 [01:18<00:15,  6.01it/s]
 77%|███████▋  | 309/401 [01:18<00:18,  4.92it/s]
 77%|███████▋  | 310/401 [01:18<00:16,  5.53it/s]
 78%|███████▊  | 312/401 [01:18<00:13,  6.76it/s]
 78%|███████▊  | 314/401 [01:18<00:10,  8.29it/s]
 79%|███████▉  | 317/401 [01:19<00:07, 11.31it/s]
 80%|███████▉  | 319/401 [01:19<00:08,  9.88it/s]
 80%|████████  | 321/401 [01:19<00:10,  7.69it/s]
 80%|████████  | 322/401 [01:19<00:11,  7.06it/s]
 81%|████████  | 323/401 [01:20<00:16,  4.61it/s]
 81%|████████  | 324/401 [01:21<00:21,  3.55it/s]
 81%|████████  | 325/401 [01:21<00:25,  2.94it/s]
 81%|████████▏ | 326/401 [01:21<00:22,  3.36it/s]
 82%|████████▏ | 328/401 [01:21<00:15,  4.81it/s]
 82%|████████▏ | 329/401 [01:23<00:33,  2.15it/s]
 82%|████████▏ | 330/401 [01:23<00:33,  2.11it/s]
 83%|████████▎ | 331/401 [01:23<00:27,  2.55it/s]
 83%|████████▎ | 332/401 [01:24<00:29,  2.33it/s]
 83%|████████▎ | 333/401 [01:24<00:30,  2.21it/s]
 84%|████████▎ | 335/401 [01:25<00:24,  2.65it/s]
 84%|████████▍ | 336/401 [01:26<00:26,  2.42it/s]
 84%|████████▍ | 338/401 [01:26<00:17,  3.64it/s]
 85%|████████▍ | 340/401 [01:26<00:11,  5.20it/s]
 85%|████████▌ | 342/401 [01:26<00:09,  6.27it/s]
 86%|████████▌ | 344/401 [01:26<00:08,  6.41it/s]
 86%|████████▋ | 346/401 [01:27<00:08,  6.69it/s]
 87%|████████▋ | 348/401 [01:27<00:09,  5.51it/s]
 87%|████████▋ | 350/401 [01:28<00:11,  4.47it/s]
 88%|████████▊ | 351/401 [01:28<00:13,  3.63it/s]
 89%|████████▊ | 355/401 [01:28<00:07,  6.41it/s]
 89%|████████▉ | 357/401 [01:29<00:10,  4.34it/s]
 90%|████████▉ | 359/401 [01:30<00:11,  3.57it/s]
 90%|████████▉ | 360/401 [01:31<00:14,  2.78it/s]
 90%|█████████ | 361/401 [01:31<00:12,  3.08it/s]
 91%|█████████ | 363/401 [01:31<00:08,  4.24it/s]
 91%|█████████ | 365/401 [01:31<00:07,  5.00it/s]
 92%|█████████▏| 367/401 [01:32<00:05,  5.76it/s]
 92%|█████████▏| 369/401 [01:32<00:05,  5.79it/s]
 92%|█████████▏| 370/401 [01:32<00:05,  5.60it/s]
 93%|█████████▎| 371/401 [01:32<00:05,  5.56it/s]
 93%|█████████▎| 373/401 [01:33<00:04,  6.30it/s]
 93%|█████████▎| 374/401 [01:33<00:04,  6.04it/s]
 94%|█████████▎| 375/401 [01:33<00:04,  5.83it/s]
 94%|█████████▍| 376/401 [01:34<00:06,  3.64it/s]
 94%|█████████▍| 378/401 [01:34<00:06,  3.40it/s]
 95%|█████████▍| 379/401 [01:35<00:07,  2.89it/s]
 95%|█████████▍| 380/401 [01:35<00:06,  3.25it/s]
 95%|█████████▌| 382/401 [01:35<00:05,  3.32it/s]
 96%|█████████▌| 383/401 [01:36<00:06,  2.79it/s]
 96%|█████████▌| 384/401 [01:36<00:06,  2.65it/s]
 96%|█████████▌| 385/401 [01:37<00:06,  2.42it/s]
 97%|█████████▋| 387/401 [01:38<00:05,  2.35it/s]
 97%|█████████▋| 389/401 [01:38<00:03,  3.30it/s]
 97%|█████████▋| 390/401 [01:38<00:03,  3.17it/s]
 98%|█████████▊| 393/401 [01:39<00:01,  5.32it/s]
 98%|█████████▊| 394/401 [01:39<00:01,  5.04it/s]
 99%|█████████▊| 395/401 [01:39<00:01,  4.41it/s]
 99%|█████████▉| 397/401 [01:39<00:00,  4.95it/s]
100%|█████████▉| 399/401 [01:40<00:00,  4.43it/s]
100%|██████████| 401/401 [01:40<00:00,  5.54it/s]
100%|██████████| 401/401 [01:40<00:00,  3.98it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:56:33.364054_ae_processed_test.json', '--output_addr', 'data/out/rag/asym/ae_rag_lp_sc_test_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.02 examples/s]
Generating train split: 401 examples [00:00, 1537.99 examples/s]
INFO 07-09 15:58:49 config.py:510] This model supports multiple tasks: {'reward', 'score', 'classify', 'generate', 'embed'}. Defaulting to 'generate'.
INFO 07-09 15:58:50 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:58:51 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:58:51 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:58:52 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.74it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.49it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.47it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.40it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]

INFO 07-09 15:58:55 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 15:58:57 worker.py:241] Memory profiling takes 2.08 seconds
INFO 07-09 15:58:57 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 15:58:57 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 15:58:57 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 15:58:57 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 15:59:00 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.81it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.91it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:10,  2.94it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:10,  2.96it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.97it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:09,  2.99it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.99it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  3.00it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:08,  2.99it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.93it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.96it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.98it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  3.00it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:06,  3.01it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  3.02it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  3.02it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:05,  3.05it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  3.06it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  3.03it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:04,  3.05it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:06<00:04,  3.07it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  3.09it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:03,  3.09it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:07<00:03,  3.10it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  3.11it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:02,  3.12it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:08<00:02,  3.12it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  3.12it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:01,  3.14it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:09<00:01,  3.14it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  3.14it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:00,  3.15it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:10<00:00,  3.09it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  3.12it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  3.13it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  3.05it/s]
INFO 07-09 15:59:12 model_runner.py:1535] Graph capturing finished in 11 secs, took 0.22 GiB
INFO 07-09 15:59:12 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 16.82 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:13<1:31:56, 13.79s/it, est. speed input: 58.73 toks/s, output: 6.02 toks/s]
Processed prompts:   0%|          | 2/401 [00:14<39:10,  5.89s/it, est. speed input: 92.36 toks/s, output: 12.15 toks/s] 
Processed prompts:   1%|          | 3/401 [00:14<22:48,  3.44s/it, est. speed input: 125.06 toks/s, output: 18.40 toks/s]
Processed prompts:   1%|          | 4/401 [00:14<14:17,  2.16s/it, est. speed input: 150.01 toks/s, output: 24.94 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:15<07:04,  1.07s/it, est. speed input: 222.16 toks/s, output: 38.16 toks/s]
Processed prompts:   2%|▏         | 8/401 [00:15<04:20,  1.51it/s, est. speed input: 286.97 toks/s, output: 51.26 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:15<03:00,  2.17it/s, est. speed input: 354.13 toks/s, output: 64.17 toks/s]
Processed prompts:   3%|▎         | 13/401 [00:15<01:52,  3.45it/s, est. speed input: 469.52 toks/s, output: 84.09 toks/s]
Processed prompts:   4%|▍         | 16/401 [00:15<01:13,  5.26it/s, est. speed input: 543.59 toks/s, output: 104.49 toks/s]
Processed prompts:   4%|▍         | 18/401 [00:16<01:02,  6.14it/s, est. speed input: 605.74 toks/s, output: 117.28 toks/s]
Processed prompts:   5%|▌         | 22/401 [00:16<00:44,  8.45it/s, est. speed input: 747.02 toks/s, output: 143.39 toks/s]
Processed prompts:   6%|▌         | 24/401 [00:16<00:41,  8.99it/s, est. speed input: 831.03 toks/s, output: 156.06 toks/s]
Processed prompts:   7%|▋         | 28/401 [00:16<00:33, 11.13it/s, est. speed input: 956.56 toks/s, output: 182.09 toks/s]
Processed prompts:   8%|▊         | 31/401 [00:17<00:33, 10.89it/s, est. speed input: 1033.09 toks/s, output: 200.21 toks/s]
Processed prompts:   8%|▊         | 34/401 [00:17<00:31, 11.67it/s, est. speed input: 1112.45 toks/s, output: 219.07 toks/s]
Processed prompts:   9%|▉         | 37/401 [00:17<00:30, 12.02it/s, est. speed input: 1181.20 toks/s, output: 237.59 toks/s]
Processed prompts:  10%|▉         | 40/401 [00:17<00:30, 12.00it/s, est. speed input: 1292.46 toks/s, output: 255.73 toks/s]
Processed prompts:  11%|█         | 45/401 [00:18<00:29, 12.25it/s, est. speed input: 1412.26 toks/s, output: 285.50 toks/s]
Processed prompts:  13%|█▎        | 52/401 [00:18<00:25, 13.92it/s, est. speed input: 1559.14 toks/s, output: 328.34 toks/s]
Processed prompts:  15%|█▍        | 60/401 [00:19<00:21, 15.56it/s, est. speed input: 1787.91 toks/s, output: 376.82 toks/s]
Processed prompts:  16%|█▌        | 63/401 [00:19<00:20, 16.57it/s, est. speed input: 1843.72 toks/s, output: 395.32 toks/s]
Processed prompts:  16%|█▌        | 65/401 [00:19<00:22, 14.85it/s, est. speed input: 1894.10 toks/s, output: 404.96 toks/s]
Processed prompts:  17%|█▋        | 68/401 [00:19<00:19, 16.74it/s, est. speed input: 2010.87 toks/s, output: 423.72 toks/s]
Processed prompts:  18%|█▊        | 73/401 [00:19<00:21, 15.51it/s, est. speed input: 2144.16 toks/s, output: 450.55 toks/s]
Processed prompts:  19%|█▉        | 78/401 [00:20<00:18, 17.59it/s, est. speed input: 2277.26 toks/s, output: 480.27 toks/s]
Processed prompts:  20%|█▉        | 80/401 [00:20<00:19, 16.40it/s, est. speed input: 2309.67 toks/s, output: 490.23 toks/s]
Processed prompts:  20%|██        | 82/401 [00:20<00:18, 16.85it/s, est. speed input: 2341.81 toks/s, output: 501.54 toks/s]
Processed prompts:  22%|██▏       | 88/401 [00:20<00:18, 16.71it/s, est. speed input: 2481.62 toks/s, output: 533.72 toks/s]
Processed prompts:  23%|██▎       | 93/401 [00:20<00:17, 17.56it/s, est. speed input: 2583.42 toks/s, output: 561.12 toks/s]
Processed prompts:  24%|██▍       | 97/401 [00:21<00:17, 17.32it/s, est. speed input: 2663.84 toks/s, output: 581.85 toks/s]
Processed prompts:  25%|██▌       | 102/401 [00:21<00:15, 19.51it/s, est. speed input: 2748.83 toks/s, output: 610.36 toks/s]
Processed prompts:  26%|██▌       | 105/401 [00:21<00:15, 18.67it/s, est. speed input: 2843.25 toks/s, output: 625.41 toks/s]
Processed prompts:  27%|██▋       | 110/401 [00:21<00:16, 18.18it/s, est. speed input: 2927.15 toks/s, output: 650.63 toks/s]
Processed prompts:  28%|██▊       | 113/401 [00:22<00:16, 17.04it/s, est. speed input: 2976.84 toks/s, output: 664.38 toks/s]
Processed prompts:  29%|██▉       | 116/401 [00:22<00:17, 16.56it/s, est. speed input: 3029.96 toks/s, output: 678.51 toks/s]
Processed prompts:  30%|██▉       | 119/401 [00:22<00:18, 15.53it/s, est. speed input: 3132.06 toks/s, output: 691.60 toks/s]
Processed prompts:  31%|███       | 123/401 [00:22<00:16, 16.87it/s, est. speed input: 3234.64 toks/s, output: 712.12 toks/s]
Processed prompts:  33%|███▎      | 134/401 [00:23<00:14, 18.33it/s, est. speed input: 3449.25 toks/s, output: 766.51 toks/s]
Processed prompts:  34%|███▍      | 138/401 [00:23<00:15, 17.35it/s, est. speed input: 3516.05 toks/s, output: 783.70 toks/s]
Processed prompts:  35%|███▌      | 141/401 [00:23<00:15, 16.83it/s, est. speed input: 3553.11 toks/s, output: 796.61 toks/s]
Processed prompts:  36%|███▌      | 143/401 [00:23<00:15, 16.30it/s, est. speed input: 3586.61 toks/s, output: 804.91 toks/s]
Processed prompts:  38%|███▊      | 152/401 [00:24<00:10, 22.85it/s, est. speed input: 3806.57 toks/s, output: 855.65 toks/s]
Processed prompts:  39%|███▉      | 158/401 [00:24<00:08, 28.33it/s, est. speed input: 3942.72 toks/s, output: 891.32 toks/s]
Processed prompts:  41%|████      | 163/401 [00:24<00:07, 31.97it/s, est. speed input: 4042.00 toks/s, output: 920.59 toks/s]
Processed prompts:  43%|████▎     | 173/401 [00:24<00:05, 41.28it/s, est. speed input: 4303.17 toks/s, output: 981.37 toks/s]
Processed prompts:  44%|████▍     | 178/401 [00:24<00:05, 43.00it/s, est. speed input: 4408.66 toks/s, output: 1011.15 toks/s]
Processed prompts:  46%|████▌     | 185/401 [00:24<00:04, 44.26it/s, est. speed input: 4540.20 toks/s, output: 1052.61 toks/s]
Processed prompts:  48%|████▊     | 194/401 [00:24<00:04, 45.78it/s, est. speed input: 4736.40 toks/s, output: 1106.87 toks/s]
Processed prompts:  50%|█████     | 201/401 [00:25<00:04, 43.37it/s, est. speed input: 4932.57 toks/s, output: 1148.04 toks/s]
Processed prompts:  52%|█████▏    | 208/401 [00:25<00:04, 45.64it/s, est. speed input: 5134.84 toks/s, output: 1191.62 toks/s]
Processed prompts:  54%|█████▍    | 216/401 [00:25<00:03, 49.78it/s, est. speed input: 5295.27 toks/s, output: 1243.05 toks/s]
Processed prompts:  55%|█████▌    | 222/401 [00:25<00:03, 49.10it/s, est. speed input: 5428.11 toks/s, output: 1280.57 toks/s]
Processed prompts:  57%|█████▋    | 228/401 [00:25<00:03, 48.76it/s, est. speed input: 5616.47 toks/s, output: 1318.63 toks/s]
Processed prompts:  58%|█████▊    | 233/401 [00:25<00:04, 39.40it/s, est. speed input: 5697.61 toks/s, output: 1345.73 toks/s]
Processed prompts:  59%|█████▉    | 238/401 [00:26<00:05, 28.33it/s, est. speed input: 5798.65 toks/s, output: 1367.34 toks/s]
Processed prompts:  60%|██████    | 242/401 [00:26<00:05, 29.38it/s, est. speed input: 5903.63 toks/s, output: 1387.73 toks/s]
Processed prompts:  61%|██████▏   | 246/401 [00:26<00:06, 22.30it/s, est. speed input: 5969.98 toks/s, output: 1403.28 toks/s]
Processed prompts:  62%|██████▏   | 249/401 [00:26<00:09, 16.78it/s, est. speed input: 5972.00 toks/s, output: 1405.31 toks/s]
Processed prompts:  63%|██████▎   | 253/401 [00:27<00:08, 17.76it/s, est. speed input: 6047.27 toks/s, output: 1419.54 toks/s]
Processed prompts:  64%|██████▍   | 256/401 [00:27<00:08, 16.44it/s, est. speed input: 6053.04 toks/s, output: 1428.86 toks/s]
Processed prompts:  64%|██████▍   | 258/401 [00:27<00:09, 15.75it/s, est. speed input: 6056.10 toks/s, output: 1434.11 toks/s]
Processed prompts:  65%|██████▍   | 260/401 [00:27<00:11, 11.76it/s, est. speed input: 6037.03 toks/s, output: 1429.81 toks/s]
Processed prompts:  65%|██████▌   | 262/401 [00:27<00:11, 12.10it/s, est. speed input: 6058.22 toks/s, output: 1430.80 toks/s]
Processed prompts:  66%|██████▌   | 264/401 [00:28<00:12, 11.15it/s, est. speed input: 6046.16 toks/s, output: 1429.62 toks/s]
Processed prompts:  67%|██████▋   | 270/401 [00:28<00:06, 18.82it/s, est. speed input: 6155.91 toks/s, output: 1452.24 toks/s]
Processed prompts:  68%|██████▊   | 273/401 [00:28<00:06, 20.57it/s, est. speed input: 6216.47 toks/s, output: 1460.52 toks/s]
Processed prompts:  69%|██████▉   | 278/401 [00:28<00:04, 25.09it/s, est. speed input: 6284.88 toks/s, output: 1477.44 toks/s]
Processed prompts:  71%|███████▏  | 286/401 [00:28<00:03, 34.95it/s, est. speed input: 6453.23 toks/s, output: 1511.56 toks/s]
Processed prompts:  73%|███████▎  | 293/401 [00:28<00:03, 34.03it/s, est. speed input: 6581.20 toks/s, output: 1533.65 toks/s]
Processed prompts:  74%|███████▍  | 297/401 [00:28<00:03, 31.95it/s, est. speed input: 6649.95 toks/s, output: 1547.17 toks/s]
Processed prompts:  75%|███████▌  | 301/401 [00:29<00:03, 28.96it/s, est. speed input: 6703.72 toks/s, output: 1557.87 toks/s]
Processed prompts:  78%|███████▊  | 313/401 [00:29<00:01, 46.24it/s, est. speed input: 6954.96 toks/s, output: 1616.37 toks/s]
Processed prompts:  80%|████████  | 321/401 [00:29<00:01, 49.88it/s, est. speed input: 7107.45 toks/s, output: 1651.89 toks/s]
Processed prompts:  82%|████████▏ | 328/401 [00:29<00:01, 53.83it/s, est. speed input: 7264.69 toks/s, output: 1683.54 toks/s]
Processed prompts:  85%|████████▍ | 339/401 [00:29<00:00, 63.88it/s, est. speed input: 7486.64 toks/s, output: 1735.93 toks/s]
Processed prompts:  86%|████████▋ | 346/401 [00:29<00:00, 62.65it/s, est. speed input: 7644.03 toks/s, output: 1774.62 toks/s]
Processed prompts:  88%|████████▊ | 353/401 [00:29<00:00, 56.33it/s, est. speed input: 7766.27 toks/s, output: 1807.18 toks/s]
Processed prompts:  90%|████████▉ | 360/401 [00:30<00:00, 58.66it/s, est. speed input: 7916.76 toks/s, output: 1845.61 toks/s]
Processed prompts:  92%|█████████▏| 370/401 [00:30<00:00, 66.75it/s, est. speed input: 8149.51 toks/s, output: 1902.12 toks/s]
Processed prompts:  94%|█████████▍| 377/401 [00:30<00:00, 57.17it/s, est. speed input: 8269.92 toks/s, output: 1934.75 toks/s]
Processed prompts:  96%|█████████▌| 384/401 [00:30<00:00, 52.16it/s, est. speed input: 8392.58 toks/s, output: 1973.42 toks/s]
Processed prompts:  97%|█████████▋| 390/401 [00:30<00:00, 43.07it/s, est. speed input: 8506.96 toks/s, output: 2002.20 toks/s]
Processed prompts:  99%|█████████▊| 395/401 [00:31<00:00, 28.57it/s, est. speed input: 8540.70 toks/s, output: 2021.83 toks/s]
Processed prompts: 100%|█████████▉| 399/401 [00:31<00:00, 14.56it/s, est. speed input: 8497.58 toks/s, output: 2016.26 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:33<00:00, 11.97it/s, est. speed input: 8127.16 toks/s, output: 1940.90 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts on Sefaria are often used to enhance readability and provide additional context. For example, the bold and big text (like <big><strong>ר' אהרן</strong></big>) is typically used to highlight names or important phrases. The small parenthesized sections (like <small>(תהלים ק\"ד, כ\"ד)</small>) are often references to other texts or sources. The quotes (like ' and ") are used to denote direct speech or specific references. The brackets and parentheses (like [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.) are used for various purposes, such as additional commentary or clarification. The italics and hyphens are used for stylistic or grammatical reasons. While these modern formatting elements can be removed to make the text more natural, they do provide important context and are part of the original text as it appears on Sefaria. If you want to remove them, you can do so, but you might lose some of the intended meaning and context. As for the font, the earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which is a direct descendant of the Phoenician alphabet. Over time, this evolved into the Aramaic alphabet and eventually into the square script used in modern Hebrew. The Torah, as we know it today, is written in the square script, which is the script used in most scrolls found in the Dead Sea caves. So, while the original texts might have been written in Paleo-Hebrew, the square script is the most common and recognizable form of Hebrew script today."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.95s/it, est. speed input: 549.81 toks/s, output: 80.32 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.95s/it, est. speed input: 549.81 toks/s, output: 80.32 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are often used to denote various elements that were added for clarity, readability, or to provide additional context. For example, the bold and big text (e.g., <big><strong>ר' אהרן</strong></big>) is likely used to highlight names or important figures, such as rabbis or key individuals. The small parenthesized sections (e.g., <small>(תהלים ק\"ד, כ\"ד)</small>) are typically references to other texts or sources, which can be useful for cross-referencing. The quotes (e.g., ' and ") are often used to denote speech or specific phrases. The brackets and parentheses (e.g., [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and (כֹּה אָמַר ה' אֱלֹהֵי יִשְׂרָאֵל) are used to include additional information or to mark specific parts of the text, such as explanations or annotations. The italics and hyphens are used for emphasis or to separate words, respectively. While these elements can be considered 'modern' or 'English' additions, they serve to enhance understanding and provide context. If you wish to remove these elements to make the text more 'natural' and closer to the original, you can do so. However, it's important to note that these additions are often part of the scholarly tradition and can provide valuable insights. For the earliest Hebrew texts, the script would have been Paleo-Hebrew, which is a direct descendant of the Phoenician alphabet. The Torah, as we know it today, was likely written in a form of Paleo-Hebrew, but it's important to remember that the exact script used for the original texts is not definitively known. If you're looking to remove these modern additions, you can do so, but you might lose some of the scholarly context and annotations that enhance the text."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.24s/it, est. speed input: 624.54 toks/s, output: 79.79 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.24s/it, est. speed input: 624.54 toks/s, output: 79.79 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are often used to convey important information or to distinguish different elements within the text. For example, the bold and big text, such as <big><strong>ר' אהרן</strong></big>, is likely used to highlight names or important figures. The small parenthesized sections, like <small>(תהלים ק\"ד, כ\"ד)</small>, are typically references to other texts or sources. The quotes, like ' and ", are used to denote different types of speech or quotations. The brackets [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] and parentheses (מעש טוביה א׳:) are used to provide additional context or to clarify certain parts of the text. The italics, hyphens, and other punctuation marks are usually added for clarity or to follow modern conventions. If you want to remove these elements to make the text more natural, you can do so, but it's important to note that some of these formatting styles are there to help with readability and understanding. For the earliest Hebrew texts, they were likely written in the Paleo-Hebrew alphabet, which is a direct descendant of the Phoenician alphabet. Over time, the script evolved into the Aramaic alphabet and eventually the square script used in modern Hebrew texts. The Samaritan script is a direct descendant of the Paleo-Hebrew alphabet, but it was not commonly used for the Torah. The Torah was likely written in the Paleo-Hebrew script, but it's important to note that the exact script used is not definitively known. If you want to remove these modern additions, you can do so, but it's a good idea to keep the original text as close to the original as possible."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.75s/it, est. speed input: 689.47 toks/s, output: 79.65 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.75s/it, est. speed input: 689.47 toks/s, output: 79.65 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts from Sefaria are primarily there to aid in readability and to provide additional context. The bold and big text, such as <big><strong>ר' אהרן</strong></big>, is likely used to highlight names or important figures. The quotes, like ' and ", are modern additions used to denote speech or quotations. The small parenthesized sections, like <small>(תהלים ק\"ד, כ\"ד)</small>, are references to other texts or sources. The brackets [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] are used to indicate additional information or commentary. The parentheses (מעשיך ה' כולם בחכמה עשית) are used to provide clarification or to enclose additional details. The italics and font sizes are used to emphasize certain words or phrases for clarity. The quotes, brackets, and parentheses are not part of the original texts but are added for modern readability. The hyphens between words are used to break up longer words for easier reading. To make the text more natural and closer to the original, you can remove these modern additions. The earliest Hebrew texts were written in the Paleo-Hebrew alphabet, which was a direct descendant of the Phoenician alphabet. Over time, this evolved into the Aramaic alphabet and eventually into the square script used in modern Hebrew texts. The font you might see in the earliest texts would be similar to the Paleo-Hebrew script, which is the precursor to the modern Hebrew script used in Torah scrolls and other ancient texts."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.77s/it, est. speed input: 685.44 toks/s, output: 79.81 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.77s/it, est. speed input: 685.44 toks/s, output: 79.81 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in the Hebrew/Aramaic texts from Sefaria are often used to provide additional context or to highlight certain elements of the text. For example, the bold and big text, such as <big><strong>ר' אהרן</strong></big>, is likely used to emphasize names or key figures. The quotes, like ' and ", are probably used to denote speech or quotations within the text. The small parenthesized sections, like <small>(תהלים ק\"ד, כ\"ד)</small>, are often used to reference other texts or sources. The brackets [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] are used to include additional information or commentary. The use of italics, quotes, and parentheses is not part of the original text but is added for clarity and to provide additional context. The hyphens between words are likely used to break up long words for readability. While these formatting styles can be helpful, they are indeed modern additions and can be removed or modified to make the text more closely resemble the original. For the earliest Hebrew texts, they were likely written in the Paleo-Hebrew alphabet, which is a direct descendant of the Phoenician alphabet. The text would not have included diacritical marks, punctuation, or modern formatting. It's important to note that the exact script used can vary, but the Paleo-Hebrew alphabet is the most likely candidate for the original Torah. If you wish to remove these modern additions, you can do so to make the text more uncluttered and closer to the original format."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.35s/it, est. speed input: 752.04 toks/s, output: 79.52 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.35s/it, est. speed input: 752.04 toks/s, output: 79.52 toks/s]
[rank0]:[W709 16:00:13.641806267 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/ae_rag_lp_sc_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 16:00:16.875172_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 16:00:16.875172_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 16:00:16.875172_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:37,  3.33it/s]
  1%|          | 3/526 [00:00<01:02,  8.33it/s]
  1%|          | 6/526 [00:00<00:36, 14.43it/s]
  2%|▏         | 8/526 [00:00<00:35, 14.67it/s]
  2%|▏         | 11/526 [00:00<00:28, 17.80it/s]
  2%|▏         | 13/526 [00:01<00:40, 12.58it/s]
  3%|▎         | 15/526 [00:01<00:36, 13.87it/s]
  3%|▎         | 17/526 [00:01<00:39, 12.93it/s]
  4%|▍         | 20/526 [00:01<00:35, 14.20it/s]
  4%|▍         | 22/526 [00:02<00:59,  8.44it/s]
  5%|▍         | 24/526 [00:02<00:55,  9.08it/s]
  5%|▍         | 26/526 [00:03<01:58,  4.21it/s]
  5%|▌         | 28/526 [00:03<01:36,  5.17it/s]
  6%|▌         | 30/526 [00:04<02:40,  3.10it/s]
  6%|▌         | 31/526 [00:05<02:51,  2.89it/s]
  6%|▌         | 32/526 [00:05<02:38,  3.11it/s]
  6%|▋         | 33/526 [00:06<04:18,  1.91it/s]
  6%|▋         | 34/526 [00:07<04:33,  1.80it/s]
  7%|▋         | 35/526 [00:08<05:13,  1.57it/s]
  7%|▋         | 36/526 [00:08<04:08,  1.97it/s]
  7%|▋         | 37/526 [00:08<03:29,  2.33it/s]
  8%|▊         | 40/526 [00:08<01:53,  4.27it/s]
  8%|▊         | 42/526 [00:08<01:23,  5.82it/s]
  8%|▊         | 44/526 [00:09<01:30,  5.30it/s]
  9%|▊         | 46/526 [00:09<01:26,  5.55it/s]
  9%|▉         | 47/526 [00:09<01:24,  5.65it/s]
  9%|▉         | 48/526 [00:10<01:34,  5.04it/s]
 10%|▉         | 50/526 [00:10<01:19,  5.99it/s]
 10%|▉         | 52/526 [00:10<01:05,  7.23it/s]
 10%|█         | 53/526 [00:11<02:49,  2.80it/s]
 10%|█         | 54/526 [00:15<08:09,  1.04s/it]
 11%|█         | 57/526 [00:15<04:17,  1.82it/s]
 11%|█         | 59/526 [00:16<04:18,  1.80it/s]
 11%|█▏        | 60/526 [00:17<04:26,  1.75it/s]
 12%|█▏        | 61/526 [00:17<04:31,  1.72it/s]
 12%|█▏        | 62/526 [00:18<04:40,  1.66it/s]
 12%|█▏        | 63/526 [00:19<05:15,  1.47it/s]
 12%|█▏        | 65/526 [00:19<03:20,  2.30it/s]
 13%|█▎        | 66/526 [00:19<02:56,  2.60it/s]
 13%|█▎        | 67/526 [00:19<02:27,  3.12it/s]
 13%|█▎        | 68/526 [00:20<03:43,  2.05it/s]
 13%|█▎        | 70/526 [00:21<03:41,  2.06it/s]
 13%|█▎        | 71/526 [00:22<03:34,  2.12it/s]
 14%|█▍        | 73/526 [00:22<03:04,  2.45it/s]
 14%|█▍        | 74/526 [00:23<03:55,  1.92it/s]
 14%|█▍        | 76/526 [00:23<02:38,  2.84it/s]
 15%|█▍        | 78/526 [00:24<02:58,  2.52it/s]
 15%|█▌        | 80/526 [00:25<02:21,  3.15it/s]
 16%|█▌        | 84/526 [00:25<01:21,  5.44it/s]
 16%|█▋        | 86/526 [00:26<02:34,  2.85it/s]
 17%|█▋        | 87/526 [00:27<02:18,  3.17it/s]
 17%|█▋        | 88/526 [00:27<02:07,  3.43it/s]
 17%|█▋        | 89/526 [00:27<02:12,  3.30it/s]
 17%|█▋        | 91/526 [00:27<01:37,  4.47it/s]
 17%|█▋        | 92/526 [00:27<01:29,  4.87it/s]
 18%|█▊        | 94/526 [00:28<01:07,  6.36it/s]
 18%|█▊        | 96/526 [00:28<01:03,  6.82it/s]
 18%|█▊        | 97/526 [00:28<01:43,  4.13it/s]
 19%|█▊        | 98/526 [00:31<05:37,  1.27it/s]
 19%|█▉        | 99/526 [00:33<07:31,  1.06s/it]
 19%|█▉        | 101/526 [00:33<04:43,  1.50it/s]
 20%|█▉        | 103/526 [00:34<03:30,  2.01it/s]
 20%|█▉        | 104/526 [00:35<04:35,  1.53it/s]
 20%|██        | 106/526 [00:35<03:06,  2.25it/s]
 21%|██        | 108/526 [00:35<02:21,  2.95it/s]
 21%|██        | 109/526 [00:36<02:09,  3.22it/s]
 21%|██        | 110/526 [00:36<02:22,  2.93it/s]
 21%|██        | 111/526 [00:37<02:32,  2.72it/s]
 21%|██▏       | 112/526 [00:37<02:40,  2.59it/s]
 21%|██▏       | 113/526 [00:37<02:10,  3.17it/s]
 22%|██▏       | 115/526 [00:37<01:26,  4.76it/s]
 22%|██▏       | 118/526 [00:37<00:51,  7.95it/s]
 23%|██▎       | 120/526 [00:38<00:59,  6.84it/s]
 23%|██▎       | 122/526 [00:38<00:55,  7.32it/s]
 24%|██▎       | 124/526 [00:39<01:58,  3.40it/s]
 24%|██▍       | 125/526 [00:39<01:44,  3.85it/s]
 24%|██▍       | 127/526 [00:39<01:19,  5.01it/s]
 24%|██▍       | 128/526 [00:40<01:13,  5.43it/s]
 25%|██▍       | 129/526 [00:40<01:11,  5.52it/s]
 25%|██▍       | 130/526 [00:40<01:10,  5.65it/s]
 25%|██▍       | 131/526 [00:40<01:12,  5.41it/s]
 25%|██▌       | 132/526 [00:40<01:04,  6.14it/s]
 25%|██▌       | 134/526 [00:40<00:48,  8.16it/s]
 26%|██▌       | 136/526 [00:41<00:55,  7.04it/s]
 26%|██▌       | 138/526 [00:41<00:54,  7.10it/s]
 27%|██▋       | 141/526 [00:41<00:39,  9.71it/s]
 27%|██▋       | 143/526 [00:41<00:41,  9.25it/s]
 28%|██▊       | 145/526 [00:42<00:37, 10.21it/s]
 28%|██▊       | 147/526 [00:42<00:43,  8.65it/s]
 28%|██▊       | 149/526 [00:42<00:41,  9.13it/s]
 29%|██▊       | 151/526 [00:42<00:35, 10.70it/s]
 29%|██▉       | 153/526 [00:42<00:31, 11.87it/s]
 29%|██▉       | 155/526 [00:43<01:05,  5.69it/s]
 30%|██▉       | 157/526 [00:43<00:58,  6.31it/s]
 30%|███       | 160/526 [00:44<01:07,  5.39it/s]
 31%|███       | 161/526 [00:44<01:08,  5.31it/s]
 31%|███       | 162/526 [00:46<03:04,  1.97it/s]
 31%|███       | 164/526 [00:46<02:07,  2.85it/s]
 32%|███▏      | 167/526 [00:46<01:21,  4.40it/s]
 32%|███▏      | 170/526 [00:47<00:55,  6.40it/s]
 33%|███▎      | 172/526 [00:49<02:15,  2.61it/s]
 33%|███▎      | 174/526 [00:49<01:55,  3.05it/s]
 33%|███▎      | 175/526 [00:49<01:43,  3.40it/s]
 33%|███▎      | 176/526 [00:49<01:34,  3.69it/s]
 34%|███▍      | 178/526 [00:49<01:11,  4.87it/s]
 34%|███▍      | 179/526 [00:50<01:06,  5.20it/s]
 34%|███▍      | 181/526 [00:50<00:49,  7.00it/s]
 35%|███▍      | 183/526 [00:51<01:28,  3.87it/s]
 35%|███▍      | 184/526 [00:51<01:40,  3.41it/s]
 35%|███▌      | 186/526 [00:53<02:33,  2.22it/s]
 36%|███▌      | 187/526 [00:53<02:14,  2.53it/s]
 36%|███▌      | 188/526 [00:53<01:57,  2.87it/s]
 36%|███▌      | 190/526 [00:53<01:20,  4.16it/s]
 36%|███▋      | 191/526 [00:53<01:14,  4.48it/s]
 37%|███▋      | 192/526 [00:53<01:07,  4.97it/s]
 37%|███▋      | 195/526 [00:53<00:38,  8.53it/s]
 37%|███▋      | 197/526 [00:54<00:31, 10.37it/s]
 38%|███▊      | 199/526 [00:56<02:09,  2.52it/s]
 38%|███▊      | 201/526 [00:56<02:00,  2.70it/s]
 39%|███▊      | 203/526 [00:57<01:54,  2.81it/s]
 39%|███▉      | 205/526 [00:57<01:24,  3.79it/s]
 39%|███▉      | 207/526 [00:57<01:06,  4.79it/s]
 40%|███▉      | 210/526 [00:57<00:45,  6.99it/s]
 40%|████      | 212/526 [00:58<01:13,  4.28it/s]
 41%|████      | 215/526 [00:58<00:53,  5.84it/s]
 41%|████▏     | 217/526 [00:59<01:20,  3.85it/s]
 41%|████▏     | 218/526 [01:00<01:40,  3.06it/s]
 42%|████▏     | 219/526 [01:01<01:49,  2.80it/s]
 42%|████▏     | 222/526 [01:01<01:08,  4.45it/s]
 42%|████▏     | 223/526 [01:01<01:02,  4.87it/s]
 43%|████▎     | 224/526 [01:01<00:57,  5.29it/s]
 43%|████▎     | 228/526 [01:01<00:31,  9.60it/s]
 44%|████▎     | 230/526 [01:01<00:28, 10.41it/s]
 44%|████▍     | 232/526 [01:02<00:49,  5.90it/s]
 44%|████▍     | 234/526 [01:02<00:41,  7.06it/s]
 45%|████▍     | 236/526 [01:02<00:38,  7.62it/s]
 45%|████▌     | 238/526 [01:03<00:42,  6.82it/s]
 46%|████▌     | 241/526 [01:03<00:33,  8.59it/s]
 46%|████▌     | 243/526 [01:03<00:30,  9.43it/s]
 47%|████▋     | 245/526 [01:04<01:03,  4.42it/s]
 47%|████▋     | 247/526 [01:04<00:55,  5.02it/s]
 47%|████▋     | 248/526 [01:05<01:04,  4.34it/s]
 47%|████▋     | 249/526 [01:06<01:28,  3.12it/s]
 48%|████▊     | 250/526 [01:06<01:16,  3.63it/s]
 48%|████▊     | 251/526 [01:06<01:09,  3.96it/s]
 48%|████▊     | 252/526 [01:06<01:05,  4.20it/s]
 48%|████▊     | 253/526 [01:06<01:00,  4.51it/s]
 48%|████▊     | 255/526 [01:07<01:27,  3.11it/s]
 49%|████▊     | 256/526 [01:07<01:16,  3.51it/s]
 49%|████▉     | 258/526 [01:07<00:56,  4.71it/s]
 49%|████▉     | 260/526 [01:08<00:43,  6.07it/s]
 50%|████▉     | 261/526 [01:08<00:41,  6.35it/s]
 50%|█████     | 263/526 [01:09<01:05,  4.00it/s]
 50%|█████     | 264/526 [01:09<01:33,  2.79it/s]
 50%|█████     | 265/526 [01:09<01:20,  3.22it/s]
 51%|█████     | 266/526 [01:10<01:30,  2.88it/s]
 51%|█████     | 267/526 [01:10<01:37,  2.65it/s]
 51%|█████     | 268/526 [01:11<01:20,  3.19it/s]
 51%|█████▏    | 270/526 [01:11<00:54,  4.68it/s]
 52%|█████▏    | 271/526 [01:11<00:51,  4.92it/s]
 52%|█████▏    | 272/526 [01:11<01:09,  3.66it/s]
 52%|█████▏    | 273/526 [01:12<01:19,  3.17it/s]
 52%|█████▏    | 274/526 [01:12<01:24,  2.97it/s]
 52%|█████▏    | 275/526 [01:14<03:13,  1.29it/s]
 52%|█████▏    | 276/526 [01:14<02:30,  1.66it/s]
 53%|█████▎    | 277/526 [01:14<01:59,  2.08it/s]
 53%|█████▎    | 279/526 [01:16<02:57,  1.39it/s]
 53%|█████▎    | 280/526 [01:18<04:05,  1.00it/s]
 53%|█████▎    | 281/526 [01:20<05:03,  1.24s/it]
 54%|█████▎    | 282/526 [01:22<05:45,  1.42s/it]
 54%|█████▍    | 283/526 [01:24<06:18,  1.56s/it]
 54%|█████▍    | 284/526 [01:26<06:41,  1.66s/it]
 54%|█████▍    | 285/526 [01:26<05:05,  1.27s/it]
 54%|█████▍    | 286/526 [01:27<04:34,  1.14s/it]
 55%|█████▍    | 287/526 [01:27<03:24,  1.17it/s]
 55%|█████▍    | 289/526 [01:27<01:56,  2.03it/s]
 55%|█████▌    | 291/526 [01:28<01:32,  2.54it/s]
 56%|█████▌    | 292/526 [01:28<01:21,  2.88it/s]
 56%|█████▌    | 294/526 [01:28<00:58,  3.99it/s]
 56%|█████▌    | 295/526 [01:28<00:51,  4.53it/s]
 56%|█████▋    | 296/526 [01:28<00:45,  5.10it/s]
 57%|█████▋    | 298/526 [01:31<02:33,  1.49it/s]
 57%|█████▋    | 299/526 [01:34<04:14,  1.12s/it]
 57%|█████▋    | 300/526 [01:35<04:21,  1.16s/it]
 57%|█████▋    | 301/526 [01:36<04:11,  1.12s/it]
 57%|█████▋    | 302/526 [01:37<04:16,  1.15s/it]
 58%|█████▊    | 303/526 [01:39<04:20,  1.17s/it]
 58%|█████▊    | 304/526 [01:39<03:12,  1.15it/s]
 58%|█████▊    | 305/526 [01:40<03:36,  1.02it/s]
 58%|█████▊    | 306/526 [01:41<03:50,  1.05s/it]
 58%|█████▊    | 307/526 [01:42<04:02,  1.11s/it]
 59%|█████▊    | 308/526 [01:44<04:19,  1.19s/it]
 59%|█████▊    | 309/526 [01:44<03:10,  1.14it/s]
 59%|█████▉    | 310/526 [01:45<02:56,  1.23it/s]
 59%|█████▉    | 311/526 [01:45<02:11,  1.64it/s]
 59%|█████▉    | 312/526 [01:46<02:51,  1.24it/s]
 60%|█████▉    | 313/526 [01:47<03:17,  1.08it/s]
 60%|█████▉    | 314/526 [01:49<03:44,  1.06s/it]
 60%|█████▉    | 315/526 [01:52<05:54,  1.68s/it]
 60%|██████    | 317/526 [01:52<03:32,  1.02s/it]
 60%|██████    | 318/526 [01:53<03:01,  1.15it/s]
 61%|██████    | 319/526 [01:53<02:28,  1.39it/s]
 61%|██████    | 321/526 [01:54<02:27,  1.39it/s]
 61%|██████    | 322/526 [01:55<02:06,  1.61it/s]
 62%|██████▏   | 324/526 [01:55<01:22,  2.45it/s]
 62%|██████▏   | 326/526 [01:55<00:59,  3.38it/s]
 62%|██████▏   | 327/526 [01:55<00:54,  3.62it/s]
 62%|██████▏   | 328/526 [01:55<00:48,  4.06it/s]
 63%|██████▎   | 330/526 [01:56<00:33,  5.80it/s]
 63%|██████▎   | 331/526 [01:56<00:33,  5.77it/s]
 63%|██████▎   | 332/526 [01:56<00:45,  4.25it/s]
 63%|██████▎   | 334/526 [01:57<01:15,  2.55it/s]
 64%|██████▎   | 335/526 [01:58<01:09,  2.73it/s]
 64%|██████▍   | 336/526 [01:59<01:49,  1.73it/s]
 64%|██████▍   | 337/526 [01:59<01:44,  1.80it/s]
 64%|██████▍   | 339/526 [02:00<01:18,  2.37it/s]
 65%|██████▍   | 340/526 [02:02<02:22,  1.30it/s]
 65%|██████▌   | 342/526 [02:02<01:32,  1.98it/s]
 65%|██████▌   | 343/526 [02:03<01:39,  1.84it/s]
 66%|██████▌   | 345/526 [02:06<02:56,  1.03it/s]
 66%|██████▌   | 346/526 [02:08<03:29,  1.17s/it]
 66%|██████▌   | 347/526 [02:11<04:58,  1.67s/it]
 66%|██████▌   | 348/526 [02:12<04:01,  1.36s/it]
 66%|██████▋   | 349/526 [02:12<03:12,  1.09s/it]
 67%|██████▋   | 350/526 [02:15<05:01,  1.71s/it]
 67%|██████▋   | 351/526 [02:17<05:07,  1.76s/it]
 67%|██████▋   | 352/526 [02:17<03:44,  1.29s/it]
 67%|██████▋   | 354/526 [02:17<02:07,  1.35it/s]
 67%|██████▋   | 355/526 [02:18<01:49,  1.56it/s]
 68%|██████▊   | 357/526 [02:18<01:17,  2.19it/s]
 68%|██████▊   | 358/526 [02:18<01:10,  2.40it/s]
 68%|██████▊   | 360/526 [02:19<00:47,  3.48it/s]
 69%|██████▊   | 361/526 [02:19<00:42,  3.86it/s]
 69%|██████▉   | 363/526 [02:19<00:45,  3.56it/s]
 69%|██████▉   | 364/526 [02:20<00:43,  3.76it/s]
 69%|██████▉   | 365/526 [02:20<00:47,  3.40it/s]
 70%|██████▉   | 366/526 [02:22<01:39,  1.61it/s]
 70%|██████▉   | 368/526 [02:22<01:03,  2.48it/s]
 70%|███████   | 369/526 [02:22<00:57,  2.71it/s]
 70%|███████   | 370/526 [02:25<02:53,  1.11s/it]
 71%|███████   | 371/526 [02:29<04:22,  1.69s/it]
 71%|███████   | 372/526 [02:32<05:34,  2.17s/it]
 71%|███████▏  | 375/526 [02:36<04:02,  1.61s/it]
 71%|███████▏  | 376/526 [02:36<03:15,  1.30s/it]
 72%|███████▏  | 378/526 [02:36<02:06,  1.17it/s]
 72%|███████▏  | 379/526 [02:36<01:50,  1.34it/s]
 72%|███████▏  | 381/526 [02:40<02:40,  1.11s/it]
 73%|███████▎  | 382/526 [02:40<02:11,  1.09it/s]
 73%|███████▎  | 383/526 [02:40<01:52,  1.27it/s]
 73%|███████▎  | 384/526 [02:43<03:20,  1.41s/it]
 73%|███████▎  | 385/526 [02:47<04:29,  1.91s/it]
 73%|███████▎  | 386/526 [02:47<03:30,  1.50s/it]
 74%|███████▍  | 388/526 [02:47<02:02,  1.12it/s]
 74%|███████▍  | 389/526 [02:48<01:53,  1.20it/s]
 74%|███████▍  | 390/526 [02:49<01:45,  1.29it/s]
 75%|███████▍  | 392/526 [02:49<01:03,  2.12it/s]
 75%|███████▍  | 394/526 [02:49<00:41,  3.15it/s]
 75%|███████▌  | 396/526 [02:49<00:29,  4.34it/s]
 76%|███████▌  | 398/526 [02:49<00:24,  5.29it/s]
 76%|███████▌  | 400/526 [02:53<01:25,  1.47it/s]
 76%|███████▌  | 401/526 [02:56<02:26,  1.17s/it]
 76%|███████▋  | 402/526 [02:56<01:59,  1.04it/s]
 77%|███████▋  | 403/526 [02:56<01:36,  1.27it/s]
 77%|███████▋  | 404/526 [02:57<01:18,  1.56it/s]
 77%|███████▋  | 406/526 [03:00<01:57,  1.02it/s]
 78%|███████▊  | 408/526 [03:00<01:17,  1.52it/s]
 78%|███████▊  | 409/526 [03:00<01:16,  1.54it/s]
 78%|███████▊  | 411/526 [03:04<02:01,  1.06s/it]
 79%|███████▊  | 413/526 [03:04<01:20,  1.41it/s]
 79%|███████▉  | 415/526 [03:04<00:59,  1.88it/s]
 79%|███████▉  | 417/526 [03:05<00:45,  2.39it/s]
 79%|███████▉  | 418/526 [03:06<01:05,  1.64it/s]
 80%|███████▉  | 419/526 [03:06<00:53,  1.99it/s]
 80%|████████  | 421/526 [03:08<01:17,  1.36it/s]
 80%|████████  | 423/526 [03:09<00:56,  1.83it/s]
 81%|████████  | 425/526 [03:09<00:38,  2.61it/s]
 81%|████████  | 426/526 [03:09<00:34,  2.93it/s]
 81%|████████▏ | 428/526 [03:09<00:24,  3.99it/s]
 82%|████████▏ | 430/526 [03:09<00:18,  5.19it/s]
 82%|████████▏ | 432/526 [03:10<00:19,  4.73it/s]
 82%|████████▏ | 433/526 [03:10<00:18,  4.93it/s]
 83%|████████▎ | 435/526 [03:12<00:49,  1.84it/s]
 83%|████████▎ | 436/526 [03:13<00:46,  1.94it/s]
 83%|████████▎ | 438/526 [03:13<00:36,  2.41it/s]
 83%|████████▎ | 439/526 [03:14<00:41,  2.11it/s]
 84%|████████▎ | 440/526 [03:15<00:42,  2.01it/s]
 84%|████████▍ | 442/526 [03:15<00:30,  2.76it/s]
 84%|████████▍ | 444/526 [03:17<00:42,  1.92it/s]
 85%|████████▍ | 445/526 [03:18<01:00,  1.35it/s]
 85%|████████▍ | 446/526 [03:18<00:47,  1.67it/s]
 85%|████████▍ | 447/526 [03:19<00:41,  1.92it/s]
 85%|████████▌ | 448/526 [03:19<00:33,  2.30it/s]
 86%|████████▌ | 450/526 [03:19<00:20,  3.65it/s]
 86%|████████▌ | 453/526 [03:19<00:11,  6.20it/s]
 87%|████████▋ | 455/526 [03:19<00:11,  6.07it/s]
 87%|████████▋ | 457/526 [03:19<00:09,  7.52it/s]
 87%|████████▋ | 459/526 [03:20<00:08,  7.82it/s]
 88%|████████▊ | 461/526 [03:20<00:08,  7.42it/s]
 88%|████████▊ | 463/526 [03:20<00:08,  7.51it/s]
 88%|████████▊ | 465/526 [03:20<00:08,  7.37it/s]
 89%|████████▊ | 466/526 [03:21<00:08,  6.80it/s]
 89%|████████▉ | 467/526 [03:21<00:09,  6.08it/s]
 89%|████████▉ | 468/526 [03:21<00:08,  6.51it/s]
 89%|████████▉ | 470/526 [03:21<00:06,  8.13it/s]
 90%|████████▉ | 471/526 [03:21<00:06,  8.47it/s]
 90%|████████▉ | 472/526 [03:22<00:09,  5.64it/s]
 90%|█████████ | 475/526 [03:22<00:11,  4.62it/s]
 90%|█████████ | 476/526 [03:23<00:10,  4.66it/s]
 91%|█████████ | 479/526 [03:23<00:09,  4.71it/s]
 91%|█████████▏| 480/526 [03:23<00:10,  4.59it/s]
 91%|█████████▏| 481/526 [03:25<00:19,  2.35it/s]
 92%|█████████▏| 482/526 [03:25<00:17,  2.55it/s]
 92%|█████████▏| 484/526 [03:25<00:12,  3.29it/s]
 92%|█████████▏| 485/526 [03:25<00:10,  3.86it/s]
 92%|█████████▏| 486/526 [03:26<00:08,  4.51it/s]
 93%|█████████▎| 488/526 [03:26<00:05,  6.44it/s]
 93%|█████████▎| 490/526 [03:26<00:04,  8.35it/s]
 94%|█████████▎| 492/526 [03:26<00:03,  9.61it/s]
 94%|█████████▍| 494/526 [03:28<00:14,  2.23it/s]
 94%|█████████▍| 495/526 [03:28<00:12,  2.48it/s]
 94%|█████████▍| 496/526 [03:29<00:10,  2.87it/s]
 94%|█████████▍| 497/526 [03:29<00:09,  3.07it/s]
 95%|█████████▍| 498/526 [03:30<00:18,  1.52it/s]
 95%|█████████▍| 499/526 [03:32<00:25,  1.05it/s]
 95%|█████████▌| 501/526 [03:32<00:14,  1.69it/s]
 96%|█████████▌| 504/526 [03:33<00:07,  2.87it/s]
 96%|█████████▌| 505/526 [03:33<00:07,  2.96it/s]
 96%|█████████▌| 506/526 [03:33<00:06,  3.21it/s]
 96%|█████████▋| 507/526 [03:33<00:04,  3.81it/s]
 97%|█████████▋| 508/526 [03:34<00:05,  3.37it/s]
 97%|█████████▋| 510/526 [03:34<00:04,  3.68it/s]
 97%|█████████▋| 511/526 [03:35<00:04,  3.21it/s]
 97%|█████████▋| 512/526 [03:35<00:03,  3.66it/s]
 98%|█████████▊| 513/526 [03:35<00:04,  2.65it/s]
 98%|█████████▊| 514/526 [03:36<00:04,  2.78it/s]
 98%|█████████▊| 515/526 [03:36<00:03,  3.03it/s]
 98%|█████████▊| 516/526 [03:36<00:02,  3.57it/s]
 98%|█████████▊| 517/526 [03:36<00:02,  3.66it/s]
 98%|█████████▊| 518/526 [03:37<00:01,  4.14it/s]
 99%|█████████▊| 519/526 [03:37<00:01,  4.59it/s]
 99%|█████████▉| 520/526 [03:37<00:02,  2.82it/s]
 99%|█████████▉| 522/526 [03:41<00:03,  1.02it/s]
 99%|█████████▉| 523/526 [03:44<00:04,  1.56s/it]
100%|█████████▉| 524/526 [03:48<00:04,  2.04s/it]
100%|█████████▉| 525/526 [03:48<00:01,  1.54s/it]
100%|██████████| 526/526 [03:51<00:00,  2.05s/it]
100%|██████████| 526/526 [03:51<00:00,  2.27it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 16:00:16.875172_lp_processed_test.json', '--output_addr', 'data/out/rag/asym/lp_rag_ae_sc_test_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  4.61 examples/s]
Generating train split: 526 examples [00:00, 1242.61 examples/s]
INFO 07-09 16:04:40 config.py:510] This model supports multiple tasks: {'generate', 'score', 'classify', 'embed', 'reward'}. Defaulting to 'generate'.
INFO 07-09 16:04:40 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:04:42 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:04:42 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:04:43 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.74it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.49it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.47it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.40it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.44it/s]

INFO 07-09 16:04:46 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:04:48 worker.py:241] Memory profiling takes 2.08 seconds
INFO 07-09 16:04:48 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:04:48 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:04:48 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:04:48 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:04:51 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.81it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.89it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:10,  2.92it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:10,  2.94it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.95it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:09,  2.95it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.94it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.95it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:08,  2.94it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.96it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.97it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.95it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:07,  2.95it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  2.96it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.97it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:05,  3.00it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  3.01it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  3.03it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:04,  3.04it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:04,  3.05it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  3.06it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:03,  3.07it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:03,  3.07it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  3.08it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:02,  3.09it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:09<00:02,  3.09it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  3.09it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:01,  3.10it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:09<00:01,  3.10it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  3.10it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:00,  3.11it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:10<00:00,  3.05it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  3.07it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  3.08it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  3.02it/s]
INFO 07-09 16:05:03 model_runner.py:1535] Graph capturing finished in 12 secs, took 0.22 GiB
INFO 07-09 16:05:03 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 17.00 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:13<1:57:57, 13.48s/it, est. speed input: 32.56 toks/s, output: 7.12 toks/s]
Processed prompts:   1%|          | 3/526 [00:13<31:06,  3.57s/it, est. speed input: 136.62 toks/s, output: 21.27 toks/s]
Processed prompts:   1%|          | 5/526 [00:13<15:35,  1.80s/it, est. speed input: 183.64 toks/s, output: 35.21 toks/s]
Processed prompts:   1%|          | 6/526 [00:14<11:51,  1.37s/it, est. speed input: 223.34 toks/s, output: 41.99 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:14<07:00,  1.23it/s, est. speed input: 306.74 toks/s, output: 56.02 toks/s]
Processed prompts:   2%|▏         | 10/526 [00:14<04:42,  1.83it/s, est. speed input: 353.42 toks/s, output: 69.75 toks/s]
Processed prompts:   2%|▏         | 13/526 [00:14<02:51,  2.99it/s, est. speed input: 465.05 toks/s, output: 90.91 toks/s]
Processed prompts:   3%|▎         | 17/526 [00:15<01:48,  4.70it/s, est. speed input: 605.75 toks/s, output: 118.69 toks/s]
Processed prompts:   4%|▍         | 21/526 [00:15<01:19,  6.34it/s, est. speed input: 741.03 toks/s, output: 145.98 toks/s]
Processed prompts:   4%|▍         | 23/526 [00:15<01:15,  6.63it/s, est. speed input: 781.60 toks/s, output: 158.62 toks/s]
Processed prompts:   5%|▍         | 25/526 [00:15<01:06,  7.53it/s, est. speed input: 828.93 toks/s, output: 172.33 toks/s]
Processed prompts:   5%|▌         | 27/526 [00:16<01:07,  7.42it/s, est. speed input: 937.20 toks/s, output: 184.53 toks/s]
Processed prompts:   6%|▌         | 31/526 [00:16<00:51,  9.53it/s, est. speed input: 1036.16 toks/s, output: 212.08 toks/s]
Processed prompts:   7%|▋         | 36/526 [00:16<00:36, 13.25it/s, est. speed input: 1180.09 toks/s, output: 247.75 toks/s]
Processed prompts:   8%|▊         | 41/526 [00:16<00:33, 14.41it/s, est. speed input: 1298.02 toks/s, output: 280.99 toks/s]
Processed prompts:   9%|▊         | 45/526 [00:17<00:34, 13.85it/s, est. speed input: 1408.38 toks/s, output: 305.86 toks/s]
Processed prompts:   9%|▉         | 48/526 [00:17<00:34, 13.83it/s, est. speed input: 1477.43 toks/s, output: 324.61 toks/s]
Processed prompts:  10%|█         | 54/526 [00:17<00:27, 17.13it/s, est. speed input: 1650.79 toks/s, output: 365.23 toks/s]
Processed prompts:  11%|█         | 59/526 [00:17<00:28, 16.28it/s, est. speed input: 1781.35 toks/s, output: 395.31 toks/s]
Processed prompts:  12%|█▏        | 61/526 [00:17<00:28, 16.58it/s, est. speed input: 1831.09 toks/s, output: 407.77 toks/s]
Processed prompts:  12%|█▏        | 63/526 [00:18<00:29, 15.79it/s, est. speed input: 1883.10 toks/s, output: 419.21 toks/s]
Processed prompts:  13%|█▎        | 66/526 [00:18<00:27, 16.55it/s, est. speed input: 1950.71 toks/s, output: 437.77 toks/s]
Processed prompts:  14%|█▍        | 74/526 [00:18<00:26, 17.21it/s, est. speed input: 2134.17 toks/s, output: 485.43 toks/s]
Processed prompts:  16%|█▌        | 82/526 [00:19<00:23, 18.72it/s, est. speed input: 2307.60 toks/s, output: 533.67 toks/s]
Processed prompts:  17%|█▋        | 87/526 [00:19<00:20, 21.09it/s, est. speed input: 2435.05 toks/s, output: 565.41 toks/s]
Processed prompts:  18%|█▊        | 93/526 [00:19<00:20, 20.68it/s, est. speed input: 2565.07 toks/s, output: 599.65 toks/s]
Processed prompts:  19%|█▉        | 99/526 [00:19<00:20, 20.73it/s, est. speed input: 2698.24 toks/s, output: 633.80 toks/s]
Processed prompts:  20%|█▉        | 103/526 [00:20<00:19, 21.23it/s, est. speed input: 2779.00 toks/s, output: 656.93 toks/s]
Processed prompts:  20%|██        | 106/526 [00:20<00:22, 18.88it/s, est. speed input: 2842.43 toks/s, output: 670.83 toks/s]
Processed prompts:  21%|██        | 111/526 [00:20<00:20, 20.59it/s, est. speed input: 2964.65 toks/s, output: 699.89 toks/s]
Processed prompts:  22%|██▏       | 114/526 [00:20<00:22, 18.40it/s, est. speed input: 3055.81 toks/s, output: 713.54 toks/s]
Processed prompts:  22%|██▏       | 118/526 [00:20<00:22, 18.02it/s, est. speed input: 3119.19 toks/s, output: 733.94 toks/s]
Processed prompts:  23%|██▎       | 122/526 [00:21<00:19, 20.25it/s, est. speed input: 3223.98 toks/s, output: 757.45 toks/s]
Processed prompts:  24%|██▍       | 126/526 [00:21<00:22, 17.50it/s, est. speed input: 3272.04 toks/s, output: 774.86 toks/s]
Processed prompts:  25%|██▌       | 132/526 [00:21<00:19, 20.53it/s, est. speed input: 3429.19 toks/s, output: 809.28 toks/s]
Processed prompts:  26%|██▌       | 135/526 [00:21<00:19, 19.65it/s, est. speed input: 3470.89 toks/s, output: 823.92 toks/s]
Processed prompts:  26%|██▌       | 138/526 [00:22<00:23, 16.77it/s, est. speed input: 3511.04 toks/s, output: 835.08 toks/s]
Processed prompts:  27%|██▋       | 143/526 [00:22<00:19, 20.05it/s, est. speed input: 3595.81 toks/s, output: 863.95 toks/s]
Processed prompts:  28%|██▊       | 148/526 [00:22<00:19, 19.62it/s, est. speed input: 3677.67 toks/s, output: 888.53 toks/s]
Processed prompts:  29%|██▉       | 153/526 [00:22<00:17, 21.18it/s, est. speed input: 3771.45 toks/s, output: 915.50 toks/s]
Processed prompts:  30%|██▉       | 156/526 [00:22<00:19, 18.66it/s, est. speed input: 3806.33 toks/s, output: 927.18 toks/s]
Processed prompts:  30%|███       | 160/526 [00:23<00:20, 17.60it/s, est. speed input: 3851.66 toks/s, output: 944.55 toks/s]
Processed prompts:  31%|███       | 162/526 [00:23<00:20, 17.81it/s, est. speed input: 3884.78 toks/s, output: 954.15 toks/s]
Processed prompts:  32%|███▏      | 168/526 [00:23<00:19, 18.65it/s, est. speed input: 4010.84 toks/s, output: 983.27 toks/s]
Processed prompts:  33%|███▎      | 172/526 [00:23<00:16, 21.90it/s, est. speed input: 4100.52 toks/s, output: 1006.56 toks/s]
Processed prompts:  34%|███▎      | 177/526 [00:23<00:17, 20.32it/s, est. speed input: 4187.62 toks/s, output: 1029.07 toks/s]
Processed prompts:  34%|███▍      | 180/526 [00:24<00:16, 21.24it/s, est. speed input: 4254.55 toks/s, output: 1044.60 toks/s]
Processed prompts:  35%|███▍      | 184/526 [00:24<00:17, 19.09it/s, est. speed input: 4309.84 toks/s, output: 1060.85 toks/s]
Processed prompts:  36%|███▌      | 188/526 [00:24<00:17, 19.43it/s, est. speed input: 4370.67 toks/s, output: 1079.61 toks/s]
Processed prompts:  37%|███▋      | 194/526 [00:24<00:18, 17.95it/s, est. speed input: 4536.43 toks/s, output: 1103.97 toks/s]
Processed prompts:  37%|███▋      | 197/526 [00:24<00:17, 18.94it/s, est. speed input: 4581.74 toks/s, output: 1118.68 toks/s]
Processed prompts:  38%|███▊      | 201/526 [00:25<00:18, 17.62it/s, est. speed input: 4642.66 toks/s, output: 1133.89 toks/s]
Processed prompts:  39%|███▉      | 205/526 [00:25<00:20, 15.63it/s, est. speed input: 4664.30 toks/s, output: 1146.46 toks/s]
Processed prompts:  40%|███▉      | 209/526 [00:25<00:21, 14.83it/s, est. speed input: 4726.16 toks/s, output: 1160.11 toks/s]
Processed prompts:  40%|████      | 211/526 [00:26<00:23, 13.13it/s, est. speed input: 4721.05 toks/s, output: 1163.37 toks/s]
Processed prompts:  40%|████      | 213/526 [00:26<00:24, 12.65it/s, est. speed input: 4731.54 toks/s, output: 1168.99 toks/s]
Processed prompts:  41%|████      | 216/526 [00:26<00:23, 13.34it/s, est. speed input: 4759.66 toks/s, output: 1180.82 toks/s]
Processed prompts:  41%|████▏     | 218/526 [00:26<00:26, 11.75it/s, est. speed input: 4768.30 toks/s, output: 1183.94 toks/s]
Processed prompts:  42%|████▏     | 221/526 [00:26<00:22, 13.75it/s, est. speed input: 4829.81 toks/s, output: 1198.45 toks/s]
Processed prompts:  43%|████▎     | 225/526 [00:27<00:20, 14.81it/s, est. speed input: 4860.82 toks/s, output: 1215.49 toks/s]
Processed prompts:  43%|████▎     | 227/526 [00:27<00:20, 14.59it/s, est. speed input: 4879.92 toks/s, output: 1222.89 toks/s]
Processed prompts:  44%|████▎     | 229/526 [00:27<00:23, 12.40it/s, est. speed input: 4882.65 toks/s, output: 1226.02 toks/s]
Processed prompts:  44%|████▍     | 231/526 [00:27<00:24, 12.01it/s, est. speed input: 4895.36 toks/s, output: 1231.87 toks/s]
Processed prompts:  45%|████▍     | 236/526 [00:27<00:17, 16.85it/s, est. speed input: 4985.48 toks/s, output: 1259.34 toks/s]
Processed prompts:  45%|████▌     | 238/526 [00:28<00:18, 15.20it/s, est. speed input: 5003.77 toks/s, output: 1265.17 toks/s]
Processed prompts:  46%|████▌     | 240/526 [00:28<00:19, 14.85it/s, est. speed input: 5028.93 toks/s, output: 1272.64 toks/s]
Processed prompts:  46%|████▌     | 242/526 [00:28<00:23, 11.84it/s, est. speed input: 5029.27 toks/s, output: 1274.40 toks/s]
Processed prompts:  46%|████▋     | 244/526 [00:28<00:31,  8.99it/s, est. speed input: 5019.62 toks/s, output: 1271.93 toks/s]
Processed prompts:  47%|████▋     | 246/526 [00:29<00:33,  8.34it/s, est. speed input: 5019.52 toks/s, output: 1273.58 toks/s]
Processed prompts:  47%|████▋     | 247/526 [00:29<00:34,  7.99it/s, est. speed input: 5021.25 toks/s, output: 1274.11 toks/s]
Processed prompts:  47%|████▋     | 248/526 [00:29<01:00,  4.60it/s, est. speed input: 4933.27 toks/s, output: 1255.37 toks/s]
Processed prompts:  47%|████▋     | 249/526 [00:30<01:01,  4.48it/s, est. speed input: 4912.06 toks/s, output: 1249.47 toks/s]
Processed prompts:  48%|████▊     | 250/526 [00:30<01:19,  3.45it/s, est. speed input: 4844.62 toks/s, output: 1233.00 toks/s]
Processed prompts:  48%|████▊     | 252/526 [00:30<00:58,  4.70it/s, est. speed input: 4849.76 toks/s, output: 1236.28 toks/s]
Processed prompts:  48%|████▊     | 253/526 [00:30<00:54,  5.01it/s, est. speed input: 4846.31 toks/s, output: 1237.82 toks/s]
Processed prompts:  48%|████▊     | 254/526 [00:31<00:51,  5.31it/s, est. speed input: 4841.22 toks/s, output: 1236.31 toks/s]
Processed prompts:  48%|████▊     | 255/526 [00:31<00:48,  5.63it/s, est. speed input: 4837.46 toks/s, output: 1234.90 toks/s]
Processed prompts:  49%|████▉     | 257/526 [00:31<00:40,  6.57it/s, est. speed input: 4844.08 toks/s, output: 1234.65 toks/s]
Processed prompts:  49%|████▉     | 258/526 [00:31<00:46,  5.74it/s, est. speed input: 4826.90 toks/s, output: 1229.64 toks/s]
Processed prompts:  50%|████▉     | 261/526 [00:31<00:30,  8.80it/s, est. speed input: 4856.78 toks/s, output: 1237.95 toks/s]
Processed prompts:  50%|█████     | 263/526 [00:32<00:31,  8.31it/s, est. speed input: 4887.09 toks/s, output: 1235.52 toks/s]
Processed prompts:  50%|█████     | 265/526 [00:32<00:28,  9.05it/s, est. speed input: 4893.93 toks/s, output: 1237.26 toks/s]
Processed prompts:  51%|█████     | 267/526 [00:32<00:23, 10.90it/s, est. speed input: 4913.55 toks/s, output: 1244.96 toks/s]
Processed prompts:  51%|█████▏    | 270/526 [00:32<00:22, 11.35it/s, est. speed input: 4926.77 toks/s, output: 1246.53 toks/s]
Processed prompts:  52%|█████▏    | 273/526 [00:32<00:18, 13.37it/s, est. speed input: 4966.10 toks/s, output: 1252.18 toks/s]
Processed prompts:  52%|█████▏    | 275/526 [00:33<00:20, 12.11it/s, est. speed input: 4978.50 toks/s, output: 1251.43 toks/s]
Processed prompts:  53%|█████▎    | 277/526 [00:33<00:18, 13.43it/s, est. speed input: 5007.41 toks/s, output: 1255.58 toks/s]
Processed prompts:  53%|█████▎    | 281/526 [00:33<00:13, 18.70it/s, est. speed input: 5049.39 toks/s, output: 1267.12 toks/s]
Processed prompts:  55%|█████▍    | 287/526 [00:33<00:08, 27.80it/s, est. speed input: 5152.92 toks/s, output: 1287.41 toks/s]
Processed prompts:  56%|█████▌    | 293/526 [00:33<00:06, 35.42it/s, est. speed input: 5232.06 toks/s, output: 1305.74 toks/s]
Processed prompts:  57%|█████▋    | 298/526 [00:33<00:08, 28.18it/s, est. speed input: 5295.34 toks/s, output: 1316.23 toks/s]
Processed prompts:  58%|█████▊    | 303/526 [00:33<00:06, 32.68it/s, est. speed input: 5377.54 toks/s, output: 1332.03 toks/s]
Processed prompts:  58%|█████▊    | 307/526 [00:34<00:08, 25.75it/s, est. speed input: 5413.17 toks/s, output: 1339.70 toks/s]
Processed prompts:  60%|█████▉    | 314/526 [00:34<00:06, 31.91it/s, est. speed input: 5523.92 toks/s, output: 1365.05 toks/s]
Processed prompts:  61%|██████▏   | 323/526 [00:34<00:04, 40.93it/s, est. speed input: 5639.33 toks/s, output: 1398.77 toks/s]
Processed prompts:  63%|██████▎   | 330/526 [00:34<00:04, 44.08it/s, est. speed input: 5735.86 toks/s, output: 1421.13 toks/s]
Processed prompts:  65%|██████▍   | 340/526 [00:34<00:03, 53.15it/s, est. speed input: 5877.83 toks/s, output: 1457.64 toks/s]
Processed prompts:  66%|██████▌   | 346/526 [00:34<00:03, 47.38it/s, est. speed input: 5950.17 toks/s, output: 1476.80 toks/s]
Processed prompts:  67%|██████▋   | 352/526 [00:34<00:03, 47.74it/s, est. speed input: 6036.03 toks/s, output: 1500.24 toks/s]
Processed prompts:  69%|██████▉   | 362/526 [00:35<00:02, 57.34it/s, est. speed input: 6180.52 toks/s, output: 1543.48 toks/s]
Processed prompts:  71%|███████   | 373/526 [00:35<00:04, 34.05it/s, est. speed input: 6292.92 toks/s, output: 1573.36 toks/s]
Processed prompts:  72%|███████▏  | 378/526 [00:35<00:04, 35.53it/s, est. speed input: 6361.95 toks/s, output: 1589.32 toks/s]
Processed prompts:  74%|███████▍  | 389/526 [00:35<00:02, 47.14it/s, est. speed input: 6524.61 toks/s, output: 1631.36 toks/s]
Processed prompts:  75%|███████▌  | 396/526 [00:35<00:02, 47.52it/s, est. speed input: 6627.76 toks/s, output: 1655.00 toks/s]
Processed prompts:  78%|███████▊  | 409/526 [00:36<00:01, 60.35it/s, est. speed input: 6844.20 toks/s, output: 1706.63 toks/s]
Processed prompts:  79%|███████▉  | 417/526 [00:36<00:01, 61.87it/s, est. speed input: 6975.52 toks/s, output: 1741.03 toks/s]
Processed prompts:  81%|████████  | 424/526 [00:36<00:01, 61.43it/s, est. speed input: 7099.86 toks/s, output: 1769.69 toks/s]
Processed prompts:  82%|████████▏ | 433/526 [00:36<00:01, 66.49it/s, est. speed input: 7248.10 toks/s, output: 1807.97 toks/s]
Processed prompts:  84%|████████▍ | 444/526 [00:36<00:01, 71.78it/s, est. speed input: 7452.55 toks/s, output: 1855.24 toks/s]
Processed prompts:  86%|████████▌ | 452/526 [00:36<00:01, 65.72it/s, est. speed input: 7584.73 toks/s, output: 1882.17 toks/s]
Processed prompts:  87%|████████▋ | 460/526 [00:36<00:00, 66.00it/s, est. speed input: 7688.77 toks/s, output: 1913.31 toks/s]
Processed prompts:  89%|████████▉ | 467/526 [00:36<00:00, 61.56it/s, est. speed input: 7824.62 toks/s, output: 1939.08 toks/s]
Processed prompts:  90%|█████████ | 474/526 [00:37<00:00, 62.33it/s, est. speed input: 7937.76 toks/s, output: 1968.27 toks/s]
Processed prompts:  91%|█████████▏| 481/526 [00:37<00:00, 57.79it/s, est. speed input: 8044.66 toks/s, output: 1995.78 toks/s]
Processed prompts:  93%|█████████▎| 487/526 [00:37<00:00, 50.61it/s, est. speed input: 8129.61 toks/s, output: 2027.11 toks/s]
Processed prompts:  94%|█████████▎| 493/526 [00:37<00:00, 41.06it/s, est. speed input: 8189.21 toks/s, output: 2052.11 toks/s]
Processed prompts:  95%|█████████▍| 498/526 [00:37<00:00, 33.24it/s, est. speed input: 8215.08 toks/s, output: 2060.24 toks/s]
Processed prompts:  95%|█████████▌| 502/526 [00:38<00:00, 27.16it/s, est. speed input: 8232.49 toks/s, output: 2064.90 toks/s]
Processed prompts:  96%|█████████▌| 506/526 [00:38<00:00, 28.83it/s, est. speed input: 8270.04 toks/s, output: 2077.18 toks/s]
Processed prompts:  97%|█████████▋| 510/526 [00:38<00:00, 20.44it/s, est. speed input: 8259.35 toks/s, output: 2076.58 toks/s]
Processed prompts:  98%|█████████▊| 513/526 [00:38<00:00, 16.81it/s, est. speed input: 8244.52 toks/s, output: 2081.94 toks/s]
Processed prompts:  98%|█████████▊| 516/526 [00:39<00:00, 10.83it/s, est. speed input: 8169.58 toks/s, output: 2074.13 toks/s]
Processed prompts:  98%|█████████▊| 518/526 [00:39<00:00, 10.71it/s, est. speed input: 8175.59 toks/s, output: 2081.10 toks/s]
Processed prompts:  99%|█████████▉| 520/526 [00:39<00:00,  9.94it/s, est. speed input: 8173.89 toks/s, output: 2087.87 toks/s]
Processed prompts:  99%|█████████▉| 522/526 [00:40<00:00,  9.03it/s, est. speed input: 8165.93 toks/s, output: 2088.19 toks/s]
Processed prompts: 100%|█████████▉| 524/526 [00:40<00:00,  7.56it/s, est. speed input: 8120.65 toks/s, output: 2087.51 toks/s]
Processed prompts: 100%|██████████| 526/526 [00:41<00:00,  3.56it/s, est. speed input: 7896.12 toks/s, output: 2036.92 toks/s]
Processed prompts: 100%|██████████| 526/526 [00:41<00:00, 12.53it/s, est. speed input: 7896.12 toks/s, output: 2036.92 toks/s]
{  "personalized_answer": "Starting the conversation about rules with your toddler is a great idea. You can begin by explaining that different households have different rules, just like how different TV shows have different ways of showing stories. For example, you might say, 'At our house, we don't use big words like "sob" or "screw you" because they can hurt people's feelings. But sometimes, in TV shows, characters use those words to show strong emotions. It's important to understand that these are just stories and not how we talk in real life. We can teach you about our house rules by showing you what we do and don't do, and why. This way, you'll learn to respect our rules and understand that other places might have different ones too.' This approach helps your toddler grasp the concept without feeling judged or restricted."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.46s/it, est. speed input: 266.10 toks/s, output: 82.47 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.46s/it, est. speed input: 266.10 toks/s, output: 82.47 toks/s]
[rank0]:[W709 16:05:50.628875838 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/lp_rag_ae_sc_test_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 16:05:53.758565_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 16:05:53.758565_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 16:05:53.758565_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<02:19,  3.03it/s]
  0%|          | 2/424 [00:00<02:20,  3.00it/s]
  1%|          | 4/424 [00:01<02:08,  3.27it/s]
  2%|▏         | 7/424 [00:01<01:23,  5.02it/s]
  2%|▏         | 10/424 [00:01<01:02,  6.63it/s]
  3%|▎         | 11/424 [00:01<00:58,  7.05it/s]
  3%|▎         | 13/424 [00:03<02:24,  2.84it/s]
  4%|▎         | 15/424 [00:03<01:51,  3.66it/s]
  4%|▍         | 16/424 [00:04<01:53,  3.58it/s]
  4%|▍         | 17/424 [00:04<01:43,  3.93it/s]
  5%|▍         | 20/424 [00:04<01:05,  6.17it/s]
  5%|▍         | 21/424 [00:04<01:03,  6.37it/s]
  5%|▌         | 22/424 [00:04<01:04,  6.19it/s]
  5%|▌         | 23/424 [00:05<01:52,  3.58it/s]
  6%|▌         | 25/424 [00:05<01:34,  4.23it/s]
  6%|▋         | 27/424 [00:06<01:39,  4.00it/s]
  7%|▋         | 30/424 [00:06<01:05,  6.05it/s]
  8%|▊         | 33/424 [00:06<00:44,  8.69it/s]
  8%|▊         | 36/424 [00:06<00:33, 11.46it/s]
  9%|▉         | 38/424 [00:07<01:00,  6.34it/s]
  9%|▉         | 40/424 [00:07<00:51,  7.41it/s]
 10%|█         | 44/424 [00:08<00:53,  7.06it/s]
 11%|█▏        | 48/424 [00:08<00:36, 10.17it/s]
 12%|█▏        | 52/424 [00:08<00:39,  9.37it/s]
 13%|█▎        | 54/424 [00:09<00:43,  8.51it/s]
 14%|█▎        | 58/424 [00:09<00:31, 11.52it/s]
 14%|█▍        | 60/424 [00:09<00:45,  7.93it/s]
 15%|█▍        | 62/424 [00:11<01:42,  3.55it/s]
 15%|█▌        | 64/424 [00:11<01:29,  4.01it/s]
 15%|█▌        | 65/424 [00:11<01:21,  4.40it/s]
 16%|█▌        | 66/424 [00:12<01:40,  3.57it/s]
 16%|█▌        | 67/424 [00:12<01:33,  3.82it/s]
 16%|█▌        | 68/424 [00:12<01:36,  3.68it/s]
 16%|█▋        | 69/424 [00:13<01:56,  3.05it/s]
 17%|█▋        | 70/424 [00:13<01:40,  3.53it/s]
 17%|█▋        | 71/424 [00:13<01:27,  4.02it/s]
 17%|█▋        | 72/424 [00:13<01:18,  4.48it/s]
 17%|█▋        | 73/424 [00:13<01:11,  4.93it/s]
 17%|█▋        | 74/424 [00:14<01:06,  5.29it/s]
 18%|█▊        | 75/424 [00:14<00:57,  6.11it/s]
 18%|█▊        | 77/424 [00:14<00:45,  7.67it/s]
 19%|█▉        | 80/424 [00:14<00:30, 11.42it/s]
 19%|█▉        | 82/424 [00:15<00:53,  6.34it/s]
 20%|█▉        | 83/424 [00:15<01:02,  5.48it/s]
 20%|██        | 85/424 [00:15<01:00,  5.63it/s]
 20%|██        | 86/424 [00:16<01:36,  3.49it/s]
 21%|██        | 87/424 [00:16<01:28,  3.80it/s]
 21%|██        | 89/424 [00:16<01:13,  4.58it/s]
 21%|██        | 90/424 [00:17<01:10,  4.76it/s]
 21%|██▏       | 91/424 [00:17<01:07,  4.95it/s]
 22%|██▏       | 92/424 [00:17<01:04,  5.12it/s]
 22%|██▏       | 93/424 [00:17<01:10,  4.71it/s]
 22%|██▏       | 94/424 [00:17<01:06,  4.94it/s]
 23%|██▎       | 96/424 [00:18<00:49,  6.67it/s]
 23%|██▎       | 98/424 [00:18<00:37,  8.67it/s]
 24%|██▎       | 100/424 [00:18<00:59,  5.41it/s]
 24%|██▍       | 101/424 [00:19<02:03,  2.62it/s]
 24%|██▍       | 103/424 [00:20<01:32,  3.48it/s]
 25%|██▍       | 105/424 [00:20<01:10,  4.55it/s]
 25%|██▌       | 107/424 [00:20<01:13,  4.29it/s]
 26%|██▌       | 109/424 [00:24<03:28,  1.51it/s]
 26%|██▌       | 110/424 [00:24<03:20,  1.57it/s]
 26%|██▌       | 111/424 [00:24<02:46,  1.88it/s]
 27%|██▋       | 114/424 [00:24<01:34,  3.29it/s]
 27%|██▋       | 116/424 [00:24<01:11,  4.32it/s]
 28%|██▊       | 118/424 [00:25<00:59,  5.18it/s]
 28%|██▊       | 120/424 [00:25<00:52,  5.79it/s]
 29%|██▉       | 122/424 [00:29<03:30,  1.43it/s]
 29%|██▉       | 123/424 [00:33<06:18,  1.26s/it]
 29%|██▉       | 124/424 [00:36<08:55,  1.79s/it]
 29%|██▉       | 125/424 [00:40<11:11,  2.25s/it]
 30%|██▉       | 126/424 [00:44<13:04,  2.63s/it]
 30%|██▉       | 127/424 [00:48<14:40,  2.96s/it]
 30%|███       | 128/424 [00:48<10:54,  2.21s/it]
 30%|███       | 129/424 [00:48<08:03,  1.64s/it]
 31%|███       | 130/424 [00:49<05:56,  1.21s/it]
 31%|███       | 131/424 [00:49<04:26,  1.10it/s]
 31%|███▏      | 133/424 [00:49<02:53,  1.68it/s]
 32%|███▏      | 136/424 [00:49<01:32,  3.12it/s]
 33%|███▎      | 139/424 [00:49<00:57,  4.93it/s]
 33%|███▎      | 142/424 [00:49<00:39,  7.07it/s]
 34%|███▍      | 145/424 [00:50<00:29,  9.54it/s]
 35%|███▍      | 148/424 [00:50<00:22, 12.22it/s]
 36%|███▌      | 151/424 [00:50<00:18, 14.91it/s]
 36%|███▋      | 154/424 [00:50<00:15, 17.51it/s]
 37%|███▋      | 157/424 [00:50<00:13, 19.42it/s]
 38%|███▊      | 160/424 [00:52<00:51,  5.09it/s]
 38%|███▊      | 163/424 [00:52<00:38,  6.77it/s]
 39%|███▉      | 166/424 [00:52<00:29,  8.75it/s]
 40%|███▉      | 169/424 [00:52<00:27,  9.33it/s]
 40%|████      | 171/424 [00:53<00:35,  7.12it/s]
 41%|████      | 173/424 [00:53<00:29,  8.43it/s]
 41%|████▏     | 175/424 [00:54<00:52,  4.74it/s]
 42%|████▏     | 177/424 [00:54<00:41,  5.92it/s]
 42%|████▏     | 179/424 [00:54<00:43,  5.69it/s]
 43%|████▎     | 181/424 [00:54<00:39,  6.08it/s]
 43%|████▎     | 184/424 [00:55<00:30,  7.94it/s]
 44%|████▍     | 188/424 [00:55<00:20, 11.28it/s]
 45%|████▍     | 190/424 [00:58<01:39,  2.36it/s]
 45%|████▌     | 192/424 [00:58<01:30,  2.56it/s]
 46%|████▌     | 194/424 [00:58<01:09,  3.29it/s]
 46%|████▌     | 196/424 [00:59<01:08,  3.34it/s]
 46%|████▋     | 197/424 [00:59<01:05,  3.48it/s]
 47%|████▋     | 198/424 [00:59<00:59,  3.82it/s]
 47%|████▋     | 199/424 [01:00<01:10,  3.18it/s]
 47%|████▋     | 200/424 [01:00<01:01,  3.64it/s]
 47%|████▋     | 201/424 [01:01<01:09,  3.21it/s]
 48%|████▊     | 202/424 [01:01<01:01,  3.61it/s]
 48%|████▊     | 203/424 [01:01<01:07,  3.27it/s]
 48%|████▊     | 204/424 [01:03<02:22,  1.54it/s]
 48%|████▊     | 205/424 [01:03<01:52,  1.94it/s]
 49%|████▊     | 206/424 [01:06<04:29,  1.24s/it]
 49%|████▉     | 207/424 [01:06<03:24,  1.06it/s]
 49%|████▉     | 209/424 [01:06<01:59,  1.79it/s]
 50%|█████     | 212/424 [01:06<01:05,  3.26it/s]
 50%|█████     | 213/424 [01:07<01:12,  2.92it/s]
 50%|█████     | 214/424 [01:07<01:19,  2.65it/s]
 51%|█████     | 215/424 [01:08<01:25,  2.45it/s]
 51%|█████     | 217/424 [01:08<01:00,  3.40it/s]
 51%|█████▏    | 218/424 [01:08<00:57,  3.57it/s]
 52%|█████▏    | 219/424 [01:09<00:53,  3.82it/s]
 52%|█████▏    | 220/424 [01:09<01:06,  3.05it/s]
 52%|█████▏    | 222/424 [01:09<00:55,  3.62it/s]
 53%|█████▎    | 223/424 [01:10<00:51,  3.93it/s]
 53%|█████▎    | 224/424 [01:10<00:43,  4.63it/s]
 53%|█████▎    | 225/424 [01:10<00:59,  3.32it/s]
 54%|█████▎    | 227/424 [01:10<00:39,  4.99it/s]
 54%|█████▍    | 229/424 [01:11<00:29,  6.66it/s]
 54%|█████▍    | 230/424 [01:12<01:24,  2.30it/s]
 54%|█████▍    | 231/424 [01:13<01:26,  2.24it/s]
 55%|█████▍    | 233/424 [01:13<01:07,  2.83it/s]
 55%|█████▌    | 234/424 [01:17<03:34,  1.13s/it]
 55%|█████▌    | 235/424 [01:17<03:05,  1.02it/s]
 56%|█████▌    | 236/424 [01:18<02:29,  1.26it/s]
 56%|█████▋    | 239/424 [01:18<01:14,  2.48it/s]
 57%|█████▋    | 240/424 [01:18<01:18,  2.36it/s]
 57%|█████▋    | 241/424 [01:19<01:21,  2.26it/s]
 57%|█████▋    | 243/424 [01:19<00:59,  3.06it/s]
 58%|█████▊    | 244/424 [01:19<00:50,  3.58it/s]
 58%|█████▊    | 246/424 [01:19<00:37,  4.79it/s]
 58%|█████▊    | 247/424 [01:20<00:45,  3.88it/s]
 58%|█████▊    | 248/424 [01:20<00:39,  4.48it/s]
 59%|█████▉    | 250/424 [01:20<00:30,  5.75it/s]
 59%|█████▉    | 252/424 [01:20<00:24,  6.95it/s]
 60%|█████▉    | 254/424 [01:20<00:21,  7.91it/s]
 60%|██████    | 256/424 [01:21<00:19,  8.73it/s]
 61%|██████    | 258/424 [01:21<00:18,  9.19it/s]
 61%|██████▏   | 260/424 [01:21<00:22,  7.36it/s]
 62%|██████▏   | 262/424 [01:21<00:17,  9.08it/s]
 62%|██████▏   | 264/424 [01:22<00:38,  4.14it/s]
 63%|██████▎   | 266/424 [01:23<00:31,  4.94it/s]
 63%|██████▎   | 268/424 [01:23<00:26,  5.92it/s]
 63%|██████▎   | 269/424 [01:23<00:35,  4.35it/s]
 64%|██████▍   | 271/424 [01:23<00:25,  5.89it/s]
 64%|██████▍   | 273/424 [01:24<00:23,  6.47it/s]
 65%|██████▌   | 277/424 [01:24<00:14, 10.46it/s]
 66%|██████▌   | 279/424 [01:24<00:16,  9.01it/s]
 66%|██████▋   | 281/424 [01:25<00:21,  6.60it/s]
 67%|██████▋   | 283/424 [01:26<00:46,  3.05it/s]
 67%|██████▋   | 285/424 [01:26<00:35,  3.92it/s]
 68%|██████▊   | 287/424 [01:27<00:31,  4.35it/s]
 68%|██████▊   | 288/424 [01:27<00:29,  4.56it/s]
 68%|██████▊   | 290/424 [01:27<00:22,  5.83it/s]
 69%|██████▊   | 291/424 [01:27<00:23,  5.76it/s]
 69%|██████▉   | 293/424 [01:29<00:52,  2.50it/s]
 70%|██████▉   | 295/424 [01:29<00:44,  2.87it/s]
 70%|██████▉   | 296/424 [01:29<00:38,  3.29it/s]
 70%|███████   | 297/424 [01:30<00:38,  3.27it/s]
 70%|███████   | 298/424 [01:30<00:34,  3.63it/s]
 71%|███████   | 301/424 [01:30<00:20,  5.96it/s]
 71%|███████   | 302/424 [01:34<01:47,  1.14it/s]
 72%|███████▏  | 304/424 [01:34<01:11,  1.69it/s]
 72%|███████▏  | 305/424 [01:34<01:00,  1.97it/s]
 72%|███████▏  | 306/424 [01:35<00:54,  2.15it/s]
 73%|███████▎  | 308/424 [01:35<00:40,  2.84it/s]
 73%|███████▎  | 309/424 [01:35<00:34,  3.29it/s]
 73%|███████▎  | 310/424 [01:36<00:48,  2.37it/s]
 74%|███████▎  | 312/424 [01:36<00:30,  3.67it/s]
 74%|███████▍  | 313/424 [01:36<00:26,  4.16it/s]
 74%|███████▍  | 314/424 [01:36<00:28,  3.90it/s]
 74%|███████▍  | 315/424 [01:37<00:25,  4.23it/s]
 75%|███████▍  | 317/424 [01:37<00:19,  5.50it/s]
 75%|███████▌  | 318/424 [01:37<00:19,  5.56it/s]
 75%|███████▌  | 319/424 [01:37<00:18,  5.63it/s]
 75%|███████▌  | 320/424 [01:37<00:17,  5.86it/s]
 76%|███████▌  | 322/424 [01:37<00:13,  7.76it/s]
 76%|███████▌  | 323/424 [01:38<00:13,  7.28it/s]
 77%|███████▋  | 325/424 [01:38<00:10,  9.72it/s]
 77%|███████▋  | 327/424 [01:42<01:16,  1.27it/s]
 77%|███████▋  | 328/424 [01:42<01:08,  1.41it/s]
 78%|███████▊  | 329/424 [01:42<00:58,  1.62it/s]
 78%|███████▊  | 330/424 [01:43<00:47,  1.97it/s]
 79%|███████▊  | 333/424 [01:43<00:34,  2.60it/s]
 79%|███████▉  | 334/424 [01:44<00:31,  2.85it/s]
 79%|███████▉  | 336/424 [01:44<00:21,  4.05it/s]
 79%|███████▉  | 337/424 [01:48<01:25,  1.01it/s]
 80%|███████▉  | 338/424 [01:48<01:09,  1.24it/s]
 80%|███████▉  | 339/424 [01:48<00:58,  1.46it/s]
 80%|████████  | 340/424 [01:52<02:05,  1.50s/it]
 80%|████████  | 341/424 [01:52<01:42,  1.24s/it]
 81%|████████  | 342/424 [01:53<01:22,  1.00s/it]
 81%|████████  | 344/424 [01:53<00:50,  1.60it/s]
 82%|████████▏ | 346/424 [01:53<00:35,  2.23it/s]
 82%|████████▏ | 347/424 [01:54<00:38,  2.00it/s]
 83%|████████▎ | 350/424 [01:55<00:28,  2.56it/s]
 83%|████████▎ | 352/424 [01:59<01:03,  1.14it/s]
 83%|████████▎ | 353/424 [01:59<00:54,  1.30it/s]
 83%|████████▎ | 354/424 [02:00<00:54,  1.29it/s]
 84%|████████▍ | 356/424 [02:01<00:40,  1.68it/s]
 84%|████████▍ | 357/424 [02:01<00:35,  1.88it/s]
 84%|████████▍ | 358/424 [02:02<00:38,  1.71it/s]
 85%|████████▍ | 359/424 [02:02<00:40,  1.61it/s]
 85%|████████▍ | 360/424 [02:02<00:31,  2.05it/s]
 85%|████████▌ | 361/424 [02:03<00:24,  2.52it/s]
 85%|████████▌ | 362/424 [02:03<00:22,  2.74it/s]
 86%|████████▌ | 363/424 [02:07<01:23,  1.38s/it]
 86%|████████▌ | 364/424 [02:07<01:03,  1.07s/it]
 86%|████████▌ | 365/424 [02:07<00:47,  1.24it/s]
 87%|████████▋ | 368/424 [02:11<01:00,  1.08s/it]
 87%|████████▋ | 369/424 [02:11<00:49,  1.10it/s]
 88%|████████▊ | 372/424 [02:12<00:26,  1.98it/s]
 88%|████████▊ | 373/424 [02:12<00:22,  2.31it/s]
 88%|████████▊ | 374/424 [02:12<00:18,  2.65it/s]
 89%|████████▊ | 376/424 [02:12<00:15,  3.04it/s]
 89%|████████▉ | 377/424 [02:13<00:13,  3.36it/s]
 89%|████████▉ | 379/424 [02:13<00:11,  3.95it/s]
 90%|████████▉ | 380/424 [02:13<00:13,  3.19it/s]
 90%|█████████ | 382/424 [02:14<00:09,  4.21it/s]
 91%|█████████ | 384/424 [02:14<00:07,  5.35it/s]
 91%|█████████ | 385/424 [02:14<00:06,  5.64it/s]
 92%|█████████▏| 388/424 [02:14<00:05,  6.41it/s]
 92%|█████████▏| 389/424 [02:15<00:07,  4.89it/s]
 92%|█████████▏| 391/424 [02:15<00:05,  6.45it/s]
 93%|█████████▎| 393/424 [02:15<00:04,  6.62it/s]
 93%|█████████▎| 394/424 [02:15<00:05,  5.52it/s]
 93%|█████████▎| 395/424 [02:16<00:06,  4.30it/s]
 93%|█████████▎| 396/424 [02:17<00:11,  2.54it/s]
 94%|█████████▎| 397/424 [02:17<00:12,  2.22it/s]
 94%|█████████▍| 398/424 [02:18<00:13,  2.00it/s]
 95%|█████████▍| 401/424 [02:18<00:06,  3.43it/s]
 95%|█████████▍| 402/424 [02:20<00:11,  1.85it/s]
 95%|█████████▌| 403/424 [02:20<00:10,  2.08it/s]
 95%|█████████▌| 404/424 [02:20<00:08,  2.49it/s]
 96%|█████████▌| 405/424 [02:21<00:06,  2.98it/s]
 96%|█████████▌| 406/424 [02:21<00:04,  3.65it/s]
 96%|█████████▌| 407/424 [02:21<00:06,  2.62it/s]
 96%|█████████▌| 408/424 [02:21<00:05,  3.09it/s]
 96%|█████████▋| 409/424 [02:22<00:04,  3.18it/s]
 97%|█████████▋| 410/424 [02:22<00:03,  3.75it/s]
 97%|█████████▋| 411/424 [02:22<00:03,  3.64it/s]
 97%|█████████▋| 413/424 [02:23<00:03,  3.56it/s]
 98%|█████████▊| 415/424 [02:24<00:02,  3.11it/s]
 98%|█████████▊| 416/424 [02:24<00:02,  2.74it/s]
 99%|█████████▊| 418/424 [02:24<00:01,  3.25it/s]
 99%|█████████▉| 420/424 [02:25<00:01,  3.60it/s]
100%|█████████▉| 422/424 [02:25<00:00,  4.76it/s]
100%|█████████▉| 423/424 [02:26<00:00,  4.03it/s]
100%|██████████| 424/424 [02:26<00:00,  4.28it/s]
100%|██████████| 424/424 [02:26<00:00,  2.90it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 16:05:53.758565_sc_processed_test.json', '--output_addr', 'data/out/rag/asym/sc_rag_ae_lp_test_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '2', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.44 examples/s]
Generating train split: 424 examples [00:00, 1550.19 examples/s]
INFO 07-09 16:08:50 config.py:510] This model supports multiple tasks: {'embed', 'classify', 'reward', 'score', 'generate'}. Defaulting to 'generate'.
INFO 07-09 16:08:50 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:08:52 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:08:52 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:08:52 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.67it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.44it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.43it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.37it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.40it/s]

INFO 07-09 16:08:56 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:08:58 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-09 16:08:58 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:08:58 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:08:58 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:08:58 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:09:01 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.68it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.82it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:11,  2.86it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:10,  2.85it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.88it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:09,  2.90it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.92it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.93it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:08,  2.92it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.93it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.95it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.95it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  2.95it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:07,  2.96it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  2.96it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.96it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:06,  2.99it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  3.00it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  3.01it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:04,  3.02it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:04,  3.02it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  3.03it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:03,  3.04it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:03,  3.04it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  3.05it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:02,  3.06it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:09<00:02,  3.06it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  3.06it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:01,  3.07it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:10<00:01,  3.05it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  3.04it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:00,  3.06it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:11<00:00,  3.01it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  3.04it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  3.05it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:11<00:00,  2.99it/s]
INFO 07-09 16:09:13 model_runner.py:1535] Graph capturing finished in 12 secs, took 0.22 GiB
INFO 07-09 16:09:13 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 17.29 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:13<1:32:25, 13.11s/it, est. speed input: 24.95 toks/s, output: 6.03 toks/s]
Processed prompts:   1%|          | 3/424 [00:13<24:48,  3.54s/it, est. speed input: 88.57 toks/s, output: 18.03 toks/s] 
Processed prompts:   1%|          | 4/424 [00:14<18:04,  2.58s/it, est. speed input: 113.48 toks/s, output: 23.99 toks/s]
Processed prompts:   1%|▏         | 6/424 [00:14<09:20,  1.34s/it, est. speed input: 211.80 toks/s, output: 37.62 toks/s]
Processed prompts:   2%|▏         | 7/424 [00:14<07:14,  1.04s/it, est. speed input: 246.51 toks/s, output: 44.23 toks/s]
Processed prompts:   2%|▏         | 8/424 [00:14<05:31,  1.25it/s, est. speed input: 267.62 toks/s, output: 50.96 toks/s]
Processed prompts:   3%|▎         | 11/424 [00:14<02:47,  2.47it/s, est. speed input: 379.41 toks/s, output: 71.68 toks/s]
Processed prompts:   3%|▎         | 14/424 [00:15<02:00,  3.39it/s, est. speed input: 463.26 toks/s, output: 91.07 toks/s]
Processed prompts:   4%|▍         | 16/424 [00:15<01:36,  4.24it/s, est. speed input: 523.39 toks/s, output: 104.78 toks/s]
Processed prompts:   4%|▍         | 17/424 [00:15<01:29,  4.54it/s, est. speed input: 546.52 toks/s, output: 111.29 toks/s]
Processed prompts:   5%|▍         | 21/424 [00:16<01:00,  6.66it/s, est. speed input: 651.11 toks/s, output: 138.75 toks/s]
Processed prompts:   5%|▌         | 23/424 [00:16<00:53,  7.50it/s, est. speed input: 689.70 toks/s, output: 152.17 toks/s]
Processed prompts:   6%|▌         | 26/424 [00:16<00:38, 10.22it/s, est. speed input: 765.11 toks/s, output: 173.63 toks/s]
Processed prompts:   7%|▋         | 28/424 [00:16<00:36, 10.99it/s, est. speed input: 835.44 toks/s, output: 187.17 toks/s]
Processed prompts:   7%|▋         | 31/424 [00:16<00:35, 10.92it/s, est. speed input: 942.79 toks/s, output: 206.47 toks/s]
Processed prompts:   8%|▊         | 34/424 [00:17<00:37, 10.40it/s, est. speed input: 1039.60 toks/s, output: 225.06 toks/s]
Processed prompts:   9%|▊         | 37/424 [00:17<00:35, 10.81it/s, est. speed input: 1123.63 toks/s, output: 244.28 toks/s]
Processed prompts:  10%|█         | 43/424 [00:17<00:28, 13.26it/s, est. speed input: 1270.46 toks/s, output: 284.38 toks/s]
Processed prompts:  12%|█▏        | 50/424 [00:17<00:21, 17.03it/s, est. speed input: 1536.41 toks/s, output: 332.08 toks/s]
Processed prompts:  13%|█▎        | 54/424 [00:18<00:23, 16.01it/s, est. speed input: 1622.81 toks/s, output: 356.27 toks/s]
Processed prompts:  14%|█▍        | 59/424 [00:18<00:22, 16.43it/s, est. speed input: 1728.63 toks/s, output: 387.69 toks/s]
Processed prompts:  17%|█▋        | 71/424 [00:19<00:19, 18.01it/s, est. speed input: 2074.41 toks/s, output: 462.44 toks/s]
Processed prompts:  17%|█▋        | 73/424 [00:19<00:20, 16.80it/s, est. speed input: 2126.85 toks/s, output: 472.70 toks/s]
Processed prompts:  18%|█▊        | 76/424 [00:19<00:19, 18.26it/s, est. speed input: 2255.63 toks/s, output: 492.14 toks/s]
Processed prompts:  19%|█▉        | 80/424 [00:19<00:18, 18.35it/s, est. speed input: 2331.76 toks/s, output: 515.91 toks/s]
Processed prompts:  20%|██        | 85/424 [00:19<00:19, 17.78it/s, est. speed input: 2467.65 toks/s, output: 544.51 toks/s]
Processed prompts:  21%|██        | 88/424 [00:20<00:18, 18.00it/s, est. speed input: 2542.91 toks/s, output: 562.03 toks/s]
Processed prompts:  22%|██▏       | 94/424 [00:20<00:17, 18.72it/s, est. speed input: 2681.57 toks/s, output: 597.04 toks/s]
Processed prompts:  23%|██▎       | 99/424 [00:20<00:15, 20.77it/s, est. speed input: 2764.63 toks/s, output: 627.73 toks/s]
Processed prompts:  24%|██▍       | 102/424 [00:20<00:16, 19.21it/s, est. speed input: 2815.68 toks/s, output: 643.29 toks/s]
Processed prompts:  25%|██▍       | 105/424 [00:21<00:20, 15.82it/s, est. speed input: 2865.45 toks/s, output: 655.66 toks/s]
Processed prompts:  27%|██▋       | 113/424 [00:21<00:14, 21.15it/s, est. speed input: 3056.51 toks/s, output: 705.53 toks/s]
Processed prompts:  27%|██▋       | 116/424 [00:21<00:15, 20.29it/s, est. speed input: 3160.25 toks/s, output: 721.34 toks/s]
Processed prompts:  28%|██▊       | 119/424 [00:21<00:14, 21.62it/s, est. speed input: 3221.37 toks/s, output: 739.19 toks/s]
Processed prompts:  29%|██▉       | 122/424 [00:21<00:14, 21.34it/s, est. speed input: 3284.40 toks/s, output: 755.74 toks/s]
Processed prompts:  30%|██▉       | 126/424 [00:21<00:15, 19.83it/s, est. speed input: 3355.51 toks/s, output: 776.18 toks/s]
Processed prompts:  30%|███       | 129/424 [00:22<00:14, 20.11it/s, est. speed input: 3399.50 toks/s, output: 792.59 toks/s]
Processed prompts:  31%|███▏      | 133/424 [00:22<00:16, 17.58it/s, est. speed input: 3468.44 toks/s, output: 810.85 toks/s]
Processed prompts:  32%|███▏      | 135/424 [00:22<00:16, 17.98it/s, est. speed input: 3491.28 toks/s, output: 821.49 toks/s]
Processed prompts:  33%|███▎      | 140/424 [00:22<00:18, 15.10it/s, est. speed input: 3561.58 toks/s, output: 841.97 toks/s]
Processed prompts:  34%|███▎      | 143/424 [00:23<00:16, 16.85it/s, est. speed input: 3600.49 toks/s, output: 858.78 toks/s]
Processed prompts:  34%|███▍      | 146/424 [00:23<00:18, 14.98it/s, est. speed input: 3624.39 toks/s, output: 870.20 toks/s]
Processed prompts:  36%|███▌      | 151/424 [00:23<00:14, 19.13it/s, est. speed input: 3718.38 toks/s, output: 899.71 toks/s]
Processed prompts:  36%|███▋      | 154/424 [00:23<00:15, 17.46it/s, est. speed input: 3752.54 toks/s, output: 912.65 toks/s]
Processed prompts:  37%|███▋      | 156/424 [00:23<00:16, 16.37it/s, est. speed input: 3781.54 toks/s, output: 920.84 toks/s]
Processed prompts:  37%|███▋      | 158/424 [00:23<00:17, 15.26it/s, est. speed input: 3790.53 toks/s, output: 928.66 toks/s]
Processed prompts:  39%|███▉      | 165/424 [00:24<00:17, 14.65it/s, est. speed input: 3950.11 toks/s, output: 958.52 toks/s]
Processed prompts:  40%|███▉      | 168/424 [00:24<00:22, 11.43it/s, est. speed input: 3960.21 toks/s, output: 962.28 toks/s]
Processed prompts:  41%|████▏     | 175/424 [00:25<00:14, 17.50it/s, est. speed input: 4166.80 toks/s, output: 1006.46 toks/s]
Processed prompts:  42%|████▏     | 178/424 [00:25<00:12, 19.08it/s, est. speed input: 4211.99 toks/s, output: 1023.63 toks/s]
Processed prompts:  43%|████▎     | 181/424 [00:25<00:11, 20.69it/s, est. speed input: 4287.72 toks/s, output: 1040.90 toks/s]
Processed prompts:  44%|████▍     | 186/424 [00:25<00:09, 26.01it/s, est. speed input: 4402.95 toks/s, output: 1072.64 toks/s]
Processed prompts:  45%|████▌     | 192/424 [00:25<00:07, 32.98it/s, est. speed input: 4551.89 toks/s, output: 1111.85 toks/s]
Processed prompts:  46%|████▋     | 197/424 [00:25<00:06, 32.96it/s, est. speed input: 4623.52 toks/s, output: 1141.86 toks/s]
Processed prompts:  47%|████▋     | 201/424 [00:25<00:07, 31.03it/s, est. speed input: 4767.56 toks/s, output: 1164.70 toks/s]
Processed prompts:  49%|████▉     | 209/424 [00:25<00:05, 38.13it/s, est. speed input: 4912.94 toks/s, output: 1217.93 toks/s]
Processed prompts:  51%|█████     | 216/424 [00:26<00:06, 32.53it/s, est. speed input: 5037.36 toks/s, output: 1257.79 toks/s]
Processed prompts:  52%|█████▏    | 220/424 [00:26<00:06, 31.80it/s, est. speed input: 5106.87 toks/s, output: 1282.11 toks/s]
Processed prompts:  53%|█████▎    | 225/424 [00:26<00:05, 33.17it/s, est. speed input: 5201.68 toks/s, output: 1314.47 toks/s]
Processed prompts:  54%|█████▍    | 229/424 [00:26<00:06, 32.38it/s, est. speed input: 5308.35 toks/s, output: 1339.35 toks/s]
Processed prompts:  55%|█████▍    | 233/424 [00:26<00:06, 29.30it/s, est. speed input: 5346.59 toks/s, output: 1359.42 toks/s]
Processed prompts:  56%|█████▌    | 237/424 [00:26<00:07, 25.49it/s, est. speed input: 5410.03 toks/s, output: 1380.83 toks/s]
Processed prompts:  57%|█████▋    | 240/424 [00:27<00:09, 20.28it/s, est. speed input: 5454.72 toks/s, output: 1392.55 toks/s]
Processed prompts:  57%|█████▋    | 243/424 [00:27<00:11, 15.54it/s, est. speed input: 5525.74 toks/s, output: 1400.68 toks/s]
Processed prompts:  58%|█████▊    | 248/424 [00:27<00:09, 18.93it/s, est. speed input: 5586.02 toks/s, output: 1421.54 toks/s]
Processed prompts:  59%|█████▉    | 251/424 [00:27<00:10, 16.79it/s, est. speed input: 5588.62 toks/s, output: 1422.93 toks/s]
Processed prompts:  60%|█████▉    | 253/424 [00:28<00:10, 16.75it/s, est. speed input: 5602.19 toks/s, output: 1425.86 toks/s]
Processed prompts:  61%|██████    | 257/424 [00:28<00:08, 20.23it/s, est. speed input: 5652.30 toks/s, output: 1446.39 toks/s]
Processed prompts:  62%|██████▏   | 261/424 [00:28<00:06, 23.32it/s, est. speed input: 5698.71 toks/s, output: 1460.92 toks/s]
Processed prompts:  62%|██████▏   | 264/424 [00:28<00:07, 22.06it/s, est. speed input: 5731.00 toks/s, output: 1466.85 toks/s]
Processed prompts:  63%|██████▎   | 267/424 [00:28<00:06, 22.95it/s, est. speed input: 5776.49 toks/s, output: 1473.59 toks/s]
Processed prompts:  64%|██████▍   | 271/424 [00:28<00:05, 25.94it/s, est. speed input: 5830.46 toks/s, output: 1482.99 toks/s]
Processed prompts:  66%|██████▌   | 279/424 [00:28<00:03, 37.67it/s, est. speed input: 5994.55 toks/s, output: 1514.58 toks/s]
Processed prompts:  67%|██████▋   | 284/424 [00:29<00:04, 31.19it/s, est. speed input: 6072.53 toks/s, output: 1527.26 toks/s]
Processed prompts:  68%|██████▊   | 288/424 [00:29<00:04, 32.43it/s, est. speed input: 6116.77 toks/s, output: 1541.69 toks/s]
Processed prompts:  69%|██████▉   | 293/424 [00:29<00:03, 35.75it/s, est. speed input: 6184.40 toks/s, output: 1558.73 toks/s]
Processed prompts:  70%|███████   | 297/424 [00:29<00:03, 33.46it/s, est. speed input: 6269.14 toks/s, output: 1572.24 toks/s]
Processed prompts:  71%|███████   | 301/424 [00:29<00:04, 30.58it/s, est. speed input: 6308.66 toks/s, output: 1582.51 toks/s]
Processed prompts:  73%|███████▎  | 308/424 [00:29<00:03, 37.45it/s, est. speed input: 6392.38 toks/s, output: 1610.17 toks/s]
Processed prompts:  74%|███████▍  | 315/424 [00:29<00:02, 42.86it/s, est. speed input: 6490.48 toks/s, output: 1643.80 toks/s]
Processed prompts:  77%|███████▋  | 325/424 [00:29<00:01, 54.52it/s, est. speed input: 6677.68 toks/s, output: 1693.21 toks/s]
Processed prompts:  79%|███████▉  | 334/424 [00:30<00:01, 61.61it/s, est. speed input: 6831.63 toks/s, output: 1732.47 toks/s]
Processed prompts:  80%|████████  | 341/424 [00:30<00:01, 62.49it/s, est. speed input: 6919.38 toks/s, output: 1763.32 toks/s]
Processed prompts:  82%|████████▏ | 348/424 [00:30<00:01, 59.69it/s, est. speed input: 7032.41 toks/s, output: 1794.69 toks/s]
Processed prompts:  84%|████████▍ | 356/424 [00:30<00:01, 64.90it/s, est. speed input: 7284.98 toks/s, output: 1832.15 toks/s]
Processed prompts:  87%|████████▋ | 368/424 [00:30<00:00, 76.50it/s, est. speed input: 7473.97 toks/s, output: 1888.37 toks/s]
Processed prompts:  89%|████████▊ | 376/424 [00:30<00:00, 67.44it/s, est. speed input: 7592.99 toks/s, output: 1923.34 toks/s]
Processed prompts:  91%|█████████ | 386/424 [00:30<00:00, 68.59it/s, est. speed input: 7759.97 toks/s, output: 1976.60 toks/s]
Processed prompts:  94%|█████████▎| 397/424 [00:30<00:00, 77.13it/s, est. speed input: 7979.10 toks/s, output: 2038.99 toks/s]
Processed prompts:  96%|█████████▌| 405/424 [00:31<00:00, 67.26it/s, est. speed input: 8157.32 toks/s, output: 2088.23 toks/s]
Processed prompts:  97%|█████████▋| 413/424 [00:31<00:00, 64.84it/s, est. speed input: 8356.00 toks/s, output: 2134.64 toks/s]
Processed prompts:  99%|█████████▉| 420/424 [00:31<00:00, 25.59it/s, est. speed input: 8357.75 toks/s, output: 2150.44 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:33<00:00, 12.78it/s, est. speed input: 8155.78 toks/s, output: 2111.94 toks/s]
[rank0]:[W709 16:09:48.302824050 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/sc_rag_ae_lp_test_2_output.json
Cleaned temporary files.
