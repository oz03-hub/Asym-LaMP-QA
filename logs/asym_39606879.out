Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:34:53.789426_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:34:53.789426_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:34:53.789426_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<02:04,  3.22it/s]
  0%|          | 2/401 [00:00<01:47,  3.70it/s]
  1%|          | 3/401 [00:02<08:15,  1.24s/it]
  1%|          | 4/401 [00:04<08:43,  1.32s/it]
  1%|          | 5/401 [00:05<08:57,  1.36s/it]
  1%|▏         | 6/401 [00:07<09:12,  1.40s/it]
  2%|▏         | 7/401 [00:08<09:22,  1.43s/it]
  2%|▏         | 8/401 [00:10<09:20,  1.43s/it]
  2%|▏         | 9/401 [00:11<09:22,  1.44s/it]
  2%|▏         | 10/401 [00:12<07:27,  1.14s/it]
  3%|▎         | 11/401 [00:13<08:30,  1.31s/it]
  3%|▎         | 13/401 [00:15<07:03,  1.09s/it]
  3%|▎         | 14/401 [00:18<10:42,  1.66s/it]
  4%|▎         | 15/401 [00:19<08:05,  1.26s/it]
  4%|▍         | 17/401 [00:19<04:57,  1.29it/s]
  4%|▍         | 18/401 [00:20<06:17,  1.02it/s]
  5%|▍         | 19/401 [00:22<07:20,  1.15s/it]
  5%|▍         | 20/401 [00:26<12:21,  1.95s/it]
  5%|▌         | 21/401 [00:26<09:21,  1.48s/it]
  5%|▌         | 22/401 [00:31<13:58,  2.21s/it]
  6%|▌         | 23/401 [00:32<12:57,  2.06s/it]
  6%|▌         | 24/401 [00:36<16:49,  2.68s/it]
  6%|▌         | 25/401 [00:37<12:04,  1.93s/it]
  6%|▋         | 26/401 [00:37<08:52,  1.42s/it]
  7%|▋         | 27/401 [00:41<13:54,  2.23s/it]
  7%|▋         | 28/401 [00:41<10:16,  1.65s/it]
  7%|▋         | 29/401 [00:41<07:23,  1.19s/it]
  7%|▋         | 30/401 [00:43<07:35,  1.23s/it]
  8%|▊         | 31/401 [00:44<07:23,  1.20s/it]
  8%|▊         | 32/401 [00:44<05:30,  1.12it/s]
  8%|▊         | 33/401 [00:45<05:56,  1.03it/s]
  8%|▊         | 34/401 [00:47<07:45,  1.27s/it]
  9%|▊         | 35/401 [00:47<05:36,  1.09it/s]
  9%|▉         | 37/401 [00:48<03:35,  1.69it/s]
 10%|▉         | 39/401 [00:49<03:38,  1.65it/s]
 10%|█         | 41/401 [00:50<03:50,  1.56it/s]
 10%|█         | 42/401 [00:51<03:22,  1.78it/s]
 11%|█         | 43/401 [00:51<02:59,  2.00it/s]
 11%|█         | 44/401 [00:52<03:39,  1.62it/s]
 11%|█▏        | 46/401 [00:52<02:44,  2.16it/s]
 12%|█▏        | 47/401 [00:54<04:49,  1.22it/s]
 12%|█▏        | 48/401 [00:55<04:14,  1.39it/s]
 12%|█▏        | 49/401 [00:55<03:41,  1.59it/s]
 12%|█▏        | 50/401 [00:56<03:55,  1.49it/s]
 13%|█▎        | 51/401 [00:56<03:29,  1.67it/s]
 13%|█▎        | 53/401 [00:57<02:37,  2.21it/s]
 13%|█▎        | 54/401 [00:57<02:14,  2.57it/s]
 14%|█▎        | 55/401 [01:00<05:44,  1.00it/s]
 14%|█▍        | 56/401 [01:01<06:12,  1.08s/it]
 14%|█▍        | 57/401 [01:02<06:00,  1.05s/it]
 14%|█▍        | 58/401 [01:02<04:29,  1.27it/s]
 15%|█▍        | 59/401 [01:05<07:41,  1.35s/it]
 15%|█▍        | 60/401 [01:06<06:31,  1.15s/it]
 15%|█▌        | 61/401 [01:06<05:19,  1.06it/s]
 15%|█▌        | 62/401 [01:06<04:14,  1.33it/s]
 16%|█▌        | 63/401 [01:07<03:47,  1.48it/s]
 16%|█▌        | 64/401 [01:07<03:27,  1.62it/s]
 16%|█▌        | 65/401 [01:08<03:14,  1.72it/s]
 16%|█▋        | 66/401 [01:09<04:25,  1.26it/s]
 17%|█▋        | 67/401 [01:09<03:32,  1.57it/s]
 17%|█▋        | 68/401 [01:10<02:49,  1.97it/s]
 17%|█▋        | 69/401 [01:10<02:08,  2.59it/s]
 17%|█▋        | 70/401 [01:11<03:16,  1.68it/s]
 18%|█▊        | 71/401 [01:11<02:51,  1.92it/s]
 18%|█▊        | 72/401 [01:12<03:36,  1.52it/s]
 18%|█▊        | 73/401 [01:12<03:03,  1.79it/s]
 18%|█▊        | 74/401 [01:13<03:42,  1.47it/s]
 19%|█▊        | 75/401 [01:14<04:11,  1.30it/s]
 19%|█▉        | 76/401 [01:15<04:29,  1.21it/s]
 19%|█▉        | 77/401 [01:16<04:43,  1.14it/s]
 19%|█▉        | 78/401 [01:16<03:32,  1.52it/s]
 20%|█▉        | 79/401 [01:17<04:01,  1.33it/s]
 20%|█▉        | 80/401 [01:18<04:22,  1.23it/s]
 20%|██        | 81/401 [01:19<04:16,  1.25it/s]
 20%|██        | 82/401 [01:20<04:31,  1.17it/s]
 21%|██        | 83/401 [01:21<04:43,  1.12it/s]
 21%|██        | 84/401 [01:22<04:50,  1.09it/s]
 21%|██        | 85/401 [01:22<03:58,  1.33it/s]
 21%|██▏       | 86/401 [01:23<04:17,  1.22it/s]
 22%|██▏       | 87/401 [01:26<07:19,  1.40s/it]
 22%|██▏       | 88/401 [01:27<06:38,  1.27s/it]
 22%|██▏       | 89/401 [01:28<06:40,  1.28s/it]
 22%|██▏       | 90/401 [01:29<04:58,  1.04it/s]
 23%|██▎       | 91/401 [01:29<03:42,  1.39it/s]
 23%|██▎       | 92/401 [01:30<04:05,  1.26it/s]
 23%|██▎       | 93/401 [01:30<03:10,  1.61it/s]
 23%|██▎       | 94/401 [01:32<05:17,  1.03s/it]
 24%|██▎       | 95/401 [01:33<05:40,  1.11s/it]
 24%|██▍       | 96/401 [01:34<05:27,  1.07s/it]
 24%|██▍       | 97/401 [01:35<05:16,  1.04s/it]
 24%|██▍       | 98/401 [01:36<04:17,  1.18it/s]
 25%|██▍       | 99/401 [01:36<03:15,  1.54it/s]
 25%|██▍       | 100/401 [01:36<02:42,  1.86it/s]
 25%|██▌       | 101/401 [01:37<03:03,  1.64it/s]
 25%|██▌       | 102/401 [01:37<02:19,  2.14it/s]
 26%|██▌       | 103/401 [01:37<02:14,  2.21it/s]
 26%|██▌       | 104/401 [01:38<03:00,  1.65it/s]
 26%|██▌       | 105/401 [01:39<03:31,  1.40it/s]
 27%|██▋       | 107/401 [01:40<02:30,  1.95it/s]
 27%|██▋       | 108/401 [01:40<02:03,  2.36it/s]
 27%|██▋       | 109/401 [01:41<02:45,  1.76it/s]
 27%|██▋       | 110/401 [01:41<02:08,  2.26it/s]
 28%|██▊       | 111/401 [01:42<02:50,  1.71it/s]
 28%|██▊       | 112/401 [01:43<03:20,  1.44it/s]
 28%|██▊       | 113/401 [01:44<03:17,  1.46it/s]
 28%|██▊       | 114/401 [01:44<03:09,  1.51it/s]
 29%|██▊       | 115/401 [01:45<02:33,  1.86it/s]
 29%|██▉       | 116/401 [01:46<03:08,  1.51it/s]
 29%|██▉       | 117/401 [01:46<02:53,  1.64it/s]
 29%|██▉       | 118/401 [01:46<02:17,  2.06it/s]
 30%|██▉       | 119/401 [01:47<03:16,  1.44it/s]
 30%|██▉       | 120/401 [01:48<02:33,  1.83it/s]
 30%|███       | 121/401 [01:48<02:04,  2.24it/s]
 30%|███       | 122/401 [01:48<02:17,  2.03it/s]
 31%|███       | 123/401 [01:50<03:25,  1.36it/s]
 31%|███       | 124/401 [01:51<04:11,  1.10it/s]
 31%|███       | 125/401 [01:52<04:44,  1.03s/it]
 31%|███▏      | 126/401 [01:53<03:37,  1.27it/s]
 32%|███▏      | 127/401 [01:54<04:18,  1.06it/s]
 32%|███▏      | 128/401 [01:55<04:48,  1.06s/it]
 32%|███▏      | 129/401 [01:56<04:39,  1.03s/it]
 32%|███▏      | 130/401 [01:57<05:01,  1.11s/it]
 33%|███▎      | 131/401 [01:58<04:32,  1.01s/it]
 33%|███▎      | 132/401 [01:58<03:32,  1.27it/s]
 33%|███▎      | 133/401 [02:01<06:09,  1.38s/it]
 33%|███▎      | 134/401 [02:02<05:35,  1.26s/it]
 34%|███▎      | 135/401 [02:03<05:13,  1.18s/it]
 34%|███▍      | 136/401 [02:04<04:55,  1.12s/it]
 34%|███▍      | 137/401 [02:04<03:38,  1.21it/s]
 34%|███▍      | 138/401 [02:05<03:48,  1.15it/s]
 35%|███▍      | 139/401 [02:06<03:39,  1.19it/s]
 35%|███▍      | 140/401 [02:06<02:50,  1.53it/s]
 35%|███▌      | 141/401 [02:08<04:14,  1.02it/s]
 35%|███▌      | 142/401 [02:09<04:41,  1.09s/it]
 36%|███▌      | 143/401 [02:10<03:49,  1.13it/s]
 36%|███▌      | 144/401 [02:11<03:54,  1.10it/s]
 36%|███▌      | 145/401 [02:11<03:04,  1.39it/s]
 36%|███▋      | 146/401 [02:12<03:23,  1.25it/s]
 37%|███▋      | 147/401 [02:13<03:35,  1.18it/s]
 37%|███▋      | 148/401 [02:13<03:01,  1.39it/s]
 37%|███▋      | 149/401 [02:14<03:18,  1.27it/s]
 37%|███▋      | 150/401 [02:15<03:31,  1.19it/s]
 38%|███▊      | 151/401 [02:17<04:06,  1.01it/s]
 38%|███▊      | 152/401 [02:18<04:04,  1.02it/s]
 38%|███▊      | 153/401 [02:18<03:22,  1.22it/s]
 38%|███▊      | 154/401 [02:19<02:56,  1.40it/s]
 39%|███▊      | 155/401 [02:20<03:38,  1.13it/s]
 39%|███▉      | 156/401 [02:21<04:09,  1.02s/it]
 39%|███▉      | 157/401 [02:22<04:28,  1.10s/it]
 40%|███▉      | 159/401 [02:23<03:19,  1.21it/s]
 40%|███▉      | 160/401 [02:24<02:54,  1.38it/s]
 40%|████      | 162/401 [02:25<02:42,  1.47it/s]
 41%|████      | 163/401 [02:26<02:50,  1.40it/s]
 41%|████      | 164/401 [02:27<02:53,  1.37it/s]
 41%|████      | 165/401 [02:28<03:07,  1.26it/s]
 41%|████▏     | 166/401 [02:29<03:18,  1.18it/s]
 42%|████▏     | 167/401 [02:29<02:32,  1.54it/s]
 42%|████▏     | 168/401 [02:30<02:52,  1.35it/s]
 42%|████▏     | 169/401 [02:31<03:06,  1.24it/s]
 42%|████▏     | 170/401 [02:32<03:17,  1.17it/s]
 43%|████▎     | 171/401 [02:33<03:24,  1.12it/s]
 43%|████▎     | 172/401 [02:33<02:52,  1.33it/s]
 43%|████▎     | 173/401 [02:34<03:07,  1.21it/s]
 43%|████▎     | 174/401 [02:35<03:18,  1.14it/s]
 44%|████▎     | 175/401 [02:36<03:23,  1.11it/s]
 44%|████▍     | 176/401 [02:37<03:27,  1.08it/s]
 44%|████▍     | 177/401 [02:38<03:53,  1.04s/it]
 44%|████▍     | 178/401 [02:39<03:46,  1.02s/it]
 45%|████▍     | 179/401 [02:40<03:41,  1.00it/s]
 45%|████▍     | 180/401 [02:41<03:39,  1.01it/s]
 45%|████▌     | 181/401 [02:42<03:37,  1.01it/s]
 45%|████▌     | 182/401 [02:43<03:36,  1.01it/s]
 46%|████▌     | 183/401 [02:47<06:26,  1.78s/it]
 46%|████▌     | 184/401 [02:50<08:21,  2.31s/it]
 46%|████▌     | 185/401 [02:54<09:44,  2.71s/it]
 46%|████▋     | 186/401 [02:58<10:40,  2.98s/it]
 47%|████▋     | 187/401 [03:01<11:18,  3.17s/it]
 47%|████▋     | 188/401 [03:01<08:06,  2.28s/it]
 47%|████▋     | 189/401 [03:05<09:32,  2.70s/it]
 47%|████▋     | 190/401 [03:09<10:27,  2.97s/it]
 48%|████▊     | 191/401 [03:11<09:10,  2.62s/it]
 48%|████▊     | 192/401 [03:12<08:17,  2.38s/it]
 48%|████▊     | 193/401 [03:13<05:58,  1.72s/it]
 48%|████▊     | 194/401 [03:13<04:26,  1.29s/it]
 49%|████▊     | 195/401 [03:16<06:50,  1.99s/it]
 49%|████▉     | 196/401 [03:18<06:35,  1.93s/it]
 49%|████▉     | 197/401 [03:20<06:37,  1.95s/it]
 49%|████▉     | 198/401 [03:24<08:14,  2.44s/it]
 50%|████▉     | 199/401 [03:26<07:33,  2.25s/it]
 50%|████▉     | 200/401 [03:27<07:05,  2.12s/it]
 50%|█████     | 201/401 [03:29<06:46,  2.03s/it]
 50%|█████     | 202/401 [03:31<06:30,  1.96s/it]
 51%|█████     | 203/401 [03:33<06:19,  1.92s/it]
 51%|█████     | 204/401 [03:35<06:11,  1.89s/it]
 51%|█████     | 205/401 [03:35<04:26,  1.36s/it]
 51%|█████▏    | 206/401 [03:37<04:52,  1.50s/it]
 52%|█████▏    | 207/401 [03:38<05:11,  1.60s/it]
 52%|█████▏    | 208/401 [03:40<05:19,  1.66s/it]
 52%|█████▏    | 209/401 [03:41<04:06,  1.28s/it]
 52%|█████▏    | 210/401 [03:42<04:35,  1.44s/it]
 53%|█████▎    | 211/401 [03:43<03:56,  1.24s/it]
 53%|█████▎    | 212/401 [03:44<03:17,  1.04s/it]
 53%|█████▎    | 213/401 [03:45<03:01,  1.03it/s]
 53%|█████▎    | 214/401 [03:46<03:47,  1.22s/it]
 54%|█████▎    | 215/401 [03:47<03:13,  1.04s/it]
 54%|█████▍    | 216/401 [03:48<03:27,  1.12s/it]
 54%|█████▍    | 218/401 [03:49<02:18,  1.32it/s]
 55%|█████▍    | 219/401 [03:50<02:12,  1.38it/s]
 55%|█████▍    | 220/401 [03:50<02:06,  1.43it/s]
 55%|█████▌    | 221/401 [03:53<03:46,  1.26s/it]
 55%|█████▌    | 222/401 [03:54<03:12,  1.08s/it]
 56%|█████▌    | 223/401 [03:54<02:23,  1.24it/s]
 56%|█████▌    | 224/401 [03:54<01:59,  1.48it/s]
 56%|█████▌    | 225/401 [03:54<01:31,  1.93it/s]
 56%|█████▋    | 226/401 [03:54<01:10,  2.48it/s]
 57%|█████▋    | 227/401 [03:55<01:00,  2.88it/s]
 57%|█████▋    | 228/401 [03:55<01:16,  2.26it/s]
 57%|█████▋    | 229/401 [03:55<01:02,  2.74it/s]
 57%|█████▋    | 230/401 [03:57<02:04,  1.37it/s]
 58%|█████▊    | 231/401 [03:57<01:35,  1.78it/s]
 58%|█████▊    | 232/401 [03:58<01:35,  1.77it/s]
 58%|█████▊    | 234/401 [04:02<03:14,  1.16s/it]
 59%|█████▊    | 235/401 [04:02<02:38,  1.05it/s]
 59%|█████▉    | 236/401 [04:02<02:02,  1.35it/s]
 59%|█████▉    | 237/401 [04:03<01:53,  1.44it/s]
 59%|█████▉    | 238/401 [04:03<01:42,  1.58it/s]
 60%|█████▉    | 239/401 [04:04<01:41,  1.60it/s]
 60%|█████▉    | 240/401 [04:04<01:20,  2.00it/s]
 60%|██████    | 242/401 [04:04<00:52,  3.03it/s]
 61%|██████    | 243/401 [04:05<01:08,  2.30it/s]
 61%|██████    | 244/401 [04:05<01:05,  2.39it/s]
 61%|██████    | 245/401 [04:05<00:52,  2.94it/s]
 61%|██████▏   | 246/401 [04:06<01:04,  2.40it/s]
 62%|██████▏   | 247/401 [04:07<01:13,  2.11it/s]
 62%|██████▏   | 248/401 [04:07<00:56,  2.71it/s]
 62%|██████▏   | 249/401 [04:08<01:43,  1.47it/s]
 63%|██████▎   | 251/401 [04:08<01:07,  2.23it/s]
 63%|██████▎   | 252/401 [04:09<00:54,  2.72it/s]
 63%|██████▎   | 254/401 [04:09<00:42,  3.42it/s]
 64%|██████▎   | 255/401 [04:11<01:27,  1.67it/s]
 64%|██████▍   | 256/401 [04:11<01:16,  1.89it/s]
 64%|██████▍   | 257/401 [04:11<01:08,  2.09it/s]
 64%|██████▍   | 258/401 [04:12<01:03,  2.27it/s]
 65%|██████▍   | 259/401 [04:12<00:57,  2.46it/s]
 65%|██████▌   | 261/401 [04:13<00:53,  2.62it/s]
 65%|██████▌   | 262/401 [04:13<00:50,  2.73it/s]
 66%|██████▌   | 263/401 [04:13<00:49,  2.80it/s]
 66%|██████▌   | 264/401 [04:13<00:43,  3.18it/s]
 66%|██████▌   | 265/401 [04:14<00:43,  3.12it/s]
 66%|██████▋   | 266/401 [04:14<00:43,  3.09it/s]
 67%|██████▋   | 267/401 [04:14<00:36,  3.62it/s]
 67%|██████▋   | 268/401 [04:14<00:33,  4.02it/s]
 67%|██████▋   | 269/401 [04:15<00:45,  2.90it/s]
 67%|██████▋   | 270/401 [04:16<00:54,  2.38it/s]
 68%|██████▊   | 272/401 [04:16<00:34,  3.69it/s]
 68%|██████▊   | 273/401 [04:16<00:30,  4.16it/s]
 68%|██████▊   | 274/401 [04:16<00:26,  4.79it/s]
 69%|██████▊   | 275/401 [04:16<00:23,  5.36it/s]
 69%|██████▉   | 276/401 [04:16<00:22,  5.60it/s]
 69%|██████▉   | 277/401 [04:17<00:33,  3.65it/s]
 69%|██████▉   | 278/401 [04:17<00:29,  4.23it/s]
 70%|██████▉   | 279/401 [04:17<00:24,  4.92it/s]
 70%|██████▉   | 280/401 [04:18<00:31,  3.88it/s]
 70%|███████   | 281/401 [04:18<00:26,  4.55it/s]
 70%|███████   | 282/401 [04:18<00:22,  5.32it/s]
 71%|███████   | 283/401 [04:18<00:35,  3.34it/s]
 71%|███████   | 284/401 [04:19<00:35,  3.30it/s]
 71%|███████   | 285/401 [04:19<00:31,  3.65it/s]
 71%|███████▏  | 286/401 [04:19<00:32,  3.49it/s]
 72%|███████▏  | 287/401 [04:19<00:33,  3.41it/s]
 72%|███████▏  | 288/401 [04:20<00:28,  4.03it/s]
 72%|███████▏  | 289/401 [04:20<00:26,  4.22it/s]
 73%|███████▎  | 291/401 [04:20<00:25,  4.24it/s]
 73%|███████▎  | 292/401 [04:22<00:58,  1.87it/s]
 73%|███████▎  | 293/401 [04:23<01:09,  1.55it/s]
 73%|███████▎  | 294/401 [04:26<02:18,  1.29s/it]
 74%|███████▎  | 295/401 [04:26<01:42,  1.04it/s]
 74%|███████▍  | 296/401 [04:27<01:40,  1.04it/s]
 74%|███████▍  | 297/401 [04:27<01:15,  1.37it/s]
 74%|███████▍  | 298/401 [04:27<01:03,  1.61it/s]
 75%|███████▍  | 299/401 [04:29<01:28,  1.16it/s]
 75%|███████▍  | 300/401 [04:30<01:26,  1.17it/s]
 75%|███████▌  | 301/401 [04:30<01:04,  1.55it/s]
 75%|███████▌  | 302/401 [04:30<00:48,  2.05it/s]
 76%|███████▌  | 303/401 [04:31<00:58,  1.69it/s]
 76%|███████▌  | 304/401 [04:31<00:59,  1.63it/s]
 76%|███████▌  | 305/401 [04:32<01:12,  1.32it/s]
 76%|███████▋  | 306/401 [04:33<01:13,  1.29it/s]
 77%|███████▋  | 307/401 [04:34<01:18,  1.20it/s]
 77%|███████▋  | 308/401 [04:35<01:06,  1.40it/s]
 77%|███████▋  | 309/401 [04:35<01:03,  1.46it/s]
 77%|███████▋  | 310/401 [04:36<00:54,  1.66it/s]
 78%|███████▊  | 311/401 [04:37<00:59,  1.51it/s]
 78%|███████▊  | 312/401 [04:37<00:51,  1.72it/s]
 78%|███████▊  | 313/401 [04:37<00:40,  2.17it/s]
 78%|███████▊  | 314/401 [04:37<00:38,  2.24it/s]
 79%|███████▊  | 315/401 [04:38<00:32,  2.62it/s]
 79%|███████▉  | 316/401 [04:38<00:26,  3.16it/s]
 79%|███████▉  | 317/401 [04:39<00:54,  1.54it/s]
 79%|███████▉  | 318/401 [04:40<00:50,  1.65it/s]
 80%|███████▉  | 319/401 [04:40<00:41,  1.98it/s]
 80%|███████▉  | 320/401 [04:41<00:40,  2.01it/s]
 80%|████████  | 321/401 [04:41<00:39,  2.05it/s]
 80%|████████  | 322/401 [04:42<00:38,  2.06it/s]
 81%|████████  | 323/401 [04:45<01:46,  1.36s/it]
 81%|████████  | 324/401 [04:48<02:30,  1.96s/it]
 81%|████████  | 325/401 [04:52<03:01,  2.39s/it]
 81%|████████▏ | 326/401 [04:53<02:26,  1.96s/it]
 82%|████████▏ | 327/401 [04:53<02:00,  1.62s/it]
 82%|████████▏ | 328/401 [04:54<01:34,  1.29s/it]
 82%|████████▏ | 329/401 [04:56<01:40,  1.40s/it]
 82%|████████▏ | 330/401 [04:59<02:21,  2.00s/it]
 83%|████████▎ | 331/401 [05:00<01:58,  1.69s/it]
 83%|████████▎ | 332/401 [05:03<02:32,  2.21s/it]
 83%|████████▎ | 333/401 [05:07<02:53,  2.56s/it]
 83%|████████▎ | 334/401 [05:07<02:07,  1.90s/it]
 84%|████████▎ | 335/401 [05:11<02:34,  2.35s/it]
 84%|████████▍ | 336/401 [05:14<02:53,  2.66s/it]
 84%|████████▍ | 337/401 [05:15<02:20,  2.20s/it]
 84%|████████▍ | 338/401 [05:16<01:47,  1.70s/it]
 85%|████████▍ | 339/401 [05:16<01:23,  1.35s/it]
 85%|████████▍ | 340/401 [05:16<01:00,  1.00it/s]
 85%|████████▌ | 341/401 [05:16<00:43,  1.37it/s]
 85%|████████▌ | 342/401 [05:17<00:35,  1.65it/s]
 86%|████████▌ | 343/401 [05:17<00:33,  1.73it/s]
 86%|████████▌ | 344/401 [05:18<00:28,  2.00it/s]
 86%|████████▌ | 345/401 [05:19<00:43,  1.28it/s]
 86%|████████▋ | 346/401 [05:19<00:36,  1.50it/s]
 87%|████████▋ | 347/401 [05:20<00:30,  1.75it/s]
 87%|████████▋ | 348/401 [05:20<00:27,  1.91it/s]
 87%|████████▋ | 349/401 [05:20<00:23,  2.26it/s]
 87%|████████▋ | 350/401 [05:23<01:02,  1.23s/it]
 88%|████████▊ | 351/401 [05:27<01:34,  1.88s/it]
 88%|████████▊ | 352/401 [05:27<01:07,  1.38s/it]
 88%|████████▊ | 353/401 [05:31<01:36,  2.02s/it]
 89%|████████▊ | 355/401 [05:31<00:54,  1.19s/it]
 89%|████████▉ | 356/401 [05:34<01:14,  1.65s/it]
 89%|████████▉ | 357/401 [05:35<01:01,  1.41s/it]
 89%|████████▉ | 358/401 [05:36<00:57,  1.33s/it]
 90%|████████▉ | 359/401 [05:37<00:51,  1.22s/it]
 90%|████████▉ | 360/401 [05:38<00:46,  1.14s/it]
 90%|█████████ | 361/401 [05:38<00:37,  1.06it/s]
 90%|█████████ | 362/401 [05:39<00:29,  1.33it/s]
 91%|█████████ | 363/401 [05:39<00:23,  1.63it/s]
 91%|█████████ | 364/401 [05:39<00:17,  2.06it/s]
 91%|█████████ | 365/401 [05:41<00:30,  1.17it/s]
 91%|█████████▏| 366/401 [05:41<00:23,  1.49it/s]
 92%|█████████▏| 367/401 [05:42<00:21,  1.61it/s]
 92%|█████████▏| 368/401 [05:42<00:15,  2.14it/s]
 92%|█████████▏| 369/401 [05:42<00:13,  2.43it/s]
 92%|█████████▏| 370/401 [05:44<00:24,  1.25it/s]
 93%|█████████▎| 371/401 [05:45<00:32,  1.07s/it]
 93%|█████████▎| 372/401 [05:45<00:23,  1.25it/s]
 93%|█████████▎| 373/401 [05:47<00:30,  1.08s/it]
 93%|█████████▎| 374/401 [05:49<00:34,  1.27s/it]
 94%|█████████▎| 375/401 [05:51<00:36,  1.40s/it]
 94%|█████████▍| 376/401 [05:54<00:47,  1.90s/it]
 94%|█████████▍| 377/401 [05:54<00:35,  1.46s/it]
 94%|█████████▍| 378/401 [05:57<00:44,  1.96s/it]
 95%|█████████▍| 379/401 [06:01<00:52,  2.39s/it]
 95%|█████████▍| 380/401 [06:02<00:46,  2.19s/it]
 95%|█████████▌| 382/401 [06:05<00:36,  1.90s/it]
 96%|█████████▌| 383/401 [06:09<00:39,  2.19s/it]
 96%|█████████▌| 384/401 [06:11<00:37,  2.23s/it]
 96%|█████████▌| 385/401 [06:14<00:40,  2.55s/it]
 96%|█████████▋| 386/401 [06:15<00:31,  2.08s/it]
 97%|█████████▋| 387/401 [06:16<00:25,  1.85s/it]
 97%|█████████▋| 388/401 [06:18<00:21,  1.64s/it]
 97%|█████████▋| 389/401 [06:18<00:15,  1.30s/it]
 97%|█████████▋| 390/401 [06:19<00:11,  1.08s/it]
 98%|█████████▊| 391/401 [06:19<00:08,  1.21it/s]
 98%|█████████▊| 392/401 [06:20<00:08,  1.09it/s]
 98%|█████████▊| 393/401 [06:20<00:05,  1.42it/s]
 98%|█████████▊| 394/401 [06:20<00:04,  1.75it/s]
 99%|█████████▊| 395/401 [06:21<00:02,  2.01it/s]
 99%|█████████▉| 396/401 [06:24<00:07,  1.40s/it]
 99%|█████████▉| 397/401 [06:25<00:04,  1.07s/it]
 99%|█████████▉| 398/401 [06:28<00:05,  1.81s/it]
100%|█████████▉| 399/401 [06:32<00:04,  2.30s/it]
100%|█████████▉| 400/401 [06:32<00:01,  1.67s/it]
100%|██████████| 401/401 [06:32<00:00,  1.21s/it]
100%|██████████| 401/401 [06:32<00:00,  1.02it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:34:53.789426_ae_processed_test.json', '--output_addr', 'data/out/rag/full_profile/ae_rag_full_profile_test_4_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '4', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  2.94 examples/s]
Generating train split: 401 examples [00:00, 542.70 examples/s]
INFO 07-09 15:41:58 config.py:510] This model supports multiple tasks: {'reward', 'classify', 'generate', 'embed', 'score'}. Defaulting to 'generate'.
INFO 07-09 15:41:58 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:41:59 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:42:01 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:42:01 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.45it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.31it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.31it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.30it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.31it/s]

INFO 07-09 15:42:04 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 15:42:06 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-09 15:42:06 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 15:42:06 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 15:42:06 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 15:42:06 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 15:42:09 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  3.08it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.40it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.52it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.55it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.60it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.63it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.65it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.67it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.66it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.68it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.69it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.71it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.71it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.72it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.70it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.71it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.77it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.80it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.82it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.85it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.87it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.87it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.88it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.89it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.91it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:06<00:02,  3.89it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.82it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.85it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.89it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:07<00:01,  3.92it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.94it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.96it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.90it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:08<00:00,  3.92it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.95it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.78it/s]
INFO 07-09 15:42:19 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 15:42:19 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.27 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:18<2:05:25, 18.81s/it, est. speed input: 34.28 toks/s, output: 4.94 toks/s]
Processed prompts:   0%|          | 2/401 [00:19<53:22,  8.03s/it, est. speed input: 78.54 toks/s, output: 10.01 toks/s] 
Processed prompts:   1%|          | 4/401 [00:19<20:08,  3.05s/it, est. speed input: 153.35 toks/s, output: 20.25 toks/s]
Processed prompts:   2%|▏         | 7/401 [00:19<09:07,  1.39s/it, est. speed input: 267.49 toks/s, output: 35.14 toks/s]
Processed prompts:   2%|▏         | 8/401 [00:20<07:36,  1.16s/it, est. speed input: 289.76 toks/s, output: 39.91 toks/s]
Processed prompts:   2%|▏         | 9/401 [00:20<06:11,  1.06it/s, est. speed input: 335.80 toks/s, output: 44.84 toks/s]
Processed prompts:   3%|▎         | 11/401 [00:20<04:09,  1.56it/s, est. speed input: 398.40 toks/s, output: 54.84 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:21<02:31,  2.56it/s, est. speed input: 522.72 toks/s, output: 70.40 toks/s]
Processed prompts:   4%|▎         | 15/401 [00:21<02:16,  2.83it/s, est. speed input: 550.59 toks/s, output: 75.32 toks/s]
Processed prompts:   5%|▍         | 19/401 [00:21<01:17,  4.92it/s, est. speed input: 729.75 toks/s, output: 96.44 toks/s]
Processed prompts:   5%|▍         | 20/401 [00:21<01:14,  5.08it/s, est. speed input: 754.82 toks/s, output: 101.25 toks/s]
Processed prompts:   6%|▌         | 23/401 [00:21<00:53,  7.07it/s, est. speed input: 845.98 toks/s, output: 116.93 toks/s]
Processed prompts:   6%|▌         | 25/401 [00:22<00:51,  7.33it/s, est. speed input: 899.06 toks/s, output: 126.59 toks/s]
Processed prompts:   7%|▋         | 27/401 [00:22<00:45,  8.26it/s, est. speed input: 1003.04 toks/s, output: 136.78 toks/s]
Processed prompts:   7%|▋         | 29/401 [00:22<00:37,  9.88it/s, est. speed input: 1051.58 toks/s, output: 147.29 toks/s]
Processed prompts:   8%|▊         | 31/401 [00:22<00:37,  9.83it/s, est. speed input: 1125.57 toks/s, output: 157.09 toks/s]
Processed prompts:   8%|▊         | 33/401 [00:22<00:40,  9.16it/s, est. speed input: 1169.07 toks/s, output: 166.40 toks/s]
Processed prompts:   9%|▊         | 35/401 [00:23<00:41,  8.81it/s, est. speed input: 1207.53 toks/s, output: 175.64 toks/s]
Processed prompts:   9%|▉         | 37/401 [00:23<00:39,  9.12it/s, est. speed input: 1250.33 toks/s, output: 185.27 toks/s]
Processed prompts:  10%|▉         | 39/401 [00:23<00:35, 10.09it/s, est. speed input: 1311.62 toks/s, output: 195.26 toks/s]
Processed prompts:  10%|█         | 41/401 [00:23<00:43,  8.29it/s, est. speed input: 1411.03 toks/s, output: 203.49 toks/s]
Processed prompts:  11%|█         | 43/401 [00:24<00:41,  8.68it/s, est. speed input: 1450.07 toks/s, output: 212.78 toks/s]
Processed prompts:  11%|█         | 44/401 [00:24<00:45,  7.76it/s, est. speed input: 1459.65 toks/s, output: 216.62 toks/s]
Processed prompts:  12%|█▏        | 47/401 [00:24<00:37,  9.33it/s, est. speed input: 1560.66 toks/s, output: 231.02 toks/s]
Processed prompts:  12%|█▏        | 50/401 [00:24<00:34, 10.07it/s, est. speed input: 1672.44 toks/s, output: 245.02 toks/s]
Processed prompts:  13%|█▎        | 53/401 [00:24<00:31, 10.88it/s, est. speed input: 1809.08 toks/s, output: 259.10 toks/s]
Processed prompts:  14%|█▎        | 55/401 [00:25<00:35,  9.72it/s, est. speed input: 1835.75 toks/s, output: 267.26 toks/s]
Processed prompts:  14%|█▍        | 57/401 [00:25<00:31, 10.84it/s, est. speed input: 1888.85 toks/s, output: 276.95 toks/s]
Processed prompts:  15%|█▍        | 60/401 [00:25<00:35,  9.59it/s, est. speed input: 1955.24 toks/s, output: 289.25 toks/s]
Processed prompts:  16%|█▌        | 64/401 [00:26<00:31, 10.56it/s, est. speed input: 2072.90 toks/s, output: 307.36 toks/s]
Processed prompts:  17%|█▋        | 70/401 [00:26<00:27, 12.04it/s, est. speed input: 2192.22 toks/s, output: 334.73 toks/s]
Processed prompts:  18%|█▊        | 72/401 [00:26<00:30, 10.90it/s, est. speed input: 2218.93 toks/s, output: 342.19 toks/s]
Processed prompts:  18%|█▊        | 74/401 [00:26<00:31, 10.48it/s, est. speed input: 2256.90 toks/s, output: 350.17 toks/s]
Processed prompts:  19%|█▉        | 77/401 [00:27<00:31, 10.21it/s, est. speed input: 2350.97 toks/s, output: 362.17 toks/s]
Processed prompts:  20%|██        | 81/401 [00:27<00:31, 10.05it/s, est. speed input: 2459.35 toks/s, output: 377.96 toks/s]
Processed prompts:  21%|██        | 84/401 [00:28<00:32,  9.65it/s, est. speed input: 2575.28 toks/s, output: 389.13 toks/s]
Processed prompts:  21%|██        | 85/401 [00:28<00:35,  8.93it/s, est. speed input: 2584.40 toks/s, output: 392.01 toks/s]
Processed prompts:  22%|██▏       | 90/401 [00:28<00:33,  9.40it/s, est. speed input: 2633.05 toks/s, output: 411.20 toks/s]
Processed prompts:  23%|██▎       | 92/401 [00:29<00:36,  8.50it/s, est. speed input: 2649.20 toks/s, output: 417.03 toks/s]
Processed prompts:  24%|██▎       | 95/401 [00:29<00:35,  8.51it/s, est. speed input: 2703.66 toks/s, output: 427.61 toks/s]
Processed prompts:  25%|██▌       | 101/401 [00:29<00:28, 10.70it/s, est. speed input: 2924.96 toks/s, output: 452.79 toks/s]
Processed prompts:  27%|██▋       | 107/401 [00:30<00:28, 10.24it/s, est. speed input: 3018.14 toks/s, output: 473.96 toks/s]
Processed prompts:  28%|██▊       | 112/401 [00:30<00:26, 10.85it/s, est. speed input: 3131.01 toks/s, output: 492.96 toks/s]
Processed prompts:  29%|██▉       | 118/401 [00:31<00:24, 11.37it/s, est. speed input: 3315.93 toks/s, output: 515.32 toks/s]
Processed prompts:  30%|███       | 122/401 [00:31<00:24, 11.60it/s, est. speed input: 3381.06 toks/s, output: 529.95 toks/s]
Processed prompts:  31%|███       | 124/401 [00:31<00:24, 11.17it/s, est. speed input: 3398.83 toks/s, output: 536.35 toks/s]
Processed prompts:  32%|███▏      | 127/401 [00:32<00:24, 11.19it/s, est. speed input: 3458.01 toks/s, output: 546.80 toks/s]
Processed prompts:  32%|███▏      | 130/401 [00:32<00:24, 11.02it/s, est. speed input: 3561.79 toks/s, output: 556.88 toks/s]
Processed prompts:  34%|███▍      | 137/401 [00:32<00:21, 12.17it/s, est. speed input: 3712.95 toks/s, output: 582.62 toks/s]
Processed prompts:  35%|███▌      | 142/401 [00:33<00:22, 11.53it/s, est. speed input: 3774.22 toks/s, output: 598.54 toks/s]
Processed prompts:  37%|███▋      | 147/401 [00:33<00:18, 13.89it/s, est. speed input: 3890.02 toks/s, output: 619.29 toks/s]
Processed prompts:  37%|███▋      | 150/401 [00:33<00:16, 15.52it/s, est. speed input: 3942.46 toks/s, output: 631.93 toks/s]
Processed prompts:  39%|███▉      | 156/401 [00:33<00:11, 21.31it/s, est. speed input: 4126.24 toks/s, output: 659.41 toks/s]
Processed prompts:  40%|████      | 162/401 [00:33<00:08, 27.24it/s, est. speed input: 4284.48 toks/s, output: 687.04 toks/s]
Processed prompts:  43%|████▎     | 171/401 [00:33<00:05, 38.49it/s, est. speed input: 4535.23 toks/s, output: 729.92 toks/s]
Processed prompts:  44%|████▍     | 177/401 [00:34<00:05, 42.66it/s, est. speed input: 4692.97 toks/s, output: 758.00 toks/s]
Processed prompts:  46%|████▌     | 183/401 [00:34<00:04, 46.36it/s, est. speed input: 4829.30 toks/s, output: 786.28 toks/s]
Processed prompts:  48%|████▊     | 191/401 [00:34<00:04, 49.09it/s, est. speed input: 5024.67 toks/s, output: 824.08 toks/s]
Processed prompts:  50%|████▉     | 200/401 [00:34<00:03, 53.77it/s, est. speed input: 5367.78 toks/s, output: 867.46 toks/s]
Processed prompts:  51%|█████▏    | 206/401 [00:34<00:03, 50.73it/s, est. speed input: 5581.30 toks/s, output: 895.72 toks/s]
Processed prompts:  53%|█████▎    | 212/401 [00:34<00:04, 44.51it/s, est. speed input: 5782.85 toks/s, output: 923.30 toks/s]
Processed prompts:  54%|█████▍    | 217/401 [00:34<00:04, 42.78it/s, est. speed input: 5896.53 toks/s, output: 947.02 toks/s]
Processed prompts:  55%|█████▌    | 222/401 [00:35<00:04, 38.11it/s, est. speed input: 6018.28 toks/s, output: 969.85 toks/s]
Processed prompts:  57%|█████▋    | 227/401 [00:35<00:05, 32.76it/s, est. speed input: 6107.52 toks/s, output: 991.94 toks/s]
Processed prompts:  58%|█████▊    | 231/401 [00:35<00:06, 26.30it/s, est. speed input: 6205.40 toks/s, output: 1007.87 toks/s]
Processed prompts:  59%|█████▉    | 236/401 [00:35<00:05, 29.35it/s, est. speed input: 6346.04 toks/s, output: 1033.40 toks/s]
Processed prompts:  60%|█████▉    | 240/401 [00:35<00:07, 22.98it/s, est. speed input: 6396.14 toks/s, output: 1048.84 toks/s]
Processed prompts:  61%|██████    | 243/401 [00:36<00:10, 15.22it/s, est. speed input: 6398.51 toks/s, output: 1054.50 toks/s]
Processed prompts:  61%|██████▏   | 246/401 [00:36<00:09, 15.92it/s, est. speed input: 6474.46 toks/s, output: 1068.73 toks/s]
Processed prompts:  62%|██████▏   | 249/401 [00:36<00:08, 17.53it/s, est. speed input: 6540.39 toks/s, output: 1080.89 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [00:37<00:10, 13.68it/s, est. speed input: 6597.54 toks/s, output: 1087.05 toks/s]
Processed prompts:  63%|██████▎   | 254/401 [00:37<00:16,  9.15it/s, est. speed input: 6571.30 toks/s, output: 1079.54 toks/s]
Processed prompts:  64%|██████▍   | 257/401 [00:37<00:14,  9.64it/s, est. speed input: 6598.74 toks/s, output: 1085.30 toks/s]
Processed prompts:  65%|██████▍   | 259/401 [00:37<00:13, 10.69it/s, est. speed input: 6632.67 toks/s, output: 1090.29 toks/s]
Processed prompts:  65%|██████▌   | 262/401 [00:38<00:10, 13.20it/s, est. speed input: 6703.49 toks/s, output: 1097.14 toks/s]
Processed prompts:  66%|██████▌   | 264/401 [00:38<00:10, 13.18it/s, est. speed input: 6716.23 toks/s, output: 1100.71 toks/s]
Processed prompts:  67%|██████▋   | 268/401 [00:38<00:07, 17.60it/s, est. speed input: 6874.57 toks/s, output: 1114.26 toks/s]
Processed prompts:  68%|██████▊   | 272/401 [00:38<00:06, 20.12it/s, est. speed input: 6940.68 toks/s, output: 1124.53 toks/s]
Processed prompts:  69%|██████▊   | 275/401 [00:38<00:05, 21.78it/s, est. speed input: 7042.07 toks/s, output: 1133.31 toks/s]
Processed prompts:  69%|██████▉   | 278/401 [00:38<00:05, 20.55it/s, est. speed input: 7103.87 toks/s, output: 1140.32 toks/s]
Processed prompts:  70%|███████   | 281/401 [00:38<00:06, 18.65it/s, est. speed input: 7154.19 toks/s, output: 1150.75 toks/s]
Processed prompts:  72%|███████▏  | 289/401 [00:39<00:04, 27.72it/s, est. speed input: 7310.75 toks/s, output: 1178.58 toks/s]
Processed prompts:  73%|███████▎  | 293/401 [00:39<00:03, 28.66it/s, est. speed input: 7383.62 toks/s, output: 1191.47 toks/s]
Processed prompts:  75%|███████▍  | 299/401 [00:39<00:03, 33.74it/s, est. speed input: 7546.80 toks/s, output: 1213.09 toks/s]
Processed prompts:  76%|███████▌  | 303/401 [00:39<00:02, 33.62it/s, est. speed input: 7636.91 toks/s, output: 1225.05 toks/s]
Processed prompts:  77%|███████▋  | 310/401 [00:39<00:02, 40.57it/s, est. speed input: 7896.14 toks/s, output: 1251.13 toks/s]
Processed prompts:  80%|███████▉  | 320/401 [00:39<00:01, 53.49it/s, est. speed input: 8149.11 toks/s, output: 1291.18 toks/s]
Processed prompts:  81%|████████▏ | 326/401 [00:39<00:01, 53.92it/s, est. speed input: 8327.82 toks/s, output: 1314.13 toks/s]
Processed prompts:  83%|████████▎ | 332/401 [00:39<00:01, 51.28it/s, est. speed input: 8522.96 toks/s, output: 1336.40 toks/s]
Processed prompts:  84%|████████▍ | 338/401 [00:40<00:01, 44.71it/s, est. speed input: 8657.25 toks/s, output: 1359.64 toks/s]
Processed prompts:  87%|████████▋ | 348/401 [00:40<00:00, 55.39it/s, est. speed input: 8997.85 toks/s, output: 1405.18 toks/s]
Processed prompts:  89%|████████▉ | 357/401 [00:40<00:00, 59.31it/s, est. speed input: 9293.06 toks/s, output: 1445.71 toks/s]
Processed prompts:  91%|█████████ | 364/401 [00:40<00:00, 58.48it/s, est. speed input: 9503.04 toks/s, output: 1476.98 toks/s]
Processed prompts:  93%|█████████▎| 371/401 [00:40<00:00, 59.37it/s, est. speed input: 9751.94 toks/s, output: 1512.25 toks/s]
Processed prompts:  94%|█████████▍| 378/401 [00:40<00:00, 61.98it/s, est. speed input: 9989.51 toks/s, output: 1546.33 toks/s]
Processed prompts:  96%|█████████▋| 386/401 [00:40<00:00, 54.25it/s, est. speed input: 10206.58 toks/s, output: 1583.42 toks/s]
Processed prompts:  98%|█████████▊| 392/401 [00:41<00:00, 19.05it/s, est. speed input: 10214.56 toks/s, output: 1591.17 toks/s]
Processed prompts:  99%|█████████▉| 397/401 [00:43<00:00, 10.24it/s, est. speed input: 10095.39 toks/s, output: 1588.00 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:44<00:00,  5.56it/s, est. speed input: 9827.42 toks/s, output: 1559.49 toks/s] 
Processed prompts: 100%|██████████| 401/401 [00:44<00:00,  8.92it/s, est. speed input: 9827.42 toks/s, output: 1559.49 toks/s]
[rank0]:[W709 15:43:06.478669988 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/ae_rag_full_profile_test_4_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:43:09.946355_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:43:09.946355_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:43:09.946355_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:36,  3.34it/s]
  1%|          | 3/526 [00:00<01:20,  6.46it/s]
  1%|          | 5/526 [00:00<00:56,  9.26it/s]
  1%|▏         | 7/526 [00:00<00:44, 11.64it/s]
  2%|▏         | 9/526 [00:01<01:44,  4.93it/s]
  2%|▏         | 11/526 [00:01<01:19,  6.47it/s]
  2%|▏         | 13/526 [00:02<01:32,  5.54it/s]
  3%|▎         | 15/526 [00:02<01:17,  6.61it/s]
  3%|▎         | 16/526 [00:02<01:19,  6.42it/s]
  3%|▎         | 18/526 [00:02<01:02,  8.07it/s]
  4%|▍         | 20/526 [00:03<01:18,  6.48it/s]
  4%|▍         | 21/526 [00:04<02:52,  2.92it/s]
  4%|▍         | 22/526 [00:04<02:59,  2.81it/s]
  4%|▍         | 23/526 [00:05<03:42,  2.26it/s]
  5%|▍         | 24/526 [00:06<04:19,  1.94it/s]
  5%|▍         | 25/526 [00:07<05:26,  1.53it/s]
  5%|▍         | 26/526 [00:07<04:37,  1.80it/s]
  5%|▌         | 27/526 [00:07<03:40,  2.26it/s]
  5%|▌         | 28/526 [00:07<03:34,  2.32it/s]
  6%|▌         | 30/526 [00:09<04:46,  1.73it/s]
  6%|▌         | 31/526 [00:09<04:40,  1.77it/s]
  6%|▌         | 32/526 [00:10<03:59,  2.06it/s]
  6%|▋         | 33/526 [00:11<05:45,  1.43it/s]
  6%|▋         | 34/526 [00:12<05:59,  1.37it/s]
  7%|▋         | 35/526 [00:13<06:36,  1.24it/s]
  7%|▋         | 36/526 [00:13<05:07,  1.59it/s]
  7%|▋         | 37/526 [00:13<04:25,  1.84it/s]
  7%|▋         | 39/526 [00:13<02:35,  3.12it/s]
  8%|▊         | 40/526 [00:14<02:19,  3.47it/s]
  8%|▊         | 42/526 [00:14<01:46,  4.53it/s]
  8%|▊         | 43/526 [00:14<02:25,  3.32it/s]
  9%|▊         | 45/526 [00:15<01:43,  4.65it/s]
  9%|▊         | 46/526 [00:15<01:50,  4.34it/s]
  9%|▉         | 47/526 [00:15<02:08,  3.74it/s]
  9%|▉         | 48/526 [00:16<02:43,  2.93it/s]
 10%|▉         | 50/526 [00:16<02:07,  3.74it/s]
 10%|▉         | 52/526 [00:16<01:37,  4.88it/s]
 10%|█         | 53/526 [00:18<03:27,  2.28it/s]
 10%|█         | 54/526 [00:21<08:50,  1.12s/it]
 11%|█         | 56/526 [00:21<05:29,  1.43it/s]
 11%|█         | 58/526 [00:22<04:27,  1.75it/s]
 11%|█         | 59/526 [00:23<04:45,  1.64it/s]
 11%|█▏        | 60/526 [00:24<05:07,  1.52it/s]
 12%|█▏        | 61/526 [00:24<05:01,  1.54it/s]
 12%|█▏        | 62/526 [00:25<06:04,  1.27it/s]
 12%|█▏        | 63/526 [00:27<07:27,  1.04it/s]
 12%|█▏        | 64/526 [00:27<06:03,  1.27it/s]
 12%|█▏        | 65/526 [00:27<04:36,  1.67it/s]
 13%|█▎        | 66/526 [00:27<03:53,  1.97it/s]
 13%|█▎        | 67/526 [00:28<03:42,  2.06it/s]
 13%|█▎        | 68/526 [00:29<04:45,  1.61it/s]
 13%|█▎        | 69/526 [00:29<03:37,  2.10it/s]
 13%|█▎        | 70/526 [00:30<05:49,  1.30it/s]
 13%|█▎        | 71/526 [00:31<06:01,  1.26it/s]
 14%|█▎        | 72/526 [00:32<05:34,  1.36it/s]
 14%|█▍        | 73/526 [00:33<06:22,  1.18it/s]
 14%|█▍        | 74/526 [00:34<07:43,  1.03s/it]
 14%|█▍        | 75/526 [00:35<05:45,  1.30it/s]
 14%|█▍        | 76/526 [00:35<04:18,  1.74it/s]
 15%|█▍        | 77/526 [00:36<05:24,  1.38it/s]
 15%|█▍        | 78/526 [00:37<07:00,  1.07it/s]
 15%|█▌        | 79/526 [00:37<05:09,  1.44it/s]
 15%|█▌        | 80/526 [00:38<04:12,  1.77it/s]
 16%|█▌        | 82/526 [00:39<04:25,  1.67it/s]
 16%|█▌        | 84/526 [00:40<04:13,  1.74it/s]
 16%|█▌        | 85/526 [00:42<06:08,  1.20it/s]
 16%|█▋        | 86/526 [00:42<05:13,  1.40it/s]
 17%|█▋        | 87/526 [00:43<05:44,  1.27it/s]
 17%|█▋        | 88/526 [00:43<04:48,  1.52it/s]
 17%|█▋        | 89/526 [00:44<04:08,  1.76it/s]
 17%|█▋        | 90/526 [00:44<03:41,  1.97it/s]
 17%|█▋        | 91/526 [00:44<03:28,  2.09it/s]
 17%|█▋        | 92/526 [00:45<02:44,  2.64it/s]
 18%|█▊        | 94/526 [00:45<01:45,  4.10it/s]
 18%|█▊        | 95/526 [00:45<01:31,  4.72it/s]
 18%|█▊        | 96/526 [00:45<02:01,  3.54it/s]
 18%|█▊        | 97/526 [00:46<02:46,  2.57it/s]
 19%|█▊        | 98/526 [00:49<08:07,  1.14s/it]
 19%|█▉        | 99/526 [00:52<12:21,  1.74s/it]
 19%|█▉        | 101/526 [00:53<07:31,  1.06s/it]
 19%|█▉        | 102/526 [00:53<06:25,  1.10it/s]
 20%|█▉        | 103/526 [00:54<05:55,  1.19it/s]
 20%|█▉        | 104/526 [00:55<06:49,  1.03it/s]
 20%|██        | 106/526 [00:56<04:41,  1.49it/s]
 21%|██        | 108/526 [00:56<03:29,  2.00it/s]
 21%|██        | 109/526 [00:57<03:13,  2.16it/s]
 21%|██        | 110/526 [00:58<04:09,  1.67it/s]
 21%|██        | 111/526 [00:58<03:50,  1.80it/s]
 21%|██▏       | 112/526 [00:58<03:37,  1.90it/s]
 21%|██▏       | 113/526 [00:59<02:49,  2.44it/s]
 22%|██▏       | 114/526 [00:59<02:19,  2.95it/s]
 22%|██▏       | 115/526 [00:59<01:55,  3.56it/s]
 22%|██▏       | 116/526 [00:59<01:33,  4.38it/s]
 22%|██▏       | 117/526 [01:00<03:34,  1.91it/s]
 22%|██▏       | 118/526 [01:01<05:02,  1.35it/s]
 23%|██▎       | 119/526 [01:02<04:11,  1.62it/s]
 23%|██▎       | 120/526 [01:03<04:58,  1.36it/s]
 23%|██▎       | 121/526 [01:03<03:55,  1.72it/s]
 23%|██▎       | 122/526 [01:04<05:18,  1.27it/s]
 23%|██▎       | 123/526 [01:05<05:54,  1.14it/s]
 24%|██▎       | 124/526 [01:07<06:45,  1.01s/it]
 24%|██▍       | 125/526 [01:07<04:59,  1.34it/s]
 24%|██▍       | 127/526 [01:07<03:07,  2.13it/s]
 24%|██▍       | 128/526 [01:07<02:37,  2.53it/s]
 25%|██▍       | 129/526 [01:08<02:35,  2.56it/s]
 25%|██▍       | 130/526 [01:08<02:34,  2.56it/s]
 25%|██▍       | 131/526 [01:08<02:16,  2.90it/s]
 25%|██▌       | 132/526 [01:08<01:53,  3.47it/s]
 25%|██▌       | 133/526 [01:09<01:38,  3.97it/s]
 26%|██▌       | 135/526 [01:09<01:28,  4.40it/s]
 26%|██▌       | 136/526 [01:09<01:37,  3.99it/s]
 26%|██▌       | 138/526 [01:10<01:19,  4.87it/s]
 26%|██▋       | 139/526 [01:10<01:30,  4.30it/s]
 27%|██▋       | 140/526 [01:10<01:22,  4.67it/s]
 27%|██▋       | 141/526 [01:10<01:21,  4.74it/s]
 27%|██▋       | 142/526 [01:10<01:15,  5.11it/s]
 27%|██▋       | 143/526 [01:11<01:57,  3.26it/s]
 27%|██▋       | 144/526 [01:11<01:39,  3.84it/s]
 28%|██▊       | 145/526 [01:12<03:26,  1.84it/s]
 28%|██▊       | 146/526 [01:13<03:01,  2.10it/s]
 28%|██▊       | 147/526 [01:13<02:49,  2.23it/s]
 28%|██▊       | 149/526 [01:14<02:08,  2.94it/s]
 29%|██▊       | 150/526 [01:14<01:48,  3.46it/s]
 29%|██▊       | 151/526 [01:14<01:34,  3.95it/s]
 29%|██▉       | 152/526 [01:14<01:25,  4.38it/s]
 29%|██▉       | 154/526 [01:15<02:15,  2.74it/s]
 29%|██▉       | 155/526 [01:16<03:03,  2.02it/s]
 30%|██▉       | 156/526 [01:17<03:50,  1.60it/s]
 30%|██▉       | 157/526 [01:17<03:28,  1.77it/s]
 30%|███       | 159/526 [01:17<02:06,  2.90it/s]
 30%|███       | 160/526 [01:19<03:37,  1.68it/s]
 31%|███       | 161/526 [01:19<03:08,  1.94it/s]
 31%|███       | 162/526 [01:21<05:30,  1.10it/s]
 31%|███       | 164/526 [01:22<03:37,  1.66it/s]
 32%|███▏      | 166/526 [01:22<02:28,  2.42it/s]
 32%|███▏      | 167/526 [01:22<02:21,  2.55it/s]
 32%|███▏      | 168/526 [01:23<03:30,  1.70it/s]
 32%|███▏      | 169/526 [01:24<03:05,  1.92it/s]
 33%|███▎      | 171/526 [01:26<04:18,  1.37it/s]
 33%|███▎      | 172/526 [01:26<03:32,  1.67it/s]
 33%|███▎      | 173/526 [01:26<03:06,  1.89it/s]
 33%|███▎      | 174/526 [01:27<02:52,  2.05it/s]
 33%|███▎      | 175/526 [01:27<02:17,  2.55it/s]
 33%|███▎      | 176/526 [01:28<03:08,  1.85it/s]
 34%|███▎      | 177/526 [01:28<02:27,  2.37it/s]
 34%|███▍      | 178/526 [01:28<01:57,  2.95it/s]
 34%|███▍      | 179/526 [01:28<01:38,  3.53it/s]
 34%|███▍      | 180/526 [01:29<03:17,  1.75it/s]
 34%|███▍      | 181/526 [01:29<02:33,  2.25it/s]
 35%|███▍      | 182/526 [01:31<04:16,  1.34it/s]
 35%|███▍      | 183/526 [01:31<03:11,  1.79it/s]
 35%|███▍      | 184/526 [01:32<03:11,  1.78it/s]
 35%|███▌      | 186/526 [01:33<04:06,  1.38it/s]
 36%|███▌      | 187/526 [01:34<03:39,  1.54it/s]
 36%|███▌      | 188/526 [01:34<03:23,  1.66it/s]
 36%|███▌      | 190/526 [01:34<02:09,  2.59it/s]
 36%|███▋      | 191/526 [01:35<01:52,  2.98it/s]
 37%|███▋      | 192/526 [01:35<01:37,  3.43it/s]
 37%|███▋      | 193/526 [01:35<01:20,  4.12it/s]
 37%|███▋      | 194/526 [01:35<01:09,  4.76it/s]
 37%|███▋      | 195/526 [01:36<02:47,  1.98it/s]
 37%|███▋      | 196/526 [01:37<03:53,  1.41it/s]
 37%|███▋      | 197/526 [01:38<03:09,  1.74it/s]
 38%|███▊      | 198/526 [01:38<02:50,  1.92it/s]
 38%|███▊      | 199/526 [01:40<05:09,  1.06it/s]
 38%|███▊      | 200/526 [01:40<04:00,  1.36it/s]
 38%|███▊      | 201/526 [01:41<04:09,  1.30it/s]
 38%|███▊      | 202/526 [01:41<03:17,  1.64it/s]
 39%|███▊      | 203/526 [01:42<03:36,  1.49it/s]
 39%|███▉      | 205/526 [01:42<02:05,  2.55it/s]
 39%|███▉      | 206/526 [01:43<01:46,  3.01it/s]
 39%|███▉      | 207/526 [01:43<01:36,  3.30it/s]
 40%|███▉      | 210/526 [01:43<00:53,  5.95it/s]
 40%|████      | 212/526 [01:44<01:39,  3.14it/s]
 41%|████      | 214/526 [01:44<01:19,  3.92it/s]
 41%|████      | 215/526 [01:45<01:42,  3.05it/s]
 41%|████      | 216/526 [01:45<01:42,  3.03it/s]
 41%|████▏     | 217/526 [01:46<02:29,  2.07it/s]
 41%|████▏     | 218/526 [01:47<03:07,  1.64it/s]
 42%|████▏     | 219/526 [01:48<03:19,  1.54it/s]
 42%|████▏     | 220/526 [01:48<02:33,  1.99it/s]
 42%|████▏     | 222/526 [01:48<01:35,  3.17it/s]
 42%|████▏     | 223/526 [01:49<02:25,  2.08it/s]
 43%|████▎     | 224/526 [01:50<02:01,  2.48it/s]
 43%|████▎     | 225/526 [01:50<01:59,  2.52it/s]
 43%|████▎     | 227/526 [01:50<01:38,  3.05it/s]
 43%|████▎     | 228/526 [01:51<01:23,  3.56it/s]
 44%|████▎     | 229/526 [01:51<01:32,  3.20it/s]
 44%|████▎     | 230/526 [01:51<01:23,  3.55it/s]
 44%|████▍     | 231/526 [01:52<02:19,  2.11it/s]
 44%|████▍     | 232/526 [01:52<01:49,  2.69it/s]
 44%|████▍     | 233/526 [01:52<01:32,  3.16it/s]
 44%|████▍     | 234/526 [01:54<02:51,  1.70it/s]
 45%|████▍     | 235/526 [01:54<02:41,  1.80it/s]
 45%|████▍     | 236/526 [01:54<02:06,  2.29it/s]
 45%|████▌     | 237/526 [01:55<01:58,  2.43it/s]
 45%|████▌     | 238/526 [01:55<01:40,  2.88it/s]
 46%|████▌     | 240/526 [01:55<01:03,  4.50it/s]
 46%|████▌     | 241/526 [01:56<01:59,  2.38it/s]
 46%|████▌     | 243/526 [01:57<01:41,  2.78it/s]
 46%|████▋     | 244/526 [01:57<01:44,  2.71it/s]
 47%|████▋     | 245/526 [01:58<02:26,  1.92it/s]
 47%|████▋     | 246/526 [01:58<02:09,  2.16it/s]
 47%|████▋     | 247/526 [01:58<01:47,  2.60it/s]
 47%|████▋     | 248/526 [01:59<02:06,  2.20it/s]
 47%|████▋     | 249/526 [02:00<02:46,  1.66it/s]
 48%|████▊     | 250/526 [02:00<02:10,  2.12it/s]
 48%|████▊     | 251/526 [02:01<02:46,  1.65it/s]
 48%|████▊     | 252/526 [02:01<02:23,  1.91it/s]
 48%|████▊     | 253/526 [02:02<01:55,  2.37it/s]
 48%|████▊     | 255/526 [02:03<02:06,  2.14it/s]
 49%|████▊     | 256/526 [02:03<01:52,  2.41it/s]
 49%|████▉     | 257/526 [02:04<02:51,  1.57it/s]
 49%|████▉     | 258/526 [02:05<03:13,  1.38it/s]
 49%|████▉     | 259/526 [02:05<02:29,  1.79it/s]
 49%|████▉     | 260/526 [02:05<01:56,  2.27it/s]
 50%|████▉     | 261/526 [02:06<02:01,  2.17it/s]
 50%|████▉     | 262/526 [02:06<01:34,  2.79it/s]
 50%|█████     | 263/526 [02:07<02:20,  1.87it/s]
 50%|█████     | 264/526 [02:08<02:42,  1.61it/s]
 50%|█████     | 265/526 [02:08<02:05,  2.09it/s]
 51%|█████     | 266/526 [02:09<02:15,  1.92it/s]
 51%|█████     | 267/526 [02:09<02:22,  1.82it/s]
 51%|█████     | 268/526 [02:09<01:50,  2.34it/s]
 51%|█████     | 269/526 [02:10<01:33,  2.74it/s]
 51%|█████▏    | 270/526 [02:10<01:46,  2.41it/s]
 52%|█████▏    | 271/526 [02:10<01:28,  2.88it/s]
 52%|█████▏    | 272/526 [02:11<01:41,  2.49it/s]
 52%|█████▏    | 273/526 [02:12<02:25,  1.74it/s]
 52%|█████▏    | 274/526 [02:12<02:11,  1.91it/s]
 52%|█████▏    | 275/526 [02:15<05:33,  1.33s/it]
 52%|█████▏    | 276/526 [02:16<04:07,  1.01it/s]
 53%|█████▎    | 277/526 [02:16<03:06,  1.33it/s]
 53%|█████▎    | 278/526 [02:16<03:04,  1.34it/s]
 53%|█████▎    | 279/526 [02:20<06:05,  1.48s/it]
 53%|█████▎    | 280/526 [02:23<08:07,  1.98s/it]
 53%|█████▎    | 281/526 [02:26<09:33,  2.34s/it]
 54%|█████▎    | 282/526 [02:29<10:32,  2.59s/it]
 54%|█████▍    | 283/526 [02:32<11:12,  2.77s/it]
 54%|█████▍    | 284/526 [02:36<11:39,  2.89s/it]
 54%|█████▍    | 285/526 [02:36<08:38,  2.15s/it]
 54%|█████▍    | 286/526 [02:37<07:01,  1.76s/it]
 55%|█████▍    | 287/526 [02:37<05:06,  1.28s/it]
 55%|█████▍    | 288/526 [02:37<03:51,  1.03it/s]
 55%|█████▍    | 289/526 [02:37<02:53,  1.36it/s]
 55%|█████▌    | 291/526 [02:38<02:31,  1.55it/s]
 56%|█████▌    | 292/526 [02:39<02:04,  1.87it/s]
 56%|█████▌    | 293/526 [02:39<02:15,  1.72it/s]
 56%|█████▌    | 294/526 [02:40<01:57,  1.97it/s]
 56%|█████▌    | 295/526 [02:40<01:44,  2.21it/s]
 56%|█████▋    | 296/526 [02:40<01:35,  2.40it/s]
 57%|█████▋    | 298/526 [02:44<03:37,  1.05it/s]
 57%|█████▋    | 299/526 [02:47<05:34,  1.47s/it]
 57%|█████▋    | 300/526 [02:48<05:32,  1.47s/it]
 57%|█████▋    | 301/526 [02:49<05:04,  1.35s/it]
 57%|█████▋    | 302/526 [02:51<05:08,  1.38s/it]
 58%|█████▊    | 303/526 [02:52<05:13,  1.40s/it]
 58%|█████▊    | 304/526 [02:52<04:01,  1.09s/it]
 58%|█████▊    | 305/526 [02:54<04:25,  1.20s/it]
 58%|█████▊    | 306/526 [02:55<04:37,  1.26s/it]
 58%|█████▊    | 307/526 [02:57<04:49,  1.32s/it]
 59%|█████▊    | 308/526 [02:58<04:57,  1.37s/it]
 59%|█████▊    | 309/526 [02:58<03:45,  1.04s/it]
 59%|█████▉    | 310/526 [02:59<03:36,  1.00s/it]
 59%|█████▉    | 311/526 [03:00<02:45,  1.30it/s]
 59%|█████▉    | 312/526 [03:01<03:32,  1.01it/s]
 60%|█████▉    | 313/526 [03:03<04:02,  1.14s/it]
 60%|█████▉    | 314/526 [03:04<04:34,  1.29s/it]
 60%|█████▉    | 315/526 [03:07<06:30,  1.85s/it]
 60%|██████    | 316/526 [03:08<04:38,  1.33s/it]
 60%|██████    | 317/526 [03:08<04:08,  1.19s/it]
 60%|██████    | 318/526 [03:09<03:45,  1.08s/it]
 61%|██████    | 319/526 [03:10<02:59,  1.15it/s]
 61%|██████    | 320/526 [03:10<02:14,  1.53it/s]
 61%|██████    | 321/526 [03:11<03:16,  1.05it/s]
 61%|██████    | 322/526 [03:12<02:38,  1.29it/s]
 61%|██████▏   | 323/526 [03:12<02:04,  1.64it/s]
 62%|██████▏   | 324/526 [03:12<01:41,  1.99it/s]
 62%|██████▏   | 325/526 [03:13<01:26,  2.31it/s]
 62%|██████▏   | 326/526 [03:13<01:08,  2.92it/s]
 62%|██████▏   | 327/526 [03:13<01:07,  2.94it/s]
 62%|██████▏   | 328/526 [03:13<00:56,  3.48it/s]
 63%|██████▎   | 330/526 [03:13<00:36,  5.31it/s]
 63%|██████▎   | 331/526 [03:14<00:40,  4.86it/s]
 63%|██████▎   | 332/526 [03:14<00:57,  3.38it/s]
 63%|██████▎   | 333/526 [03:14<00:52,  3.69it/s]
 63%|██████▎   | 334/526 [03:16<01:47,  1.79it/s]
 64%|██████▎   | 335/526 [03:16<01:46,  1.79it/s]
 64%|██████▍   | 336/526 [03:17<02:27,  1.29it/s]
 64%|██████▍   | 337/526 [03:18<02:24,  1.30it/s]
 64%|██████▍   | 338/526 [03:19<02:16,  1.38it/s]
 64%|██████▍   | 339/526 [03:19<01:58,  1.57it/s]
 65%|██████▍   | 340/526 [03:22<04:19,  1.40s/it]
 65%|██████▍   | 341/526 [03:23<03:08,  1.02s/it]
 65%|██████▌   | 342/526 [03:23<02:37,  1.17it/s]
 65%|██████▌   | 343/526 [03:24<02:35,  1.18it/s]
 66%|██████▌   | 345/526 [03:31<06:09,  2.04s/it]
 66%|██████▌   | 346/526 [03:34<06:58,  2.33s/it]
 66%|██████▌   | 347/526 [03:41<10:21,  3.47s/it]
 66%|██████▌   | 348/526 [03:42<08:18,  2.80s/it]
 66%|██████▋   | 349/526 [03:42<06:20,  2.15s/it]
 67%|██████▋   | 350/526 [03:49<10:14,  3.49s/it]
 67%|██████▋   | 351/526 [03:52<09:55,  3.40s/it]
 67%|██████▋   | 352/526 [03:52<07:11,  2.48s/it]
 67%|██████▋   | 353/526 [03:53<05:11,  1.80s/it]
 67%|██████▋   | 355/526 [03:53<03:08,  1.10s/it]
 68%|██████▊   | 356/526 [03:53<02:26,  1.16it/s]
 68%|██████▊   | 357/526 [03:54<02:13,  1.27it/s]
 68%|██████▊   | 358/526 [03:54<02:03,  1.36it/s]
 68%|██████▊   | 359/526 [03:55<01:40,  1.66it/s]
 68%|██████▊   | 360/526 [03:55<01:17,  2.14it/s]
 69%|██████▊   | 361/526 [03:55<01:06,  2.50it/s]
 69%|██████▉   | 363/526 [03:56<01:02,  2.63it/s]
 69%|██████▉   | 364/526 [03:56<00:54,  2.97it/s]
 69%|██████▉   | 365/526 [03:57<01:05,  2.44it/s]
 70%|██████▉   | 366/526 [03:58<02:00,  1.33it/s]
 70%|██████▉   | 367/526 [03:58<01:32,  1.72it/s]
 70%|██████▉   | 368/526 [03:59<01:12,  2.18it/s]
 70%|███████   | 369/526 [03:59<01:10,  2.22it/s]
 70%|███████   | 370/526 [04:06<05:55,  2.28s/it]
 71%|███████   | 371/526 [04:12<09:18,  3.60s/it]
 71%|███████   | 372/526 [04:19<11:34,  4.51s/it]
 71%|███████   | 374/526 [04:19<06:17,  2.48s/it]
 71%|███████▏  | 375/526 [04:26<08:54,  3.54s/it]
 71%|███████▏  | 376/526 [04:26<06:36,  2.65s/it]
 72%|███████▏  | 377/526 [04:27<05:11,  2.09s/it]
 72%|███████▏  | 379/526 [04:27<03:09,  1.29s/it]
 72%|███████▏  | 380/526 [04:28<02:31,  1.04s/it]
 72%|███████▏  | 381/526 [04:34<05:55,  2.45s/it]
 73%|███████▎  | 382/526 [04:35<04:37,  1.93s/it]
 73%|███████▎  | 383/526 [04:35<03:36,  1.51s/it]
 73%|███████▎  | 384/526 [04:42<06:59,  2.95s/it]
 73%|███████▎  | 385/526 [04:48<09:29,  4.04s/it]
 73%|███████▎  | 386/526 [04:49<07:20,  3.15s/it]
 74%|███████▎  | 387/526 [04:50<05:19,  2.30s/it]
 74%|███████▍  | 388/526 [04:50<03:59,  1.73s/it]
 74%|███████▍  | 389/526 [04:51<03:12,  1.40s/it]
 74%|███████▍  | 390/526 [04:51<02:38,  1.17s/it]
 74%|███████▍  | 391/526 [04:51<01:56,  1.15it/s]
 75%|███████▍  | 392/526 [04:52<01:25,  1.56it/s]
 75%|███████▍  | 393/526 [04:52<01:23,  1.58it/s]
 75%|███████▍  | 394/526 [04:52<01:03,  2.09it/s]
 75%|███████▌  | 396/526 [04:52<00:39,  3.30it/s]
 75%|███████▌  | 397/526 [04:53<00:33,  3.82it/s]
 76%|███████▌  | 398/526 [04:53<00:33,  3.79it/s]
 76%|███████▌  | 399/526 [05:00<04:18,  2.04s/it]
 76%|███████▌  | 400/526 [05:00<03:08,  1.50s/it]
 76%|███████▌  | 401/526 [05:07<06:18,  3.03s/it]
 76%|███████▋  | 402/526 [05:07<04:44,  2.29s/it]
 77%|███████▋  | 403/526 [05:07<03:31,  1.72s/it]
 77%|███████▋  | 404/526 [05:08<02:35,  1.27s/it]
 77%|███████▋  | 405/526 [05:08<01:55,  1.04it/s]
 77%|███████▋  | 406/526 [05:13<04:19,  2.16s/it]
 78%|███████▊  | 408/526 [05:13<02:23,  1.22s/it]
 78%|███████▊  | 409/526 [05:14<02:04,  1.06s/it]
 78%|███████▊  | 410/526 [05:14<01:35,  1.21it/s]
 78%|███████▊  | 411/526 [05:21<04:41,  2.45s/it]
 78%|███████▊  | 412/526 [05:21<03:27,  1.82s/it]
 79%|███████▊  | 414/526 [05:21<01:58,  1.06s/it]
 79%|███████▉  | 415/526 [05:21<01:38,  1.13it/s]
 79%|███████▉  | 417/526 [05:22<01:08,  1.60it/s]
 79%|███████▉  | 418/526 [05:24<01:34,  1.14it/s]
 80%|███████▉  | 419/526 [05:24<01:14,  1.43it/s]
 80%|████████  | 421/526 [05:27<02:03,  1.18s/it]
 80%|████████  | 422/526 [05:28<01:37,  1.07it/s]
 80%|████████  | 423/526 [05:28<01:20,  1.28it/s]
 81%|████████  | 424/526 [05:28<01:03,  1.62it/s]
 81%|████████  | 425/526 [05:28<00:48,  2.07it/s]
 81%|████████  | 426/526 [05:28<00:41,  2.41it/s]
 81%|████████  | 427/526 [05:29<00:33,  2.96it/s]
 81%|████████▏ | 428/526 [05:29<00:26,  3.65it/s]
 82%|████████▏ | 429/526 [05:29<00:22,  4.25it/s]
 82%|████████▏ | 431/526 [05:30<00:35,  2.71it/s]
 82%|████████▏ | 433/526 [05:30<00:25,  3.64it/s]
 83%|████████▎ | 435/526 [05:33<00:59,  1.54it/s]
 83%|████████▎ | 436/526 [05:34<01:03,  1.42it/s]
 83%|████████▎ | 438/526 [05:35<00:56,  1.57it/s]
 83%|████████▎ | 439/526 [05:36<00:58,  1.48it/s]
 84%|████████▎ | 440/526 [05:36<00:58,  1.48it/s]
 84%|████████▍ | 442/526 [05:37<00:42,  1.97it/s]
 84%|████████▍ | 444/526 [05:38<00:52,  1.57it/s]
 85%|████████▍ | 445/526 [05:40<01:08,  1.18it/s]
 85%|████████▍ | 446/526 [05:40<00:57,  1.40it/s]
 85%|████████▍ | 447/526 [05:41<00:49,  1.59it/s]
 85%|████████▌ | 448/526 [05:41<00:40,  1.93it/s]
 86%|████████▌ | 450/526 [05:41<00:25,  3.00it/s]
 86%|████████▌ | 451/526 [05:41<00:21,  3.51it/s]
 86%|████████▌ | 453/526 [05:41<00:14,  4.98it/s]
 86%|████████▋ | 454/526 [05:42<00:20,  3.57it/s]
 87%|████████▋ | 456/526 [05:42<00:15,  4.50it/s]
 87%|████████▋ | 458/526 [05:42<00:13,  5.23it/s]
 87%|████████▋ | 459/526 [05:43<00:13,  5.02it/s]
 87%|████████▋ | 460/526 [05:43<00:18,  3.60it/s]
 88%|████████▊ | 461/526 [05:43<00:15,  4.17it/s]
 88%|████████▊ | 462/526 [05:44<00:14,  4.32it/s]
 88%|████████▊ | 463/526 [05:44<00:17,  3.70it/s]
 88%|████████▊ | 465/526 [05:44<00:13,  4.44it/s]
 89%|████████▊ | 466/526 [05:45<00:15,  3.83it/s]
 89%|████████▉ | 467/526 [05:45<00:18,  3.28it/s]
 89%|████████▉ | 468/526 [05:45<00:14,  3.87it/s]
 89%|████████▉ | 470/526 [05:45<00:10,  5.43it/s]
 90%|████████▉ | 471/526 [05:45<00:09,  6.03it/s]
 90%|████████▉ | 472/526 [05:46<00:12,  4.31it/s]
 90%|█████████ | 474/526 [05:46<00:08,  6.06it/s]
 90%|█████████ | 475/526 [05:47<00:16,  3.14it/s]
 90%|█████████ | 476/526 [05:47<00:16,  2.99it/s]
 91%|█████████ | 478/526 [05:47<00:10,  4.58it/s]
 91%|█████████ | 479/526 [05:48<00:17,  2.76it/s]
 91%|█████████▏| 480/526 [05:49<00:17,  2.68it/s]
 91%|█████████▏| 481/526 [05:50<00:29,  1.51it/s]
 92%|█████████▏| 482/526 [05:50<00:24,  1.77it/s]
 92%|█████████▏| 483/526 [05:51<00:20,  2.12it/s]
 92%|█████████▏| 484/526 [05:51<00:17,  2.47it/s]
 92%|█████████▏| 485/526 [05:51<00:14,  2.80it/s]
 92%|█████████▏| 486/526 [05:51<00:11,  3.37it/s]
 93%|█████████▎| 487/526 [05:51<00:10,  3.75it/s]
 93%|█████████▎| 489/526 [05:52<00:07,  4.85it/s]
 93%|█████████▎| 490/526 [05:52<00:07,  4.88it/s]
 93%|█████████▎| 491/526 [05:53<00:11,  3.10it/s]
 94%|█████████▎| 493/526 [05:56<00:32,  1.02it/s]
 94%|█████████▍| 495/526 [05:57<00:20,  1.49it/s]
 94%|█████████▍| 496/526 [05:57<00:16,  1.78it/s]
 94%|█████████▍| 497/526 [05:58<00:19,  1.45it/s]
 95%|█████████▍| 498/526 [06:00<00:26,  1.07it/s]
 95%|█████████▍| 499/526 [06:01<00:31,  1.17s/it]
 95%|█████████▌| 500/526 [06:02<00:23,  1.12it/s]
 95%|█████████▌| 501/526 [06:02<00:17,  1.42it/s]
 96%|█████████▌| 503/526 [06:02<00:10,  2.26it/s]
 96%|█████████▌| 504/526 [06:02<00:08,  2.49it/s]
 96%|█████████▌| 505/526 [06:03<00:08,  2.37it/s]
 96%|█████████▌| 506/526 [06:03<00:07,  2.71it/s]
 96%|█████████▋| 507/526 [06:03<00:05,  3.28it/s]
 97%|█████████▋| 508/526 [06:04<00:06,  2.92it/s]
 97%|█████████▋| 510/526 [06:05<00:06,  2.31it/s]
 97%|█████████▋| 511/526 [06:05<00:06,  2.16it/s]
 97%|█████████▋| 512/526 [06:05<00:05,  2.57it/s]
 98%|█████████▊| 513/526 [06:06<00:06,  1.98it/s]
 98%|█████████▊| 514/526 [06:07<00:05,  2.17it/s]
 98%|█████████▊| 515/526 [06:07<00:04,  2.25it/s]
 98%|█████████▊| 516/526 [06:07<00:03,  2.78it/s]
 98%|█████████▊| 517/526 [06:08<00:03,  2.68it/s]
 98%|█████████▊| 518/526 [06:08<00:02,  2.92it/s]
 99%|█████████▊| 519/526 [06:08<00:01,  3.51it/s]
 99%|█████████▉| 520/526 [06:09<00:02,  2.03it/s]
 99%|█████████▉| 521/526 [06:09<00:01,  2.65it/s]
 99%|█████████▉| 522/526 [06:12<00:05,  1.27s/it]
 99%|█████████▉| 523/526 [06:16<00:05,  1.89s/it]
100%|█████████▉| 524/526 [06:19<00:04,  2.35s/it]
100%|█████████▉| 525/526 [06:20<00:01,  1.75s/it]
100%|██████████| 526/526 [06:23<00:00,  2.23s/it]
100%|██████████| 526/526 [06:23<00:00,  1.37it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:43:09.946355_lp_processed_test.json', '--output_addr', 'data/out/rag/full_profile/lp_rag_full_profile_test_4_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '4', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.18 examples/s]
Generating train split: 526 examples [00:00, 712.29 examples/s]
INFO 07-09 15:50:02 config.py:510] This model supports multiple tasks: {'reward', 'classify', 'generate', 'score', 'embed'}. Defaulting to 'generate'.
INFO 07-09 15:50:02 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:50:03 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:50:05 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:50:05 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.43it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.29it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.29it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.28it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.29it/s]

INFO 07-09 15:50:08 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 15:50:10 worker.py:241] Memory profiling takes 2.12 seconds
INFO 07-09 15:50:10 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 15:50:10 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 15:50:10 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 15:50:10 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 15:50:13 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  3.02it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.34it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.44it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.49it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.53it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.56it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.57it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.59it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.59it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.59it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.61it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.63it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.63it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.63it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.64it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.65it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.69it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:05<00:04,  3.72it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.74it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.77it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.78it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.79it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.80it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.81it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.80it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.74it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.78it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.79it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.82it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.83it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.84it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.85it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.79it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.83it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.86it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.70it/s]
INFO 07-09 15:50:23 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 15:50:23 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.53 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:20<2:55:07, 20.01s/it, est. speed input: 31.43 toks/s, output: 4.95 toks/s]
Processed prompts:   1%|          | 3/526 [00:20<46:27,  5.33s/it, est. speed input: 103.08 toks/s, output: 14.81 toks/s]
Processed prompts:   1%|          | 4/526 [00:20<31:22,  3.61s/it, est. speed input: 125.26 toks/s, output: 19.72 toks/s]
Processed prompts:   1%|          | 5/526 [00:21<22:39,  2.61s/it, est. speed input: 177.17 toks/s, output: 24.61 toks/s]
Processed prompts:   1%|▏         | 7/526 [00:21<12:22,  1.43s/it, est. speed input: 280.46 toks/s, output: 35.11 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:21<09:35,  1.11s/it, est. speed input: 301.33 toks/s, output: 40.38 toks/s]
Processed prompts:   2%|▏         | 10/526 [00:22<05:56,  1.45it/s, est. speed input: 361.72 toks/s, output: 51.11 toks/s]
Processed prompts:   2%|▏         | 11/526 [00:22<04:54,  1.75it/s, est. speed input: 402.61 toks/s, output: 56.34 toks/s]
Processed prompts:   3%|▎         | 14/526 [00:22<02:49,  3.01it/s, est. speed input: 500.08 toks/s, output: 72.53 toks/s]
Processed prompts:   3%|▎         | 16/526 [00:22<02:05,  4.07it/s, est. speed input: 599.61 toks/s, output: 83.44 toks/s]
Processed prompts:   4%|▎         | 19/526 [00:23<01:39,  5.11it/s, est. speed input: 703.19 toks/s, output: 98.96 toks/s]
Processed prompts:   5%|▍         | 24/526 [00:23<01:02,  7.98it/s, est. speed input: 856.12 toks/s, output: 125.94 toks/s]
Processed prompts:   5%|▍         | 26/526 [00:23<00:58,  8.60it/s, est. speed input: 917.94 toks/s, output: 136.35 toks/s]
Processed prompts:   6%|▌         | 30/526 [00:23<00:48, 10.32it/s, est. speed input: 1062.49 toks/s, output: 157.25 toks/s]
Processed prompts:   6%|▋         | 33/526 [00:24<00:46, 10.50it/s, est. speed input: 1175.95 toks/s, output: 172.22 toks/s]
Processed prompts:   7%|▋         | 36/526 [00:24<00:46, 10.58it/s, est. speed input: 1270.31 toks/s, output: 187.02 toks/s]
Processed prompts:   9%|▊         | 45/526 [00:25<00:43, 11.01it/s, est. speed input: 1617.01 toks/s, output: 230.61 toks/s]
Processed prompts:   9%|▉         | 47/526 [00:25<00:48,  9.92it/s, est. speed input: 1664.60 toks/s, output: 238.85 toks/s]
Processed prompts:  10%|█         | 54/526 [00:25<00:41, 11.38it/s, est. speed input: 1820.03 toks/s, output: 272.66 toks/s]
Processed prompts:  11%|█         | 59/526 [00:26<00:42, 11.08it/s, est. speed input: 1989.16 toks/s, output: 294.84 toks/s]
Processed prompts:  12%|█▏        | 63/526 [00:26<00:38, 11.88it/s, est. speed input: 2108.98 toks/s, output: 313.52 toks/s]
Processed prompts:  12%|█▏        | 65/526 [00:26<00:39, 11.80it/s, est. speed input: 2161.33 toks/s, output: 322.34 toks/s]
Processed prompts:  13%|█▎        | 68/526 [00:27<00:40, 11.30it/s, est. speed input: 2239.84 toks/s, output: 334.96 toks/s]
Processed prompts:  13%|█▎        | 70/526 [00:27<00:39, 11.42it/s, est. speed input: 2288.35 toks/s, output: 343.74 toks/s]
Processed prompts:  14%|█▍        | 73/526 [00:27<00:36, 12.36it/s, est. speed input: 2372.38 toks/s, output: 357.49 toks/s]
Processed prompts:  14%|█▍        | 75/526 [00:27<00:37, 11.93it/s, est. speed input: 2424.53 toks/s, output: 365.89 toks/s]
Processed prompts:  15%|█▍        | 77/526 [00:27<00:34, 13.06it/s, est. speed input: 2488.93 toks/s, output: 375.35 toks/s]
Processed prompts:  15%|█▌        | 80/526 [00:28<00:39, 11.20it/s, est. speed input: 2556.36 toks/s, output: 386.91 toks/s]
Processed prompts:  16%|█▌        | 83/526 [00:28<00:34, 12.93it/s, est. speed input: 2613.60 toks/s, output: 400.89 toks/s]
Processed prompts:  17%|█▋        | 87/526 [00:28<00:32, 13.34it/s, est. speed input: 2722.38 toks/s, output: 418.34 toks/s]
Processed prompts:  17%|█▋        | 89/526 [00:28<00:30, 14.20it/s, est. speed input: 2821.23 toks/s, output: 427.54 toks/s]
Processed prompts:  18%|█▊        | 97/526 [00:29<00:28, 14.97it/s, est. speed input: 3311.24 toks/s, output: 462.55 toks/s]
Processed prompts:  19%|█▉        | 101/526 [00:29<00:28, 15.00it/s, est. speed input: 3407.23 toks/s, output: 479.59 toks/s]
Processed prompts:  20%|█▉        | 103/526 [00:29<00:31, 13.26it/s, est. speed input: 3479.83 toks/s, output: 486.35 toks/s]
Processed prompts:  20%|██        | 107/526 [00:29<00:30, 13.80it/s, est. speed input: 3572.82 toks/s, output: 503.17 toks/s]
Processed prompts:  21%|██        | 110/526 [00:30<00:33, 12.59it/s, est. speed input: 3636.73 toks/s, output: 514.00 toks/s]
Processed prompts:  21%|██▏       | 112/526 [00:30<00:31, 13.27it/s, est. speed input: 3670.68 toks/s, output: 522.57 toks/s]
Processed prompts:  22%|██▏       | 114/526 [00:30<00:32, 12.54it/s, est. speed input: 3694.35 toks/s, output: 529.90 toks/s]
Processed prompts:  22%|██▏       | 116/526 [00:30<00:32, 12.77it/s, est. speed input: 3758.38 toks/s, output: 537.94 toks/s]
Processed prompts:  23%|██▎       | 121/526 [00:31<00:30, 13.27it/s, est. speed input: 3852.07 toks/s, output: 557.96 toks/s]
Processed prompts:  24%|██▎       | 124/526 [00:31<00:27, 14.51it/s, est. speed input: 3923.37 toks/s, output: 570.92 toks/s]
Processed prompts:  25%|██▌       | 132/526 [00:31<00:32, 12.22it/s, est. speed input: 4045.33 toks/s, output: 598.81 toks/s]
Processed prompts:  26%|██▌       | 136/526 [00:32<00:28, 13.90it/s, est. speed input: 4112.69 toks/s, output: 616.12 toks/s]
Processed prompts:  26%|██▌       | 138/526 [00:32<00:30, 12.67it/s, est. speed input: 4126.73 toks/s, output: 622.07 toks/s]
Processed prompts:  27%|██▋       | 140/526 [00:32<00:28, 13.54it/s, est. speed input: 4156.66 toks/s, output: 630.45 toks/s]
Processed prompts:  27%|██▋       | 142/526 [00:32<00:29, 12.92it/s, est. speed input: 4178.92 toks/s, output: 637.35 toks/s]
Processed prompts:  28%|██▊       | 147/526 [00:33<00:33, 11.15it/s, est. speed input: 4272.53 toks/s, output: 652.81 toks/s]
Processed prompts:  29%|██▉       | 153/526 [00:33<00:32, 11.62it/s, est. speed input: 4337.84 toks/s, output: 673.85 toks/s]
Processed prompts:  30%|██▉       | 157/526 [00:33<00:29, 12.45it/s, est. speed input: 4487.12 toks/s, output: 688.88 toks/s]
Processed prompts:  30%|███       | 159/526 [00:34<00:31, 11.83it/s, est. speed input: 4511.07 toks/s, output: 694.80 toks/s]
Processed prompts:  31%|███       | 162/526 [00:34<00:30, 11.91it/s, est. speed input: 4553.43 toks/s, output: 704.99 toks/s]
Processed prompts:  31%|███       | 164/526 [00:34<00:31, 11.54it/s, est. speed input: 4583.71 toks/s, output: 711.21 toks/s]
Processed prompts:  32%|███▏      | 166/526 [00:34<00:30, 11.88it/s, est. speed input: 4618.27 toks/s, output: 718.25 toks/s]
Processed prompts:  33%|███▎      | 173/526 [00:35<00:26, 13.40it/s, est. speed input: 4808.93 toks/s, output: 744.01 toks/s]
Processed prompts:  33%|███▎      | 175/526 [00:35<00:24, 14.10it/s, est. speed input: 4852.62 toks/s, output: 751.84 toks/s]
Processed prompts:  34%|███▎      | 177/526 [00:35<00:29, 11.70it/s, est. speed input: 4860.57 toks/s, output: 755.95 toks/s]
Processed prompts:  34%|███▍      | 179/526 [00:35<00:33, 10.43it/s, est. speed input: 4917.76 toks/s, output: 760.51 toks/s]
Processed prompts:  34%|███▍      | 181/526 [00:36<00:33, 10.36it/s, est. speed input: 4929.68 toks/s, output: 766.46 toks/s]
Processed prompts:  35%|███▌      | 185/526 [00:36<00:37,  9.15it/s, est. speed input: 4955.01 toks/s, output: 775.83 toks/s]
Processed prompts:  36%|███▌      | 188/526 [00:36<00:34,  9.82it/s, est. speed input: 5007.91 toks/s, output: 785.56 toks/s]
Processed prompts:  36%|███▌      | 190/526 [00:37<00:36,  9.19it/s, est. speed input: 5042.85 toks/s, output: 789.97 toks/s]
Processed prompts:  37%|███▋      | 195/526 [00:37<00:30, 11.02it/s, est. speed input: 5144.64 toks/s, output: 807.75 toks/s]
Processed prompts:  37%|███▋      | 197/526 [00:37<00:34,  9.44it/s, est. speed input: 5148.34 toks/s, output: 810.79 toks/s]
Processed prompts:  38%|███▊      | 198/526 [00:37<00:35,  9.19it/s, est. speed input: 5151.50 toks/s, output: 813.11 toks/s]
Processed prompts:  38%|███▊      | 199/526 [00:38<00:40,  7.98it/s, est. speed input: 5147.84 toks/s, output: 813.54 toks/s]
Processed prompts:  39%|███▊      | 203/526 [00:38<00:35,  9.06it/s, est. speed input: 5190.81 toks/s, output: 825.81 toks/s]
Processed prompts:  39%|███▉      | 207/526 [00:38<00:34,  9.32it/s, est. speed input: 5235.00 toks/s, output: 837.15 toks/s]
Processed prompts:  40%|████      | 211/526 [00:39<00:34,  9.01it/s, est. speed input: 5282.49 toks/s, output: 847.09 toks/s]
Processed prompts:  40%|████      | 212/526 [00:39<00:40,  7.82it/s, est. speed input: 5270.37 toks/s, output: 846.63 toks/s]
Processed prompts:  41%|████      | 214/526 [00:39<00:34,  8.94it/s, est. speed input: 5302.44 toks/s, output: 854.01 toks/s]
Processed prompts:  41%|████      | 215/526 [00:39<00:36,  8.42it/s, est. speed input: 5304.62 toks/s, output: 855.70 toks/s]
Processed prompts:  41%|████▏     | 218/526 [00:40<00:33,  9.12it/s, est. speed input: 5357.05 toks/s, output: 864.76 toks/s]
Processed prompts:  42%|████▏     | 221/526 [00:40<00:32,  9.51it/s, est. speed input: 5395.62 toks/s, output: 873.68 toks/s]
Processed prompts:  42%|████▏     | 222/526 [00:40<00:34,  8.85it/s, est. speed input: 5408.83 toks/s, output: 875.34 toks/s]
Processed prompts:  43%|████▎     | 226/526 [00:41<00:36,  8.29it/s, est. speed input: 5471.23 toks/s, output: 884.49 toks/s]
Processed prompts:  44%|████▎     | 229/526 [00:41<00:30,  9.76it/s, est. speed input: 5511.19 toks/s, output: 895.54 toks/s]
Processed prompts:  44%|████▍     | 231/526 [00:41<00:40,  7.21it/s, est. speed input: 5500.98 toks/s, output: 894.89 toks/s]
Processed prompts:  44%|████▍     | 232/526 [00:42<00:39,  7.43it/s, est. speed input: 5518.23 toks/s, output: 897.75 toks/s]
Processed prompts:  44%|████▍     | 233/526 [00:42<00:42,  6.97it/s, est. speed input: 5515.23 toks/s, output: 898.97 toks/s]
Processed prompts:  45%|████▍     | 235/526 [00:42<00:52,  5.55it/s, est. speed input: 5495.78 toks/s, output: 898.64 toks/s]
Processed prompts:  45%|████▍     | 236/526 [00:42<00:51,  5.64it/s, est. speed input: 5526.92 toks/s, output: 900.52 toks/s]
Processed prompts:  45%|████▌     | 238/526 [00:43<00:49,  5.84it/s, est. speed input: 5556.85 toks/s, output: 904.50 toks/s]
Processed prompts:  46%|████▌     | 240/526 [00:43<00:49,  5.73it/s, est. speed input: 5580.37 toks/s, output: 907.75 toks/s]
Processed prompts:  46%|████▌     | 241/526 [00:44<01:40,  2.85it/s, est. speed input: 5463.76 toks/s, output: 891.28 toks/s]
Processed prompts:  46%|████▌     | 243/526 [00:44<01:21,  3.47it/s, est. speed input: 5468.79 toks/s, output: 892.55 toks/s]
Processed prompts:  47%|████▋     | 245/526 [00:45<01:04,  4.33it/s, est. speed input: 5467.41 toks/s, output: 893.22 toks/s]
Processed prompts:  47%|████▋     | 247/526 [00:45<00:57,  4.86it/s, est. speed input: 5470.11 toks/s, output: 895.81 toks/s]
Processed prompts:  47%|████▋     | 248/526 [00:45<00:56,  4.95it/s, est. speed input: 5467.06 toks/s, output: 895.11 toks/s]
Processed prompts:  47%|████▋     | 249/526 [00:46<01:06,  4.19it/s, est. speed input: 5451.58 toks/s, output: 891.16 toks/s]
Processed prompts:  48%|████▊     | 252/526 [00:46<00:54,  5.01it/s, est. speed input: 5450.16 toks/s, output: 891.72 toks/s]
Processed prompts:  48%|████▊     | 254/526 [00:46<00:44,  6.08it/s, est. speed input: 5483.01 toks/s, output: 893.54 toks/s]
Processed prompts:  48%|████▊     | 255/526 [00:46<00:47,  5.72it/s, est. speed input: 5481.77 toks/s, output: 893.13 toks/s]
Processed prompts:  49%|████▉     | 257/526 [00:47<00:35,  7.54it/s, est. speed input: 5501.92 toks/s, output: 896.87 toks/s]
Processed prompts:  49%|████▉     | 259/526 [00:47<00:38,  6.93it/s, est. speed input: 5498.10 toks/s, output: 895.88 toks/s]
Processed prompts:  49%|████▉     | 260/526 [00:47<00:42,  6.30it/s, est. speed input: 5495.40 toks/s, output: 894.88 toks/s]
Processed prompts:  50%|█████     | 264/526 [00:47<00:31,  8.27it/s, est. speed input: 5516.22 toks/s, output: 899.51 toks/s]
Processed prompts:  50%|█████     | 265/526 [00:48<00:33,  7.72it/s, est. speed input: 5516.00 toks/s, output: 899.48 toks/s]
Processed prompts:  51%|█████     | 267/526 [00:48<00:30,  8.59it/s, est. speed input: 5539.76 toks/s, output: 905.08 toks/s]
Processed prompts:  51%|█████     | 268/526 [00:48<00:52,  4.95it/s, est. speed input: 5487.40 toks/s, output: 896.72 toks/s]
Processed prompts:  51%|█████     | 269/526 [00:49<00:52,  4.94it/s, est. speed input: 5479.70 toks/s, output: 896.10 toks/s]
Processed prompts:  52%|█████▏    | 274/526 [00:49<00:24, 10.31it/s, est. speed input: 5648.42 toks/s, output: 907.62 toks/s]
Processed prompts:  52%|█████▏    | 276/526 [00:49<00:23, 10.70it/s, est. speed input: 5674.47 toks/s, output: 910.24 toks/s]
Processed prompts:  53%|█████▎    | 279/526 [00:49<00:19, 12.55it/s, est. speed input: 5705.51 toks/s, output: 915.88 toks/s]
Processed prompts:  54%|█████▍    | 286/526 [00:49<00:10, 22.23it/s, est. speed input: 5824.94 toks/s, output: 934.64 toks/s]
Processed prompts:  55%|█████▌    | 290/526 [00:49<00:10, 23.02it/s, est. speed input: 5889.39 toks/s, output: 943.18 toks/s]
Processed prompts:  56%|█████▌    | 294/526 [00:49<00:08, 26.12it/s, est. speed input: 5975.69 toks/s, output: 953.70 toks/s]
Processed prompts:  57%|█████▋    | 298/526 [00:50<00:07, 28.87it/s, est. speed input: 6047.84 toks/s, output: 967.26 toks/s]
Processed prompts:  58%|█████▊    | 305/526 [00:50<00:05, 38.34it/s, est. speed input: 6154.56 toks/s, output: 986.34 toks/s]
Processed prompts:  60%|█████▉    | 315/526 [00:50<00:04, 48.11it/s, est. speed input: 6389.98 toks/s, output: 1014.35 toks/s]
Processed prompts:  61%|██████    | 322/526 [00:50<00:04, 48.43it/s, est. speed input: 6507.79 toks/s, output: 1036.78 toks/s]
Processed prompts:  62%|██████▏   | 328/526 [00:50<00:04, 46.72it/s, est. speed input: 6622.14 toks/s, output: 1052.97 toks/s]
Processed prompts:  64%|██████▍   | 336/526 [00:50<00:03, 50.19it/s, est. speed input: 6773.23 toks/s, output: 1077.78 toks/s]
Processed prompts:  66%|██████▌   | 346/526 [00:50<00:03, 57.57it/s, est. speed input: 6968.96 toks/s, output: 1105.41 toks/s]
Processed prompts:  68%|██████▊   | 356/526 [00:50<00:02, 63.49it/s, est. speed input: 7157.95 toks/s, output: 1137.32 toks/s]
Processed prompts:  69%|██████▉   | 363/526 [00:51<00:02, 61.35it/s, est. speed input: 7267.31 toks/s, output: 1163.46 toks/s]
Processed prompts:  70%|███████   | 370/526 [00:51<00:03, 50.46it/s, est. speed input: 7403.39 toks/s, output: 1180.73 toks/s]
Processed prompts:  72%|███████▏  | 380/526 [00:51<00:02, 58.72it/s, est. speed input: 7588.44 toks/s, output: 1210.15 toks/s]
Processed prompts:  74%|███████▍  | 389/526 [00:51<00:02, 63.68it/s, est. speed input: 7819.18 toks/s, output: 1240.99 toks/s]
Processed prompts:  75%|███████▌  | 396/526 [00:51<00:02, 63.52it/s, est. speed input: 7950.45 toks/s, output: 1262.58 toks/s]
Processed prompts:  77%|███████▋  | 403/526 [00:51<00:02, 58.83it/s, est. speed input: 8069.11 toks/s, output: 1281.29 toks/s]
Processed prompts:  79%|███████▉  | 415/526 [00:51<00:01, 69.08it/s, est. speed input: 8318.37 toks/s, output: 1319.35 toks/s]
Processed prompts:  80%|████████  | 423/526 [00:52<00:01, 59.27it/s, est. speed input: 8466.36 toks/s, output: 1343.63 toks/s]
Processed prompts:  82%|████████▏ | 430/526 [00:52<00:02, 45.16it/s, est. speed input: 8581.16 toks/s, output: 1361.01 toks/s]
Processed prompts:  83%|████████▎ | 437/526 [00:52<00:01, 46.40it/s, est. speed input: 8737.45 toks/s, output: 1387.73 toks/s]
Processed prompts:  84%|████████▍ | 444/526 [00:52<00:01, 50.32it/s, est. speed input: 8885.30 toks/s, output: 1410.00 toks/s]
Processed prompts:  86%|████████▌ | 450/526 [00:52<00:01, 49.04it/s, est. speed input: 8976.27 toks/s, output: 1426.67 toks/s]
Processed prompts:  87%|████████▋ | 456/526 [00:52<00:01, 45.94it/s, est. speed input: 9111.18 toks/s, output: 1443.89 toks/s]
Processed prompts:  88%|████████▊ | 461/526 [00:53<00:01, 40.26it/s, est. speed input: 9206.97 toks/s, output: 1455.73 toks/s]
Processed prompts:  89%|████████▊ | 466/526 [00:53<00:01, 37.16it/s, est. speed input: 9297.15 toks/s, output: 1475.64 toks/s]
Processed prompts:  89%|████████▉ | 470/526 [00:53<00:02, 27.57it/s, est. speed input: 9357.19 toks/s, output: 1487.54 toks/s]
Processed prompts:  90%|█████████ | 475/526 [00:53<00:01, 29.95it/s, est. speed input: 9470.50 toks/s, output: 1506.23 toks/s]
Processed prompts:  91%|█████████▏| 480/526 [00:53<00:01, 30.73it/s, est. speed input: 9534.39 toks/s, output: 1515.69 toks/s]
Processed prompts:  92%|█████████▏| 485/526 [00:53<00:01, 31.97it/s, est. speed input: 9620.07 toks/s, output: 1530.92 toks/s]
Processed prompts:  93%|█████████▎| 489/526 [00:54<00:01, 32.35it/s, est. speed input: 9683.06 toks/s, output: 1541.51 toks/s]
Processed prompts:  94%|█████████▎| 493/526 [00:54<00:01, 24.73it/s, est. speed input: 9750.26 toks/s, output: 1548.82 toks/s]
Processed prompts:  94%|█████████▍| 497/526 [00:54<00:01, 25.62it/s, est. speed input: 9803.91 toks/s, output: 1559.54 toks/s]
Processed prompts:  95%|█████████▌| 500/526 [00:54<00:01, 23.98it/s, est. speed input: 9843.90 toks/s, output: 1564.86 toks/s]
Processed prompts:  96%|█████████▌| 503/526 [00:54<00:01, 20.37it/s, est. speed input: 9890.38 toks/s, output: 1575.39 toks/s]
Processed prompts:  97%|█████████▋| 508/526 [00:54<00:00, 24.79it/s, est. speed input: 9998.32 toks/s, output: 1596.87 toks/s]
Processed prompts:  97%|█████████▋| 512/526 [00:55<00:00, 26.70it/s, est. speed input: 10101.23 toks/s, output: 1613.93 toks/s]
Processed prompts:  98%|█████████▊| 515/526 [00:55<00:00, 12.45it/s, est. speed input: 10050.63 toks/s, output: 1612.69 toks/s]
Processed prompts:  98%|█████████▊| 518/526 [00:56<00:00, 10.12it/s, est. speed input: 10052.51 toks/s, output: 1618.26 toks/s]
Processed prompts:  99%|█████████▉| 520/526 [00:56<00:00,  8.99it/s, est. speed input: 10068.13 toks/s, output: 1622.85 toks/s]
Processed prompts:  99%|█████████▉| 522/526 [00:56<00:00,  8.05it/s, est. speed input: 10048.25 toks/s, output: 1626.93 toks/s]
Processed prompts: 100%|█████████▉| 524/526 [00:57<00:00,  6.46it/s, est. speed input: 10007.01 toks/s, output: 1629.25 toks/s]
Processed prompts: 100%|█████████▉| 525/526 [00:58<00:00,  3.25it/s, est. speed input: 9818.85 toks/s, output: 1603.74 toks/s] 
Processed prompts: 100%|██████████| 526/526 [00:58<00:00,  8.97it/s, est. speed input: 9841.50 toks/s, output: 1610.06 toks/s]
{  "personalized_answer": "It sounds like you're in a challenging situation where a coworker, let's call them 'Tarnisher,' is affecting your professional standing. Given your past experiences with a problematic manager, it's understandable that you're concerned about how to address this without jeopardizing your own career. Here are a few steps you can consider:\n\n1. **Document Specific Incidents:** Keep a record of any instances where Tarnisher has tarnished your reputation. Note the dates, details, and any witnesses. This documentation can be crucial if you decide to escalate the issue.\n\n2. **Seek Support from Trusted Colleagues:** Before taking any formal action, discuss the situation with trusted colleagues who might have noticed similar behavior. They can provide additional insights and support.\n\n3. **Address the Issue Directly:** If you feel comfortable, you could have a private conversation with Tarnisher to express your concerns. Be specific about the behavior that you find problematic and how it affects your work. Use "I" statements to avoid sounding accusatory, such as 'I feel that my reputation is being tarnished when...' This approach can sometimes lead to a resolution or at least a better understanding of each other's perspectives.\n\n4. **Escalate to HR:** If the behavior continues or the direct approach doesn't yield results, consider reporting the issue to HR. You can do this anonymously if you're concerned about retaliation. When you do, be prepared to provide specific examples and any documentation you have collected. HR can then investigate and take appropriate action.\n\n5. **Consider a Mentor or Sponsor:** Having a mentor or sponsor who understands your career goals can be invaluable. They can offer guidance and support, and might be able to help mediate or provide a different perspective on the situation.\n\nRemember, it's important to handle these situations with care to protect your professional relationships and career. Good luck!"}
Invalid JSON
{  "personalized_answer": "It sounds like you're dealing with a challenging situation where some of your teammates are not only unappreciative but also actively trying to undermine your efforts. Here are some steps you can take to address this issue:\n\n1. **Document Specific Incidents:** Keep a record of specific instances where teammates have tried to hold you back or brought you down. This will help you present a clear and factual case when you need to discuss the issue.\n\n2. **Communicate Your Feelings:** Schedule a private meeting with the individuals involved to discuss your feelings. Use "I" statements to express how their actions make you feel, such as 'I feel unsupported when...'. Avoid blaming or accusing language to keep the conversation constructive.\n\n3. **Seek Support from Management:** If the behavior continues, consider speaking to your manager or HR about the situation. Provide them with the documented incidents and express your concerns. They can help mediate the situation and ensure that everyone is working towards a positive and supportive team environment.\n\n4. **Set Clear Boundaries:** Clearly communicate your boundaries and expectations. Let them know that you are willing to help, but you need to be recognized for your efforts and that you cannot continue to go the extra mile without support.\n\n5. **Focus on Positive Interactions:** Try to build positive relationships with other teammates who support your efforts. This can help create a more collaborative and supportive team dynamic.\n\n6. **Consider a Team Meeting:** If the issue is widespread, you might suggest a team meeting to discuss the importance of mutual support and recognition. This can help shift the team culture towards a more positive and collaborative environment.\n\nRemember, it's important to handle these situations with professionalism and patience. Your hard work and dedication deserve recognition and support from your team."}
Invalid JSON
None

Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  50%|█████     | 1/2 [00:02<00:02,  2.58s/it, est. speed input: 829.21 toks/s, output: 73.94 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:04<00:00,  2.34s/it, est. speed input: 872.13 toks/s, output: 118.91 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:04<00:00,  2.38s/it, est. speed input: 872.13 toks/s, output: 118.91 toks/s]
{  "personalized_answer": "It sounds like you're dealing with a challenging situation where some of your teammates are not only unappreciative but also actively trying to undermine your efforts. Here are some steps you can take to address this issue while maintaining a professional and positive environment:\n\n1. **Document Specific Incidents:** Keep a record of specific instances where your teammates have held you back or brought you down. This will help you present a clear and factual case when you need to discuss the issue.\n\n2. **Schedule a Private Meeting:** Arrange a private meeting with the individuals involved to discuss your concerns. Approach the conversation with a focus on understanding their perspective and expressing your own feelings. Use "I" statements to avoid sounding accusatory, such as 'I feel that my contributions are not being recognized, and I believe this is affecting our team dynamics.'\n\n3. **Highlight Your Contributions:** Prepare examples of times when you've gone above and beyond your responsibilities. Share these examples to demonstrate your value to the team and the positive impact you've had.\n\n4. **Seek Support from Management:** If the issue persists, consider discussing the situation with your manager. Provide them with the documented evidence and express your concerns. They can help mediate the situation and ensure that your contributions are acknowledged.\n\n5. **Focus on Team Building:** Encourage team-building activities that foster a supportive and collaborative environment. This can help shift the team culture and make it more inclusive.\n\n6. **Set Clear Expectations:** Work with your team to establish clear expectations and roles. This can help prevent misunderstandings and ensure that everyone is on the same page.\n\nBy taking these steps, you can address the issue in a constructive manner and work towards a more positive and supportive team environment."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.77s/it, est. speed input: 419.88 toks/s, output: 82.42 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.77s/it, est. speed input: 419.88 toks/s, output: 82.42 toks/s]
{  "personalized_answer": "It sounds like you're dealing with a challenging situation where some of your teammates might be intentionally trying to undermine your efforts and progress. Given your past experiences, it's clear that you value professionalism and respect in the workplace. Here are a few steps you can take to address this issue:\n\n1. **Document Specific Incidents:** Keep a record of instances where teammates have tried to hold you back or bring you down. This documentation can be crucial for any formal discussions or reports you might need to make.\n\n2. **Communicate Clearly and Professionally:** Schedule a one-on-one meeting with the individuals involved to discuss your concerns. Be specific about the behaviors that are causing you distress and explain how these behaviors affect your work and morale. Use "I" statements to express your feelings, such as 'I feel [emotion] when [specific behavior] happens.'\n\n3. **Seek Support from Management:** If the behavior continues, consider speaking to your manager or HR about the situation. Provide them with the documented evidence and express your concerns. They can provide guidance and potentially mediate the situation.\n\n4. **Set Boundaries:** Clearly communicate your boundaries and expectations. Let them know that you are committed to your work and that you expect the same level of professionalism and respect from everyone in the team.\n\n5. **Focus on Your Goals:** Continue to focus on your goals and the positive impact you are making. Surround yourself with supportive colleagues and seek out mentors or allies who can provide encouragement and guidance.\n\n6. **Consider a Mentor:** Finding a mentor within the company who can provide guidance and support can be very beneficial. They can offer advice and help you navigate these challenging situations.\n\nRemember, it's important to maintain your professionalism and integrity throughout this process. Your dedication and hard work deserve to be recognized and respected by your teammates."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.76s/it, est. speed input: 420.43 toks/s, output: 82.53 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.76s/it, est. speed input: 420.43 toks/s, output: 82.53 toks/s]
[rank0]:[W709 15:51:38.100248119 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/lp_rag_full_profile_test_4_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:51:42.577833_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:51:42.577833_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:51:42.577833_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<03:07,  2.26it/s]
  0%|          | 2/424 [00:01<05:04,  1.39it/s]
  1%|          | 3/424 [00:01<03:04,  2.28it/s]
  1%|          | 4/424 [00:03<06:32,  1.07it/s]
  1%|          | 5/424 [00:03<04:50,  1.44it/s]
  2%|▏         | 7/424 [00:04<04:07,  1.69it/s]
  2%|▏         | 8/424 [00:05<04:10,  1.66it/s]
  2%|▏         | 9/424 [00:05<03:14,  2.13it/s]
  2%|▏         | 10/424 [00:05<02:51,  2.41it/s]
  3%|▎         | 11/424 [00:05<02:19,  2.96it/s]
  3%|▎         | 12/424 [00:05<02:15,  3.05it/s]
  3%|▎         | 13/424 [00:07<05:11,  1.32it/s]
  3%|▎         | 14/424 [00:07<03:59,  1.71it/s]
  4%|▎         | 15/424 [00:08<03:14,  2.10it/s]
  4%|▍         | 16/424 [00:08<03:26,  1.97it/s]
  4%|▍         | 17/424 [00:08<02:57,  2.29it/s]
  4%|▍         | 18/424 [00:09<02:33,  2.65it/s]
  4%|▍         | 19/424 [00:09<03:00,  2.25it/s]
  5%|▍         | 20/424 [00:09<02:26,  2.75it/s]
  5%|▍         | 21/424 [00:10<01:59,  3.38it/s]
  5%|▌         | 22/424 [00:10<02:40,  2.50it/s]
  5%|▌         | 23/424 [00:12<04:48,  1.39it/s]
  6%|▌         | 24/424 [00:12<04:35,  1.45it/s]
  6%|▌         | 25/424 [00:13<05:03,  1.31it/s]
  6%|▌         | 26/424 [00:14<04:45,  1.39it/s]
  6%|▋         | 27/424 [00:16<06:40,  1.01s/it]
  7%|▋         | 28/424 [00:16<05:52,  1.12it/s]
  7%|▋         | 29/424 [00:16<04:37,  1.42it/s]
  7%|▋         | 30/424 [00:17<03:35,  1.83it/s]
  7%|▋         | 31/424 [00:17<03:42,  1.77it/s]
  8%|▊         | 33/424 [00:17<02:11,  2.97it/s]
  8%|▊         | 34/424 [00:18<02:03,  3.15it/s]
  8%|▊         | 36/424 [00:18<01:22,  4.68it/s]
  9%|▊         | 37/424 [00:18<02:10,  2.98it/s]
  9%|▉         | 38/424 [00:19<02:03,  3.12it/s]
  9%|▉         | 40/424 [00:19<01:33,  4.12it/s]
 10%|▉         | 41/424 [00:19<01:33,  4.10it/s]
 10%|▉         | 42/424 [00:20<02:08,  2.97it/s]
 10%|█         | 43/424 [00:20<01:48,  3.50it/s]
 10%|█         | 44/424 [00:22<04:08,  1.53it/s]
 11%|█         | 45/424 [00:22<04:02,  1.56it/s]
 11%|█         | 46/424 [00:23<03:21,  1.87it/s]
 11%|█         | 47/424 [00:23<03:29,  1.80it/s]
 11%|█▏        | 48/424 [00:24<03:36,  1.73it/s]
 12%|█▏        | 49/424 [00:24<03:39,  1.71it/s]
 12%|█▏        | 51/424 [00:25<02:53,  2.14it/s]
 12%|█▏        | 52/424 [00:26<02:53,  2.14it/s]
 12%|█▎        | 53/424 [00:26<03:05,  2.00it/s]
 13%|█▎        | 54/424 [00:27<03:44,  1.65it/s]
 13%|█▎        | 55/424 [00:27<03:08,  1.95it/s]
 13%|█▎        | 56/424 [00:28<03:18,  1.85it/s]
 14%|█▎        | 58/424 [00:28<01:59,  3.07it/s]
 14%|█▍        | 59/424 [00:30<03:57,  1.53it/s]
 15%|█▍        | 62/424 [00:33<05:15,  1.15it/s]
 15%|█▍        | 63/424 [00:34<04:56,  1.22it/s]
 15%|█▌        | 64/424 [00:34<04:12,  1.42it/s]
 15%|█▌        | 65/424 [00:34<03:20,  1.79it/s]
 16%|█▌        | 66/424 [00:36<05:00,  1.19it/s]
 16%|█▌        | 67/424 [00:36<03:59,  1.49it/s]
 16%|█▌        | 68/424 [00:36<03:48,  1.56it/s]
 16%|█▋        | 69/424 [00:38<05:26,  1.09it/s]
 17%|█▋        | 70/424 [00:38<04:26,  1.33it/s]
 17%|█▋        | 71/424 [00:39<03:44,  1.58it/s]
 17%|█▋        | 72/424 [00:39<03:13,  1.82it/s]
 17%|█▋        | 73/424 [00:39<02:51,  2.05it/s]
 17%|█▋        | 74/424 [00:40<02:34,  2.26it/s]
 18%|█▊        | 75/424 [00:42<05:18,  1.10it/s]
 18%|█▊        | 77/424 [00:42<03:22,  1.72it/s]
 18%|█▊        | 78/424 [00:42<02:43,  2.12it/s]
 19%|█▉        | 80/424 [00:42<01:49,  3.15it/s]
 19%|█▉        | 81/424 [00:43<02:28,  2.31it/s]
 19%|█▉        | 82/424 [00:44<02:58,  1.92it/s]
 20%|█▉        | 83/424 [00:45<03:37,  1.57it/s]
 20%|█▉        | 84/424 [00:45<02:47,  2.03it/s]
 20%|██        | 85/424 [00:46<03:34,  1.58it/s]
 20%|██        | 86/424 [00:47<03:54,  1.44it/s]
 21%|██        | 87/424 [00:48<04:21,  1.29it/s]
 21%|██        | 88/424 [00:48<03:39,  1.53it/s]
 21%|██        | 89/424 [00:49<04:10,  1.34it/s]
 21%|██        | 90/424 [00:49<03:14,  1.72it/s]
 21%|██▏       | 91/424 [00:50<03:55,  1.41it/s]
 22%|██▏       | 92/424 [00:51<04:21,  1.27it/s]
 22%|██▏       | 93/424 [00:52<04:03,  1.36it/s]
 22%|██▏       | 94/424 [00:53<04:24,  1.25it/s]
 22%|██▏       | 95/424 [00:53<03:17,  1.67it/s]
 23%|██▎       | 96/424 [00:53<02:50,  1.92it/s]
 23%|██▎       | 98/424 [00:54<01:44,  3.12it/s]
 23%|██▎       | 99/424 [00:54<01:30,  3.57it/s]
 24%|██▎       | 100/424 [00:54<01:54,  2.82it/s]
 24%|██▍       | 101/424 [00:56<03:20,  1.61it/s]
 24%|██▍       | 102/424 [00:56<02:50,  1.89it/s]
 24%|██▍       | 103/424 [00:56<02:22,  2.26it/s]
 25%|██▍       | 104/424 [00:56<01:56,  2.74it/s]
 25%|██▍       | 105/424 [00:57<02:23,  2.22it/s]
 25%|██▌       | 106/424 [00:57<01:51,  2.85it/s]
 25%|██▌       | 107/424 [00:58<02:18,  2.28it/s]
 26%|██▌       | 109/424 [01:01<05:23,  1.03s/it]
 26%|██▌       | 110/424 [01:03<06:11,  1.18s/it]
 26%|██▌       | 111/424 [01:03<05:16,  1.01s/it]
 26%|██▋       | 112/424 [01:04<04:00,  1.30it/s]
 27%|██▋       | 114/424 [01:04<02:23,  2.17it/s]
 27%|██▋       | 116/424 [01:04<01:39,  3.08it/s]
 28%|██▊       | 118/424 [01:04<01:18,  3.88it/s]
 28%|██▊       | 119/424 [01:04<01:14,  4.10it/s]
 29%|██▊       | 121/424 [01:05<01:01,  4.96it/s]
 29%|██▉       | 122/424 [01:11<07:45,  1.54s/it]
 29%|██▉       | 123/424 [01:18<13:46,  2.74s/it]
 29%|██▉       | 124/424 [01:25<18:45,  3.75s/it]
 29%|██▉       | 125/424 [01:32<22:35,  4.53s/it]
 30%|██▉       | 126/424 [01:39<25:40,  5.17s/it]
 30%|██▉       | 127/424 [01:45<27:55,  5.64s/it]
 30%|███       | 128/424 [01:46<21:15,  4.31s/it]
 30%|███       | 129/424 [01:47<16:20,  3.32s/it]
 31%|███       | 130/424 [01:48<12:49,  2.62s/it]
 31%|███       | 131/424 [01:49<10:23,  2.13s/it]
 31%|███       | 132/424 [01:50<07:57,  1.64s/it]
 31%|███▏      | 133/424 [01:50<06:31,  1.35s/it]
 32%|███▏      | 134/424 [01:50<04:43,  1.02it/s]
 32%|███▏      | 135/424 [01:51<03:33,  1.35it/s]
 32%|███▏      | 136/424 [01:51<02:44,  1.75it/s]
 32%|███▏      | 137/424 [01:51<02:11,  2.19it/s]
 33%|███▎      | 138/424 [01:51<01:46,  2.69it/s]
 33%|███▎      | 139/424 [01:51<01:29,  3.19it/s]
 33%|███▎      | 140/424 [01:51<01:12,  3.94it/s]
 33%|███▎      | 141/424 [01:52<01:04,  4.36it/s]
 33%|███▎      | 142/424 [01:52<01:01,  4.61it/s]
 34%|███▎      | 143/424 [01:52<00:58,  4.84it/s]
 34%|███▍      | 144/424 [01:52<00:56,  4.99it/s]
 34%|███▍      | 145/424 [01:52<00:53,  5.25it/s]
 34%|███▍      | 146/424 [01:52<00:51,  5.39it/s]
 35%|███▍      | 147/424 [01:53<00:50,  5.45it/s]
 35%|███▍      | 148/424 [01:53<00:50,  5.47it/s]
 35%|███▌      | 149/424 [01:53<00:50,  5.49it/s]
 35%|███▌      | 150/424 [01:53<00:50,  5.46it/s]
 36%|███▌      | 151/424 [01:53<00:50,  5.42it/s]
 36%|███▌      | 152/424 [01:54<00:49,  5.48it/s]
 36%|███▌      | 153/424 [01:54<00:49,  5.48it/s]
 36%|███▋      | 154/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 155/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 156/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 157/424 [01:54<00:48,  5.51it/s]
 37%|███▋      | 158/424 [01:55<00:48,  5.49it/s]
 38%|███▊      | 159/424 [01:55<00:48,  5.48it/s]
 38%|███▊      | 160/424 [01:57<02:58,  1.48it/s]
 38%|███▊      | 161/424 [01:57<02:18,  1.90it/s]
 38%|███▊      | 162/424 [01:57<01:51,  2.35it/s]
 38%|███▊      | 163/424 [01:57<01:31,  2.86it/s]
 39%|███▊      | 164/424 [01:57<01:18,  3.31it/s]
 39%|███▉      | 165/424 [01:58<01:08,  3.78it/s]
 39%|███▉      | 166/424 [01:58<00:56,  4.53it/s]
 39%|███▉      | 167/424 [01:58<00:54,  4.74it/s]
 40%|███▉      | 168/424 [01:58<01:01,  4.16it/s]
 40%|███▉      | 169/424 [01:59<01:08,  3.70it/s]
 40%|████      | 170/424 [01:59<01:11,  3.53it/s]
 40%|████      | 171/424 [01:59<01:22,  3.05it/s]
 41%|████      | 172/424 [01:59<01:07,  3.75it/s]
 41%|████      | 174/424 [02:00<01:28,  2.84it/s]
 41%|████▏     | 175/424 [02:00<01:12,  3.42it/s]
 42%|████▏     | 176/424 [02:01<01:03,  3.90it/s]
 42%|████▏     | 177/424 [02:01<00:56,  4.36it/s]
 42%|████▏     | 178/424 [02:01<01:01,  4.03it/s]
 42%|████▏     | 179/424 [02:01<00:59,  4.10it/s]
 42%|████▏     | 180/424 [02:02<01:09,  3.50it/s]
 43%|████▎     | 181/424 [02:02<00:59,  4.08it/s]
 43%|████▎     | 182/424 [02:02<00:57,  4.23it/s]
 43%|████▎     | 183/424 [02:02<00:56,  4.30it/s]
 43%|████▎     | 184/424 [02:03<01:17,  3.10it/s]
 44%|████▎     | 185/424 [02:03<01:38,  2.43it/s]
 44%|████▍     | 186/424 [02:04<01:42,  2.32it/s]
 44%|████▍     | 187/424 [02:04<01:36,  2.46it/s]
 44%|████▍     | 188/424 [02:05<01:34,  2.49it/s]
 45%|████▍     | 189/424 [02:06<02:58,  1.32it/s]
 45%|████▍     | 190/424 [02:10<06:53,  1.77s/it]
 45%|████▌     | 191/424 [02:11<05:14,  1.35s/it]
 45%|████▌     | 192/424 [02:12<05:34,  1.44s/it]
 46%|████▌     | 194/424 [02:13<03:23,  1.13it/s]
 46%|████▌     | 196/424 [02:13<02:29,  1.53it/s]
 46%|████▋     | 197/424 [02:14<02:09,  1.76it/s]
 47%|████▋     | 198/424 [02:14<01:48,  2.08it/s]
 47%|████▋     | 199/424 [02:15<02:04,  1.81it/s]
 47%|████▋     | 200/424 [02:15<01:42,  2.19it/s]
 47%|████▋     | 201/424 [02:16<02:53,  1.28it/s]
 48%|████▊     | 202/424 [02:17<02:15,  1.64it/s]
 48%|████▊     | 203/424 [02:18<03:22,  1.09it/s]
 48%|████▊     | 204/424 [02:21<05:44,  1.56s/it]
 48%|████▊     | 205/424 [02:22<04:36,  1.26s/it]
 49%|████▊     | 206/424 [02:25<06:30,  1.79s/it]
 49%|████▉     | 207/424 [02:25<04:51,  1.34s/it]
 49%|████▉     | 208/424 [02:26<03:43,  1.04s/it]
 49%|████▉     | 209/424 [02:26<02:48,  1.28it/s]
 50%|████▉     | 210/424 [02:26<02:16,  1.57it/s]
 50%|█████     | 212/424 [02:26<01:21,  2.62it/s]
 50%|█████     | 213/424 [02:27<01:28,  2.39it/s]
 50%|█████     | 214/424 [02:27<01:35,  2.20it/s]
 51%|█████     | 215/424 [02:28<01:56,  1.80it/s]
 51%|█████     | 216/424 [02:28<01:32,  2.24it/s]
 51%|█████     | 217/424 [02:29<01:18,  2.65it/s]
 51%|█████▏    | 218/424 [02:29<01:11,  2.86it/s]
 52%|█████▏    | 219/424 [02:29<01:06,  3.08it/s]
 52%|█████▏    | 220/424 [02:30<01:37,  2.10it/s]
 52%|█████▏    | 221/424 [02:30<01:26,  2.34it/s]
 52%|█████▏    | 222/424 [02:31<01:19,  2.56it/s]
 53%|█████▎    | 223/424 [02:31<01:11,  2.81it/s]
 53%|█████▎    | 224/424 [02:31<01:08,  2.93it/s]
 53%|█████▎    | 225/424 [02:33<02:21,  1.41it/s]
 54%|█████▎    | 227/424 [02:33<01:31,  2.15it/s]
 54%|█████▍    | 229/424 [02:33<01:02,  3.12it/s]
 54%|█████▍    | 230/424 [02:37<03:05,  1.05it/s]
 54%|█████▍    | 231/424 [02:37<02:44,  1.17it/s]
 55%|█████▍    | 232/424 [02:37<02:06,  1.51it/s]
 55%|█████▍    | 233/424 [02:39<02:57,  1.08it/s]
 55%|█████▌    | 234/424 [02:46<08:12,  2.59s/it]
 55%|█████▌    | 235/424 [02:47<06:35,  2.09s/it]
 56%|█████▌    | 236/424 [02:47<04:59,  1.59s/it]
 56%|█████▌    | 238/424 [02:47<02:48,  1.10it/s]
 57%|█████▋    | 240/424 [02:49<02:44,  1.12it/s]
 57%|█████▋    | 241/424 [02:50<02:40,  1.14it/s]
 57%|█████▋    | 242/424 [02:50<02:07,  1.43it/s]
 57%|█████▋    | 243/424 [02:50<01:52,  1.61it/s]
 58%|█████▊    | 244/424 [02:51<01:53,  1.58it/s]
 58%|█████▊    | 245/424 [02:51<01:27,  2.04it/s]
 58%|█████▊    | 246/424 [02:51<01:18,  2.27it/s]
 58%|█████▊    | 247/424 [02:53<02:19,  1.27it/s]
 58%|█████▊    | 248/424 [02:53<01:44,  1.69it/s]
 59%|█████▊    | 249/424 [02:53<01:18,  2.22it/s]
 59%|█████▉    | 250/424 [02:54<01:29,  1.95it/s]
 59%|█████▉    | 251/424 [02:54<01:11,  2.43it/s]
 59%|█████▉    | 252/424 [02:54<00:55,  3.11it/s]
 60%|█████▉    | 253/424 [02:54<00:44,  3.85it/s]
 60%|█████▉    | 254/424 [02:54<00:36,  4.64it/s]
 60%|██████    | 255/424 [02:54<00:30,  5.46it/s]
 60%|██████    | 256/424 [02:55<00:27,  6.16it/s]
 61%|██████    | 257/424 [02:55<00:24,  6.81it/s]
 61%|██████    | 258/424 [02:55<00:22,  7.29it/s]
 61%|██████    | 259/424 [02:55<00:29,  5.52it/s]
 61%|██████▏   | 260/424 [02:56<01:08,  2.41it/s]
 62%|██████▏   | 261/424 [02:56<00:52,  3.11it/s]
 62%|██████▏   | 263/424 [02:57<01:06,  2.44it/s]
 62%|██████▏   | 264/424 [02:57<00:53,  2.97it/s]
 63%|██████▎   | 266/424 [02:58<00:46,  3.38it/s]
 63%|██████▎   | 267/424 [02:58<00:39,  3.94it/s]
 63%|██████▎   | 268/424 [02:58<00:34,  4.57it/s]
 63%|██████▎   | 269/424 [02:59<00:58,  2.66it/s]
 64%|██████▎   | 270/424 [02:59<00:46,  3.30it/s]
 64%|██████▍   | 272/424 [02:59<00:30,  4.92it/s]
 64%|██████▍   | 273/424 [02:59<00:30,  4.95it/s]
 65%|██████▍   | 275/424 [02:59<00:21,  6.95it/s]
 65%|██████▌   | 277/424 [02:59<00:17,  8.26it/s]
 66%|██████▌   | 279/424 [03:01<00:40,  3.60it/s]
 66%|██████▌   | 280/424 [03:01<00:43,  3.30it/s]
 66%|██████▋   | 281/424 [03:01<00:46,  3.09it/s]
 67%|██████▋   | 283/424 [03:05<01:55,  1.22it/s]
 67%|██████▋   | 284/424 [03:05<01:33,  1.49it/s]
 67%|██████▋   | 285/424 [03:05<01:14,  1.86it/s]
 68%|██████▊   | 287/424 [03:05<00:56,  2.44it/s]
 68%|██████▊   | 288/424 [03:06<00:53,  2.53it/s]
 68%|██████▊   | 289/424 [03:06<00:49,  2.72it/s]
 69%|██████▊   | 291/424 [03:06<00:36,  3.67it/s]
 69%|██████▉   | 292/424 [03:06<00:30,  4.27it/s]
 69%|██████▉   | 293/424 [03:10<02:05,  1.04it/s]
 70%|██████▉   | 295/424 [03:10<01:36,  1.34it/s]
 70%|██████▉   | 296/424 [03:11<01:17,  1.66it/s]
 70%|███████   | 297/424 [03:11<01:09,  1.82it/s]
 70%|███████   | 298/424 [03:11<00:58,  2.14it/s]
 71%|███████   | 299/424 [03:11<00:48,  2.57it/s]
 71%|███████   | 301/424 [03:12<00:35,  3.46it/s]
 71%|███████   | 302/424 [03:18<03:44,  1.84s/it]
 71%|███████▏  | 303/424 [03:19<02:58,  1.47s/it]
 72%|███████▏  | 304/424 [03:19<02:14,  1.12s/it]
 72%|███████▏  | 305/424 [03:19<01:48,  1.10it/s]
 72%|███████▏  | 306/424 [03:20<01:30,  1.30it/s]
 73%|███████▎  | 308/424 [03:20<00:58,  1.99it/s]
 73%|███████▎  | 309/424 [03:21<00:58,  1.95it/s]
 73%|███████▎  | 310/424 [03:22<01:12,  1.57it/s]
 74%|███████▎  | 312/424 [03:22<00:47,  2.38it/s]
 74%|███████▍  | 313/424 [03:22<00:41,  2.67it/s]
 74%|███████▍  | 314/424 [03:23<00:42,  2.61it/s]
 74%|███████▍  | 315/424 [03:24<01:07,  1.62it/s]
 75%|███████▍  | 316/424 [03:24<00:51,  2.09it/s]
 75%|███████▍  | 317/424 [03:25<01:17,  1.38it/s]
 75%|███████▌  | 318/424 [03:27<01:35,  1.12it/s]
 75%|███████▌  | 319/424 [03:27<01:16,  1.37it/s]
 75%|███████▌  | 320/424 [03:27<00:59,  1.74it/s]
 76%|███████▌  | 322/424 [03:27<00:35,  2.86it/s]
 76%|███████▌  | 323/424 [03:27<00:31,  3.22it/s]
 76%|███████▋  | 324/424 [03:28<00:27,  3.66it/s]
 77%|███████▋  | 325/424 [03:28<00:24,  4.05it/s]
 77%|███████▋  | 326/424 [03:35<03:23,  2.08s/it]
 77%|███████▋  | 327/424 [03:36<03:00,  1.86s/it]
 77%|███████▋  | 328/424 [03:37<02:29,  1.55s/it]
 78%|███████▊  | 329/424 [03:37<01:55,  1.22s/it]
 78%|███████▊  | 330/424 [03:39<01:57,  1.25s/it]
 78%|███████▊  | 331/424 [03:39<01:25,  1.09it/s]
 79%|███████▊  | 333/424 [03:40<01:16,  1.18it/s]
 79%|███████▉  | 334/424 [03:41<01:05,  1.36it/s]
 79%|███████▉  | 335/424 [03:41<01:02,  1.41it/s]
 79%|███████▉  | 336/424 [03:43<01:31,  1.04s/it]
 79%|███████▉  | 337/424 [03:50<03:51,  2.66s/it]
 80%|███████▉  | 338/424 [03:50<02:54,  2.03s/it]
 80%|███████▉  | 339/424 [03:51<02:25,  1.71s/it]
 80%|████████  | 340/424 [03:58<04:29,  3.21s/it]
 80%|████████  | 341/424 [04:00<03:48,  2.76s/it]
 81%|████████  | 342/424 [04:01<03:18,  2.42s/it]
 81%|████████  | 343/424 [04:02<02:21,  1.75s/it]
 81%|████████  | 344/424 [04:02<01:55,  1.44s/it]
 81%|████████▏ | 345/424 [04:02<01:22,  1.04s/it]
 82%|████████▏ | 346/424 [04:03<01:06,  1.17it/s]
 82%|████████▏ | 347/424 [04:04<01:02,  1.22it/s]
 83%|████████▎ | 350/424 [04:04<00:38,  1.90it/s]
 83%|████████▎ | 352/424 [04:11<01:49,  1.53s/it]
 83%|████████▎ | 353/424 [04:12<01:34,  1.33s/it]
 83%|████████▎ | 354/424 [04:13<01:27,  1.25s/it]
 84%|████████▎ | 355/424 [04:13<01:08,  1.01it/s]
 84%|████████▍ | 356/424 [04:15<01:18,  1.15s/it]
 84%|████████▍ | 357/424 [04:16<01:13,  1.09s/it]
 84%|████████▍ | 358/424 [04:17<01:11,  1.08s/it]
 85%|████████▍ | 359/424 [04:18<01:09,  1.06s/it]
 85%|████████▍ | 360/424 [04:18<00:52,  1.21it/s]
 85%|████████▌ | 361/424 [04:18<00:40,  1.55it/s]
 85%|████████▌ | 362/424 [04:18<00:34,  1.78it/s]
 86%|████████▌ | 363/424 [04:25<02:25,  2.38s/it]
 86%|████████▌ | 364/424 [04:25<01:47,  1.79s/it]
 86%|████████▌ | 365/424 [04:26<01:17,  1.32s/it]
 86%|████████▋ | 366/424 [04:26<00:55,  1.05it/s]
 87%|████████▋ | 367/424 [04:26<00:39,  1.43it/s]
 87%|████████▋ | 368/424 [04:33<02:22,  2.55s/it]
 87%|████████▋ | 369/424 [04:33<01:43,  1.89s/it]
 87%|████████▋ | 370/424 [04:33<01:13,  1.35s/it]
 88%|████████▊ | 372/424 [04:33<00:40,  1.29it/s]
 88%|████████▊ | 373/424 [04:34<00:32,  1.57it/s]
 88%|████████▊ | 374/424 [04:35<00:36,  1.38it/s]
 89%|████████▊ | 376/424 [04:35<00:27,  1.73it/s]
 89%|████████▉ | 377/424 [04:37<00:35,  1.34it/s]
 89%|████████▉ | 378/424 [04:37<00:27,  1.67it/s]
 89%|████████▉ | 379/424 [04:37<00:26,  1.70it/s]
 90%|████████▉ | 380/424 [04:39<00:37,  1.17it/s]
 90%|█████████ | 382/424 [04:40<00:33,  1.26it/s]
 91%|█████████ | 384/424 [04:41<00:21,  1.84it/s]
 91%|█████████ | 385/424 [04:41<00:18,  2.14it/s]
 91%|█████████▏| 387/424 [04:41<00:11,  3.22it/s]
 92%|█████████▏| 388/424 [04:42<00:13,  2.68it/s]
 92%|█████████▏| 389/424 [04:46<00:44,  1.28s/it]
 92%|█████████▏| 390/424 [04:46<00:34,  1.01s/it]
 92%|█████████▏| 391/424 [04:46<00:25,  1.28it/s]
 92%|█████████▏| 392/424 [04:46<00:19,  1.67it/s]
 93%|█████████▎| 393/424 [04:47<00:19,  1.59it/s]
 93%|█████████▎| 394/424 [04:48<00:19,  1.57it/s]
 93%|█████████▎| 395/424 [04:49<00:27,  1.07it/s]
 93%|█████████▎| 396/424 [04:50<00:26,  1.05it/s]
 94%|█████████▎| 397/424 [04:52<00:28,  1.05s/it]
 94%|█████████▍| 398/424 [04:53<00:29,  1.12s/it]
 94%|█████████▍| 399/424 [04:53<00:22,  1.11it/s]
 94%|█████████▍| 400/424 [04:54<00:19,  1.23it/s]
 95%|█████████▍| 401/424 [04:54<00:14,  1.56it/s]
 95%|█████████▍| 402/424 [04:57<00:30,  1.40s/it]
 95%|█████████▌| 403/424 [05:00<00:36,  1.75s/it]
 95%|█████████▌| 404/424 [05:00<00:25,  1.29s/it]
 96%|█████████▌| 405/424 [05:00<00:19,  1.02s/it]
 96%|█████████▌| 406/424 [05:01<00:13,  1.33it/s]
 96%|█████████▌| 407/424 [05:02<00:15,  1.09it/s]
 96%|█████████▌| 408/424 [05:03<00:15,  1.07it/s]
 96%|█████████▋| 409/424 [05:05<00:21,  1.43s/it]
 97%|█████████▋| 410/424 [05:06<00:15,  1.10s/it]
 97%|█████████▋| 411/424 [05:07<00:13,  1.05s/it]
 97%|█████████▋| 412/424 [05:07<00:09,  1.29it/s]
 97%|█████████▋| 413/424 [05:08<00:11,  1.03s/it]
 98%|█████████▊| 415/424 [05:10<00:08,  1.09it/s]
 98%|█████████▊| 416/424 [05:11<00:06,  1.17it/s]
 98%|█████████▊| 417/424 [05:11<00:05,  1.27it/s]
 99%|█████████▊| 418/424 [05:16<00:10,  1.72s/it]
 99%|█████████▉| 419/424 [05:16<00:07,  1.41s/it]
 99%|█████████▉| 420/424 [05:18<00:05,  1.48s/it]
 99%|█████████▉| 421/424 [05:19<00:03,  1.33s/it]
100%|█████████▉| 422/424 [05:19<00:01,  1.02it/s]
100%|█████████▉| 423/424 [05:23<00:01,  1.91s/it]
100%|██████████| 424/424 [05:24<00:00,  1.64s/it]
100%|██████████| 424/424 [05:24<00:00,  1.31it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:51:42.577833_sc_processed_test.json', '--output_addr', 'data/out/rag/full_profile/sc_rag_full_profile_test_4_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '4', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.62 examples/s]
Generating train split: 424 examples [00:00, 725.17 examples/s]
INFO 07-09 15:57:36 config.py:510] This model supports multiple tasks: {'classify', 'embed', 'reward', 'score', 'generate'}. Defaulting to 'generate'.
INFO 07-09 15:57:36 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:57:37 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:57:38 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:57:38 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.45it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.31it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.31it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.30it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.31it/s]

INFO 07-09 15:57:42 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 15:57:44 worker.py:241] Memory profiling takes 2.08 seconds
INFO 07-09 15:57:44 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 15:57:44 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 15:57:44 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 15:57:44 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 15:57:47 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  3.03it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.32it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.43it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.49it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.49it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.52it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:07,  3.54it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.56it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.56it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.57it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.59it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.60it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.61it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.60it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.61it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.61it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.66it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:05<00:04,  3.69it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.71it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:04,  3.73it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.75it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.76it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.77it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.78it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.79it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.80it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.71it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.74it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.76it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.80it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.80it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.83it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:09<00:00,  3.77it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.80it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.82it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.67it/s]
INFO 07-09 15:57:56 model_runner.py:1535] Graph capturing finished in 10 secs, took 0.22 GiB
INFO 07-09 15:57:56 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.52 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:20<2:22:52, 20.27s/it, est. speed input: 47.77 toks/s, output: 4.34 toks/s]
Processed prompts:   0%|          | 2/424 [00:20<1:01:16,  8.71s/it, est. speed input: 88.84 toks/s, output: 8.95 toks/s]
Processed prompts:   1%|          | 3/424 [00:21<34:20,  4.89s/it, est. speed input: 145.79 toks/s, output: 13.70 toks/s]
Processed prompts:   1%|          | 4/424 [00:21<21:27,  3.07s/it, est. speed input: 178.80 toks/s, output: 18.55 toks/s]
Processed prompts:   1%|          | 5/424 [00:21<14:05,  2.02s/it, est. speed input: 212.97 toks/s, output: 23.49 toks/s]
Processed prompts:   1%|▏         | 6/424 [00:21<09:37,  1.38s/it, est. speed input: 257.15 toks/s, output: 28.47 toks/s]
Processed prompts:   2%|▏         | 9/424 [00:22<04:22,  1.58it/s, est. speed input: 375.52 toks/s, output: 43.36 toks/s]
Processed prompts:   3%|▎         | 12/424 [00:22<02:28,  2.77it/s, est. speed input: 504.50 toks/s, output: 58.77 toks/s]
Processed prompts:   3%|▎         | 14/424 [00:22<02:02,  3.34it/s, est. speed input: 643.80 toks/s, output: 68.53 toks/s]
Processed prompts:   4%|▍         | 16/424 [00:22<01:34,  4.31it/s, est. speed input: 814.41 toks/s, output: 78.69 toks/s]
Processed prompts:   4%|▍         | 18/424 [00:23<01:33,  4.36it/s, est. speed input: 885.81 toks/s, output: 87.83 toks/s]
Processed prompts:   5%|▍         | 20/424 [00:23<01:23,  4.84it/s, est. speed input: 948.09 toks/s, output: 97.44 toks/s]
Processed prompts:   5%|▌         | 22/424 [00:23<01:05,  6.12it/s, est. speed input: 1040.74 toks/s, output: 107.79 toks/s]
Processed prompts:   6%|▌         | 24/424 [00:23<00:58,  6.85it/s, est. speed input: 1134.36 toks/s, output: 117.70 toks/s]
Processed prompts:   6%|▌         | 26/424 [00:23<00:49,  8.03it/s, est. speed input: 1241.02 toks/s, output: 127.84 toks/s]
Processed prompts:   7%|▋         | 28/424 [00:24<00:45,  8.62it/s, est. speed input: 1302.38 toks/s, output: 137.70 toks/s]
Processed prompts:   7%|▋         | 31/424 [00:24<00:37, 10.41it/s, est. speed input: 1366.77 toks/s, output: 152.87 toks/s]
Processed prompts:   8%|▊         | 33/424 [00:24<00:38, 10.16it/s, est. speed input: 1470.14 toks/s, output: 162.55 toks/s]
Processed prompts:   8%|▊         | 35/424 [00:24<00:40,  9.52it/s, est. speed input: 1520.25 toks/s, output: 171.86 toks/s]
Processed prompts:   9%|▊         | 37/424 [00:25<00:42,  9.19it/s, est. speed input: 1622.61 toks/s, output: 181.25 toks/s]
Processed prompts:   9%|▉         | 39/424 [00:25<00:44,  8.61it/s, est. speed input: 1654.32 toks/s, output: 190.30 toks/s]
Processed prompts:  10%|▉         | 41/424 [00:25<00:46,  8.25it/s, est. speed input: 1696.38 toks/s, output: 199.37 toks/s]
Processed prompts:  10%|█         | 43/424 [00:25<00:42,  8.99it/s, est. speed input: 1814.55 toks/s, output: 209.07 toks/s]
Processed prompts:  10%|█         | 44/424 [00:25<00:46,  8.12it/s, est. speed input: 1825.77 toks/s, output: 213.17 toks/s]
Processed prompts:  11%|█         | 47/424 [00:26<00:43,  8.68it/s, est. speed input: 1959.91 toks/s, output: 227.21 toks/s]
Processed prompts:  12%|█▏        | 50/424 [00:26<00:37,  9.88it/s, est. speed input: 2052.99 toks/s, output: 241.75 toks/s]
Processed prompts:  12%|█▏        | 51/424 [00:26<00:40,  9.13it/s, est. speed input: 2072.72 toks/s, output: 245.90 toks/s]
Processed prompts:  12%|█▎        | 53/424 [00:26<00:34, 10.81it/s, est. speed input: 2124.89 toks/s, output: 256.00 toks/s]
Processed prompts:  14%|█▎        | 58/424 [00:27<00:32, 11.36it/s, est. speed input: 2283.41 toks/s, output: 279.48 toks/s]
Processed prompts:  14%|█▍        | 61/424 [00:27<00:31, 11.62it/s, est. speed input: 2417.32 toks/s, output: 293.54 toks/s]
Processed prompts:  16%|█▌        | 66/424 [00:27<00:28, 12.56it/s, est. speed input: 2583.99 toks/s, output: 317.18 toks/s]
Processed prompts:  17%|█▋        | 70/424 [00:28<00:30, 11.68it/s, est. speed input: 2719.11 toks/s, output: 334.54 toks/s]
Processed prompts:  17%|█▋        | 74/424 [00:28<00:27, 12.71it/s, est. speed input: 2839.04 toks/s, output: 353.37 toks/s]
Processed prompts:  18%|█▊        | 76/424 [00:28<00:28, 12.02it/s, est. speed input: 2873.44 toks/s, output: 361.75 toks/s]
Processed prompts:  19%|█▊        | 79/424 [00:28<00:25, 13.43it/s, est. speed input: 2971.74 toks/s, output: 376.17 toks/s]
Processed prompts:  19%|█▉        | 81/424 [00:28<00:25, 13.31it/s, est. speed input: 3029.86 toks/s, output: 385.13 toks/s]
Processed prompts:  20%|█▉        | 83/424 [00:29<00:28, 11.76it/s, est. speed input: 3066.36 toks/s, output: 392.95 toks/s]
Processed prompts:  20%|██        | 86/424 [00:29<00:31, 10.85it/s, est. speed input: 3186.76 toks/s, output: 404.99 toks/s]
Processed prompts:  22%|██▏       | 93/424 [00:29<00:26, 12.57it/s, est. speed input: 3393.46 toks/s, output: 436.16 toks/s]
Processed prompts:  23%|██▎       | 97/424 [00:30<00:26, 12.23it/s, est. speed input: 3476.12 toks/s, output: 452.55 toks/s]
Processed prompts:  24%|██▎       | 100/424 [00:30<00:28, 11.49it/s, est. speed input: 3522.42 toks/s, output: 464.05 toks/s]
Processed prompts:  24%|██▍       | 102/424 [00:30<00:25, 12.48it/s, est. speed input: 3593.43 toks/s, output: 473.34 toks/s]
Processed prompts:  25%|██▍       | 105/424 [00:31<00:28, 11.38it/s, est. speed input: 3658.16 toks/s, output: 484.50 toks/s]
Processed prompts:  25%|██▌       | 107/424 [00:31<00:27, 11.40it/s, est. speed input: 3710.96 toks/s, output: 492.52 toks/s]
Processed prompts:  26%|██▌       | 109/424 [00:31<00:28, 11.05it/s, est. speed input: 3774.30 toks/s, output: 500.15 toks/s]
Processed prompts:  26%|██▌       | 111/424 [00:31<00:26, 11.92it/s, est. speed input: 3806.48 toks/s, output: 508.85 toks/s]
Processed prompts:  27%|██▋       | 114/424 [00:31<00:26, 11.67it/s, est. speed input: 3881.02 toks/s, output: 520.63 toks/s]
Processed prompts:  28%|██▊       | 119/424 [00:32<00:24, 12.63it/s, est. speed input: 4001.55 toks/s, output: 541.57 toks/s]
Processed prompts:  29%|██▉       | 124/424 [00:32<00:21, 13.98it/s, est. speed input: 4185.25 toks/s, output: 563.24 toks/s]
Processed prompts:  30%|███       | 128/424 [00:32<00:21, 13.57it/s, est. speed input: 4274.90 toks/s, output: 579.09 toks/s]
Processed prompts:  31%|███       | 130/424 [00:32<00:21, 13.87it/s, est. speed input: 4307.14 toks/s, output: 587.46 toks/s]
Processed prompts:  32%|███▏      | 134/424 [00:33<00:23, 12.17it/s, est. speed input: 4399.08 toks/s, output: 601.45 toks/s]
Processed prompts:  33%|███▎      | 141/424 [00:33<00:22, 12.52it/s, est. speed input: 4628.14 toks/s, output: 628.45 toks/s]
Processed prompts:  34%|███▍      | 144/424 [00:34<00:24, 11.32it/s, est. speed input: 4679.72 toks/s, output: 637.55 toks/s]
Processed prompts:  35%|███▍      | 147/424 [00:34<00:24, 11.20it/s, est. speed input: 4718.10 toks/s, output: 648.12 toks/s]
Processed prompts:  36%|███▌      | 153/424 [00:34<00:21, 12.87it/s, est. speed input: 4801.51 toks/s, output: 672.51 toks/s]
Processed prompts:  37%|███▋      | 156/424 [00:35<00:22, 12.04it/s, est. speed input: 4839.83 toks/s, output: 682.22 toks/s]
Processed prompts:  38%|███▊      | 159/424 [00:35<00:22, 11.53it/s, est. speed input: 4878.70 toks/s, output: 692.14 toks/s]
Processed prompts:  38%|███▊      | 163/424 [00:35<00:21, 12.08it/s, est. speed input: 4938.50 toks/s, output: 707.10 toks/s]
Processed prompts:  39%|███▉      | 166/424 [00:36<00:20, 12.35it/s, est. speed input: 5022.80 toks/s, output: 718.17 toks/s]
Processed prompts:  40%|███▉      | 169/424 [00:36<00:19, 13.21it/s, est. speed input: 5114.91 toks/s, output: 730.06 toks/s]
Processed prompts:  40%|████      | 171/424 [00:36<00:18, 14.04it/s, est. speed input: 5179.33 toks/s, output: 738.29 toks/s]
Processed prompts:  42%|████▏     | 176/424 [00:36<00:12, 19.89it/s, est. speed input: 5314.85 toks/s, output: 762.21 toks/s]
Processed prompts:  42%|████▏     | 179/424 [00:36<00:11, 21.63it/s, est. speed input: 5369.41 toks/s, output: 775.82 toks/s]
Processed prompts:  43%|████▎     | 182/424 [00:36<00:10, 23.19it/s, est. speed input: 5432.30 toks/s, output: 789.56 toks/s]
Processed prompts:  44%|████▍     | 186/424 [00:36<00:08, 26.87it/s, est. speed input: 5537.68 toks/s, output: 808.68 toks/s]
Processed prompts:  46%|████▌     | 193/424 [00:36<00:06, 37.37it/s, est. speed input: 5768.11 toks/s, output: 843.98 toks/s]
Processed prompts:  47%|████▋     | 198/424 [00:36<00:06, 35.84it/s, est. speed input: 5875.25 toks/s, output: 867.67 toks/s]
Processed prompts:  48%|████▊     | 202/424 [00:37<00:06, 32.90it/s, est. speed input: 5954.01 toks/s, output: 886.09 toks/s]
Processed prompts:  49%|████▊     | 206/424 [00:37<00:07, 31.04it/s, est. speed input: 6079.81 toks/s, output: 904.77 toks/s]
Processed prompts:  50%|████▉     | 210/424 [00:37<00:08, 24.95it/s, est. speed input: 6145.13 toks/s, output: 921.51 toks/s]
Processed prompts:  51%|█████     | 217/424 [00:37<00:06, 31.66it/s, est. speed input: 6343.83 toks/s, output: 955.37 toks/s]
Processed prompts:  53%|█████▎    | 223/424 [00:37<00:06, 32.25it/s, est. speed input: 6483.33 toks/s, output: 985.37 toks/s]
Processed prompts:  54%|█████▍    | 228/424 [00:37<00:05, 33.62it/s, est. speed input: 6595.50 toks/s, output: 1011.08 toks/s]
Processed prompts:  55%|█████▍    | 232/424 [00:38<00:06, 30.08it/s, est. speed input: 6664.65 toks/s, output: 1030.18 toks/s]
Processed prompts:  56%|█████▌    | 236/424 [00:38<00:08, 21.35it/s, est. speed input: 6742.92 toks/s, output: 1045.23 toks/s]
Processed prompts:  56%|█████▋    | 239/424 [00:39<00:14, 13.07it/s, est. speed input: 6726.97 toks/s, output: 1049.26 toks/s]
Processed prompts:  57%|█████▋    | 241/424 [00:39<00:14, 12.81it/s, est. speed input: 6747.98 toks/s, output: 1051.29 toks/s]
Processed prompts:  58%|█████▊    | 244/424 [00:39<00:12, 13.87it/s, est. speed input: 6810.96 toks/s, output: 1063.15 toks/s]
Processed prompts:  58%|█████▊    | 246/424 [00:39<00:12, 14.27it/s, est. speed input: 6847.89 toks/s, output: 1065.97 toks/s]
Processed prompts:  59%|█████▊    | 249/424 [00:39<00:10, 16.33it/s, est. speed input: 6870.54 toks/s, output: 1073.97 toks/s]
Processed prompts:  59%|█████▉    | 251/424 [00:39<00:10, 16.35it/s, est. speed input: 6898.11 toks/s, output: 1080.24 toks/s]
Processed prompts:  60%|█████▉    | 254/424 [00:39<00:09, 18.39it/s, est. speed input: 6934.62 toks/s, output: 1086.96 toks/s]
Processed prompts:  61%|██████    | 257/424 [00:40<00:09, 17.15it/s, est. speed input: 6972.12 toks/s, output: 1092.03 toks/s]
Processed prompts:  62%|██████▏   | 261/424 [00:40<00:10, 16.03it/s, est. speed input: 7012.31 toks/s, output: 1096.86 toks/s]
Processed prompts:  63%|██████▎   | 266/424 [00:40<00:07, 21.37it/s, est. speed input: 7093.16 toks/s, output: 1113.27 toks/s]
Processed prompts:  65%|██████▍   | 274/424 [00:40<00:04, 31.92it/s, est. speed input: 7247.99 toks/s, output: 1144.78 toks/s]
Processed prompts:  66%|██████▌   | 278/424 [00:40<00:04, 32.68it/s, est. speed input: 7350.21 toks/s, output: 1156.83 toks/s]
Processed prompts:  67%|██████▋   | 282/424 [00:40<00:05, 26.61it/s, est. speed input: 7403.58 toks/s, output: 1165.25 toks/s]
Processed prompts:  67%|██████▋   | 286/424 [00:41<00:06, 20.96it/s, est. speed input: 7445.61 toks/s, output: 1172.09 toks/s]
Processed prompts:  69%|██████▊   | 291/424 [00:41<00:05, 25.49it/s, est. speed input: 7570.75 toks/s, output: 1186.08 toks/s]
Processed prompts:  70%|██████▉   | 296/424 [00:41<00:04, 29.74it/s, est. speed input: 7689.83 toks/s, output: 1205.91 toks/s]
Processed prompts:  71%|███████   | 302/424 [00:41<00:03, 34.05it/s, est. speed input: 7778.23 toks/s, output: 1223.37 toks/s]
Processed prompts:  73%|███████▎  | 310/424 [00:41<00:02, 41.89it/s, est. speed input: 7970.53 toks/s, output: 1254.44 toks/s]
Processed prompts:  75%|███████▍  | 316/424 [00:41<00:02, 43.84it/s, est. speed input: 8056.27 toks/s, output: 1273.31 toks/s]
Processed prompts:  76%|███████▌  | 321/424 [00:41<00:02, 40.63it/s, est. speed input: 8153.44 toks/s, output: 1296.23 toks/s]
Processed prompts:  77%|███████▋  | 327/424 [00:42<00:02, 43.64it/s, est. speed input: 8303.76 toks/s, output: 1320.69 toks/s]
Processed prompts:  78%|███████▊  | 332/424 [00:42<00:02, 38.74it/s, est. speed input: 8425.38 toks/s, output: 1339.61 toks/s]
Processed prompts:  80%|███████▉  | 338/424 [00:42<00:02, 42.72it/s, est. speed input: 8569.38 toks/s, output: 1364.85 toks/s]
Processed prompts:  83%|████████▎ | 350/424 [00:42<00:01, 60.90it/s, est. speed input: 8875.51 toks/s, output: 1412.97 toks/s]
Processed prompts:  85%|████████▍ | 359/424 [00:42<00:01, 64.43it/s, est. speed input: 9100.81 toks/s, output: 1448.10 toks/s]
Processed prompts:  87%|████████▋ | 368/424 [00:42<00:00, 68.49it/s, est. speed input: 9314.71 toks/s, output: 1483.54 toks/s]
Processed prompts:  89%|████████▊ | 376/424 [00:42<00:00, 66.15it/s, est. speed input: 9495.64 toks/s, output: 1518.01 toks/s]
Processed prompts:  91%|█████████ | 384/424 [00:42<00:00, 60.07it/s, est. speed input: 9693.11 toks/s, output: 1548.10 toks/s]
Processed prompts:  92%|█████████▏| 391/424 [00:43<00:00, 53.61it/s, est. speed input: 9835.26 toks/s, output: 1578.97 toks/s]
Processed prompts:  95%|█████████▍| 401/424 [00:43<00:00, 64.14it/s, est. speed input: 10082.83 toks/s, output: 1623.83 toks/s]
Processed prompts:  96%|█████████▌| 408/424 [00:43<00:00, 57.76it/s, est. speed input: 10246.25 toks/s, output: 1656.04 toks/s]
Processed prompts:  98%|█████████▊| 415/424 [00:43<00:00, 50.05it/s, est. speed input: 10382.96 toks/s, output: 1693.04 toks/s]
Processed prompts:  99%|█████████▉| 421/424 [00:43<00:00, 34.09it/s, est. speed input: 10489.19 toks/s, output: 1721.63 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:44<00:00,  9.54it/s, est. speed input: 10431.15 toks/s, output: 1721.58 toks/s]
{  "personalized_answer": {    "Based on your past questions and preferences, it seems that you value clarity, elegance, and the impact of your work. When considering the referee's suggestion for a better proof of your theorem, it would be best to include both proofs in your paper. Present your original proof first, as it provides a clear and accessible path for understanding the theorem. Then, introduce the improved proof, highlighting its advantages and how it enhances the overall understanding of the result. This approach respects the aesthetic and practical aspects of your work, aligning with your past preferences for both elegance and rigor. Additionally, including both proofs demonstrates your thoroughness and openness to improvement, which can be beneficial for your publication and future research."  }}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.09s/it, est. speed input: 439.44 toks/s, output: 82.72 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.09s/it, est. speed input: 439.44 toks/s, output: 82.72 toks/s]
{  "personalized_answer": {    "Based on your past questions and preferences, it seems that you value clarity, elegance, and the impact of your work. When deciding whether to publish your original proof or the improved one, consider the following: Since the referee's suggested proof is better, it likely offers a more rigorous and potentially more accessible explanation. This aligns with your past preference for rigorous and understandable theorems. However, it's also important to acknowledge the original work. You could include both proofs in your paper, perhaps in a supplementary section, to give credit to the original idea while presenting the improved version. This approach respects the integrity of your initial contribution and showcases the refinement of your work. Ultimately, the improved proof should be the main focus, as it represents a significant enhancement in the field."  }}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.44s/it, est. speed input: 377.30 toks/s, output: 82.93 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.44s/it, est. speed input: 377.30 toks/s, output: 82.93 toks/s]
[rank0]:[W709 15:58:48.279212499 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/sc_rag_full_profile_test_4_output.json
Cleaned temporary files.
Keeping ['lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:58:51.622623_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:58:51.622623_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:58:51.622623_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<01:35,  4.18it/s]
  1%|          | 3/401 [00:00<01:39,  3.99it/s]
  1%|          | 4/401 [00:01<03:01,  2.19it/s]
  1%|          | 5/401 [00:02<03:54,  1.69it/s]
  1%|▏         | 6/401 [00:03<04:28,  1.47it/s]
  2%|▏         | 7/401 [00:04<04:50,  1.36it/s]
  2%|▏         | 8/401 [00:05<05:02,  1.30it/s]
  2%|▏         | 9/401 [00:05<05:09,  1.27it/s]
  2%|▏         | 10/401 [00:05<03:50,  1.70it/s]
  3%|▎         | 11/401 [00:07<05:12,  1.25it/s]
  3%|▎         | 13/401 [00:08<04:43,  1.37it/s]
  3%|▎         | 14/401 [00:09<04:20,  1.49it/s]
  4%|▍         | 17/401 [00:09<02:14,  2.86it/s]
  4%|▍         | 18/401 [00:10<03:25,  1.87it/s]
  5%|▍         | 19/401 [00:11<04:26,  1.44it/s]
  5%|▍         | 20/401 [00:14<07:14,  1.14s/it]
  5%|▌         | 22/401 [00:16<07:39,  1.21s/it]
  6%|▌         | 23/401 [00:18<07:41,  1.22s/it]
  6%|▌         | 24/401 [00:20<09:42,  1.55s/it]
  6%|▋         | 26/401 [00:20<05:50,  1.07it/s]
  7%|▋         | 27/401 [00:23<08:07,  1.30s/it]
  7%|▋         | 29/401 [00:23<05:01,  1.23it/s]
  7%|▋         | 30/401 [00:23<04:07,  1.50it/s]
  8%|▊         | 31/401 [00:24<04:06,  1.50it/s]
  8%|▊         | 33/401 [00:25<03:17,  1.87it/s]
  8%|▊         | 34/401 [00:25<02:46,  2.20it/s]
  9%|▉         | 36/401 [00:25<01:49,  3.32it/s]
  9%|▉         | 38/401 [00:25<01:19,  4.57it/s]
 10%|▉         | 40/401 [00:25<01:03,  5.71it/s]
 10%|█         | 42/401 [00:26<01:02,  5.72it/s]
 11%|█         | 43/401 [00:26<01:03,  5.63it/s]
 11%|█         | 44/401 [00:26<00:57,  6.16it/s]
 11%|█▏        | 46/401 [00:26<00:54,  6.47it/s]
 12%|█▏        | 47/401 [00:26<00:55,  6.40it/s]
 12%|█▏        | 48/401 [00:27<01:03,  5.58it/s]
 12%|█▏        | 49/401 [00:27<01:01,  5.70it/s]
 13%|█▎        | 52/401 [00:27<00:35,  9.78it/s]
 13%|█▎        | 54/401 [00:27<00:35,  9.67it/s]
 14%|█▍        | 56/401 [00:28<01:02,  5.56it/s]
 14%|█▍        | 57/401 [00:28<00:57,  6.01it/s]
 15%|█▍        | 59/401 [00:28<01:11,  4.80it/s]
 15%|█▍        | 60/401 [00:29<01:06,  5.15it/s]
 15%|█▌        | 62/401 [00:29<00:59,  5.74it/s]
 16%|█▌        | 63/401 [00:29<00:58,  5.75it/s]
 16%|█▌        | 64/401 [00:29<00:57,  5.84it/s]
 16%|█▌        | 65/401 [00:29<00:57,  5.87it/s]
 16%|█▋        | 66/401 [00:29<00:54,  6.12it/s]
 17%|█▋        | 68/401 [00:30<00:38,  8.60it/s]
 17%|█▋        | 70/401 [00:30<00:34,  9.73it/s]
 18%|█▊        | 72/401 [00:30<00:33,  9.93it/s]
 18%|█▊        | 74/401 [00:30<00:30, 10.75it/s]
 19%|█▉        | 76/401 [00:30<00:31, 10.22it/s]
 19%|█▉        | 78/401 [00:30<00:29, 11.01it/s]
 20%|█▉        | 80/401 [00:31<00:30, 10.45it/s]
 20%|██        | 82/401 [00:31<00:28, 11.18it/s]
 21%|██        | 84/401 [00:31<00:29, 10.64it/s]
 21%|██▏       | 86/401 [00:31<00:27, 11.38it/s]
 22%|██▏       | 88/401 [00:32<00:49,  6.30it/s]
 22%|██▏       | 89/401 [00:32<00:48,  6.39it/s]
 23%|██▎       | 91/401 [00:32<00:38,  8.11it/s]
 23%|██▎       | 93/401 [00:32<00:35,  8.60it/s]
 24%|██▎       | 95/401 [00:33<00:39,  7.76it/s]
 24%|██▍       | 96/401 [00:33<00:38,  7.99it/s]
 24%|██▍       | 97/401 [00:33<00:37,  8.21it/s]
 24%|██▍       | 98/401 [00:33<00:36,  8.20it/s]
 25%|██▍       | 100/401 [00:33<00:28, 10.61it/s]
 25%|██▌       | 102/401 [00:33<00:24, 12.44it/s]
 26%|██▌       | 104/401 [00:33<00:34,  8.58it/s]
 26%|██▋       | 106/401 [00:34<00:29,  9.95it/s]
 27%|██▋       | 108/401 [00:34<00:32,  9.13it/s]
 27%|██▋       | 110/401 [00:34<00:27, 10.39it/s]
 28%|██▊       | 112/401 [00:34<00:28, 10.03it/s]
 28%|██▊       | 114/401 [00:34<00:28, 10.03it/s]
 29%|██▉       | 116/401 [00:35<00:26, 10.96it/s]
 29%|██▉       | 118/401 [00:35<00:28, 10.02it/s]
 30%|██▉       | 120/401 [00:35<00:26, 10.69it/s]
 30%|███       | 122/401 [00:35<00:24, 11.30it/s]
 31%|███       | 124/401 [00:35<00:29,  9.42it/s]
 31%|███▏      | 126/401 [00:36<00:34,  8.07it/s]
 32%|███▏      | 127/401 [00:36<00:34,  7.85it/s]
 32%|███▏      | 128/401 [00:36<00:35,  7.67it/s]
 32%|███▏      | 129/401 [00:36<00:33,  8.03it/s]
 32%|███▏      | 130/401 [00:36<00:35,  7.66it/s]
 33%|███▎      | 133/401 [00:37<00:43,  6.10it/s]
 33%|███▎      | 134/401 [00:37<00:40,  6.53it/s]
 34%|███▎      | 135/401 [00:37<00:38,  6.97it/s]
 34%|███▍      | 136/401 [00:37<00:35,  7.42it/s]
 34%|███▍      | 138/401 [00:37<00:30,  8.64it/s]
 35%|███▍      | 140/401 [00:37<00:24, 10.77it/s]
 35%|███▌      | 142/401 [00:38<00:30,  8.53it/s]
 36%|███▌      | 144/401 [00:38<00:35,  7.16it/s]
 36%|███▋      | 146/401 [00:38<00:29,  8.74it/s]
 37%|███▋      | 148/401 [00:39<00:40,  6.18it/s]
 37%|███▋      | 149/401 [00:39<00:38,  6.60it/s]
 37%|███▋      | 150/401 [00:39<00:35,  7.01it/s]
 38%|███▊      | 151/401 [00:39<00:35,  7.01it/s]
 38%|███▊      | 152/401 [00:39<00:33,  7.49it/s]
 38%|███▊      | 153/401 [00:40<00:40,  6.06it/s]
 38%|███▊      | 154/401 [00:40<00:39,  6.32it/s]
 39%|███▊      | 155/401 [00:40<00:38,  6.46it/s]
 39%|███▉      | 156/401 [00:40<00:37,  6.58it/s]
 39%|███▉      | 157/401 [00:40<00:36,  6.68it/s]
 40%|███▉      | 159/401 [00:40<00:26,  9.10it/s]
 40%|███▉      | 160/401 [00:40<00:33,  7.13it/s]
 40%|████      | 162/401 [00:41<00:27,  8.78it/s]
 41%|████      | 164/401 [00:41<00:21, 10.78it/s]
 41%|████▏     | 166/401 [00:41<00:22, 10.26it/s]
 42%|████▏     | 168/401 [00:41<00:22, 10.20it/s]
 42%|████▏     | 170/401 [00:41<00:23,  9.96it/s]
 43%|████▎     | 172/401 [00:42<00:29,  7.81it/s]
 43%|████▎     | 173/401 [00:42<00:28,  8.06it/s]
 43%|████▎     | 174/401 [00:42<00:27,  8.28it/s]
 44%|████▎     | 175/401 [00:42<00:26,  8.47it/s]
 44%|████▍     | 176/401 [00:42<00:25,  8.66it/s]
 44%|████▍     | 177/401 [00:42<00:27,  8.05it/s]
 44%|████▍     | 178/401 [00:42<00:26,  8.32it/s]
 45%|████▍     | 179/401 [00:43<00:25,  8.55it/s]
 45%|████▍     | 180/401 [00:43<00:24,  8.88it/s]
 45%|████▌     | 181/401 [00:43<00:24,  9.10it/s]
 45%|████▌     | 182/401 [00:43<00:23,  9.14it/s]
 46%|████▌     | 184/401 [00:43<00:19, 11.04it/s]
 46%|████▋     | 186/401 [00:43<00:17, 12.27it/s]
 47%|████▋     | 188/401 [00:43<00:18, 11.37it/s]
 47%|████▋     | 190/401 [00:43<00:17, 12.36it/s]
 48%|████▊     | 192/401 [00:44<00:41,  5.07it/s]
 48%|████▊     | 193/401 [00:44<00:38,  5.40it/s]
 48%|████▊     | 194/401 [00:45<00:41,  4.94it/s]
 49%|████▉     | 196/401 [00:45<00:45,  4.49it/s]
 49%|████▉     | 197/401 [00:47<01:57,  1.74it/s]
 50%|████▉     | 199/401 [00:48<01:32,  2.18it/s]
 50%|████▉     | 200/401 [00:48<01:31,  2.21it/s]
 50%|█████     | 201/401 [00:49<01:30,  2.20it/s]
 50%|█████     | 202/401 [00:49<01:28,  2.24it/s]
 51%|█████     | 203/401 [00:49<01:28,  2.23it/s]
 51%|█████     | 204/401 [00:50<01:28,  2.22it/s]
 51%|█████▏    | 206/401 [00:50<01:09,  2.79it/s]
 52%|█████▏    | 207/401 [00:51<01:13,  2.64it/s]
 52%|█████▏    | 208/401 [00:51<01:16,  2.52it/s]
 52%|█████▏    | 209/401 [00:52<01:15,  2.53it/s]
 52%|█████▏    | 210/401 [00:52<01:17,  2.45it/s]
 53%|█████▎    | 211/401 [00:53<01:26,  2.21it/s]
 53%|█████▎    | 212/401 [00:53<01:16,  2.48it/s]
 53%|█████▎    | 213/401 [00:53<01:24,  2.22it/s]
 53%|█████▎    | 214/401 [00:55<02:17,  1.36it/s]
 54%|█████▎    | 215/401 [00:55<01:47,  1.74it/s]
 54%|█████▍    | 216/401 [00:56<01:57,  1.57it/s]
 54%|█████▍    | 218/401 [00:56<01:13,  2.51it/s]
 55%|█████▍    | 219/401 [00:56<01:03,  2.86it/s]
 55%|█████▍    | 220/401 [00:57<00:56,  3.21it/s]
 55%|█████▌    | 221/401 [00:57<01:06,  2.69it/s]
 55%|█████▌    | 222/401 [00:57<00:58,  3.08it/s]
 56%|█████▌    | 224/401 [00:58<00:45,  3.86it/s]
 56%|█████▌    | 225/401 [00:58<00:38,  4.53it/s]
 56%|█████▋    | 226/401 [00:58<00:33,  5.26it/s]
 57%|█████▋    | 228/401 [00:59<00:43,  3.95it/s]
 57%|█████▋    | 229/401 [00:59<00:40,  4.27it/s]
 57%|█████▋    | 230/401 [00:59<00:38,  4.39it/s]
 58%|█████▊    | 231/401 [00:59<00:35,  4.83it/s]
 58%|█████▊    | 232/401 [00:59<00:37,  4.46it/s]
 58%|█████▊    | 234/401 [01:02<02:15,  1.23it/s]
 59%|█████▊    | 235/401 [01:03<01:54,  1.45it/s]
 59%|█████▉    | 236/401 [01:03<01:29,  1.84it/s]
 59%|█████▉    | 237/401 [01:03<01:17,  2.12it/s]
 59%|█████▉    | 238/401 [01:03<01:03,  2.59it/s]
 60%|█████▉    | 239/401 [01:03<00:54,  2.98it/s]
 60%|██████    | 241/401 [01:04<00:33,  4.76it/s]
 61%|██████    | 243/401 [01:04<00:39,  3.97it/s]
 61%|██████    | 244/401 [01:05<00:42,  3.73it/s]
 61%|██████▏   | 246/401 [01:05<00:32,  4.80it/s]
 62%|██████▏   | 247/401 [01:05<00:31,  4.83it/s]
 62%|██████▏   | 248/401 [01:05<00:28,  5.45it/s]
 62%|██████▏   | 249/401 [01:06<00:55,  2.76it/s]
 63%|██████▎   | 254/401 [01:06<00:21,  6.93it/s]
 64%|██████▍   | 256/401 [01:07<00:39,  3.65it/s]
 65%|██████▍   | 260/401 [01:07<00:23,  5.95it/s]
 65%|██████▌   | 262/401 [01:08<00:25,  5.42it/s]
 66%|██████▌   | 265/401 [01:08<00:18,  7.44it/s]
 67%|██████▋   | 268/401 [01:08<00:14,  9.38it/s]
 67%|██████▋   | 270/401 [01:09<00:21,  6.02it/s]
 68%|██████▊   | 273/401 [01:09<00:16,  7.95it/s]
 69%|██████▊   | 275/401 [01:09<00:14,  8.79it/s]
 69%|██████▉   | 277/401 [01:10<00:16,  7.34it/s]
 70%|██████▉   | 279/401 [01:10<00:15,  8.11it/s]
 70%|███████   | 281/401 [01:10<00:15,  7.73it/s]
 71%|███████   | 283/401 [01:10<00:17,  6.89it/s]
 71%|███████   | 285/401 [01:11<00:14,  7.80it/s]
 72%|███████▏  | 288/401 [01:11<00:10, 10.30it/s]
 73%|███████▎  | 291/401 [01:11<00:12,  8.53it/s]
 73%|███████▎  | 293/401 [01:12<00:22,  4.88it/s]
 73%|███████▎  | 294/401 [01:13<00:27,  3.90it/s]
 74%|███████▍  | 296/401 [01:13<00:21,  4.90it/s]
 75%|███████▍  | 299/401 [01:14<00:24,  4.20it/s]
 75%|███████▌  | 301/401 [01:14<00:18,  5.28it/s]
 76%|███████▌  | 304/401 [01:14<00:18,  5.11it/s]
 76%|███████▋  | 306/401 [01:15<00:15,  6.20it/s]
 77%|███████▋  | 308/401 [01:15<00:14,  6.48it/s]
 77%|███████▋  | 309/401 [01:15<00:17,  5.40it/s]
 78%|███████▊  | 311/401 [01:15<00:13,  6.49it/s]
 78%|███████▊  | 313/401 [01:16<00:11,  7.85it/s]
 79%|███████▊  | 315/401 [01:16<00:09,  9.10it/s]
 79%|███████▉  | 318/401 [01:16<00:07, 11.24it/s]
 80%|███████▉  | 320/401 [01:16<00:09,  8.91it/s]
 80%|████████  | 322/401 [01:17<00:10,  7.47it/s]
 81%|████████  | 323/401 [01:17<00:15,  5.12it/s]
 81%|████████  | 324/401 [01:18<00:19,  3.95it/s]
 81%|████████  | 325/401 [01:18<00:23,  3.26it/s]
 81%|████████▏ | 326/401 [01:18<00:20,  3.63it/s]
 82%|████████▏ | 328/401 [01:18<00:14,  5.07it/s]
 82%|████████▏ | 329/401 [01:20<00:31,  2.27it/s]
 82%|████████▏ | 330/401 [01:20<00:32,  2.21it/s]
 83%|████████▎ | 331/401 [01:20<00:26,  2.65it/s]
 83%|████████▎ | 332/401 [01:21<00:28,  2.42it/s]
 83%|████████▎ | 333/401 [01:21<00:29,  2.29it/s]
 84%|████████▎ | 335/401 [01:22<00:24,  2.74it/s]
 84%|████████▍ | 336/401 [01:22<00:25,  2.51it/s]
 84%|████████▍ | 338/401 [01:23<00:16,  3.78it/s]
 85%|████████▌ | 341/401 [01:23<00:10,  5.91it/s]
 86%|████████▌ | 343/401 [01:23<00:08,  6.90it/s]
 86%|████████▌ | 345/401 [01:23<00:07,  7.21it/s]
 86%|████████▋ | 346/401 [01:23<00:08,  6.59it/s]
 87%|████████▋ | 348/401 [01:24<00:09,  5.44it/s]
 87%|████████▋ | 350/401 [01:24<00:11,  4.44it/s]
 88%|████████▊ | 351/401 [01:25<00:13,  3.62it/s]
 89%|████████▊ | 355/401 [01:25<00:06,  6.60it/s]
 89%|████████▉ | 357/401 [01:26<00:09,  4.47it/s]
 90%|████████▉ | 359/401 [01:27<00:11,  3.68it/s]
 90%|████████▉ | 360/401 [01:27<00:14,  2.86it/s]
 90%|█████████ | 361/401 [01:28<00:12,  3.17it/s]
 91%|█████████ | 363/401 [01:28<00:08,  4.38it/s]
 91%|█████████ | 365/401 [01:28<00:06,  5.20it/s]
 92%|█████████▏| 367/401 [01:28<00:05,  5.98it/s]
 92%|█████████▏| 369/401 [01:29<00:05,  6.05it/s]
 92%|█████████▏| 370/401 [01:29<00:05,  5.88it/s]
 93%|█████████▎| 371/401 [01:29<00:05,  5.83it/s]
 93%|█████████▎| 373/401 [01:29<00:04,  6.60it/s]
 93%|█████████▎| 374/401 [01:29<00:04,  6.32it/s]
 94%|█████████▎| 375/401 [01:30<00:04,  6.15it/s]
 94%|█████████▍| 376/401 [01:30<00:06,  3.88it/s]
 94%|█████████▍| 378/401 [01:31<00:06,  3.54it/s]
 95%|█████████▍| 379/401 [01:31<00:07,  2.99it/s]
 95%|█████████▍| 380/401 [01:31<00:06,  3.37it/s]
 95%|█████████▌| 382/401 [01:32<00:05,  3.42it/s]
 96%|█████████▌| 383/401 [01:33<00:06,  2.87it/s]
 96%|█████████▌| 384/401 [01:33<00:06,  2.71it/s]
 96%|█████████▌| 385/401 [01:33<00:06,  2.48it/s]
 97%|█████████▋| 387/401 [01:34<00:05,  2.41it/s]
 97%|█████████▋| 389/401 [01:35<00:03,  3.39it/s]
 97%|█████████▋| 390/401 [01:35<00:03,  3.26it/s]
 98%|█████████▊| 393/401 [01:35<00:01,  5.50it/s]
 98%|█████████▊| 394/401 [01:35<00:01,  5.19it/s]
 99%|█████████▊| 395/401 [01:36<00:01,  4.51it/s]
 99%|█████████▉| 397/401 [01:36<00:00,  5.11it/s]
100%|█████████▉| 399/401 [01:36<00:00,  4.58it/s]
100%|██████████| 401/401 [01:37<00:00,  5.75it/s]
100%|██████████| 401/401 [01:37<00:00,  4.13it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:58:51.622623_ae_processed_test.json', '--output_addr', 'data/out/rag/asym/ae_rag_lp_sc_test_4_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '4', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  9.57 examples/s]
Generating train split: 401 examples [00:00, 1842.34 examples/s]
INFO 07-09 16:00:54 config.py:510] This model supports multiple tasks: {'embed', 'score', 'classify', 'reward', 'generate'}. Defaulting to 'generate'.
INFO 07-09 16:00:54 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:00:55 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:00:56 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:00:56 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.45it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.32it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.31it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.30it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.32it/s]

INFO 07-09 16:01:00 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:01:02 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-09 16:01:02 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:01:02 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:01:02 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:01:02 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:01:05 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  2.91it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:10,  3.28it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.49it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.60it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.66it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.71it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.74it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.76it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:06,  3.76it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.78it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:02<00:06,  3.80it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.81it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.82it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.83it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.83it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:04,  3.84it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.88it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.92it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.94it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.86it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.90it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.94it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.97it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.99it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  4.00it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:06<00:02,  4.02it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:01,  4.02it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  4.03it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  4.05it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:07<00:01,  4.07it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:00,  4.08it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  4.10it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  4.02it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:08<00:00,  4.05it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  4.07it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.88it/s]
INFO 07-09 16:01:14 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 16:01:14 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.03 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:19<2:08:44, 19.31s/it, est. speed input: 31.43 toks/s, output: 4.61 toks/s]
Processed prompts:   0%|          | 2/401 [00:20<55:48,  8.39s/it, est. speed input: 76.82 toks/s, output: 9.52 toks/s]  
Processed prompts:   1%|          | 3/401 [00:20<31:22,  4.73s/it, est. speed input: 123.23 toks/s, output: 14.63 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:20<10:59,  1.67s/it, est. speed input: 243.01 toks/s, output: 30.21 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:21<05:14,  1.24it/s, est. speed input: 455.13 toks/s, output: 50.62 toks/s]
Processed prompts:   3%|▎         | 11/401 [00:21<04:35,  1.42it/s, est. speed input: 501.24 toks/s, output: 55.57 toks/s]
Processed prompts:   3%|▎         | 13/401 [00:21<03:14,  2.00it/s, est. speed input: 589.81 toks/s, output: 66.11 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:21<02:49,  2.29it/s, est. speed input: 678.52 toks/s, output: 71.10 toks/s]
Processed prompts:   4%|▍         | 16/401 [00:21<01:56,  3.30it/s, est. speed input: 737.72 toks/s, output: 81.70 toks/s]
Processed prompts:   4%|▍         | 18/401 [00:21<01:26,  4.41it/s, est. speed input: 810.18 toks/s, output: 92.17 toks/s]
Processed prompts:   5%|▍         | 20/401 [00:22<01:14,  5.11it/s, est. speed input: 870.58 toks/s, output: 102.07 toks/s]
Processed prompts:   5%|▌         | 22/401 [00:22<00:56,  6.66it/s, est. speed input: 922.27 toks/s, output: 112.65 toks/s]
Processed prompts:   6%|▌         | 25/401 [00:22<00:47,  7.98it/s, est. speed input: 1068.17 toks/s, output: 127.83 toks/s]
Processed prompts:   7%|▋         | 28/401 [00:22<00:36, 10.21it/s, est. speed input: 1158.64 toks/s, output: 143.50 toks/s]
Processed prompts:   7%|▋         | 30/401 [00:22<00:34, 10.78it/s, est. speed input: 1232.47 toks/s, output: 153.61 toks/s]
Processed prompts:   9%|▊         | 35/401 [00:23<00:28, 12.88it/s, est. speed input: 1421.48 toks/s, output: 178.97 toks/s]
Processed prompts:  10%|█         | 41/401 [00:23<00:32, 11.14it/s, est. speed input: 1606.22 toks/s, output: 206.51 toks/s]
Processed prompts:  11%|█▏        | 46/401 [00:24<00:34, 10.40it/s, est. speed input: 1780.90 toks/s, output: 228.62 toks/s]
Processed prompts:  13%|█▎        | 51/401 [00:24<00:32, 10.78it/s, est. speed input: 1894.60 toks/s, output: 251.30 toks/s]
Processed prompts:  14%|█▍        | 56/401 [00:25<00:30, 11.20it/s, est. speed input: 2054.24 toks/s, output: 273.61 toks/s]
Processed prompts:  15%|█▍        | 60/401 [00:25<00:30, 11.15it/s, est. speed input: 2149.33 toks/s, output: 290.72 toks/s]
Processed prompts:  16%|█▌        | 64/401 [00:25<00:28, 12.01it/s, est. speed input: 2316.77 toks/s, output: 308.64 toks/s]
Processed prompts:  17%|█▋        | 68/401 [00:26<00:27, 11.95it/s, est. speed input: 2439.70 toks/s, output: 325.45 toks/s]
Processed prompts:  18%|█▊        | 74/401 [00:26<00:26, 12.43it/s, est. speed input: 2569.18 toks/s, output: 350.84 toks/s]
Processed prompts:  20%|█▉        | 80/401 [00:27<00:26, 12.11it/s, est. speed input: 2751.61 toks/s, output: 374.65 toks/s]
Processed prompts:  21%|██▏       | 86/401 [00:27<00:25, 12.21it/s, est. speed input: 2900.20 toks/s, output: 398.32 toks/s]
Processed prompts:  22%|██▏       | 88/401 [00:27<00:27, 11.28it/s, est. speed input: 2929.51 toks/s, output: 404.80 toks/s]
Processed prompts:  22%|██▏       | 90/401 [00:28<00:25, 12.10it/s, est. speed input: 2973.11 toks/s, output: 413.54 toks/s]
Processed prompts:  23%|██▎       | 92/401 [00:28<00:31,  9.71it/s, est. speed input: 2986.43 toks/s, output: 418.18 toks/s]
Processed prompts:  25%|██▍       | 99/401 [00:28<00:25, 11.83it/s, est. speed input: 3199.93 toks/s, output: 447.04 toks/s]
Processed prompts:  25%|██▌       | 102/401 [00:29<00:25, 11.91it/s, est. speed input: 3287.15 toks/s, output: 458.45 toks/s]
Processed prompts:  26%|██▌       | 105/401 [00:29<00:25, 11.57it/s, est. speed input: 3360.78 toks/s, output: 469.19 toks/s]
Processed prompts:  27%|██▋       | 107/401 [00:29<00:25, 11.42it/s, est. speed input: 3389.64 toks/s, output: 476.38 toks/s]
Processed prompts:  28%|██▊       | 112/401 [00:30<00:25, 11.29it/s, est. speed input: 3493.25 toks/s, output: 494.25 toks/s]
Processed prompts:  29%|██▊       | 115/401 [00:30<00:27, 10.28it/s, est. speed input: 3558.65 toks/s, output: 503.33 toks/s]
Processed prompts:  30%|██▉       | 119/401 [00:30<00:25, 11.24it/s, est. speed input: 3668.93 toks/s, output: 518.58 toks/s]
Processed prompts:  31%|███       | 124/401 [00:31<00:24, 11.19it/s, est. speed input: 3779.30 toks/s, output: 535.86 toks/s]
Processed prompts:  32%|███▏      | 127/401 [00:31<00:22, 12.13it/s, est. speed input: 3834.39 toks/s, output: 547.62 toks/s]
Processed prompts:  32%|███▏      | 130/401 [00:31<00:23, 11.44it/s, est. speed input: 3875.67 toks/s, output: 557.17 toks/s]
Processed prompts:  33%|███▎      | 134/401 [00:31<00:21, 12.41it/s, est. speed input: 4018.13 toks/s, output: 572.25 toks/s]
Processed prompts:  34%|███▍      | 136/401 [00:32<00:21, 12.08it/s, est. speed input: 4040.02 toks/s, output: 578.87 toks/s]
Processed prompts:  35%|███▍      | 139/401 [00:32<00:21, 12.28it/s, est. speed input: 4096.80 toks/s, output: 589.49 toks/s]
Processed prompts:  35%|███▌      | 141/401 [00:32<00:25, 10.09it/s, est. speed input: 4106.78 toks/s, output: 593.42 toks/s]
Processed prompts:  36%|███▋      | 146/401 [00:32<00:21, 12.06it/s, est. speed input: 4220.19 toks/s, output: 612.46 toks/s]
Processed prompts:  37%|███▋      | 149/401 [00:33<00:17, 14.25it/s, est. speed input: 4303.15 toks/s, output: 625.39 toks/s]
Processed prompts:  38%|███▊      | 153/401 [00:33<00:13, 18.05it/s, est. speed input: 4439.77 toks/s, output: 643.42 toks/s]
Processed prompts:  40%|████      | 161/401 [00:33<00:08, 28.92it/s, est. speed input: 4773.92 toks/s, output: 681.71 toks/s]
Processed prompts:  41%|████      | 165/401 [00:33<00:07, 30.90it/s, est. speed input: 4847.22 toks/s, output: 699.99 toks/s]
Processed prompts:  42%|████▏     | 169/401 [00:33<00:07, 32.66it/s, est. speed input: 4953.01 toks/s, output: 718.42 toks/s]
Processed prompts:  44%|████▎     | 175/401 [00:33<00:05, 39.01it/s, est. speed input: 5145.99 toks/s, output: 747.27 toks/s]
Processed prompts:  45%|████▌     | 181/401 [00:33<00:04, 44.28it/s, est. speed input: 5333.04 toks/s, output: 776.35 toks/s]
Processed prompts:  47%|████▋     | 187/401 [00:33<00:04, 43.41it/s, est. speed input: 5504.69 toks/s, output: 804.64 toks/s]
Processed prompts:  48%|████▊     | 192/401 [00:34<00:06, 33.71it/s, est. speed input: 5627.60 toks/s, output: 826.02 toks/s]
Processed prompts:  51%|█████     | 203/401 [00:34<00:04, 46.11it/s, est. speed input: 5919.69 toks/s, output: 882.69 toks/s]
Processed prompts:  53%|█████▎    | 211/401 [00:34<00:03, 49.77it/s, est. speed input: 6165.44 toks/s, output: 923.35 toks/s]
Processed prompts:  55%|█████▍    | 220/401 [00:34<00:03, 55.14it/s, est. speed input: 6421.55 toks/s, output: 970.28 toks/s]
Processed prompts:  57%|█████▋    | 227/401 [00:34<00:03, 50.73it/s, est. speed input: 6657.55 toks/s, output: 1005.16 toks/s]
Processed prompts:  58%|█████▊    | 233/401 [00:34<00:03, 46.32it/s, est. speed input: 6802.01 toks/s, output: 1034.85 toks/s]
Processed prompts:  59%|█████▉    | 238/401 [00:35<00:05, 31.75it/s, est. speed input: 6881.15 toks/s, output: 1054.80 toks/s]
Processed prompts:  60%|██████    | 242/401 [00:35<00:06, 24.07it/s, est. speed input: 6946.33 toks/s, output: 1069.67 toks/s]
Processed prompts:  61%|██████▏   | 246/401 [00:35<00:06, 24.38it/s, est. speed input: 7035.68 toks/s, output: 1089.80 toks/s]
Processed prompts:  62%|██████▏   | 249/401 [00:35<00:06, 23.16it/s, est. speed input: 7082.29 toks/s, output: 1103.89 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [00:35<00:06, 23.68it/s, est. speed input: 7165.81 toks/s, output: 1116.34 toks/s]
Processed prompts:  64%|██████▎   | 255/401 [00:36<00:12, 11.47it/s, est. speed input: 7114.24 toks/s, output: 1104.70 toks/s]
Processed prompts:  64%|██████▍   | 257/401 [00:36<00:11, 12.25it/s, est. speed input: 7127.27 toks/s, output: 1107.75 toks/s]
Processed prompts:  65%|██████▍   | 259/401 [00:36<00:10, 13.08it/s, est. speed input: 7146.53 toks/s, output: 1111.47 toks/s]
Processed prompts:  65%|██████▌   | 261/401 [00:36<00:10, 13.12it/s, est. speed input: 7159.03 toks/s, output: 1113.35 toks/s]
Processed prompts:  66%|██████▌   | 263/401 [00:37<00:11, 12.42it/s, est. speed input: 7161.06 toks/s, output: 1114.65 toks/s]
Processed prompts:  67%|██████▋   | 268/401 [00:37<00:07, 17.62it/s, est. speed input: 7284.38 toks/s, output: 1126.35 toks/s]
Processed prompts:  68%|██████▊   | 271/401 [00:37<00:07, 18.32it/s, est. speed input: 7344.60 toks/s, output: 1133.62 toks/s]
Processed prompts:  69%|██████▊   | 275/401 [00:37<00:05, 22.51it/s, est. speed input: 7415.92 toks/s, output: 1145.64 toks/s]
Processed prompts:  70%|███████   | 281/401 [00:37<00:04, 28.86it/s, est. speed input: 7595.04 toks/s, output: 1168.22 toks/s]
Processed prompts:  71%|███████   | 285/401 [00:37<00:04, 27.59it/s, est. speed input: 7674.92 toks/s, output: 1178.26 toks/s]
Processed prompts:  73%|███████▎  | 293/401 [00:37<00:02, 37.25it/s, est. speed input: 7864.34 toks/s, output: 1204.94 toks/s]
Processed prompts:  75%|███████▌  | 302/401 [00:38<00:02, 41.87it/s, est. speed input: 8110.57 toks/s, output: 1239.07 toks/s]
Processed prompts:  77%|███████▋  | 310/401 [00:38<00:01, 48.66it/s, est. speed input: 8314.07 toks/s, output: 1268.10 toks/s]
Processed prompts:  81%|████████  | 323/401 [00:38<00:01, 66.05it/s, est. speed input: 8720.85 toks/s, output: 1318.54 toks/s]
Processed prompts:  83%|████████▎ | 331/401 [00:38<00:01, 64.87it/s, est. speed input: 8958.41 toks/s, output: 1350.79 toks/s]
Processed prompts:  85%|████████▍ | 340/401 [00:38<00:00, 67.43it/s, est. speed input: 9247.91 toks/s, output: 1390.84 toks/s]
Processed prompts:  87%|████████▋ | 350/401 [00:38<00:00, 72.78it/s, est. speed input: 9450.00 toks/s, output: 1432.08 toks/s]
Processed prompts:  90%|█████████ | 361/401 [00:38<00:00, 80.29it/s, est. speed input: 9789.89 toks/s, output: 1476.39 toks/s]
Processed prompts:  92%|█████████▏| 370/401 [00:38<00:00, 70.36it/s, est. speed input: 10043.66 toks/s, output: 1512.63 toks/s]
Processed prompts:  94%|█████████▍| 378/401 [00:39<00:00, 66.99it/s, est. speed input: 10224.80 toks/s, output: 1547.17 toks/s]
Processed prompts:  96%|█████████▌| 385/401 [00:39<00:00, 65.59it/s, est. speed input: 10396.51 toks/s, output: 1577.72 toks/s]
Processed prompts:  98%|█████████▊| 392/401 [00:39<00:00, 36.65it/s, est. speed input: 10542.17 toks/s, output: 1598.78 toks/s]
Processed prompts:  99%|█████████▉| 398/401 [00:40<00:00, 13.99it/s, est. speed input: 10414.24 toks/s, output: 1593.69 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:43<00:00,  9.14it/s, est. speed input: 9840.06 toks/s, output: 1519.43 toks/s] 
{  "personalized_answer": "Based on your past interest in Hebrew and Aramaic texts, it seems you are looking to understand the formatting styles in Hebrew/Aramaic texts from Sefaria. These styles serve various purposes, such as clarifying text, adding context, and maintaining traditional formatting. Here's a breakdown of the elements you've noticed:\n\n1. **Quotes (' and "")**: These are used to denote speech or direct quotes within the text. They help distinguish between the main text and quoted material.\n2. **Parentheses (small and large)**: Small parentheses are often used for footnotes or additional information, while large parentheses are used for more significant clarifications or to introduce a new section.\n3. **Bold Text**: Bold text is typically used to highlight names, important terms, or to emphasize certain words. In your examples, it appears to be used for names like 'ר' אהרן' and 'ר' אשר'.\n4. **Italics**: Italics are used to denote specific terms, names, or to highlight certain phrases. They can also be used for titles or to indicate a shift in context.\n5. **Brackets and Parentheses**: These are used to include additional information, such as references to other texts or to provide context. For example, [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] is a bracketed reference to a specific verse.\n6. **Hyphens**: Hyphens are used to connect words that are split across lines, ensuring the meaning of the word is clear.\n\nTo remove or change these elements, you can use text processing tools or scripts to strip out these formatting styles. However, it's important to note that these styles are part of the traditional formatting and can provide valuable context. If you want to remove them, you might consider using a tool that preserves the original text while removing these modern additions. For example, you could use a script to remove all non-Hebrew characters and punctuation, leaving only the core text.\n\nIf you're interested in the historical formatting of Hebrew texts, you might want to look at examples of Torah scrolls or traditional Hebrew books. These often have a more uniform and less cluttered appearance, with minimal punctuation and no modern formatting elements."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.29s/it, est. speed input: 712.28 toks/s, output: 80.49 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.29s/it, est. speed input: 712.28 toks/s, output: 80.49 toks/s]
[rank0]:[W709 16:02:05.870744103 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/ae_rag_lp_sc_test_4_output.json
Cleaned temporary files.
Keeping ['ae', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 16:02:08.987251_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 16:02:08.987251_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 16:02:08.987251_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:28,  3.55it/s]
  1%|          | 3/526 [00:00<00:58,  8.87it/s]
  1%|          | 6/526 [00:00<00:33, 15.50it/s]
  2%|▏         | 9/526 [00:00<00:30, 16.99it/s]
  2%|▏         | 12/526 [00:00<00:25, 19.93it/s]
  3%|▎         | 15/526 [00:01<00:36, 14.02it/s]
  3%|▎         | 17/526 [00:01<00:38, 13.34it/s]
  4%|▍         | 20/526 [00:01<00:34, 14.82it/s]
  4%|▍         | 22/526 [00:01<00:56,  8.96it/s]
  5%|▍         | 24/526 [00:02<00:51,  9.66it/s]
  5%|▍         | 26/526 [00:03<01:52,  4.45it/s]
  5%|▌         | 28/526 [00:03<01:31,  5.42it/s]
  6%|▌         | 30/526 [00:04<02:32,  3.25it/s]
  6%|▌         | 31/526 [00:04<02:44,  3.01it/s]
  6%|▌         | 32/526 [00:05<02:32,  3.23it/s]
  6%|▋         | 33/526 [00:06<04:06,  2.00it/s]
  6%|▋         | 34/526 [00:07<04:21,  1.88it/s]
  7%|▋         | 35/526 [00:07<04:59,  1.64it/s]
  7%|▋         | 36/526 [00:08<03:57,  2.06it/s]
  7%|▋         | 37/526 [00:08<03:20,  2.44it/s]
  8%|▊         | 40/526 [00:08<01:48,  4.48it/s]
  8%|▊         | 43/526 [00:08<01:32,  5.20it/s]
  9%|▊         | 45/526 [00:09<01:15,  6.41it/s]
  9%|▊         | 46/526 [00:09<01:22,  5.84it/s]
  9%|▉         | 47/526 [00:09<01:20,  5.94it/s]
  9%|▉         | 48/526 [00:09<01:31,  5.20it/s]
 10%|▉         | 50/526 [00:09<01:15,  6.29it/s]
 10%|▉         | 52/526 [00:10<01:01,  7.65it/s]
 10%|█         | 53/526 [00:11<02:42,  2.90it/s]
 10%|█         | 54/526 [00:14<07:56,  1.01s/it]
 11%|█         | 57/526 [00:14<04:09,  1.88it/s]
 11%|█         | 59/526 [00:15<04:09,  1.87it/s]
 11%|█▏        | 60/526 [00:16<04:15,  1.82it/s]
 12%|█▏        | 61/526 [00:16<04:20,  1.78it/s]
 12%|█▏        | 62/526 [00:17<04:29,  1.72it/s]
 12%|█▏        | 63/526 [00:18<05:04,  1.52it/s]
 12%|█▏        | 65/526 [00:18<03:11,  2.41it/s]
 13%|█▎        | 66/526 [00:18<02:47,  2.75it/s]
 13%|█▎        | 67/526 [00:18<02:19,  3.30it/s]
 13%|█▎        | 68/526 [00:19<03:35,  2.13it/s]
 13%|█▎        | 70/526 [00:20<03:33,  2.13it/s]
 13%|█▎        | 71/526 [00:21<03:26,  2.20it/s]
 14%|█▍        | 73/526 [00:21<02:58,  2.54it/s]
 14%|█▍        | 74/526 [00:22<03:47,  1.99it/s]
 14%|█▍        | 76/526 [00:22<02:32,  2.96it/s]
 15%|█▍        | 78/526 [00:23<02:50,  2.62it/s]
 15%|█▌        | 80/526 [00:24<02:15,  3.28it/s]
 16%|█▌        | 84/526 [00:24<01:17,  5.69it/s]
 16%|█▋        | 86/526 [00:25<02:28,  2.96it/s]
 17%|█▋        | 87/526 [00:25<02:12,  3.31it/s]
 17%|█▋        | 88/526 [00:26<02:02,  3.59it/s]
 17%|█▋        | 89/526 [00:26<02:06,  3.45it/s]
 17%|█▋        | 91/526 [00:26<01:33,  4.67it/s]
 17%|█▋        | 92/526 [00:26<01:25,  5.10it/s]
 18%|█▊        | 94/526 [00:26<01:04,  6.70it/s]
 18%|█▊        | 96/526 [00:27<00:59,  7.22it/s]
 18%|█▊        | 97/526 [00:27<01:38,  4.34it/s]
 19%|█▊        | 98/526 [00:30<05:26,  1.31it/s]
 19%|█▉        | 99/526 [00:32<07:16,  1.02s/it]
 19%|█▉        | 101/526 [00:32<04:33,  1.55it/s]
 20%|█▉        | 103/526 [00:32<03:22,  2.08it/s]
 20%|█▉        | 104/526 [00:34<04:25,  1.59it/s]
 20%|██        | 106/526 [00:34<03:00,  2.32it/s]
 21%|██        | 108/526 [00:34<02:17,  3.05it/s]
 21%|██        | 109/526 [00:34<02:04,  3.34it/s]
 21%|██        | 110/526 [00:35<02:17,  3.03it/s]
 21%|██        | 111/526 [00:35<02:27,  2.82it/s]
 21%|██▏       | 112/526 [00:35<02:33,  2.70it/s]
 22%|██▏       | 114/526 [00:36<01:43,  4.00it/s]
 22%|██▏       | 116/526 [00:36<01:14,  5.53it/s]
 23%|██▎       | 119/526 [00:36<00:58,  7.01it/s]
 23%|██▎       | 120/526 [00:36<00:55,  7.32it/s]
 23%|██▎       | 121/526 [00:36<01:00,  6.69it/s]
 24%|██▎       | 124/526 [00:38<01:49,  3.67it/s]
 24%|██▍       | 126/526 [00:38<01:22,  4.84it/s]
 24%|██▍       | 127/526 [00:38<01:17,  5.14it/s]
 24%|██▍       | 128/526 [00:38<01:10,  5.63it/s]
 25%|██▍       | 129/526 [00:38<01:09,  5.73it/s]
 25%|██▍       | 130/526 [00:38<01:07,  5.87it/s]
 25%|██▍       | 131/526 [00:38<01:10,  5.64it/s]
 25%|██▌       | 133/526 [00:39<00:54,  7.24it/s]
 26%|██▌       | 135/526 [00:39<00:44,  8.84it/s]
 26%|██▌       | 136/526 [00:39<00:55,  7.03it/s]
 26%|██▌       | 138/526 [00:39<00:53,  7.23it/s]
 27%|██▋       | 141/526 [00:39<00:37, 10.28it/s]
 27%|██▋       | 143/526 [00:40<00:39,  9.76it/s]
 28%|██▊       | 145/526 [00:40<00:35, 10.82it/s]
 28%|██▊       | 147/526 [00:40<00:41,  9.06it/s]
 28%|██▊       | 149/526 [00:40<00:39,  9.59it/s]
 29%|██▊       | 151/526 [00:40<00:33, 11.30it/s]
 29%|██▉       | 153/526 [00:41<00:29, 12.57it/s]
 29%|██▉       | 155/526 [00:41<01:02,  5.91it/s]
 30%|██▉       | 157/526 [00:42<00:56,  6.59it/s]
 30%|███       | 160/526 [00:42<01:05,  5.60it/s]
 31%|███       | 161/526 [00:42<01:06,  5.53it/s]
 31%|███       | 162/526 [00:44<02:59,  2.03it/s]
 31%|███▏      | 165/526 [00:44<01:46,  3.40it/s]
 32%|███▏      | 167/526 [00:44<01:21,  4.41it/s]
 32%|███▏      | 170/526 [00:45<00:54,  6.54it/s]
 33%|███▎      | 172/526 [00:47<02:14,  2.64it/s]
 33%|███▎      | 174/526 [00:47<01:53,  3.11it/s]
 33%|███▎      | 176/526 [00:47<01:34,  3.71it/s]
 34%|███▍      | 178/526 [00:47<01:14,  4.65it/s]
 34%|███▍      | 180/526 [00:48<01:00,  5.74it/s]
 35%|███▍      | 182/526 [00:48<01:31,  3.75it/s]
 35%|███▍      | 184/526 [00:49<01:27,  3.91it/s]
 35%|███▌      | 186/526 [00:50<02:13,  2.55it/s]
 36%|███▌      | 187/526 [00:51<02:00,  2.82it/s]
 36%|███▌      | 188/526 [00:51<01:48,  3.13it/s]
 36%|███▌      | 190/526 [00:51<01:16,  4.39it/s]
 36%|███▋      | 191/526 [00:51<01:10,  4.72it/s]
 37%|███▋      | 192/526 [00:51<01:03,  5.23it/s]
 37%|███▋      | 196/526 [00:51<00:32, 10.18it/s]
 38%|███▊      | 198/526 [00:51<00:34,  9.60it/s]
 38%|███▊      | 200/526 [00:53<01:56,  2.80it/s]
 38%|███▊      | 202/526 [00:54<01:50,  2.93it/s]
 39%|███▊      | 203/526 [00:55<02:00,  2.68it/s]
 39%|███▉      | 205/526 [00:55<01:25,  3.75it/s]
 39%|███▉      | 207/526 [00:55<01:05,  4.87it/s]
 40%|███▉      | 210/526 [00:55<00:43,  7.28it/s]
 40%|████      | 212/526 [00:56<01:11,  4.39it/s]
 41%|████      | 215/526 [00:56<00:51,  6.06it/s]
 41%|████▏     | 217/526 [00:57<01:16,  4.04it/s]
 41%|████▏     | 218/526 [00:58<01:36,  3.20it/s]
 42%|████▏     | 219/526 [00:58<01:45,  2.91it/s]
 42%|████▏     | 222/526 [00:58<01:04,  4.68it/s]
 43%|████▎     | 224/526 [00:59<00:55,  5.45it/s]
 43%|████▎     | 228/526 [00:59<00:33,  8.98it/s]
 44%|████▎     | 230/526 [00:59<00:29,  9.90it/s]
 44%|████▍     | 232/526 [00:59<00:48,  6.11it/s]
 44%|████▍     | 234/526 [01:00<00:40,  7.29it/s]
 45%|████▍     | 236/526 [01:00<00:36,  7.88it/s]
 45%|████▌     | 238/526 [01:00<00:40,  7.07it/s]
 46%|████▌     | 241/526 [01:00<00:31,  8.96it/s]
 46%|████▌     | 243/526 [01:00<00:28,  9.85it/s]
 47%|████▋     | 245/526 [01:02<01:01,  4.59it/s]
 47%|████▋     | 247/526 [01:02<00:53,  5.23it/s]
 47%|████▋     | 248/526 [01:02<01:01,  4.51it/s]
 47%|████▋     | 249/526 [01:03<01:24,  3.27it/s]
 48%|████▊     | 250/526 [01:03<01:12,  3.79it/s]
 48%|████▊     | 251/526 [01:03<01:06,  4.14it/s]
 48%|████▊     | 252/526 [01:03<01:02,  4.36it/s]
 48%|████▊     | 253/526 [01:03<00:58,  4.70it/s]
 48%|████▊     | 255/526 [01:04<01:23,  3.24it/s]
 49%|████▊     | 256/526 [01:04<01:13,  3.65it/s]
 49%|████▉     | 258/526 [01:05<00:55,  4.87it/s]
 49%|████▉     | 260/526 [01:05<00:42,  6.31it/s]
 50%|████▉     | 261/526 [01:05<00:40,  6.59it/s]
 50%|█████     | 263/526 [01:06<01:03,  4.14it/s]
 50%|█████     | 264/526 [01:06<01:30,  2.90it/s]
 50%|█████     | 265/526 [01:07<01:17,  3.35it/s]
 51%|█████     | 266/526 [01:07<01:27,  2.98it/s]
 51%|█████     | 267/526 [01:08<01:34,  2.75it/s]
 51%|█████     | 268/526 [01:08<01:18,  3.31it/s]
 51%|█████▏    | 270/526 [01:08<00:52,  4.87it/s]
 52%|█████▏    | 271/526 [01:08<00:49,  5.12it/s]
 52%|█████▏    | 272/526 [01:08<01:07,  3.79it/s]
 52%|█████▏    | 273/526 [01:09<01:17,  3.27it/s]
 52%|█████▏    | 274/526 [01:09<01:22,  3.06it/s]
 52%|█████▏    | 275/526 [01:11<03:07,  1.34it/s]
 52%|█████▏    | 276/526 [01:11<02:25,  1.72it/s]
 53%|█████▎    | 277/526 [01:11<01:55,  2.16it/s]
 53%|█████▎    | 279/526 [01:13<02:49,  1.46it/s]
 53%|█████▎    | 280/526 [01:15<03:56,  1.04it/s]
 53%|█████▎    | 281/526 [01:17<04:53,  1.20s/it]
 54%|█████▎    | 282/526 [01:19<05:34,  1.37s/it]
 54%|█████▍    | 283/526 [01:21<06:05,  1.50s/it]
 54%|█████▍    | 284/526 [01:23<06:28,  1.60s/it]
 54%|█████▍    | 285/526 [01:23<04:56,  1.23s/it]
 54%|█████▍    | 286/526 [01:24<04:25,  1.11s/it]
 55%|█████▍    | 287/526 [01:24<03:17,  1.21it/s]
 55%|█████▍    | 289/526 [01:24<01:53,  2.10it/s]
 55%|█████▌    | 291/526 [01:24<01:29,  2.63it/s]
 56%|█████▌    | 292/526 [01:25<01:18,  2.97it/s]
 56%|█████▌    | 294/526 [01:25<00:56,  4.13it/s]
 56%|█████▌    | 295/526 [01:25<00:49,  4.69it/s]
 56%|█████▋    | 296/526 [01:25<00:43,  5.30it/s]
 57%|█████▋    | 298/526 [01:28<02:29,  1.53it/s]
 57%|█████▋    | 299/526 [01:30<04:07,  1.09s/it]
 57%|█████▋    | 300/526 [01:31<04:13,  1.12s/it]
 57%|█████▋    | 301/526 [01:32<04:03,  1.08s/it]
 57%|█████▋    | 302/526 [01:34<04:08,  1.11s/it]
 58%|█████▊    | 303/526 [01:35<04:11,  1.13s/it]
 58%|█████▊    | 304/526 [01:35<03:06,  1.19it/s]
 58%|█████▊    | 305/526 [01:36<03:28,  1.06it/s]
 58%|█████▊    | 306/526 [01:37<03:43,  1.02s/it]
 58%|█████▊    | 307/526 [01:39<03:55,  1.08s/it]
 59%|█████▊    | 308/526 [01:40<04:11,  1.16s/it]
 59%|█████▊    | 309/526 [01:40<03:04,  1.17it/s]
 59%|█████▉    | 310/526 [01:41<02:51,  1.26it/s]
 59%|█████▉    | 311/526 [01:41<02:07,  1.69it/s]
 59%|█████▉    | 312/526 [01:42<02:46,  1.28it/s]
 60%|█████▉    | 313/526 [01:43<03:11,  1.11it/s]
 60%|█████▉    | 314/526 [01:45<03:37,  1.03s/it]
 60%|█████▉    | 315/526 [01:48<05:45,  1.64s/it]
 60%|██████    | 317/526 [01:48<03:27,  1.01it/s]
 60%|██████    | 318/526 [01:48<02:56,  1.18it/s]
 61%|██████    | 319/526 [01:49<02:24,  1.43it/s]
 61%|██████    | 321/526 [01:50<02:24,  1.42it/s]
 61%|██████    | 322/526 [01:50<02:02,  1.66it/s]
 62%|██████▏   | 324/526 [01:51<01:20,  2.51it/s]
 62%|██████▏   | 326/526 [01:51<00:57,  3.49it/s]
 62%|██████▏   | 327/526 [01:51<00:53,  3.75it/s]
 62%|██████▏   | 328/526 [01:51<00:46,  4.22it/s]
 63%|██████▎   | 330/526 [01:51<00:32,  6.06it/s]
 63%|██████▎   | 332/526 [01:52<00:40,  4.74it/s]
 63%|██████▎   | 334/526 [01:53<01:05,  2.92it/s]
 64%|██████▎   | 335/526 [01:53<01:02,  3.04it/s]
 64%|██████▍   | 336/526 [01:54<01:38,  1.94it/s]
 64%|██████▍   | 337/526 [01:55<01:36,  1.97it/s]
 64%|██████▍   | 339/526 [01:55<01:14,  2.52it/s]
 65%|██████▍   | 340/526 [01:57<02:15,  1.38it/s]
 65%|██████▌   | 342/526 [01:58<01:28,  2.07it/s]
 65%|██████▌   | 343/526 [01:58<01:34,  1.93it/s]
 66%|██████▌   | 345/526 [02:01<02:48,  1.07it/s]
 66%|██████▌   | 346/526 [02:03<03:22,  1.12s/it]
 66%|██████▌   | 347/526 [02:06<04:48,  1.61s/it]
 66%|██████▌   | 348/526 [02:07<03:54,  1.32s/it]
 66%|██████▋   | 349/526 [02:07<03:07,  1.06s/it]
 67%|██████▋   | 350/526 [02:10<04:53,  1.67s/it]
 67%|██████▋   | 351/526 [02:12<04:59,  1.71s/it]
 67%|██████▋   | 352/526 [02:12<03:39,  1.26s/it]
 67%|██████▋   | 354/526 [02:13<02:04,  1.39it/s]
 67%|██████▋   | 355/526 [02:13<01:47,  1.60it/s]
 68%|██████▊   | 357/526 [02:13<01:14,  2.26it/s]
 68%|██████▊   | 358/526 [02:13<01:08,  2.47it/s]
 68%|██████▊   | 360/526 [02:14<00:46,  3.59it/s]
 69%|██████▊   | 361/526 [02:14<00:41,  3.98it/s]
 69%|██████▉   | 363/526 [02:14<00:44,  3.68it/s]
 69%|██████▉   | 364/526 [02:15<00:41,  3.88it/s]
 69%|██████▉   | 365/526 [02:15<00:45,  3.51it/s]
 70%|██████▉   | 366/526 [02:17<01:36,  1.65it/s]
 70%|██████▉   | 368/526 [02:17<01:01,  2.55it/s]
 70%|███████   | 369/526 [02:17<00:56,  2.79it/s]
 70%|███████   | 370/526 [02:20<02:49,  1.09s/it]
 71%|███████   | 371/526 [02:24<04:15,  1.65s/it]
 71%|███████   | 372/526 [02:27<05:20,  2.08s/it]
 71%|███████▏  | 375/526 [02:30<03:54,  1.55s/it]
 71%|███████▏  | 376/526 [02:30<03:08,  1.26s/it]
 72%|███████▏  | 378/526 [02:30<02:01,  1.22it/s]
 72%|███████▏  | 379/526 [02:31<01:46,  1.38it/s]
 72%|███████▏  | 381/526 [02:34<02:35,  1.07s/it]
 73%|███████▎  | 382/526 [02:34<02:06,  1.13it/s]
 73%|███████▎  | 383/526 [02:34<01:48,  1.32it/s]
 73%|███████▎  | 384/526 [02:38<03:13,  1.36s/it]
 73%|███████▎  | 385/526 [02:41<04:20,  1.85s/it]
 73%|███████▎  | 386/526 [02:41<03:24,  1.46s/it]
 74%|███████▍  | 388/526 [02:42<01:59,  1.16it/s]
 74%|███████▍  | 389/526 [02:42<01:50,  1.24it/s]
 74%|███████▍  | 390/526 [02:43<01:42,  1.33it/s]
 75%|███████▍  | 393/526 [02:43<00:52,  2.55it/s]
 75%|███████▌  | 396/526 [02:43<00:32,  4.05it/s]
 76%|███████▌  | 398/526 [02:43<00:26,  4.89it/s]
 76%|███████▌  | 400/526 [02:47<01:20,  1.57it/s]
 76%|███████▌  | 401/526 [02:50<02:15,  1.08s/it]
 76%|███████▋  | 402/526 [02:50<01:52,  1.10it/s]
 77%|███████▋  | 403/526 [02:50<01:31,  1.34it/s]
 77%|███████▋  | 404/526 [02:50<01:14,  1.63it/s]
 77%|███████▋  | 406/526 [02:53<01:52,  1.07it/s]
 78%|███████▊  | 408/526 [02:53<01:14,  1.58it/s]
 78%|███████▊  | 409/526 [02:54<01:13,  1.60it/s]
 78%|███████▊  | 411/526 [02:57<01:57,  1.02s/it]
 79%|███████▊  | 413/526 [02:58<01:17,  1.46it/s]
 79%|███████▉  | 415/526 [02:58<00:57,  1.94it/s]
 79%|███████▉  | 417/526 [02:58<00:44,  2.47it/s]
 79%|███████▉  | 418/526 [03:00<01:02,  1.72it/s]
 80%|███████▉  | 420/526 [03:00<00:42,  2.47it/s]
 80%|████████  | 421/526 [03:02<01:18,  1.34it/s]
 80%|████████  | 423/526 [03:02<00:55,  1.85it/s]
 81%|████████  | 426/526 [03:02<00:34,  2.93it/s]
 81%|████████▏ | 428/526 [03:03<00:25,  3.79it/s]
 82%|████████▏ | 430/526 [03:03<00:19,  4.82it/s]
 82%|████████▏ | 432/526 [03:03<00:20,  4.59it/s]
 82%|████████▏ | 433/526 [03:03<00:19,  4.80it/s]
 83%|████████▎ | 435/526 [03:06<00:47,  1.92it/s]
 83%|████████▎ | 436/526 [03:06<00:44,  2.01it/s]
 83%|████████▎ | 438/526 [03:07<00:35,  2.48it/s]
 83%|████████▎ | 439/526 [03:07<00:39,  2.22it/s]
 84%|████████▎ | 440/526 [03:08<00:40,  2.10it/s]
 84%|████████▍ | 442/526 [03:08<00:29,  2.87it/s]
 84%|████████▍ | 444/526 [03:10<00:41,  1.97it/s]
 85%|████████▍ | 445/526 [03:11<00:58,  1.39it/s]
 85%|████████▍ | 447/526 [03:12<00:41,  1.91it/s]
 85%|████████▌ | 448/526 [03:12<00:35,  2.21it/s]
 86%|████████▌ | 450/526 [03:12<00:23,  3.30it/s]
 86%|████████▌ | 453/526 [03:12<00:13,  5.43it/s]
 87%|████████▋ | 455/526 [03:12<00:12,  5.59it/s]
 87%|████████▋ | 457/526 [03:12<00:09,  7.02it/s]
 87%|████████▋ | 459/526 [03:13<00:08,  7.76it/s]
 88%|████████▊ | 461/526 [03:13<00:08,  7.50it/s]
 88%|████████▊ | 463/526 [03:13<00:08,  7.68it/s]
 88%|████████▊ | 465/526 [03:13<00:08,  7.58it/s]
 89%|████████▊ | 466/526 [03:14<00:08,  7.01it/s]
 89%|████████▉ | 467/526 [03:14<00:09,  6.25it/s]
 89%|████████▉ | 468/526 [03:14<00:08,  6.69it/s]
 89%|████████▉ | 470/526 [03:14<00:06,  8.45it/s]
 90%|████████▉ | 472/526 [03:15<00:08,  6.47it/s]
 90%|█████████ | 475/526 [03:15<00:09,  5.23it/s]
 90%|█████████ | 476/526 [03:15<00:09,  5.19it/s]
 91%|█████████ | 479/526 [03:16<00:09,  5.08it/s]
 91%|█████████▏| 480/526 [03:16<00:09,  4.92it/s]
 91%|█████████▏| 481/526 [03:17<00:17,  2.53it/s]
 92%|█████████▏| 482/526 [03:18<00:16,  2.71it/s]
 92%|█████████▏| 484/526 [03:18<00:12,  3.47it/s]
 92%|█████████▏| 486/526 [03:18<00:08,  4.54it/s]
 93%|█████████▎| 488/526 [03:18<00:06,  6.08it/s]
 93%|█████████▎| 490/526 [03:18<00:04,  7.82it/s]
 94%|█████████▎| 492/526 [03:19<00:03,  9.14it/s]
 94%|█████████▍| 494/526 [03:21<00:13,  2.38it/s]
 94%|█████████▍| 495/526 [03:21<00:11,  2.63it/s]
 94%|█████████▍| 496/526 [03:21<00:09,  3.05it/s]
 94%|█████████▍| 497/526 [03:21<00:08,  3.23it/s]
 95%|█████████▍| 498/526 [03:23<00:17,  1.60it/s]
 95%|█████████▍| 499/526 [03:25<00:24,  1.10it/s]
 95%|█████████▌| 501/526 [03:25<00:14,  1.75it/s]
 96%|█████████▌| 504/526 [03:25<00:07,  2.99it/s]
 96%|█████████▌| 505/526 [03:25<00:06,  3.08it/s]
 96%|█████████▌| 506/526 [03:26<00:05,  3.37it/s]
 97%|█████████▋| 508/526 [03:26<00:04,  3.67it/s]
 97%|█████████▋| 510/526 [03:27<00:04,  3.90it/s]
 97%|█████████▋| 511/526 [03:27<00:04,  3.45it/s]
 97%|█████████▋| 512/526 [03:27<00:03,  3.86it/s]
 98%|█████████▊| 513/526 [03:28<00:04,  2.88it/s]
 98%|█████████▊| 514/526 [03:28<00:04,  2.98it/s]
 98%|█████████▊| 515/526 [03:28<00:03,  3.21it/s]
 98%|█████████▊| 516/526 [03:28<00:02,  3.76it/s]
 98%|█████████▊| 517/526 [03:29<00:02,  3.82it/s]
 98%|█████████▊| 518/526 [03:29<00:01,  4.31it/s]
 99%|█████████▊| 519/526 [03:29<00:01,  4.78it/s]
 99%|█████████▉| 520/526 [03:30<00:02,  2.92it/s]
 99%|█████████▉| 522/526 [03:33<00:03,  1.05it/s]
 99%|█████████▉| 523/526 [03:36<00:04,  1.51s/it]
100%|█████████▉| 524/526 [03:40<00:03,  1.99s/it]
100%|█████████▉| 525/526 [03:40<00:01,  1.50s/it]
100%|██████████| 526/526 [03:43<00:00,  2.00s/it]
100%|██████████| 526/526 [03:43<00:00,  2.35it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 16:02:08.987251_lp_processed_test.json', '--output_addr', 'data/out/rag/asym/lp_rag_ae_sc_test_4_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '4', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  4.54 examples/s]
Generating train split: 526 examples [00:00, 1221.87 examples/s]
INFO 07-09 16:06:18 config.py:510] This model supports multiple tasks: {'reward', 'embed', 'score', 'generate', 'classify'}. Defaulting to 'generate'.
INFO 07-09 16:06:18 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:06:20 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:06:21 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:06:21 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.44it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.29it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.29it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.28it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.29it/s]

INFO 07-09 16:06:25 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:06:27 worker.py:241] Memory profiling takes 2.11 seconds
INFO 07-09 16:06:27 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:06:27 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:06:27 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:06:27 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:06:30 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  2.86it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:10,  3.27it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.43it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.51it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.56it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.59it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.62it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.63it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.63it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.63it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.65it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.67it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.68it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.69it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.69it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.70it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.73it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.77it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.79it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.81it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.82it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.84it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.85it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.73it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.78it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.82it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.85it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.85it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.89it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.91it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.82it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.86it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.82it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.86it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.90it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.73it/s]
INFO 07-09 16:06:39 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 16:06:39 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.43 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:18<2:42:18, 18.55s/it, est. speed input: 28.84 toks/s, output: 5.39 toks/s]
Processed prompts:   1%|          | 3/526 [00:19<43:39,  5.01s/it, est. speed input: 101.01 toks/s, output: 16.14 toks/s]
Processed prompts:   1%|          | 4/526 [00:19<29:20,  3.37s/it, est. speed input: 146.27 toks/s, output: 21.63 toks/s]
Processed prompts:   1%|          | 5/526 [00:19<20:00,  2.30s/it, est. speed input: 169.05 toks/s, output: 27.22 toks/s]
Processed prompts:   1%|          | 6/526 [00:19<14:09,  1.63s/it, est. speed input: 203.37 toks/s, output: 32.70 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:19<07:47,  1.11it/s, est. speed input: 287.73 toks/s, output: 43.89 toks/s]
Processed prompts:   2%|▏         | 11/526 [00:20<04:16,  2.01it/s, est. speed input: 406.88 toks/s, output: 60.60 toks/s]
Processed prompts:   3%|▎         | 14/526 [00:20<02:46,  3.08it/s, est. speed input: 501.16 toks/s, output: 77.26 toks/s]
Processed prompts:   3%|▎         | 17/526 [00:20<02:06,  4.02it/s, est. speed input: 594.98 toks/s, output: 93.40 toks/s]
Processed prompts:   4%|▎         | 19/526 [00:20<01:39,  5.08it/s, est. speed input: 645.36 toks/s, output: 104.72 toks/s]
Processed prompts:   5%|▍         | 25/526 [00:21<01:06,  7.49it/s, est. speed input: 828.17 toks/s, output: 137.21 toks/s]
Processed prompts:   6%|▌         | 30/526 [00:21<00:51,  9.62it/s, est. speed input: 993.53 toks/s, output: 164.23 toks/s]
Processed prompts:   6%|▋         | 34/526 [00:22<00:48, 10.19it/s, est. speed input: 1110.94 toks/s, output: 184.59 toks/s]
Processed prompts:   7%|▋         | 36/526 [00:22<00:45, 10.88it/s, est. speed input: 1172.15 toks/s, output: 195.03 toks/s]
Processed prompts:   7%|▋         | 38/526 [00:22<00:44, 10.85it/s, est. speed input: 1238.21 toks/s, output: 204.94 toks/s]
Processed prompts:   8%|▊         | 40/526 [00:22<00:43, 11.18it/s, est. speed input: 1286.80 toks/s, output: 214.97 toks/s]
Processed prompts:   8%|▊         | 43/526 [00:22<00:47, 10.23it/s, est. speed input: 1367.95 toks/s, output: 228.82 toks/s]
Processed prompts:   9%|▊         | 46/526 [00:23<00:42, 11.37it/s, est. speed input: 1485.09 toks/s, output: 243.90 toks/s]
Processed prompts:   9%|▉         | 49/526 [00:23<00:44, 10.75it/s, est. speed input: 1607.88 toks/s, output: 257.62 toks/s]
Processed prompts:  10%|▉         | 52/526 [00:23<00:39, 11.91it/s, est. speed input: 1690.97 toks/s, output: 272.49 toks/s]
Processed prompts:  10%|█         | 55/526 [00:23<00:42, 11.02it/s, est. speed input: 1773.24 toks/s, output: 285.73 toks/s]
Processed prompts:  11%|█         | 57/526 [00:24<00:38, 12.26it/s, est. speed input: 1852.56 toks/s, output: 295.86 toks/s]
Processed prompts:  11%|█         | 59/526 [00:24<00:46, 10.08it/s, est. speed input: 1894.08 toks/s, output: 303.35 toks/s]
Processed prompts:  12%|█▏        | 63/526 [00:24<00:39, 11.67it/s, est. speed input: 1993.23 toks/s, output: 322.42 toks/s]
Processed prompts:  13%|█▎        | 68/526 [00:25<00:40, 11.41it/s, est. speed input: 2136.69 toks/s, output: 344.21 toks/s]
Processed prompts:  13%|█▎        | 70/526 [00:25<00:36, 12.40it/s, est. speed input: 2196.63 toks/s, output: 353.89 toks/s]
Processed prompts:  15%|█▍        | 78/526 [00:25<00:32, 13.58it/s, est. speed input: 2390.63 toks/s, output: 390.15 toks/s]
Processed prompts:  15%|█▌        | 81/526 [00:25<00:33, 13.11it/s, est. speed input: 2443.85 toks/s, output: 402.74 toks/s]
Processed prompts:  16%|█▌        | 84/526 [00:26<00:30, 14.34it/s, est. speed input: 2525.67 toks/s, output: 416.97 toks/s]
Processed prompts:  18%|█▊        | 95/526 [00:26<00:27, 15.67it/s, est. speed input: 2806.93 toks/s, output: 466.14 toks/s]
Processed prompts:  19%|█▊        | 98/526 [00:26<00:25, 16.65it/s, est. speed input: 2884.71 toks/s, output: 480.16 toks/s]
Processed prompts:  19%|█▉        | 101/526 [00:27<00:29, 14.57it/s, est. speed input: 2949.84 toks/s, output: 490.89 toks/s]
Processed prompts:  20%|█▉        | 105/526 [00:27<00:28, 14.70it/s, est. speed input: 3046.63 toks/s, output: 507.62 toks/s]
Processed prompts:  21%|██        | 108/526 [00:27<00:31, 13.36it/s, est. speed input: 3116.61 toks/s, output: 518.30 toks/s]
Processed prompts:  21%|██▏       | 112/526 [00:27<00:29, 14.01it/s, est. speed input: 3202.19 toks/s, output: 534.94 toks/s]
Processed prompts:  22%|██▏       | 115/526 [00:28<00:31, 12.96it/s, est. speed input: 3267.53 toks/s, output: 545.52 toks/s]
Processed prompts:  23%|██▎       | 121/526 [00:28<00:26, 15.20it/s, est. speed input: 3437.35 toks/s, output: 571.60 toks/s]
Processed prompts:  23%|██▎       | 123/526 [00:28<00:30, 13.36it/s, est. speed input: 3465.34 toks/s, output: 577.46 toks/s]
Processed prompts:  24%|██▍       | 126/526 [00:29<00:33, 11.77it/s, est. speed input: 3518.94 toks/s, output: 586.59 toks/s]
Processed prompts:  24%|██▍       | 128/526 [00:29<00:36, 10.85it/s, est. speed input: 3561.91 toks/s, output: 592.41 toks/s]
Processed prompts:  25%|██▍       | 130/526 [00:29<00:34, 11.37it/s, est. speed input: 3591.26 toks/s, output: 600.14 toks/s]
Processed prompts:  25%|██▌       | 132/526 [00:29<00:37, 10.46it/s, est. speed input: 3626.55 toks/s, output: 605.96 toks/s]
Processed prompts:  26%|██▋       | 139/526 [00:30<00:27, 13.84it/s, est. speed input: 3785.94 toks/s, output: 635.49 toks/s]
Processed prompts:  28%|██▊       | 148/526 [00:30<00:25, 14.72it/s, est. speed input: 4023.90 toks/s, output: 670.58 toks/s]
Processed prompts:  29%|██▉       | 153/526 [00:31<00:24, 14.99it/s, est. speed input: 4131.05 toks/s, output: 689.67 toks/s]
Processed prompts:  30%|██▉       | 157/526 [00:31<00:25, 14.41it/s, est. speed input: 4227.15 toks/s, output: 703.55 toks/s]
Processed prompts:  31%|███       | 162/526 [00:31<00:24, 14.76it/s, est. speed input: 4306.30 toks/s, output: 722.21 toks/s]
Processed prompts:  31%|███       | 164/526 [00:31<00:26, 13.57it/s, est. speed input: 4355.51 toks/s, output: 727.66 toks/s]
Processed prompts:  32%|███▏      | 167/526 [00:32<00:28, 12.63it/s, est. speed input: 4381.95 toks/s, output: 736.63 toks/s]
Processed prompts:  33%|███▎      | 171/526 [00:32<00:24, 14.38it/s, est. speed input: 4455.65 toks/s, output: 752.88 toks/s]
Processed prompts:  33%|███▎      | 173/526 [00:32<00:24, 14.23it/s, est. speed input: 4523.54 toks/s, output: 759.88 toks/s]
Processed prompts:  33%|███▎      | 176/526 [00:32<00:24, 14.34it/s, est. speed input: 4593.08 toks/s, output: 770.65 toks/s]
Processed prompts:  34%|███▍      | 179/526 [00:32<00:25, 13.61it/s, est. speed input: 4639.34 toks/s, output: 780.35 toks/s]
Processed prompts:  35%|███▍      | 182/526 [00:33<00:23, 14.53it/s, est. speed input: 4705.47 toks/s, output: 791.80 toks/s]
Processed prompts:  35%|███▍      | 184/526 [00:33<00:27, 12.55it/s, est. speed input: 4725.93 toks/s, output: 796.51 toks/s]
Processed prompts:  35%|███▌      | 186/526 [00:33<00:25, 13.34it/s, est. speed input: 4770.62 toks/s, output: 804.06 toks/s]
Processed prompts:  36%|███▌      | 189/526 [00:33<00:30, 11.02it/s, est. speed input: 4809.20 toks/s, output: 810.83 toks/s]
Processed prompts:  37%|███▋      | 192/526 [00:34<00:28, 11.87it/s, est. speed input: 4916.57 toks/s, output: 821.22 toks/s]
Processed prompts:  38%|███▊      | 198/526 [00:34<00:27, 11.83it/s, est. speed input: 5011.25 toks/s, output: 839.71 toks/s]
Processed prompts:  38%|███▊      | 200/526 [00:34<00:25, 12.69it/s, est. speed input: 5037.59 toks/s, output: 847.34 toks/s]
Processed prompts:  38%|███▊      | 202/526 [00:34<00:27, 11.98it/s, est. speed input: 5080.50 toks/s, output: 852.67 toks/s]
Processed prompts:  39%|███▉      | 204/526 [00:35<00:28, 11.21it/s, est. speed input: 5115.33 toks/s, output: 857.77 toks/s]
Processed prompts:  39%|███▉      | 206/526 [00:35<00:33,  9.53it/s, est. speed input: 5144.50 toks/s, output: 860.72 toks/s]
Processed prompts:  40%|███▉      | 209/526 [00:35<00:29, 10.75it/s, est. speed input: 5187.76 toks/s, output: 871.12 toks/s]
Processed prompts:  40%|████      | 212/526 [00:35<00:31,  9.98it/s, est. speed input: 5213.88 toks/s, output: 878.25 toks/s]
Processed prompts:  41%|████      | 214/526 [00:36<00:30, 10.21it/s, est. speed input: 5231.72 toks/s, output: 884.25 toks/s]
Processed prompts:  41%|████      | 216/526 [00:36<00:29, 10.36it/s, est. speed input: 5279.30 toks/s, output: 890.22 toks/s]
Processed prompts:  41%|████▏     | 218/526 [00:36<00:28, 10.91it/s, est. speed input: 5299.83 toks/s, output: 896.83 toks/s]
Processed prompts:  42%|████▏     | 220/526 [00:36<00:27, 11.05it/s, est. speed input: 5326.00 toks/s, output: 903.04 toks/s]
Processed prompts:  42%|████▏     | 222/526 [00:36<00:26, 11.38it/s, est. speed input: 5364.31 toks/s, output: 909.53 toks/s]
Processed prompts:  43%|████▎     | 224/526 [00:37<00:28, 10.46it/s, est. speed input: 5384.98 toks/s, output: 914.34 toks/s]
Processed prompts:  43%|████▎     | 226/526 [00:37<00:35,  8.46it/s, est. speed input: 5399.39 toks/s, output: 916.36 toks/s]
Processed prompts:  44%|████▎     | 229/526 [00:37<00:36,  8.20it/s, est. speed input: 5425.96 toks/s, output: 922.84 toks/s]
Processed prompts:  44%|████▍     | 231/526 [00:38<00:37,  7.90it/s, est. speed input: 5420.44 toks/s, output: 926.68 toks/s]
Processed prompts:  45%|████▍     | 235/526 [00:38<00:37,  7.71it/s, est. speed input: 5457.73 toks/s, output: 935.07 toks/s]
Processed prompts:  45%|████▌     | 237/526 [00:38<00:39,  7.31it/s, est. speed input: 5467.37 toks/s, output: 938.17 toks/s]
Processed prompts:  45%|████▌     | 238/526 [00:39<00:40,  7.10it/s, est. speed input: 5493.20 toks/s, output: 939.66 toks/s]
Processed prompts:  46%|████▌     | 240/526 [00:39<00:38,  7.43it/s, est. speed input: 5506.76 toks/s, output: 944.87 toks/s]
Processed prompts:  46%|████▌     | 241/526 [00:39<00:45,  6.31it/s, est. speed input: 5501.88 toks/s, output: 943.82 toks/s]
Processed prompts:  46%|████▌     | 242/526 [00:39<00:46,  6.14it/s, est. speed input: 5497.85 toks/s, output: 945.03 toks/s]
Processed prompts:  46%|████▌     | 243/526 [00:40<00:53,  5.28it/s, est. speed input: 5487.16 toks/s, output: 943.92 toks/s]
Processed prompts:  46%|████▋     | 244/526 [00:40<00:54,  5.14it/s, est. speed input: 5477.05 toks/s, output: 944.57 toks/s]
Processed prompts:  47%|████▋     | 245/526 [00:40<01:08,  4.12it/s, est. speed input: 5441.60 toks/s, output: 938.54 toks/s]
Processed prompts:  47%|████▋     | 246/526 [00:40<01:04,  4.31it/s, est. speed input: 5444.33 toks/s, output: 939.59 toks/s]
Processed prompts:  47%|████▋     | 249/526 [00:41<00:45,  6.12it/s, est. speed input: 5478.77 toks/s, output: 944.52 toks/s]
Processed prompts:  48%|████▊     | 250/526 [00:41<00:45,  6.12it/s, est. speed input: 5482.80 toks/s, output: 946.54 toks/s]
Processed prompts:  48%|████▊     | 252/526 [00:41<00:33,  8.16it/s, est. speed input: 5528.85 toks/s, output: 949.78 toks/s]
Processed prompts:  48%|████▊     | 254/526 [00:41<00:41,  6.59it/s, est. speed input: 5510.44 toks/s, output: 945.67 toks/s]
Processed prompts:  48%|████▊     | 255/526 [00:42<00:45,  5.99it/s, est. speed input: 5504.28 toks/s, output: 943.46 toks/s]
Processed prompts:  49%|████▉     | 257/526 [00:42<00:41,  6.45it/s, est. speed input: 5512.75 toks/s, output: 942.92 toks/s]
Processed prompts:  49%|████▉     | 258/526 [00:42<00:44,  6.06it/s, est. speed input: 5509.24 toks/s, output: 941.42 toks/s]
Processed prompts:  49%|████▉     | 260/526 [00:42<00:42,  6.23it/s, est. speed input: 5514.44 toks/s, output: 940.34 toks/s]
Processed prompts:  50%|████▉     | 262/526 [00:43<00:51,  5.08it/s, est. speed input: 5494.72 toks/s, output: 935.05 toks/s]
Processed prompts:  50%|█████     | 264/526 [00:43<00:40,  6.41it/s, est. speed input: 5525.70 toks/s, output: 937.81 toks/s]
Processed prompts:  50%|█████     | 265/526 [00:43<00:41,  6.27it/s, est. speed input: 5526.41 toks/s, output: 937.23 toks/s]
Processed prompts:  51%|█████     | 267/526 [00:43<00:38,  6.66it/s, est. speed input: 5526.19 toks/s, output: 937.17 toks/s]
Processed prompts:  51%|█████     | 268/526 [00:44<00:44,  5.82it/s, est. speed input: 5524.18 toks/s, output: 934.33 toks/s]
Processed prompts:  51%|█████▏    | 270/526 [00:44<00:33,  7.57it/s, est. speed input: 5539.22 toks/s, output: 936.93 toks/s]
Processed prompts:  52%|█████▏    | 271/526 [00:44<00:35,  7.10it/s, est. speed input: 5544.98 toks/s, output: 936.48 toks/s]
Processed prompts:  52%|█████▏    | 274/526 [00:44<00:23, 10.87it/s, est. speed input: 5591.43 toks/s, output: 944.32 toks/s]
Processed prompts:  53%|█████▎    | 278/526 [00:44<00:15, 16.28it/s, est. speed input: 5676.96 toks/s, output: 954.19 toks/s]
Processed prompts:  53%|█████▎    | 281/526 [00:44<00:12, 18.87it/s, est. speed input: 5746.42 toks/s, output: 960.73 toks/s]
Processed prompts:  54%|█████▍    | 284/526 [00:44<00:11, 21.06it/s, est. speed input: 5810.62 toks/s, output: 966.81 toks/s]
Processed prompts:  55%|█████▍    | 288/526 [00:45<00:09, 25.23it/s, est. speed input: 5860.83 toks/s, output: 976.90 toks/s]
Processed prompts:  55%|█████▌    | 291/526 [00:45<00:10, 22.92it/s, est. speed input: 5917.53 toks/s, output: 983.70 toks/s]
Processed prompts:  56%|█████▋    | 297/526 [00:45<00:07, 31.43it/s, est. speed input: 6071.50 toks/s, output: 1001.42 toks/s]
Processed prompts:  58%|█████▊    | 303/526 [00:45<00:05, 38.27it/s, est. speed input: 6190.60 toks/s, output: 1016.99 toks/s]
Processed prompts:  59%|█████▊    | 308/526 [00:45<00:10, 20.81it/s, est. speed input: 6271.58 toks/s, output: 1021.27 toks/s]
Processed prompts:  60%|██████    | 316/526 [00:46<00:07, 26.45it/s, est. speed input: 6563.89 toks/s, output: 1046.19 toks/s]
Processed prompts:  62%|██████▏   | 324/526 [00:46<00:06, 33.32it/s, est. speed input: 6695.76 toks/s, output: 1068.58 toks/s]
Processed prompts:  63%|██████▎   | 330/526 [00:46<00:05, 35.95it/s, est. speed input: 6791.50 toks/s, output: 1084.75 toks/s]
Processed prompts:  64%|██████▍   | 337/526 [00:46<00:04, 40.16it/s, est. speed input: 6907.65 toks/s, output: 1103.72 toks/s]
Processed prompts:  65%|██████▌   | 343/526 [00:46<00:04, 41.84it/s, est. speed input: 7009.56 toks/s, output: 1119.73 toks/s]
Processed prompts:  67%|██████▋   | 354/526 [00:46<00:03, 53.93it/s, est. speed input: 7243.91 toks/s, output: 1153.06 toks/s]
Processed prompts:  70%|██████▉   | 368/526 [00:46<00:02, 70.54it/s, est. speed input: 7516.23 toks/s, output: 1200.21 toks/s]
Processed prompts:  72%|███████▏  | 380/526 [00:46<00:01, 79.43it/s, est. speed input: 7785.22 toks/s, output: 1244.61 toks/s]
Processed prompts:  74%|███████▍  | 389/526 [00:47<00:01, 73.19it/s, est. speed input: 7927.94 toks/s, output: 1275.34 toks/s]
Processed prompts:  76%|███████▌  | 398/526 [00:47<00:01, 75.56it/s, est. speed input: 8104.75 toks/s, output: 1306.83 toks/s]
Processed prompts:  77%|███████▋  | 406/526 [00:47<00:01, 66.63it/s, est. speed input: 8280.09 toks/s, output: 1332.05 toks/s]
Processed prompts:  79%|███████▉  | 417/526 [00:47<00:01, 72.92it/s, est. speed input: 8496.01 toks/s, output: 1368.74 toks/s]
Processed prompts:  81%|████████  | 425/526 [00:47<00:01, 62.89it/s, est. speed input: 8612.99 toks/s, output: 1391.65 toks/s]
Processed prompts:  82%|████████▏ | 432/526 [00:47<00:01, 58.82it/s, est. speed input: 8740.78 toks/s, output: 1414.61 toks/s]
Processed prompts:  83%|████████▎ | 439/526 [00:47<00:01, 60.14it/s, est. speed input: 8889.27 toks/s, output: 1437.81 toks/s]
Processed prompts:  85%|████████▍ | 446/526 [00:48<00:01, 54.83it/s, est. speed input: 9080.47 toks/s, output: 1456.95 toks/s]
Processed prompts:  86%|████████▌ | 453/526 [00:48<00:01, 58.05it/s, est. speed input: 9217.76 toks/s, output: 1479.08 toks/s]
Processed prompts:  88%|████████▊ | 462/526 [00:48<00:01, 62.54it/s, est. speed input: 9389.84 toks/s, output: 1511.12 toks/s]
Processed prompts:  89%|████████▉ | 469/526 [00:48<00:00, 59.02it/s, est. speed input: 9501.79 toks/s, output: 1528.97 toks/s]
Processed prompts:  90%|█████████ | 476/526 [00:48<00:00, 57.59it/s, est. speed input: 9620.61 toks/s, output: 1556.09 toks/s]
Processed prompts:  92%|█████████▏| 482/526 [00:48<00:00, 55.03it/s, est. speed input: 9723.96 toks/s, output: 1573.03 toks/s]
Processed prompts:  93%|█████████▎| 488/526 [00:48<00:00, 45.26it/s, est. speed input: 9848.82 toks/s, output: 1591.98 toks/s]
Processed prompts:  94%|█████████▎| 493/526 [00:49<00:00, 38.92it/s, est. speed input: 9922.71 toks/s, output: 1603.89 toks/s]
Processed prompts:  95%|█████████▍| 498/526 [00:49<00:00, 40.93it/s, est. speed input: 10006.51 toks/s, output: 1621.81 toks/s]
Processed prompts:  96%|█████████▌| 504/526 [00:49<00:00, 44.00it/s, est. speed input: 10092.38 toks/s, output: 1647.39 toks/s]
Processed prompts:  97%|█████████▋| 509/526 [00:49<00:00, 33.66it/s, est. speed input: 10116.27 toks/s, output: 1658.08 toks/s]
Processed prompts:  98%|█████████▊| 513/526 [00:50<00:00, 16.17it/s, est. speed input: 10079.56 toks/s, output: 1652.03 toks/s]
Processed prompts:  98%|█████████▊| 516/526 [00:50<00:00, 15.29it/s, est. speed input: 10122.16 toks/s, output: 1659.59 toks/s]
Processed prompts:  99%|█████████▊| 519/526 [00:50<00:00, 12.02it/s, est. speed input: 10103.81 toks/s, output: 1664.16 toks/s]
Processed prompts:  99%|█████████▉| 522/526 [00:51<00:00, 13.20it/s, est. speed input: 10121.35 toks/s, output: 1676.99 toks/s]
Processed prompts: 100%|█████████▉| 524/526 [00:51<00:00, 13.25it/s, est. speed input: 10130.88 toks/s, output: 1687.60 toks/s]
Processed prompts: 100%|██████████| 526/526 [00:52<00:00,  7.07it/s, est. speed input: 10024.73 toks/s, output: 1676.33 toks/s]
Processed prompts: 100%|██████████| 526/526 [00:52<00:00, 10.12it/s, est. speed input: 10024.73 toks/s, output: 1676.33 toks/s]
{  "personalized_answer": "Considering your past interest in punctuation and dialogue, it seems you value precision in language. For Grammarly's edits, it's often beneficial to review and understand the suggestions. However, in cases like dialogue, it's crucial to maintain the natural flow and clarity of speech. For instance, in your statement, 'He commented that, "I have such a miserable cold, your sarcastic remarks are hardly making any effect on me." ' the use of 'that' is not redundant and helps clarify the attribution. Grammarly might suggest removing it, but in this context, it's better to keep it for clarity. As for the punctuation, 'He commented, "I have such a miserable cold, your sarcastic remarks are hardly making any effect on me," ' is correct with a comma before 'He commented.' This maintains the natural pause and flow of the sentence. Regarding your meditation practice, it's great to be mindful of your hearing, and this can indeed help you stay present. However, if Grammarly is suggesting changes that seem to disrupt the natural flow of your writing, especially in creative or personal contexts, it might be worth considering its suggestions with a critical eye, keeping in mind the context and your goals."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.76s/it, est. speed input: 457.29 toks/s, output: 82.73 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.76s/it, est. speed input: 457.29 toks/s, output: 82.73 toks/s]
[rank0]:[W709 16:07:35.790913638 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/lp_rag_ae_sc_test_4_output.json
Cleaned temporary files.
Keeping ['ae', 'lp'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 16:07:38.869652_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 16:07:38.869652_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 16:07:38.869652_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<02:18,  3.05it/s]
  0%|          | 2/424 [00:00<02:12,  3.18it/s]
  1%|          | 4/424 [00:01<02:03,  3.41it/s]
  2%|▏         | 7/424 [00:01<01:19,  5.25it/s]
  2%|▏         | 10/424 [00:01<00:59,  6.96it/s]
  3%|▎         | 12/424 [00:01<00:50,  8.18it/s]
  3%|▎         | 13/424 [00:03<02:25,  2.82it/s]
  4%|▎         | 15/424 [00:03<01:50,  3.69it/s]
  4%|▍         | 16/424 [00:03<01:52,  3.63it/s]
  4%|▍         | 17/424 [00:04<01:41,  4.01it/s]
  5%|▍         | 20/424 [00:04<01:02,  6.43it/s]
  5%|▌         | 22/424 [00:04<01:00,  6.66it/s]
  5%|▌         | 23/424 [00:05<01:37,  4.11it/s]
  6%|▌         | 25/424 [00:05<01:25,  4.66it/s]
  6%|▋         | 27/424 [00:05<01:31,  4.33it/s]
  7%|▋         | 30/424 [00:06<01:01,  6.39it/s]
  8%|▊         | 34/424 [00:06<00:38, 10.05it/s]
  9%|▊         | 37/424 [00:06<00:57,  6.79it/s]
  9%|▉         | 40/424 [00:07<00:45,  8.37it/s]
 10%|█         | 44/424 [00:07<00:49,  7.74it/s]
 12%|█▏        | 49/424 [00:07<00:32, 11.50it/s]
 12%|█▏        | 52/424 [00:08<00:38,  9.76it/s]
 13%|█▎        | 54/424 [00:08<00:41,  8.88it/s]
 14%|█▎        | 58/424 [00:08<00:30, 12.11it/s]
 14%|█▍        | 61/424 [00:09<00:40,  9.03it/s]
 15%|█▍        | 63/424 [00:10<01:27,  4.13it/s]
 15%|█▌        | 65/424 [00:11<01:19,  4.54it/s]
 16%|█▌        | 66/424 [00:11<01:32,  3.85it/s]
 16%|█▌        | 67/424 [00:11<01:27,  4.08it/s]
 16%|█▌        | 68/424 [00:12<01:30,  3.93it/s]
 16%|█▋        | 69/424 [00:12<01:49,  3.26it/s]
 17%|█▋        | 70/424 [00:12<01:35,  3.70it/s]
 17%|█▋        | 71/424 [00:12<01:24,  4.16it/s]
 17%|█▋        | 72/424 [00:12<01:16,  4.60it/s]
 17%|█▋        | 73/424 [00:13<01:09,  5.04it/s]
 17%|█▋        | 74/424 [00:13<01:04,  5.40it/s]
 18%|█▊        | 76/424 [00:13<00:45,  7.60it/s]
 18%|█▊        | 77/424 [00:13<00:46,  7.50it/s]
 19%|█▉        | 80/424 [00:13<00:29, 11.58it/s]
 19%|█▉        | 82/424 [00:14<00:52,  6.54it/s]
 20%|█▉        | 84/424 [00:14<00:47,  7.12it/s]
 20%|██        | 85/424 [00:14<00:49,  6.89it/s]
 20%|██        | 86/424 [00:15<01:13,  4.61it/s]
 21%|██        | 87/424 [00:15<01:08,  4.91it/s]
 21%|██        | 89/424 [00:15<00:54,  6.12it/s]
 21%|██        | 90/424 [00:15<00:54,  6.10it/s]
 21%|██▏       | 91/424 [00:15<00:54,  6.09it/s]
 22%|██▏       | 92/424 [00:15<00:54,  6.10it/s]
 22%|██▏       | 93/424 [00:16<01:01,  5.38it/s]
 22%|██▏       | 94/424 [00:16<00:58,  5.60it/s]
 23%|██▎       | 96/424 [00:16<00:43,  7.50it/s]
 23%|██▎       | 98/424 [00:16<00:33,  9.63it/s]
 24%|██▎       | 100/424 [00:17<00:53,  6.01it/s]
 24%|██▍       | 101/424 [00:18<01:55,  2.80it/s]
 24%|██▍       | 103/424 [00:18<01:26,  3.70it/s]
 25%|██▍       | 105/424 [00:18<01:06,  4.83it/s]
 25%|██▌       | 107/424 [00:19<01:10,  4.48it/s]
 26%|██▌       | 109/424 [00:22<03:22,  1.55it/s]
 26%|██▌       | 110/424 [00:22<03:14,  1.61it/s]
 26%|██▌       | 111/424 [00:22<02:41,  1.94it/s]
 27%|██▋       | 114/424 [00:23<01:31,  3.40it/s]
 27%|██▋       | 116/424 [00:23<01:08,  4.47it/s]
 28%|██▊       | 118/424 [00:23<00:56,  5.37it/s]
 28%|██▊       | 120/424 [00:23<00:50,  6.02it/s]
 29%|██▉       | 122/424 [00:27<03:27,  1.46it/s]
 29%|██▉       | 123/424 [00:31<06:09,  1.23s/it]
 29%|██▉       | 124/424 [00:34<08:43,  1.74s/it]
 29%|██▉       | 125/424 [00:38<10:56,  2.20s/it]
 30%|██▉       | 126/424 [00:42<12:48,  2.58s/it]
 30%|██▉       | 127/424 [00:46<14:20,  2.90s/it]
 30%|███       | 128/424 [00:46<10:39,  2.16s/it]
 30%|███       | 129/424 [00:46<07:51,  1.60s/it]
 31%|███       | 130/424 [00:46<05:48,  1.18s/it]
 31%|███       | 131/424 [00:46<04:20,  1.13it/s]
 31%|███▏      | 133/424 [00:47<02:48,  1.72it/s]
 32%|███▏      | 137/424 [00:47<01:17,  3.68it/s]
 33%|███▎      | 141/424 [00:47<00:46,  6.05it/s]
 34%|███▍      | 145/424 [00:47<00:31,  8.78it/s]
 35%|███▌      | 149/424 [00:47<00:23, 11.77it/s]
 36%|███▌      | 153/424 [00:47<00:18, 14.84it/s]
 37%|███▋      | 157/424 [00:48<00:14, 17.87it/s]
 38%|███▊      | 160/424 [00:49<00:45,  5.77it/s]
 39%|███▊      | 164/424 [00:49<00:33,  7.87it/s]
 39%|███▉      | 167/424 [00:49<00:26,  9.73it/s]
 40%|████      | 170/424 [00:50<00:26,  9.61it/s]
 41%|████      | 173/424 [00:50<00:30,  8.25it/s]
 41%|████▏     | 175/424 [00:51<00:48,  5.16it/s]
 42%|████▏     | 178/424 [00:51<00:40,  6.00it/s]
 42%|████▏     | 180/424 [00:52<00:41,  5.90it/s]
 43%|████▎     | 183/424 [00:52<00:30,  7.86it/s]
 44%|████▎     | 185/424 [00:52<00:26,  8.91it/s]
 44%|████▍     | 188/424 [00:52<00:20, 11.50it/s]
 45%|████▍     | 190/424 [00:55<01:41,  2.31it/s]
 45%|████▌     | 192/424 [00:56<01:31,  2.55it/s]
 46%|████▌     | 194/424 [00:56<01:09,  3.31it/s]
 46%|████▌     | 196/424 [00:56<01:07,  3.37it/s]
 46%|████▋     | 197/424 [00:57<01:04,  3.54it/s]
 47%|████▋     | 198/424 [00:57<00:58,  3.89it/s]
 47%|████▋     | 199/424 [00:57<01:08,  3.27it/s]
 47%|████▋     | 200/424 [00:57<00:59,  3.76it/s]
 47%|████▋     | 201/424 [00:58<01:07,  3.30it/s]
 48%|████▊     | 202/424 [00:58<00:59,  3.72it/s]
 48%|████▊     | 203/424 [00:58<01:05,  3.36it/s]
 48%|████▊     | 204/424 [01:00<02:19,  1.58it/s]
 48%|████▊     | 205/424 [01:00<01:49,  1.99it/s]
 49%|████▊     | 206/424 [01:03<04:22,  1.21s/it]
 49%|████▉     | 207/424 [01:03<03:19,  1.09it/s]
 49%|████▉     | 209/424 [01:03<01:56,  1.84it/s]
 50%|█████     | 212/424 [01:03<01:02,  3.37it/s]
 50%|█████     | 214/424 [01:04<01:14,  2.82it/s]
 51%|█████     | 215/424 [01:05<01:19,  2.64it/s]
 51%|█████     | 217/424 [01:05<00:59,  3.48it/s]
 51%|█████▏    | 218/424 [01:05<00:56,  3.64it/s]
 52%|█████▏    | 219/424 [01:06<00:52,  3.88it/s]
 52%|█████▏    | 220/424 [01:06<01:03,  3.19it/s]
 52%|█████▏    | 222/424 [01:06<00:53,  3.74it/s]
 53%|█████▎    | 223/424 [01:07<00:49,  4.08it/s]
 53%|█████▎    | 225/424 [01:07<00:54,  3.68it/s]
 54%|█████▎    | 227/424 [01:07<00:38,  5.11it/s]
 54%|█████▍    | 229/424 [01:07<00:29,  6.63it/s]
 54%|█████▍    | 231/424 [01:09<01:19,  2.42it/s]
 55%|█████▍    | 233/424 [01:10<01:06,  2.89it/s]
 55%|█████▌    | 234/424 [01:14<03:04,  1.03it/s]
 55%|█████▌    | 235/424 [01:14<02:44,  1.15it/s]
 56%|█████▌    | 236/424 [01:14<02:16,  1.38it/s]
 56%|█████▋    | 239/424 [01:14<01:11,  2.58it/s]
 57%|█████▋    | 240/424 [01:15<01:14,  2.46it/s]
 57%|█████▋    | 241/424 [01:15<01:17,  2.36it/s]
 57%|█████▋    | 243/424 [01:16<00:56,  3.19it/s]
 58%|█████▊    | 244/424 [01:16<00:48,  3.72it/s]
 58%|█████▊    | 246/424 [01:16<00:35,  5.00it/s]
 58%|█████▊    | 247/424 [01:16<00:43,  4.07it/s]
 58%|█████▊    | 248/424 [01:16<00:37,  4.72it/s]
 59%|█████▉    | 250/424 [01:17<00:28,  6.04it/s]
 59%|█████▉    | 252/424 [01:17<00:23,  7.32it/s]
 60%|█████▉    | 254/424 [01:17<00:20,  8.37it/s]
 60%|██████    | 256/424 [01:17<00:18,  9.31it/s]
 61%|██████    | 258/424 [01:17<00:16,  9.98it/s]
 61%|██████▏   | 260/424 [01:18<00:20,  7.83it/s]
 62%|██████▏   | 263/424 [01:19<00:34,  4.62it/s]
 62%|██████▎   | 265/424 [01:19<00:28,  5.57it/s]
 63%|██████▎   | 266/424 [01:19<00:27,  5.82it/s]
 63%|██████▎   | 268/424 [01:19<00:22,  6.93it/s]
 63%|██████▎   | 269/424 [01:20<00:32,  4.81it/s]
 64%|██████▍   | 272/424 [01:20<00:20,  7.29it/s]
 65%|██████▍   | 274/424 [01:20<00:18,  7.99it/s]
 66%|██████▌   | 278/424 [01:20<00:11, 12.43it/s]
 66%|██████▌   | 280/424 [01:21<00:17,  8.35it/s]
 67%|██████▋   | 282/424 [01:21<00:18,  7.50it/s]
 67%|██████▋   | 284/424 [01:23<00:43,  3.25it/s]
 68%|██████▊   | 287/424 [01:23<00:32,  4.16it/s]
 68%|██████▊   | 288/424 [01:23<00:31,  4.37it/s]
 68%|██████▊   | 289/424 [01:23<00:27,  4.85it/s]
 69%|██████▊   | 291/424 [01:23<00:23,  5.74it/s]
 69%|██████▉   | 293/424 [01:25<00:48,  2.70it/s]
 70%|██████▉   | 295/424 [01:25<00:42,  3.04it/s]
 70%|██████▉   | 296/424 [01:26<00:36,  3.47it/s]
 70%|███████   | 297/424 [01:26<00:36,  3.44it/s]
 70%|███████   | 298/424 [01:26<00:33,  3.80it/s]
 71%|███████   | 301/424 [01:26<00:19,  6.19it/s]
 71%|███████   | 302/424 [01:30<01:42,  1.19it/s]
 72%|███████▏  | 304/424 [01:30<01:08,  1.76it/s]
 72%|███████▏  | 305/424 [01:30<00:57,  2.06it/s]
 72%|███████▏  | 306/424 [01:30<00:52,  2.24it/s]
 73%|███████▎  | 308/424 [01:31<00:39,  2.95it/s]
 73%|███████▎  | 309/424 [01:31<00:33,  3.43it/s]
 73%|███████▎  | 310/424 [01:32<00:46,  2.45it/s]
 74%|███████▍  | 313/424 [01:32<00:26,  4.17it/s]
 74%|███████▍  | 314/424 [01:32<00:27,  3.99it/s]
 74%|███████▍  | 315/424 [01:32<00:25,  4.29it/s]
 75%|███████▍  | 317/424 [01:33<00:19,  5.49it/s]
 75%|███████▌  | 318/424 [01:33<00:18,  5.60it/s]
 75%|███████▌  | 319/424 [01:33<00:18,  5.70it/s]
 75%|███████▌  | 320/424 [01:33<00:17,  5.95it/s]
 76%|███████▌  | 322/424 [01:33<00:12,  7.88it/s]
 76%|███████▌  | 323/424 [01:33<00:13,  7.43it/s]
 77%|███████▋  | 326/424 [01:37<01:08,  1.43it/s]
 77%|███████▋  | 327/424 [01:37<00:57,  1.68it/s]
 77%|███████▋  | 328/424 [01:38<00:53,  1.80it/s]
 78%|███████▊  | 329/424 [01:38<00:46,  2.02it/s]
 78%|███████▊  | 330/424 [01:38<00:38,  2.43it/s]
 79%|███████▊  | 333/424 [01:39<00:29,  3.06it/s]
 79%|███████▉  | 334/424 [01:39<00:27,  3.31it/s]
 79%|███████▉  | 336/424 [01:39<00:18,  4.65it/s]
 79%|███████▉  | 337/424 [01:43<01:22,  1.06it/s]
 80%|███████▉  | 338/424 [01:43<01:06,  1.29it/s]
 80%|███████▉  | 339/424 [01:44<00:55,  1.53it/s]
 80%|████████  | 340/424 [01:47<02:02,  1.45s/it]
 80%|████████  | 341/424 [01:48<01:39,  1.20s/it]
 81%|████████  | 342/424 [01:48<01:19,  1.03it/s]
 81%|████████  | 344/424 [01:48<00:48,  1.65it/s]
 82%|████████▏ | 346/424 [01:49<00:33,  2.31it/s]
 82%|████████▏ | 347/424 [01:49<00:37,  2.07it/s]
 83%|████████▎ | 350/424 [01:50<00:28,  2.64it/s]
 83%|████████▎ | 352/424 [01:54<01:01,  1.17it/s]
 83%|████████▎ | 353/424 [01:54<00:52,  1.34it/s]
 83%|████████▎ | 354/424 [01:55<00:52,  1.33it/s]
 84%|████████▍ | 356/424 [01:56<00:39,  1.73it/s]
 84%|████████▍ | 357/424 [01:56<00:34,  1.94it/s]
 84%|████████▍ | 358/424 [01:57<00:37,  1.76it/s]
 85%|████████▍ | 359/424 [01:57<00:39,  1.65it/s]
 85%|████████▍ | 360/424 [01:57<00:30,  2.11it/s]
 85%|████████▌ | 361/424 [01:58<00:24,  2.59it/s]
 85%|████████▌ | 362/424 [01:58<00:22,  2.81it/s]
 86%|████████▌ | 363/424 [02:02<01:20,  1.32s/it]
 86%|████████▌ | 364/424 [02:02<01:01,  1.02s/it]
 86%|████████▌ | 365/424 [02:02<00:45,  1.30it/s]
 87%|████████▋ | 368/424 [02:06<00:58,  1.05s/it]
 87%|████████▋ | 369/424 [02:06<00:48,  1.14it/s]
 88%|████████▊ | 372/424 [02:06<00:25,  2.05it/s]
 88%|████████▊ | 373/424 [02:06<00:21,  2.40it/s]
 88%|████████▊ | 374/424 [02:07<00:18,  2.75it/s]
 89%|████████▊ | 376/424 [02:07<00:15,  3.13it/s]
 89%|████████▉ | 377/424 [02:07<00:13,  3.47it/s]
 89%|████████▉ | 379/424 [02:08<00:11,  4.07it/s]
 90%|████████▉ | 380/424 [02:08<00:13,  3.30it/s]
 90%|█████████ | 382/424 [02:08<00:09,  4.36it/s]
 91%|█████████ | 384/424 [02:08<00:07,  5.62it/s]
 91%|█████████ | 385/424 [02:09<00:06,  5.93it/s]
 92%|█████████▏| 388/424 [02:09<00:05,  6.73it/s]
 92%|█████████▏| 389/424 [02:09<00:06,  5.12it/s]
 92%|█████████▏| 391/424 [02:09<00:04,  6.77it/s]
 93%|█████████▎| 393/424 [02:10<00:04,  6.93it/s]
 93%|█████████▎| 394/424 [02:10<00:05,  5.89it/s]
 93%|█████████▎| 395/424 [02:10<00:06,  4.57it/s]
 93%|█████████▎| 396/424 [02:11<00:10,  2.64it/s]
 94%|█████████▎| 397/424 [02:12<00:11,  2.29it/s]
 94%|█████████▍| 398/424 [02:13<00:12,  2.06it/s]
 95%|█████████▍| 401/424 [02:13<00:06,  3.55it/s]
 95%|█████████▍| 402/424 [02:14<00:11,  1.92it/s]
 95%|█████████▌| 403/424 [02:15<00:09,  2.15it/s]
 95%|█████████▌| 404/424 [02:15<00:07,  2.58it/s]
 96%|█████████▌| 405/424 [02:15<00:06,  3.09it/s]
 96%|█████████▌| 407/424 [02:16<00:05,  2.91it/s]
 96%|█████████▌| 408/424 [02:16<00:04,  3.33it/s]
 96%|█████████▋| 409/424 [02:16<00:04,  3.39it/s]
 97%|█████████▋| 410/424 [02:16<00:03,  3.89it/s]
 97%|█████████▋| 411/424 [02:17<00:03,  3.79it/s]
 97%|█████████▋| 413/424 [02:17<00:02,  3.74it/s]
 98%|█████████▊| 415/424 [02:18<00:02,  3.25it/s]
 98%|█████████▊| 416/424 [02:18<00:02,  2.85it/s]
 99%|█████████▊| 418/424 [02:19<00:01,  3.37it/s]
 99%|█████████▉| 420/424 [02:19<00:01,  3.73it/s]
100%|█████████▉| 422/424 [02:19<00:00,  4.97it/s]
100%|█████████▉| 423/424 [02:20<00:00,  4.21it/s]
100%|██████████| 424/424 [02:20<00:00,  4.53it/s]
100%|██████████| 424/424 [02:20<00:00,  3.02it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 16:07:38.869652_sc_processed_test.json', '--output_addr', 'data/out/rag/asym/sc_rag_ae_lp_test_4_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '4', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.16 examples/s]
Generating train split: 424 examples [00:00, 1586.95 examples/s]
INFO 07-09 16:10:26 config.py:510] This model supports multiple tasks: {'embed', 'reward', 'generate', 'score', 'classify'}. Defaulting to 'generate'.
INFO 07-09 16:10:26 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:10:27 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:10:28 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:10:28 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.47it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.32it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.32it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.31it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.32it/s]

INFO 07-09 16:10:32 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:10:34 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-09 16:10:34 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:10:34 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:10:34 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:10:34 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:10:37 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  2.89it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.32it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.50it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.60it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.67it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.70it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.73it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.75it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:06,  3.75it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.77it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:02<00:06,  3.79it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.80it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.74it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.77it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.79it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:04,  3.81it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.86it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.90it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.93it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.90it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.93it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.95it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.97it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.99it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  4.00it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:06<00:02,  4.00it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:01,  4.02it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  4.02it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  4.04it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:07<00:01,  4.06it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:00,  4.06it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  4.08it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  4.01it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:08<00:00,  4.03it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  4.06it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.87it/s]
INFO 07-09 16:10:46 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 16:10:46 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.04 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:17<2:02:42, 17.41s/it, est. speed input: 27.92 toks/s, output: 3.68 toks/s]
Processed prompts:   0%|          | 2/424 [00:17<51:13,  7.28s/it, est. speed input: 60.05 toks/s, output: 7.38 toks/s]  
Processed prompts:   1%|          | 3/424 [00:19<33:06,  4.72s/it, est. speed input: 216.47 toks/s, output: 11.73 toks/s]
Processed prompts:   1%|          | 5/424 [00:19<14:43,  2.11s/it, est. speed input: 282.88 toks/s, output: 21.61 toks/s]
Processed prompts:   2%|▏         | 8/424 [00:19<06:54,  1.00it/s, est. speed input: 457.56 toks/s, output: 36.39 toks/s]
Processed prompts:   2%|▏         | 9/424 [00:19<05:49,  1.19it/s, est. speed input: 479.31 toks/s, output: 41.14 toks/s]
Processed prompts:   2%|▏         | 10/424 [00:20<04:48,  1.44it/s, est. speed input: 531.64 toks/s, output: 46.04 toks/s]
Processed prompts:   3%|▎         | 12/424 [00:20<03:35,  1.91it/s, est. speed input: 595.94 toks/s, output: 55.60 toks/s]
Processed prompts:   3%|▎         | 14/424 [00:20<02:33,  2.66it/s, est. speed input: 733.35 toks/s, output: 66.09 toks/s]
Processed prompts:   4%|▍         | 16/424 [00:21<02:06,  3.24it/s, est. speed input: 804.43 toks/s, output: 76.26 toks/s]
Processed prompts:   4%|▍         | 18/424 [00:21<01:41,  3.99it/s, est. speed input: 861.76 toks/s, output: 86.76 toks/s]
Processed prompts:   5%|▍         | 20/424 [00:21<01:17,  5.25it/s, est. speed input: 922.72 toks/s, output: 97.75 toks/s]
Processed prompts:   5%|▌         | 23/424 [00:21<01:01,  6.57it/s, est. speed input: 996.28 toks/s, output: 113.63 toks/s]
Processed prompts:   6%|▌         | 25/424 [00:22<00:50,  7.86it/s, est. speed input: 1099.96 toks/s, output: 124.54 toks/s]
Processed prompts:   6%|▋         | 27/424 [00:22<00:46,  8.48it/s, est. speed input: 1194.91 toks/s, output: 135.02 toks/s]
Processed prompts:   7%|▋         | 29/424 [00:22<00:40,  9.73it/s, est. speed input: 1251.42 toks/s, output: 145.79 toks/s]
Processed prompts:   7%|▋         | 31/424 [00:22<00:39,  9.95it/s, est. speed input: 1307.44 toks/s, output: 156.12 toks/s]
Processed prompts:   8%|▊         | 33/424 [00:22<00:38, 10.20it/s, est. speed input: 1395.16 toks/s, output: 166.40 toks/s]
Processed prompts:   8%|▊         | 35/424 [00:23<00:44,  8.77it/s, est. speed input: 1454.90 toks/s, output: 175.69 toks/s]
Processed prompts:   9%|▉         | 38/424 [00:23<00:34, 11.10it/s, est. speed input: 1591.91 toks/s, output: 191.72 toks/s]
Processed prompts:   9%|▉         | 40/424 [00:23<00:37, 10.22it/s, est. speed input: 1641.31 toks/s, output: 201.24 toks/s]
Processed prompts:  10%|█         | 43/424 [00:23<00:37, 10.28it/s, est. speed input: 1720.19 toks/s, output: 215.92 toks/s]
Processed prompts:  11%|█         | 47/424 [00:23<00:30, 12.36it/s, est. speed input: 1853.72 toks/s, output: 236.73 toks/s]
Processed prompts:  12%|█▏        | 51/424 [00:24<00:32, 11.43it/s, est. speed input: 1968.36 toks/s, output: 255.57 toks/s]
Processed prompts:  13%|█▎        | 57/424 [00:24<00:31, 11.80it/s, est. speed input: 2148.26 toks/s, output: 284.41 toks/s]
Processed prompts:  15%|█▍        | 62/424 [00:25<00:25, 14.43it/s, est. speed input: 2333.73 toks/s, output: 310.50 toks/s]
Processed prompts:  15%|█▌        | 65/424 [00:25<00:28, 12.45it/s, est. speed input: 2377.18 toks/s, output: 323.10 toks/s]
Processed prompts:  17%|█▋        | 70/424 [00:25<00:28, 12.38it/s, est. speed input: 2476.93 toks/s, output: 345.91 toks/s]
Processed prompts:  17%|█▋        | 74/424 [00:26<00:27, 12.61it/s, est. speed input: 2623.91 toks/s, output: 364.13 toks/s]
Processed prompts:  19%|█▉        | 80/424 [00:26<00:25, 13.36it/s, est. speed input: 2814.17 toks/s, output: 391.83 toks/s]
Processed prompts:  20%|█▉        | 83/424 [00:26<00:24, 13.75it/s, est. speed input: 2868.95 toks/s, output: 405.62 toks/s]
Processed prompts:  20%|██        | 85/424 [00:26<00:27, 12.49it/s, est. speed input: 2944.29 toks/s, output: 413.22 toks/s]
Processed prompts:  22%|██▏       | 93/424 [00:27<00:25, 12.88it/s, est. speed input: 3166.70 toks/s, output: 448.05 toks/s]
Processed prompts:  23%|██▎       | 98/424 [00:27<00:24, 13.17it/s, est. speed input: 3282.25 toks/s, output: 469.70 toks/s]
Processed prompts:  24%|██▍       | 102/424 [00:28<00:22, 14.31it/s, est. speed input: 3468.41 toks/s, output: 488.12 toks/s]
Processed prompts:  25%|██▍       | 105/424 [00:28<00:24, 12.84it/s, est. speed input: 3545.70 toks/s, output: 498.99 toks/s]
Processed prompts:  26%|██▌       | 110/424 [00:28<00:21, 14.39it/s, est. speed input: 3639.88 toks/s, output: 521.55 toks/s]
Processed prompts:  26%|██▋       | 112/424 [00:28<00:22, 13.58it/s, est. speed input: 3683.31 toks/s, output: 529.02 toks/s]
Processed prompts:  28%|██▊       | 117/424 [00:29<00:18, 16.24it/s, est. speed input: 3802.30 toks/s, output: 552.47 toks/s]
Processed prompts:  29%|██▊       | 121/424 [00:29<00:20, 15.09it/s, est. speed input: 3872.23 toks/s, output: 568.30 toks/s]
Processed prompts:  29%|██▉       | 123/424 [00:29<00:19, 15.23it/s, est. speed input: 3916.83 toks/s, output: 576.75 toks/s]
Processed prompts:  29%|██▉       | 125/424 [00:29<00:21, 13.70it/s, est. speed input: 3938.39 toks/s, output: 583.64 toks/s]
Processed prompts:  31%|███       | 132/424 [00:30<00:17, 17.07it/s, est. speed input: 4187.20 toks/s, output: 615.38 toks/s]
Processed prompts:  32%|███▏      | 134/424 [00:30<00:19, 14.57it/s, est. speed input: 4230.51 toks/s, output: 621.38 toks/s]
Processed prompts:  32%|███▏      | 136/424 [00:30<00:18, 15.30it/s, est. speed input: 4270.63 toks/s, output: 630.08 toks/s]
Processed prompts:  33%|███▎      | 138/424 [00:30<00:19, 14.94it/s, est. speed input: 4294.01 toks/s, output: 637.95 toks/s]
Processed prompts:  33%|███▎      | 142/424 [00:31<00:25, 10.91it/s, est. speed input: 4337.97 toks/s, output: 648.55 toks/s]
Processed prompts:  35%|███▍      | 148/424 [00:31<00:23, 11.74it/s, est. speed input: 4530.76 toks/s, output: 670.82 toks/s]
Processed prompts:  35%|███▌      | 150/424 [00:31<00:21, 12.60it/s, est. speed input: 4618.54 toks/s, output: 679.24 toks/s]
Processed prompts:  36%|███▌      | 152/424 [00:31<00:24, 11.26it/s, est. speed input: 4647.75 toks/s, output: 684.55 toks/s]
Processed prompts:  36%|███▋      | 154/424 [00:32<00:25, 10.47it/s, est. speed input: 4646.08 toks/s, output: 690.16 toks/s]
Processed prompts:  37%|███▋      | 158/424 [00:32<00:23, 11.16it/s, est. speed input: 4718.84 toks/s, output: 704.55 toks/s]
Processed prompts:  38%|███▊      | 160/424 [00:32<00:26, 10.04it/s, est. speed input: 4742.52 toks/s, output: 709.32 toks/s]
Processed prompts:  38%|███▊      | 162/424 [00:32<00:27,  9.58it/s, est. speed input: 4779.13 toks/s, output: 714.81 toks/s]
Processed prompts:  39%|███▉      | 167/424 [00:33<00:25,  9.94it/s, est. speed input: 4890.73 toks/s, output: 731.04 toks/s]
Processed prompts:  41%|████      | 174/424 [00:33<00:15, 15.89it/s, est. speed input: 5075.39 toks/s, output: 764.80 toks/s]
Processed prompts:  42%|████▏     | 177/424 [00:33<00:14, 17.64it/s, est. speed input: 5139.30 toks/s, output: 778.38 toks/s]
Processed prompts:  43%|████▎     | 182/424 [00:33<00:10, 22.63it/s, est. speed input: 5237.33 toks/s, output: 802.73 toks/s]
Processed prompts:  45%|████▌     | 192/424 [00:33<00:06, 36.71it/s, est. speed input: 5492.80 toks/s, output: 854.23 toks/s]
Processed prompts:  47%|████▋     | 198/424 [00:34<00:06, 37.50it/s, est. speed input: 5668.05 toks/s, output: 883.06 toks/s]
Processed prompts:  48%|████▊     | 203/424 [00:34<00:05, 40.14it/s, est. speed input: 5793.26 toks/s, output: 908.04 toks/s]
Processed prompts:  49%|████▉     | 209/424 [00:34<00:05, 40.50it/s, est. speed input: 5881.40 toks/s, output: 937.47 toks/s]
Processed prompts:  50%|█████     | 214/424 [00:34<00:07, 28.19it/s, est. speed input: 5995.62 toks/s, output: 955.14 toks/s]
Processed prompts:  51%|█████▏    | 218/424 [00:34<00:07, 26.37it/s, est. speed input: 6063.59 toks/s, output: 973.26 toks/s]
Processed prompts:  52%|█████▏    | 222/424 [00:34<00:07, 27.10it/s, est. speed input: 6177.76 toks/s, output: 992.91 toks/s]
Processed prompts:  54%|█████▍    | 228/424 [00:35<00:06, 31.44it/s, est. speed input: 6332.01 toks/s, output: 1021.88 toks/s]
Processed prompts:  56%|█████▌    | 236/424 [00:35<00:04, 39.08it/s, est. speed input: 6516.68 toks/s, output: 1065.88 toks/s]
Processed prompts:  57%|█████▋    | 241/424 [00:35<00:07, 23.05it/s, est. speed input: 6620.18 toks/s, output: 1082.40 toks/s]
Processed prompts:  58%|█████▊    | 245/424 [00:35<00:08, 22.00it/s, est. speed input: 6682.75 toks/s, output: 1101.35 toks/s]
Processed prompts:  58%|█████▊    | 248/424 [00:36<00:10, 17.13it/s, est. speed input: 6734.45 toks/s, output: 1110.43 toks/s]
Processed prompts:  59%|█████▉    | 251/424 [00:36<00:09, 17.39it/s, est. speed input: 6779.88 toks/s, output: 1117.26 toks/s]
Processed prompts:  60%|█████▉    | 254/424 [00:36<00:11, 15.06it/s, est. speed input: 6806.12 toks/s, output: 1119.47 toks/s]
Processed prompts:  61%|██████    | 259/424 [00:36<00:08, 18.57it/s, est. speed input: 6969.63 toks/s, output: 1134.16 toks/s]
Processed prompts:  62%|██████▏   | 262/424 [00:37<00:10, 15.87it/s, est. speed input: 6971.04 toks/s, output: 1142.89 toks/s]
Processed prompts:  63%|██████▎   | 269/424 [00:37<00:06, 23.48it/s, est. speed input: 7101.96 toks/s, output: 1167.56 toks/s]
Processed prompts:  64%|██████▍   | 273/424 [00:37<00:06, 22.66it/s, est. speed input: 7143.98 toks/s, output: 1176.27 toks/s]
Processed prompts:  65%|██████▌   | 276/424 [00:37<00:06, 23.36it/s, est. speed input: 7179.22 toks/s, output: 1183.04 toks/s]
Processed prompts:  66%|██████▋   | 281/424 [00:37<00:05, 24.35it/s, est. speed input: 7269.15 toks/s, output: 1194.62 toks/s]
Processed prompts:  68%|██████▊   | 288/424 [00:37<00:04, 32.47it/s, est. speed input: 7433.32 toks/s, output: 1215.09 toks/s]
Processed prompts:  69%|██████▉   | 292/424 [00:37<00:04, 30.94it/s, est. speed input: 7502.00 toks/s, output: 1225.75 toks/s]
Processed prompts:  71%|███████   | 300/424 [00:38<00:03, 38.66it/s, est. speed input: 7672.38 toks/s, output: 1249.35 toks/s]
Processed prompts:  72%|███████▏  | 305/424 [00:38<00:03, 36.27it/s, est. speed input: 7776.37 toks/s, output: 1265.16 toks/s]
Processed prompts:  75%|███████▍  | 316/424 [00:38<00:02, 49.82it/s, est. speed input: 8053.40 toks/s, output: 1302.60 toks/s]
Processed prompts:  78%|███████▊  | 329/424 [00:38<00:01, 65.47it/s, est. speed input: 8332.33 toks/s, output: 1349.50 toks/s]
Processed prompts:  80%|███████▉  | 339/424 [00:38<00:01, 71.74it/s, est. speed input: 8513.50 toks/s, output: 1385.07 toks/s]
Processed prompts:  82%|████████▏ | 347/424 [00:38<00:01, 68.11it/s, est. speed input: 8668.12 toks/s, output: 1410.87 toks/s]
Processed prompts:  84%|████████▎ | 355/424 [00:38<00:01, 66.49it/s, est. speed input: 8918.58 toks/s, output: 1438.04 toks/s]
Processed prompts:  86%|████████▌ | 363/424 [00:39<00:00, 66.25it/s, est. speed input: 9082.94 toks/s, output: 1470.55 toks/s]
Processed prompts:  87%|████████▋ | 370/424 [00:39<00:00, 58.21it/s, est. speed input: 9185.86 toks/s, output: 1493.97 toks/s]
Processed prompts:  89%|████████▉ | 377/424 [00:39<00:00, 51.62it/s, est. speed input: 9433.24 toks/s, output: 1517.74 toks/s]
Processed prompts:  91%|█████████ | 385/424 [00:39<00:00, 57.46it/s, est. speed input: 9610.02 toks/s, output: 1554.41 toks/s]
Processed prompts:  92%|█████████▏| 392/424 [00:39<00:00, 51.72it/s, est. speed input: 9705.47 toks/s, output: 1579.97 toks/s]
Processed prompts:  95%|█████████▍| 401/424 [00:39<00:00, 60.12it/s, est. speed input: 9939.36 toks/s, output: 1619.65 toks/s]
Processed prompts:  96%|█████████▌| 408/424 [00:39<00:00, 54.73it/s, est. speed input: 10103.64 toks/s, output: 1647.84 toks/s]
Processed prompts:  98%|█████████▊| 416/424 [00:40<00:00, 56.60it/s, est. speed input: 10368.51 toks/s, output: 1695.26 toks/s]
Processed prompts: 100%|█████████▉| 422/424 [00:40<00:00, 22.39it/s, est. speed input: 10419.86 toks/s, output: 1701.30 toks/s]
Processed prompts: 100%|██████████| 424/424 [00:40<00:00, 10.37it/s, est. speed input: 10459.76 toks/s, output: 1711.41 toks/s]
[rank0]:[W709 16:11:29.533604424 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/sc_rag_ae_lp_test_4_output.json
Cleaned temporary files.
