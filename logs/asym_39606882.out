Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 15:47:17.813722_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 15:47:17.813722_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 15:47:17.813722_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<02:05,  3.20it/s]
  0%|          | 2/401 [00:00<01:47,  3.69it/s]
  1%|          | 3/401 [00:02<08:13,  1.24s/it]
  1%|          | 4/401 [00:04<08:44,  1.32s/it]
  1%|          | 5/401 [00:05<09:00,  1.37s/it]
  1%|▏         | 6/401 [00:07<09:14,  1.40s/it]
  2%|▏         | 7/401 [00:08<09:23,  1.43s/it]
  2%|▏         | 8/401 [00:10<09:21,  1.43s/it]
  2%|▏         | 9/401 [00:11<09:23,  1.44s/it]
  2%|▏         | 10/401 [00:12<07:27,  1.15s/it]
  3%|▎         | 11/401 [00:13<08:31,  1.31s/it]
  3%|▎         | 13/401 [00:15<07:04,  1.09s/it]
  3%|▎         | 14/401 [00:18<10:43,  1.66s/it]
  4%|▎         | 15/401 [00:19<08:06,  1.26s/it]
  4%|▍         | 17/401 [00:19<04:58,  1.29it/s]
  4%|▍         | 18/401 [00:21<06:18,  1.01it/s]
  5%|▍         | 19/401 [00:22<07:21,  1.16s/it]
  5%|▍         | 20/401 [00:26<12:22,  1.95s/it]
  5%|▌         | 21/401 [00:27<09:22,  1.48s/it]
  5%|▌         | 22/401 [00:31<14:00,  2.22s/it]
  6%|▌         | 23/401 [00:32<12:59,  2.06s/it]
  6%|▌         | 24/401 [00:37<16:51,  2.68s/it]
  6%|▌         | 25/401 [00:37<12:05,  1.93s/it]
  6%|▋         | 26/401 [00:37<08:53,  1.42s/it]
  7%|▋         | 27/401 [00:41<13:55,  2.23s/it]
  7%|▋         | 28/401 [00:41<10:16,  1.65s/it]
  7%|▋         | 29/401 [00:41<07:23,  1.19s/it]
  7%|▋         | 30/401 [00:43<07:36,  1.23s/it]
  8%|▊         | 31/401 [00:44<07:24,  1.20s/it]
  8%|▊         | 32/401 [00:44<05:31,  1.11it/s]
  8%|▊         | 33/401 [00:45<05:56,  1.03it/s]
  8%|▊         | 34/401 [00:47<07:45,  1.27s/it]
  9%|▊         | 35/401 [00:47<05:36,  1.09it/s]
  9%|▉         | 37/401 [00:48<03:36,  1.68it/s]
 10%|▉         | 39/401 [00:49<03:39,  1.65it/s]
 10%|█         | 41/401 [00:50<03:51,  1.56it/s]
 10%|█         | 42/401 [00:51<03:22,  1.77it/s]
 11%|█         | 43/401 [00:51<02:59,  1.99it/s]
 11%|█         | 44/401 [00:52<03:40,  1.62it/s]
 11%|█▏        | 46/401 [00:52<02:45,  2.15it/s]
 12%|█▏        | 47/401 [00:54<04:49,  1.22it/s]
 12%|█▏        | 48/401 [00:55<04:14,  1.39it/s]
 12%|█▏        | 49/401 [00:55<03:41,  1.59it/s]
 12%|█▏        | 50/401 [00:56<03:55,  1.49it/s]
 13%|█▎        | 51/401 [00:56<03:29,  1.67it/s]
 13%|█▎        | 53/401 [00:57<02:37,  2.22it/s]
 13%|█▎        | 54/401 [00:57<02:14,  2.58it/s]
 14%|█▎        | 55/401 [01:00<05:44,  1.00it/s]
 14%|█▍        | 56/401 [01:01<06:12,  1.08s/it]
 14%|█▍        | 57/401 [01:02<06:00,  1.05s/it]
 14%|█▍        | 58/401 [01:02<04:28,  1.28it/s]
 15%|█▍        | 59/401 [01:05<07:40,  1.35s/it]
 15%|█▍        | 60/401 [01:06<06:30,  1.15s/it]
 15%|█▌        | 61/401 [01:06<05:19,  1.07it/s]
 15%|█▌        | 62/401 [01:06<04:15,  1.33it/s]
 16%|█▌        | 63/401 [01:07<03:48,  1.48it/s]
 16%|█▌        | 64/401 [01:07<03:27,  1.62it/s]
 16%|█▌        | 65/401 [01:08<03:15,  1.72it/s]
 16%|█▋        | 66/401 [01:09<04:25,  1.26it/s]
 17%|█▋        | 67/401 [01:09<03:32,  1.57it/s]
 17%|█▋        | 68/401 [01:10<02:49,  1.97it/s]
 17%|█▋        | 70/401 [01:11<03:00,  1.83it/s]
 18%|█▊        | 71/401 [01:11<02:44,  2.01it/s]
 18%|█▊        | 72/401 [01:12<03:26,  1.60it/s]
 18%|█▊        | 73/401 [01:12<02:58,  1.84it/s]
 18%|█▊        | 74/401 [01:13<03:36,  1.51it/s]
 19%|█▊        | 75/401 [01:14<04:05,  1.33it/s]
 19%|█▉        | 76/401 [01:15<04:25,  1.22it/s]
 19%|█▉        | 77/401 [01:16<04:40,  1.16it/s]
 19%|█▉        | 78/401 [01:17<03:31,  1.53it/s]
 20%|█▉        | 79/401 [01:18<04:01,  1.34it/s]
 20%|█▉        | 80/401 [01:18<04:21,  1.23it/s]
 20%|██        | 81/401 [01:19<04:15,  1.25it/s]
 20%|██        | 82/401 [01:20<04:31,  1.17it/s]
 21%|██        | 83/401 [01:21<04:43,  1.12it/s]
 21%|██        | 84/401 [01:22<04:51,  1.09it/s]
 21%|██        | 85/401 [01:23<03:58,  1.32it/s]
 21%|██▏       | 86/401 [01:24<04:18,  1.22it/s]
 22%|██▏       | 87/401 [01:26<07:19,  1.40s/it]
 22%|██▏       | 88/401 [01:27<06:38,  1.27s/it]
 22%|██▏       | 89/401 [01:29<06:41,  1.29s/it]
 22%|██▏       | 90/401 [01:29<04:59,  1.04it/s]
 23%|██▎       | 91/401 [01:29<03:43,  1.39it/s]
 23%|██▎       | 92/401 [01:30<04:06,  1.26it/s]
 23%|██▎       | 93/401 [01:30<03:11,  1.61it/s]
 23%|██▎       | 94/401 [01:32<05:16,  1.03s/it]
 24%|██▎       | 95/401 [01:33<05:39,  1.11s/it]
 24%|██▍       | 96/401 [01:34<05:26,  1.07s/it]
 24%|██▍       | 97/401 [01:35<05:16,  1.04s/it]
 24%|██▍       | 98/401 [01:36<04:16,  1.18it/s]
 25%|██▍       | 99/401 [01:36<03:15,  1.55it/s]
 25%|██▍       | 100/401 [01:36<02:41,  1.86it/s]
 25%|██▌       | 101/401 [01:37<03:03,  1.63it/s]
 25%|██▌       | 102/401 [01:37<02:20,  2.13it/s]
 26%|██▌       | 103/401 [01:38<02:15,  2.20it/s]
 26%|██▌       | 104/401 [01:39<03:01,  1.64it/s]
 26%|██▌       | 105/401 [01:39<03:32,  1.39it/s]
 27%|██▋       | 107/401 [01:40<02:31,  1.94it/s]
 27%|██▋       | 108/401 [01:40<02:04,  2.36it/s]
 27%|██▋       | 109/401 [01:41<02:45,  1.76it/s]
 27%|██▋       | 110/401 [01:41<02:08,  2.27it/s]
 28%|██▊       | 111/401 [01:42<02:49,  1.71it/s]
 28%|██▊       | 112/401 [01:43<03:20,  1.44it/s]
 28%|██▊       | 113/401 [01:44<03:16,  1.46it/s]
 28%|██▊       | 114/401 [01:44<03:09,  1.52it/s]
 29%|██▊       | 115/401 [01:45<02:33,  1.86it/s]
 29%|██▉       | 116/401 [01:46<03:08,  1.51it/s]
 29%|██▉       | 117/401 [01:46<02:52,  1.64it/s]
 29%|██▉       | 118/401 [01:46<02:17,  2.06it/s]
 30%|██▉       | 119/401 [01:48<03:16,  1.44it/s]
 30%|██▉       | 120/401 [01:48<02:33,  1.84it/s]
 30%|███       | 121/401 [01:48<02:04,  2.25it/s]
 30%|███       | 122/401 [01:49<02:17,  2.03it/s]
 31%|███       | 123/401 [01:50<03:24,  1.36it/s]
 31%|███       | 124/401 [01:51<04:11,  1.10it/s]
 31%|███       | 125/401 [01:52<04:44,  1.03s/it]
 31%|███▏      | 126/401 [01:53<03:36,  1.27it/s]
 32%|███▏      | 127/401 [01:54<04:18,  1.06it/s]
 32%|███▏      | 128/401 [01:55<04:48,  1.06s/it]
 32%|███▏      | 129/401 [01:56<04:39,  1.03s/it]
 32%|███▏      | 130/401 [01:58<05:01,  1.11s/it]
 33%|███▎      | 131/401 [01:58<04:33,  1.01s/it]
 33%|███▎      | 132/401 [01:59<03:32,  1.27it/s]
 33%|███▎      | 133/401 [02:01<06:08,  1.38s/it]
 33%|███▎      | 134/401 [02:02<05:35,  1.26s/it]
 34%|███▎      | 135/401 [02:03<05:13,  1.18s/it]
 34%|███▍      | 136/401 [02:04<04:55,  1.12s/it]
 34%|███▍      | 137/401 [02:04<03:38,  1.21it/s]
 34%|███▍      | 138/401 [02:05<03:47,  1.15it/s]
 35%|███▍      | 139/401 [02:06<03:39,  1.19it/s]
 35%|███▍      | 140/401 [02:06<02:50,  1.53it/s]
 35%|███▌      | 141/401 [02:08<04:14,  1.02it/s]
 35%|███▌      | 142/401 [02:09<04:40,  1.08s/it]
 36%|███▌      | 143/401 [02:10<03:48,  1.13it/s]
 36%|███▌      | 144/401 [02:11<03:53,  1.10it/s]
 36%|███▌      | 145/401 [02:11<03:04,  1.39it/s]
 36%|███▋      | 146/401 [02:12<03:23,  1.25it/s]
 37%|███▋      | 147/401 [02:13<03:35,  1.18it/s]
 37%|███▋      | 148/401 [02:14<03:01,  1.40it/s]
 37%|███▋      | 149/401 [02:14<03:18,  1.27it/s]
 37%|███▋      | 150/401 [02:15<03:31,  1.19it/s]
 38%|███▊      | 151/401 [02:17<04:06,  1.02it/s]
 38%|███▊      | 152/401 [02:18<04:03,  1.02it/s]
 38%|███▊      | 153/401 [02:18<03:22,  1.23it/s]
 38%|███▊      | 154/401 [02:19<02:56,  1.40it/s]
 39%|███▊      | 155/401 [02:20<03:38,  1.13it/s]
 39%|███▉      | 156/401 [02:21<04:08,  1.02s/it]
 39%|███▉      | 157/401 [02:23<04:28,  1.10s/it]
 40%|███▉      | 159/401 [02:24<03:19,  1.21it/s]
 40%|███▉      | 160/401 [02:24<02:54,  1.38it/s]
 40%|████      | 162/401 [02:25<02:42,  1.47it/s]
 41%|████      | 163/401 [02:26<02:49,  1.40it/s]
 41%|████      | 164/401 [02:27<02:52,  1.37it/s]
 41%|████      | 165/401 [02:28<03:07,  1.26it/s]
 41%|████▏     | 166/401 [02:29<03:19,  1.18it/s]
 42%|████▏     | 167/401 [02:29<02:32,  1.53it/s]
 42%|████▏     | 168/401 [02:30<02:52,  1.35it/s]
 42%|████▏     | 169/401 [02:31<03:06,  1.24it/s]
 42%|████▏     | 170/401 [02:32<03:17,  1.17it/s]
 43%|████▎     | 171/401 [02:33<03:24,  1.13it/s]
 43%|████▎     | 172/401 [02:33<02:52,  1.33it/s]
 43%|████▎     | 173/401 [02:34<03:07,  1.22it/s]
 43%|████▎     | 174/401 [02:35<03:18,  1.14it/s]
 44%|████▎     | 175/401 [02:36<03:23,  1.11it/s]
 44%|████▍     | 176/401 [02:37<03:27,  1.08it/s]
 44%|████▍     | 177/401 [02:38<03:53,  1.04s/it]
 44%|████▍     | 178/401 [02:39<03:46,  1.02s/it]
 45%|████▍     | 179/401 [02:40<03:41,  1.00it/s]
 45%|████▍     | 180/401 [02:41<03:39,  1.01it/s]
 45%|████▌     | 181/401 [02:42<03:37,  1.01it/s]
 45%|████▌     | 182/401 [02:43<03:36,  1.01it/s]
 46%|████▌     | 183/401 [02:47<06:26,  1.77s/it]
 46%|████▌     | 184/401 [02:50<08:21,  2.31s/it]
 46%|████▌     | 185/401 [02:54<09:45,  2.71s/it]
 46%|████▋     | 186/401 [02:58<10:40,  2.98s/it]
 47%|████▋     | 187/401 [03:01<11:19,  3.17s/it]
 47%|████▋     | 188/401 [03:02<08:06,  2.29s/it]
 47%|████▋     | 189/401 [03:05<09:32,  2.70s/it]
 47%|████▋     | 190/401 [03:09<10:27,  2.97s/it]
 48%|████▊     | 191/401 [03:11<09:11,  2.62s/it]
 48%|████▊     | 192/401 [03:12<08:17,  2.38s/it]
 48%|████▊     | 193/401 [03:13<05:58,  1.72s/it]
 48%|████▊     | 194/401 [03:13<04:26,  1.29s/it]
 49%|████▊     | 195/401 [03:17<06:49,  1.99s/it]
 49%|████▉     | 196/401 [03:18<06:34,  1.93s/it]
 49%|████▉     | 197/401 [03:20<06:37,  1.95s/it]
 49%|████▉     | 198/401 [03:24<08:14,  2.44s/it]
 50%|████▉     | 199/401 [03:26<07:33,  2.25s/it]
 50%|████▉     | 200/401 [03:28<07:05,  2.12s/it]
 50%|█████     | 201/401 [03:29<06:46,  2.03s/it]
 50%|█████     | 202/401 [03:31<06:30,  1.96s/it]
 51%|█████     | 203/401 [03:33<06:19,  1.92s/it]
 51%|█████     | 204/401 [03:35<06:11,  1.88s/it]
 51%|█████     | 205/401 [03:35<04:26,  1.36s/it]
 51%|█████▏    | 206/401 [03:37<04:52,  1.50s/it]
 52%|█████▏    | 207/401 [03:39<05:11,  1.60s/it]
 52%|█████▏    | 208/401 [03:40<05:19,  1.66s/it]
 52%|█████▏    | 209/401 [03:41<04:06,  1.28s/it]
 52%|█████▏    | 210/401 [03:43<04:36,  1.45s/it]
 53%|█████▎    | 211/401 [03:43<03:56,  1.24s/it]
 53%|█████▎    | 212/401 [03:44<03:17,  1.04s/it]
 53%|█████▎    | 213/401 [03:45<03:01,  1.04it/s]
 53%|█████▎    | 214/401 [03:47<03:47,  1.22s/it]
 54%|█████▎    | 215/401 [03:47<03:13,  1.04s/it]
 54%|█████▍    | 216/401 [03:48<03:27,  1.12s/it]
 54%|█████▍    | 218/401 [03:49<02:19,  1.32it/s]
 55%|█████▍    | 219/401 [03:50<02:12,  1.38it/s]
 55%|█████▍    | 220/401 [03:50<02:06,  1.44it/s]
 55%|█████▌    | 221/401 [03:53<03:45,  1.25s/it]
 55%|█████▌    | 222/401 [03:54<03:12,  1.08s/it]
 56%|█████▌    | 223/401 [03:54<02:23,  1.24it/s]
 56%|█████▌    | 224/401 [03:54<01:59,  1.49it/s]
 56%|█████▌    | 225/401 [03:54<01:31,  1.93it/s]
 56%|█████▋    | 226/401 [03:55<01:10,  2.49it/s]
 57%|█████▋    | 227/401 [03:55<01:00,  2.89it/s]
 57%|█████▋    | 228/401 [03:55<01:16,  2.27it/s]
 57%|█████▋    | 229/401 [03:56<01:02,  2.75it/s]
 57%|█████▋    | 230/401 [03:57<02:04,  1.37it/s]
 58%|█████▊    | 231/401 [03:57<01:35,  1.78it/s]
 58%|█████▊    | 232/401 [03:58<01:35,  1.77it/s]
 58%|█████▊    | 234/401 [04:02<03:13,  1.16s/it]
 59%|█████▊    | 235/401 [04:02<02:38,  1.05it/s]
 59%|█████▉    | 236/401 [04:02<02:02,  1.35it/s]
 59%|█████▉    | 237/401 [04:03<01:53,  1.44it/s]
 59%|█████▉    | 238/401 [04:03<01:42,  1.59it/s]
 60%|█████▉    | 239/401 [04:04<01:41,  1.60it/s]
 60%|█████▉    | 240/401 [04:04<01:20,  2.00it/s]
 60%|██████    | 242/401 [04:04<00:52,  3.04it/s]
 61%|██████    | 243/401 [04:05<01:08,  2.31it/s]
 61%|██████    | 244/401 [04:05<01:05,  2.39it/s]
 61%|██████    | 245/401 [04:05<00:53,  2.94it/s]
 61%|██████▏   | 246/401 [04:06<01:04,  2.40it/s]
 62%|██████▏   | 247/401 [04:07<01:12,  2.11it/s]
 62%|██████▏   | 248/401 [04:07<00:56,  2.72it/s]
 62%|██████▏   | 249/401 [04:08<01:43,  1.47it/s]
 63%|██████▎   | 251/401 [04:09<01:07,  2.22it/s]
 63%|██████▎   | 252/401 [04:09<00:54,  2.71it/s]
 63%|██████▎   | 254/401 [04:09<00:43,  3.41it/s]
 64%|██████▎   | 255/401 [04:11<01:27,  1.66it/s]
 64%|██████▍   | 256/401 [04:11<01:16,  1.89it/s]
 64%|██████▍   | 257/401 [04:11<01:09,  2.09it/s]
 64%|██████▍   | 258/401 [04:12<01:03,  2.26it/s]
 65%|██████▍   | 259/401 [04:12<00:57,  2.46it/s]
 65%|██████▌   | 261/401 [04:13<00:53,  2.61it/s]
 65%|██████▌   | 262/401 [04:13<00:50,  2.73it/s]
 66%|██████▌   | 263/401 [04:13<00:49,  2.80it/s]
 66%|██████▌   | 264/401 [04:14<00:43,  3.18it/s]
 66%|██████▌   | 265/401 [04:14<00:43,  3.13it/s]
 66%|██████▋   | 266/401 [04:14<00:43,  3.10it/s]
 67%|██████▋   | 267/401 [04:14<00:36,  3.63it/s]
 67%|██████▋   | 268/401 [04:15<00:33,  4.01it/s]
 67%|██████▋   | 269/401 [04:15<00:45,  2.89it/s]
 67%|██████▋   | 270/401 [04:16<00:55,  2.37it/s]
 68%|██████▊   | 272/401 [04:16<00:35,  3.67it/s]
 68%|██████▊   | 273/401 [04:16<00:30,  4.14it/s]
 68%|██████▊   | 274/401 [04:16<00:26,  4.75it/s]
 69%|██████▊   | 275/401 [04:16<00:23,  5.33it/s]
 69%|██████▉   | 276/401 [04:16<00:22,  5.58it/s]
 69%|██████▉   | 277/401 [04:17<00:34,  3.64it/s]
 69%|██████▉   | 278/401 [04:17<00:29,  4.21it/s]
 70%|██████▉   | 279/401 [04:17<00:24,  4.91it/s]
 70%|██████▉   | 280/401 [04:18<00:31,  3.87it/s]
 70%|███████   | 281/401 [04:18<00:26,  4.55it/s]
 70%|███████   | 282/401 [04:18<00:22,  5.32it/s]
 71%|███████   | 283/401 [04:18<00:35,  3.35it/s]
 71%|███████   | 284/401 [04:19<00:35,  3.30it/s]
 71%|███████   | 285/401 [04:19<00:31,  3.66it/s]
 71%|███████▏  | 286/401 [04:19<00:33,  3.46it/s]
 72%|███████▏  | 287/401 [04:20<00:33,  3.39it/s]
 72%|███████▏  | 288/401 [04:20<00:28,  4.00it/s]
 72%|███████▏  | 289/401 [04:20<00:26,  4.19it/s]
 73%|███████▎  | 291/401 [04:20<00:26,  4.22it/s]
 73%|███████▎  | 292/401 [04:22<00:58,  1.86it/s]
 73%|███████▎  | 293/401 [04:23<01:09,  1.55it/s]
 73%|███████▎  | 294/401 [04:26<02:18,  1.29s/it]
 74%|███████▎  | 295/401 [04:26<01:42,  1.04it/s]
 74%|███████▍  | 296/401 [04:27<01:40,  1.04it/s]
 74%|███████▍  | 297/401 [04:27<01:15,  1.37it/s]
 74%|███████▍  | 298/401 [04:27<01:04,  1.61it/s]
 75%|███████▍  | 299/401 [04:29<01:28,  1.16it/s]
 75%|███████▍  | 300/401 [04:30<01:26,  1.17it/s]
 75%|███████▌  | 301/401 [04:30<01:04,  1.55it/s]
 75%|███████▌  | 302/401 [04:30<00:48,  2.05it/s]
 76%|███████▌  | 303/401 [04:31<00:57,  1.69it/s]
 76%|███████▌  | 304/401 [04:31<00:59,  1.63it/s]
 76%|███████▌  | 305/401 [04:33<01:13,  1.32it/s]
 76%|███████▋  | 306/401 [04:33<01:13,  1.29it/s]
 77%|███████▋  | 307/401 [04:34<01:18,  1.20it/s]
 77%|███████▋  | 308/401 [04:35<01:06,  1.40it/s]
 77%|███████▋  | 309/401 [04:35<01:03,  1.46it/s]
 77%|███████▋  | 310/401 [04:36<00:54,  1.66it/s]
 78%|███████▊  | 311/401 [04:37<01:00,  1.50it/s]
 78%|███████▊  | 312/401 [04:37<00:51,  1.71it/s]
 78%|███████▊  | 313/401 [04:37<00:40,  2.16it/s]
 78%|███████▊  | 314/401 [04:38<00:38,  2.24it/s]
 79%|███████▊  | 315/401 [04:38<00:32,  2.62it/s]
 79%|███████▉  | 316/401 [04:38<00:26,  3.16it/s]
 79%|███████▉  | 317/401 [04:39<00:54,  1.54it/s]
 79%|███████▉  | 318/401 [04:40<00:50,  1.65it/s]
 80%|███████▉  | 319/401 [04:40<00:41,  1.98it/s]
 80%|███████▉  | 320/401 [04:41<00:40,  2.02it/s]
 80%|████████  | 321/401 [04:41<00:39,  2.05it/s]
 80%|████████  | 322/401 [04:42<00:38,  2.06it/s]
 81%|████████  | 323/401 [04:45<01:46,  1.36s/it]
 81%|████████  | 324/401 [04:48<02:30,  1.96s/it]
 81%|████████  | 325/401 [04:52<03:01,  2.39s/it]
 81%|████████▏ | 326/401 [04:53<02:26,  1.95s/it]
 82%|████████▏ | 327/401 [04:54<01:59,  1.62s/it]
 82%|████████▏ | 328/401 [04:54<01:34,  1.29s/it]
 82%|████████▏ | 329/401 [04:56<01:40,  1.40s/it]
 82%|████████▏ | 330/401 [04:59<02:21,  2.00s/it]
 83%|████████▎ | 331/401 [05:00<01:58,  1.69s/it]
 83%|████████▎ | 332/401 [05:04<02:32,  2.21s/it]
 83%|████████▎ | 333/401 [05:07<02:53,  2.55s/it]
 83%|████████▎ | 334/401 [05:07<02:06,  1.89s/it]
 84%|████████▎ | 335/401 [05:11<02:34,  2.35s/it]
 84%|████████▍ | 336/401 [05:14<02:52,  2.66s/it]
 84%|████████▍ | 337/401 [05:15<02:20,  2.20s/it]
 84%|████████▍ | 338/401 [05:16<01:46,  1.70s/it]
 85%|████████▍ | 339/401 [05:16<01:23,  1.35s/it]
 85%|████████▍ | 340/401 [05:16<01:00,  1.01it/s]
 85%|████████▌ | 341/401 [05:16<00:43,  1.37it/s]
 85%|████████▌ | 342/401 [05:17<00:35,  1.66it/s]
 86%|████████▌ | 343/401 [05:17<00:33,  1.73it/s]
 86%|████████▌ | 344/401 [05:18<00:28,  2.00it/s]
 86%|████████▌ | 345/401 [05:19<00:44,  1.27it/s]
 86%|████████▋ | 346/401 [05:19<00:36,  1.49it/s]
 87%|████████▋ | 347/401 [05:20<00:31,  1.73it/s]
 87%|████████▋ | 348/401 [05:20<00:28,  1.89it/s]
 87%|████████▋ | 349/401 [05:21<00:23,  2.24it/s]
 87%|████████▋ | 350/401 [05:24<01:02,  1.24s/it]
 88%|████████▊ | 351/401 [05:27<01:34,  1.88s/it]
 88%|████████▊ | 352/401 [05:27<01:07,  1.39s/it]
 88%|████████▊ | 353/401 [05:31<01:37,  2.03s/it]
 89%|████████▊ | 355/401 [05:31<00:54,  1.19s/it]
 89%|████████▉ | 356/401 [05:34<01:14,  1.66s/it]
 89%|████████▉ | 357/401 [05:35<01:02,  1.41s/it]
 89%|████████▉ | 358/401 [05:36<00:57,  1.34s/it]
 90%|████████▉ | 359/401 [05:37<00:51,  1.23s/it]
 90%|████████▉ | 360/401 [05:38<00:46,  1.14s/it]
 90%|█████████ | 361/401 [05:38<00:37,  1.06it/s]
 90%|█████████ | 362/401 [05:39<00:29,  1.33it/s]
 91%|█████████ | 363/401 [05:39<00:23,  1.63it/s]
 91%|█████████ | 364/401 [05:39<00:17,  2.06it/s]
 91%|█████████ | 365/401 [05:41<00:30,  1.17it/s]
 91%|█████████▏| 366/401 [05:41<00:23,  1.49it/s]
 92%|█████████▏| 367/401 [05:42<00:21,  1.61it/s]
 92%|█████████▏| 368/401 [05:42<00:15,  2.14it/s]
 92%|█████████▏| 369/401 [05:42<00:13,  2.43it/s]
 92%|█████████▏| 370/401 [05:44<00:24,  1.25it/s]
 93%|█████████▎| 371/401 [05:45<00:32,  1.07s/it]
 93%|█████████▎| 372/401 [05:46<00:23,  1.25it/s]
 93%|█████████▎| 373/401 [05:47<00:30,  1.08s/it]
 93%|█████████▎| 374/401 [05:49<00:34,  1.27s/it]
 94%|█████████▎| 375/401 [05:51<00:36,  1.40s/it]
 94%|█████████▍| 376/401 [05:54<00:47,  1.90s/it]
 94%|█████████▍| 377/401 [05:54<00:34,  1.46s/it]
 94%|█████████▍| 378/401 [05:57<00:45,  1.96s/it]
 95%|█████████▍| 379/401 [06:01<00:52,  2.39s/it]
 95%|█████████▍| 380/401 [06:03<00:46,  2.19s/it]
 95%|█████████▌| 382/401 [06:06<00:35,  1.89s/it]
 96%|█████████▌| 383/401 [06:09<00:39,  2.20s/it]
 96%|█████████▌| 384/401 [06:11<00:38,  2.24s/it]
 96%|█████████▌| 385/401 [06:14<00:40,  2.55s/it]
 96%|█████████▋| 386/401 [06:15<00:31,  2.08s/it]
 97%|█████████▋| 387/401 [06:17<00:25,  1.85s/it]
 97%|█████████▋| 388/401 [06:18<00:21,  1.64s/it]
 97%|█████████▋| 389/401 [06:18<00:15,  1.30s/it]
 97%|█████████▋| 390/401 [06:19<00:11,  1.08s/it]
 98%|█████████▊| 391/401 [06:19<00:08,  1.21it/s]
 98%|█████████▊| 392/401 [06:20<00:08,  1.09it/s]
 98%|█████████▊| 393/401 [06:20<00:05,  1.42it/s]
 98%|█████████▊| 394/401 [06:21<00:03,  1.75it/s]
 99%|█████████▊| 395/401 [06:21<00:03,  2.00it/s]
 99%|█████████▉| 396/401 [06:24<00:07,  1.40s/it]
 99%|█████████▉| 397/401 [06:25<00:04,  1.07s/it]
 99%|█████████▉| 398/401 [06:28<00:05,  1.82s/it]
100%|█████████▉| 399/401 [06:32<00:04,  2.30s/it]
100%|█████████▉| 400/401 [06:32<00:01,  1.67s/it]
100%|██████████| 401/401 [06:32<00:00,  1.21s/it]
100%|██████████| 401/401 [06:32<00:00,  1.02it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 15:47:17.813722_ae_processed_test.json', '--output_addr', 'data/out/rag/full_profile/ae_rag_full_profile_test_8_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '8', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  2.64 examples/s]
Generating train split: 401 examples [00:00, 514.14 examples/s]
INFO 07-09 15:54:25 config.py:510] This model supports multiple tasks: {'classify', 'reward', 'score', 'generate', 'embed'}. Defaulting to 'generate'.
INFO 07-09 15:54:25 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 15:54:26 selector.py:120] Using Flash Attention backend.
INFO 07-09 15:54:27 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 15:54:28 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:04<00:14,  4.99s/it]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:10<00:10,  5.06s/it]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:14<00:04,  4.88s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:19<00:00,  4.91s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:19<00:00,  4.93s/it]

INFO 07-09 16:23:58 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:24:00 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-09 16:24:00 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:24:00 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:24:00 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:24:00 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:24:03 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  3.06it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.38it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.50it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.56it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.60it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.63it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.66it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.67it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.66it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.68it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.70it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.71it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.72it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.73it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.73it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.73it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.78it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.82it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.83it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.86it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.87it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.88it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.89it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.90it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.91it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:06<00:02,  3.92it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.93it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.93it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.95it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:07<00:01,  3.95it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.95it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.97it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.89it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:08<00:00,  3.93it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.95it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.80it/s]
INFO 07-09 16:24:12 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 16:24:12 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.22 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:29<3:18:04, 29.71s/it, est. speed input: 32.18 toks/s, output: 3.13 toks/s]
Processed prompts:   0%|          | 2/401 [00:29<1:21:56, 12.32s/it, est. speed input: 83.22 toks/s, output: 6.26 toks/s]
Processed prompts:   1%|          | 4/401 [00:30<31:54,  4.82s/it, est. speed input: 191.14 toks/s, output: 12.46 toks/s]
Processed prompts:   1%|          | 5/401 [00:30<22:24,  3.40s/it, est. speed input: 244.38 toks/s, output: 15.69 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:31<16:18,  2.48s/it, est. speed input: 278.30 toks/s, output: 18.88 toks/s]
Processed prompts:   2%|▏         | 9/401 [00:31<07:58,  1.22s/it, est. speed input: 383.98 toks/s, output: 28.49 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:32<06:37,  1.02s/it, est. speed input: 470.87 toks/s, output: 31.73 toks/s]
Processed prompts:   3%|▎         | 11/401 [00:32<05:22,  1.21it/s, est. speed input: 499.34 toks/s, output: 35.02 toks/s]
Processed prompts:   3%|▎         | 13/401 [00:33<03:59,  1.62it/s, est. speed input: 541.21 toks/s, output: 41.31 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:33<03:23,  1.91it/s, est. speed input: 593.90 toks/s, output: 44.60 toks/s]
Processed prompts:   4%|▎         | 15/401 [00:33<02:46,  2.32it/s, est. speed input: 622.78 toks/s, output: 47.99 toks/s]
Processed prompts:   4%|▍         | 16/401 [00:33<02:23,  2.68it/s, est. speed input: 644.93 toks/s, output: 51.27 toks/s]
Processed prompts:   5%|▍         | 19/401 [00:33<01:34,  4.04it/s, est. speed input: 841.17 toks/s, output: 61.38 toks/s]
Processed prompts:   5%|▌         | 21/401 [00:34<01:22,  4.62it/s, est. speed input: 904.04 toks/s, output: 68.03 toks/s]
Processed prompts:   6%|▌         | 23/401 [00:34<01:06,  5.71it/s, est. speed input: 948.74 toks/s, output: 74.90 toks/s]
Processed prompts:   6%|▌         | 25/401 [00:34<01:04,  5.80it/s, est. speed input: 1031.17 toks/s, output: 81.40 toks/s]
Processed prompts:   7%|▋         | 28/401 [00:35<00:51,  7.28it/s, est. speed input: 1118.86 toks/s, output: 91.61 toks/s]
Processed prompts:   7%|▋         | 29/401 [00:35<00:54,  6.79it/s, est. speed input: 1181.60 toks/s, output: 94.73 toks/s]
Processed prompts:   9%|▊         | 35/401 [00:36<00:50,  7.21it/s, est. speed input: 1339.50 toks/s, output: 114.13 toks/s]
Processed prompts:  10%|▉         | 39/401 [00:36<00:51,  7.06it/s, est. speed input: 1454.98 toks/s, output: 126.52 toks/s]
Processed prompts:  10%|█         | 42/401 [00:37<00:58,  6.11it/s, est. speed input: 1663.78 toks/s, output: 134.83 toks/s]
Processed prompts:  11%|█         | 45/401 [00:37<00:57,  6.21it/s, est. speed input: 1769.81 toks/s, output: 143.69 toks/s]
Processed prompts:  11%|█▏        | 46/401 [00:38<01:04,  5.52it/s, est. speed input: 1785.90 toks/s, output: 145.96 toks/s]
Processed prompts:  12%|█▏        | 50/401 [00:38<00:51,  6.83it/s, est. speed input: 1909.31 toks/s, output: 158.47 toks/s]
Processed prompts:  13%|█▎        | 52/401 [00:38<00:57,  6.11it/s, est. speed input: 1961.36 toks/s, output: 163.62 toks/s]
Processed prompts:  14%|█▎        | 55/401 [00:39<00:47,  7.23it/s, est. speed input: 2125.99 toks/s, output: 172.98 toks/s]
Processed prompts:  14%|█▍        | 57/401 [00:39<00:53,  6.43it/s, est. speed input: 2189.51 toks/s, output: 178.08 toks/s]
Processed prompts:  15%|█▌        | 61/401 [00:40<00:51,  6.56it/s, est. speed input: 2284.45 toks/s, output: 189.22 toks/s]
Processed prompts:  16%|█▋        | 66/401 [00:40<00:49,  6.75it/s, est. speed input: 2412.82 toks/s, output: 202.94 toks/s]
Processed prompts:  17%|█▋        | 70/401 [00:41<00:43,  7.67it/s, est. speed input: 2477.09 toks/s, output: 214.71 toks/s]
Processed prompts:  19%|█▉        | 76/401 [00:42<00:51,  6.28it/s, est. speed input: 2680.42 toks/s, output: 228.54 toks/s]
Processed prompts:  20%|██        | 82/401 [00:43<00:45,  6.94it/s, est. speed input: 2817.19 toks/s, output: 244.55 toks/s]
Processed prompts:  21%|██        | 85/401 [00:43<00:50,  6.26it/s, est. speed input: 2935.15 toks/s, output: 250.68 toks/s]
Processed prompts:  22%|██▏       | 90/401 [00:44<00:51,  6.02it/s, est. speed input: 3037.18 toks/s, output: 261.78 toks/s]
Processed prompts:  24%|██▍       | 96/401 [00:45<00:51,  5.93it/s, est. speed input: 3213.26 toks/s, output: 274.85 toks/s]
Processed prompts:  25%|██▍       | 100/401 [00:46<00:45,  6.68it/s, est. speed input: 3291.06 toks/s, output: 285.27 toks/s]
Processed prompts:  25%|██▌       | 101/401 [00:46<00:50,  6.00it/s, est. speed input: 3286.24 toks/s, output: 286.29 toks/s]
Processed prompts:  26%|██▌       | 105/401 [00:47<00:44,  6.58it/s, est. speed input: 3443.74 toks/s, output: 295.95 toks/s]
Processed prompts:  27%|██▋       | 108/401 [00:47<00:48,  6.06it/s, est. speed input: 3510.47 toks/s, output: 301.58 toks/s]
Processed prompts:  27%|██▋       | 110/401 [00:47<00:49,  5.91it/s, est. speed input: 3583.93 toks/s, output: 305.51 toks/s]
Processed prompts:  29%|██▊       | 115/401 [00:48<00:44,  6.36it/s, est. speed input: 3764.45 toks/s, output: 316.63 toks/s]
Processed prompts:  30%|██▉       | 119/401 [00:49<00:39,  7.08it/s, est. speed input: 3830.04 toks/s, output: 326.27 toks/s]
Processed prompts:  30%|███       | 121/401 [00:49<00:45,  6.20it/s, est. speed input: 3852.68 toks/s, output: 329.18 toks/s]
Processed prompts:  31%|███       | 123/401 [00:49<00:44,  6.19it/s, est. speed input: 3895.63 toks/s, output: 333.23 toks/s]
Processed prompts:  32%|███▏      | 129/401 [00:50<00:39,  6.85it/s, est. speed input: 4080.04 toks/s, output: 346.51 toks/s]
Processed prompts:  33%|███▎      | 133/401 [00:51<00:38,  6.97it/s, est. speed input: 4152.69 toks/s, output: 354.98 toks/s]
Processed prompts:  33%|███▎      | 134/401 [00:51<00:43,  6.21it/s, est. speed input: 4167.56 toks/s, output: 355.84 toks/s]
Processed prompts:  34%|███▍      | 136/401 [00:51<00:39,  6.72it/s, est. speed input: 4204.69 toks/s, output: 360.51 toks/s]
Processed prompts:  35%|███▍      | 139/401 [00:52<00:37,  7.08it/s, est. speed input: 4244.60 toks/s, output: 367.07 toks/s]
Processed prompts:  36%|███▌      | 144/401 [00:52<00:35,  7.22it/s, est. speed input: 4303.42 toks/s, output: 377.57 toks/s]
Processed prompts:  37%|███▋      | 150/401 [00:52<00:22, 11.19it/s, est. speed input: 4490.90 toks/s, output: 394.93 toks/s]
Processed prompts:  38%|███▊      | 152/401 [00:53<00:21, 11.67it/s, est. speed input: 4536.74 toks/s, output: 400.10 toks/s]
Processed prompts:  40%|███▉      | 159/401 [00:53<00:13, 18.32it/s, est. speed input: 4760.68 toks/s, output: 420.87 toks/s]
Processed prompts:  41%|████      | 164/401 [00:53<00:10, 22.22it/s, est. speed input: 4945.33 toks/s, output: 435.57 toks/s]
Processed prompts:  43%|████▎     | 174/401 [00:53<00:06, 34.17it/s, est. speed input: 5198.92 toks/s, output: 466.14 toks/s]
Processed prompts:  45%|████▍     | 179/401 [00:53<00:06, 35.96it/s, est. speed input: 5296.52 toks/s, output: 481.05 toks/s]
Processed prompts:  47%|████▋     | 187/401 [00:53<00:05, 39.49it/s, est. speed input: 5503.25 toks/s, output: 505.26 toks/s]
Processed prompts:  48%|████▊     | 192/401 [00:53<00:05, 40.90it/s, est. speed input: 5674.45 toks/s, output: 520.57 toks/s]
Processed prompts:  49%|████▉     | 197/401 [00:53<00:04, 42.20it/s, est. speed input: 5824.79 toks/s, output: 536.07 toks/s]
Processed prompts:  50%|█████     | 202/401 [00:54<00:04, 43.45it/s, est. speed input: 6034.38 toks/s, output: 551.68 toks/s]
Processed prompts:  52%|█████▏    | 207/401 [00:54<00:06, 32.17it/s, est. speed input: 6169.71 toks/s, output: 565.88 toks/s]
Processed prompts:  53%|█████▎    | 214/401 [00:54<00:05, 36.11it/s, est. speed input: 6342.77 toks/s, output: 588.33 toks/s]
Processed prompts:  55%|█████▍    | 219/401 [00:54<00:05, 35.31it/s, est. speed input: 6503.46 toks/s, output: 604.18 toks/s]
Processed prompts:  56%|█████▌    | 223/401 [00:55<00:08, 21.04it/s, est. speed input: 6580.27 toks/s, output: 613.70 toks/s]
Processed prompts:  57%|█████▋    | 228/401 [00:55<00:08, 19.81it/s, est. speed input: 6766.27 toks/s, output: 628.88 toks/s]
Processed prompts:  58%|█████▊    | 234/401 [00:55<00:06, 24.13it/s, est. speed input: 6915.32 toks/s, output: 649.77 toks/s]
Processed prompts:  59%|█████▉    | 238/401 [00:55<00:08, 19.57it/s, est. speed input: 6997.14 toks/s, output: 661.35 toks/s]
Processed prompts:  60%|██████    | 241/401 [00:56<00:11, 14.51it/s, est. speed input: 7029.17 toks/s, output: 668.32 toks/s]
Processed prompts:  61%|██████    | 243/401 [00:56<00:11, 13.77it/s, est. speed input: 7077.81 toks/s, output: 674.26 toks/s]
Processed prompts:  61%|██████    | 245/401 [00:56<00:12, 12.44it/s, est. speed input: 7133.78 toks/s, output: 679.82 toks/s]
Processed prompts:  62%|██████▏   | 248/401 [00:56<00:10, 14.25it/s, est. speed input: 7247.20 toks/s, output: 684.28 toks/s]
Processed prompts:  62%|██████▏   | 250/401 [00:57<00:21,  7.05it/s, est. speed input: 7200.65 toks/s, output: 683.35 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [00:58<00:23,  6.22it/s, est. speed input: 7194.98 toks/s, output: 684.62 toks/s]
Processed prompts:  63%|██████▎   | 254/401 [00:58<00:20,  7.29it/s, est. speed input: 7223.71 toks/s, output: 687.84 toks/s]
Processed prompts:  64%|██████▍   | 257/401 [00:58<00:15,  9.57it/s, est. speed input: 7316.43 toks/s, output: 693.34 toks/s]
Processed prompts:  65%|██████▌   | 261/401 [00:58<00:10, 13.20it/s, est. speed input: 7504.34 toks/s, output: 701.85 toks/s]
Processed prompts:  66%|██████▌   | 264/401 [00:58<00:09, 15.17it/s, est. speed input: 7571.97 toks/s, output: 707.57 toks/s]
Processed prompts:  67%|██████▋   | 267/401 [00:58<00:08, 15.82it/s, est. speed input: 7633.11 toks/s, output: 713.64 toks/s]
Processed prompts:  67%|██████▋   | 269/401 [00:58<00:08, 15.81it/s, est. speed input: 7676.35 toks/s, output: 717.38 toks/s]
Processed prompts:  69%|██████▊   | 275/401 [00:59<00:05, 23.62it/s, est. speed input: 7867.34 toks/s, output: 732.42 toks/s]
Processed prompts:  70%|██████▉   | 280/401 [00:59<00:04, 26.41it/s, est. speed input: 8029.24 toks/s, output: 744.46 toks/s]
Processed prompts:  72%|███████▏  | 287/401 [00:59<00:03, 35.09it/s, est. speed input: 8260.04 toks/s, output: 760.42 toks/s]
Processed prompts:  73%|███████▎  | 293/401 [00:59<00:02, 40.19it/s, est. speed input: 8426.62 toks/s, output: 775.37 toks/s]
Processed prompts:  75%|███████▍  | 299/401 [00:59<00:02, 44.58it/s, est. speed input: 8620.77 toks/s, output: 790.47 toks/s]
Processed prompts:  76%|███████▌  | 304/401 [00:59<00:02, 39.14it/s, est. speed input: 8748.14 toks/s, output: 801.31 toks/s]
Processed prompts:  78%|███████▊  | 311/401 [00:59<00:02, 43.26it/s, est. speed input: 8987.06 toks/s, output: 818.75 toks/s]
Processed prompts:  80%|███████▉  | 319/401 [00:59<00:01, 49.05it/s, est. speed input: 9246.66 toks/s, output: 841.03 toks/s]
Processed prompts:  81%|████████  | 325/401 [01:00<00:01, 49.07it/s, est. speed input: 9432.30 toks/s, output: 857.12 toks/s]
Processed prompts:  83%|████████▎ | 332/401 [01:00<00:01, 52.01it/s, est. speed input: 9663.69 toks/s, output: 875.76 toks/s]
Processed prompts:  85%|████████▍ | 340/401 [01:00<00:01, 57.46it/s, est. speed input: 9928.62 toks/s, output: 900.30 toks/s]
Processed prompts:  86%|████████▋ | 346/401 [01:00<00:01, 53.81it/s, est. speed input: 10160.12 toks/s, output: 916.52 toks/s]
Processed prompts:  89%|████████▉ | 357/401 [01:00<00:00, 64.61it/s, est. speed input: 10549.96 toks/s, output: 953.89 toks/s]
Processed prompts:  91%|█████████ | 364/401 [01:00<00:00, 64.01it/s, est. speed input: 10859.74 toks/s, output: 974.79 toks/s]
Processed prompts:  93%|█████████▎| 371/401 [01:00<00:00, 56.97it/s, est. speed input: 11204.48 toks/s, output: 995.43 toks/s]
Processed prompts:  94%|█████████▍| 377/401 [01:00<00:00, 54.08it/s, est. speed input: 11421.99 toks/s, output: 1018.51 toks/s]
Processed prompts:  96%|█████████▌| 383/401 [01:01<00:00, 42.29it/s, est. speed input: 11619.91 toks/s, output: 1037.36 toks/s]
Processed prompts:  97%|█████████▋| 388/401 [01:01<00:00, 18.70it/s, est. speed input: 11674.75 toks/s, output: 1045.33 toks/s]
Processed prompts:  98%|█████████▊| 392/401 [01:03<00:00,  9.32it/s, est. speed input: 11637.82 toks/s, output: 1047.46 toks/s]
Processed prompts:  99%|█████████▊| 395/401 [01:03<00:00,  8.01it/s, est. speed input: 11711.59 toks/s, output: 1058.72 toks/s]
Processed prompts:  99%|█████████▉| 397/401 [01:04<00:00,  7.31it/s, est. speed input: 11729.85 toks/s, output: 1065.26 toks/s]
Processed prompts: 100%|█████████▉| 399/401 [01:04<00:00,  6.20it/s, est. speed input: 11724.60 toks/s, output: 1072.54 toks/s]
Processed prompts: 100%|██████████| 401/401 [01:06<00:00,  2.81it/s, est. speed input: 11374.06 toks/s, output: 1053.89 toks/s]
Processed prompts: 100%|██████████| 401/401 [01:06<00:00,  6.00it/s, est. speed input: 11374.06 toks/s, output: 1053.89 toks/s]
{  "personalized_answer": "It sounds like you're looking for a jazz instrument or style, but your past interests in building characters and game mechanics suggest you might be drawn to something with a unique or unconventional sound. Given your interest in acrobatics and daggers, perhaps you're thinking of a jazz instrument that can add a sharp, agile element to your music, much like your character Frederico. One instrument that might fit this description is the **saxophone**, particularly the **soprano saxophone**. Its high, piercing sound can be very agile and versatile, much like your character's combat style. As for jazz styles, you might enjoy **bebop** or **cool jazz**, which are known for their fast, complex rhythms and improvisational nature, similar to the quick movements and tactical thinking of your character. If you're looking for something more specific, you could explore **jazz fusion** or **saxophone quartets**, which often incorporate a wide range of sounds and styles, much like the diverse "toys" and abilities your character Frederico might use in battle."}
Invalid JSON
{  "personalized_answer": "Certainly! Improving items can be a rewarding part of your gameplay. Based on your past interests, here are some suggestions tailored to your preferences:\n\n1. **Stealing for Blacksmithing**: Continue using the technique you mentioned for stealing items from closed-door armories. For light/medium armor, bows, staves, and shields, you might want to check locations like the Red Squall Armory in Wayrest, or other similar armories in the game. Just make sure to log out and back in to avoid getting caught.\n\n2. **Rubedo Leather**: Unfortunately, surveys in The Elder Scrolls Online (TESO) do not typically provide Rubedo Leather. However, you can try crafting items that require less Rubedo Leather or look for alternative sources within the game world. You might also consider trading with other players or joining guilds that specialize in crafting.\n\n3. **Inventory Speed in The Witcher 3**: Unfortunately, the inventory system in The Witcher 3 is designed to be slow, which is part of the game's immersive experience. However, you can try using mods or third-party tools to speed up the inventory transfer process. Just be cautious as some of these tools might not be officially supported and could potentially cause issues.\n\n4. **Adapting XP-Changing Items**: For milestone-leveling games, you can adapt XP-changing items by setting specific milestones or challenges that require the use of such items. For example, you could create a quest where the player must complete a certain number of tasks before they can use the Fool card. This way, the XP change is tied to the narrative and progression of the game.\n\n5. **Donating Gold in Diablo 3**: You can donate gold to your friends by using the Action House. Simply go to the Action House, select the "Donate" option, and choose the amount of gold you want to donate. This will allow your friends to purchase better gear and items.\n\n6. **Ending Hit Point Reduction**: As a DM, you can use other spells or abilities to restore hit points. For example, you could introduce a NPC who can cast spells to restore hit points, or use a potion that restores hit points. Greater restoration is a powerful option, but you can also consider other spells like Lesser Restoration or even a custom spell you create.\n\n7. **Storing Items in Divinity: Original Sin**: You can store your items in various locations. Once you complete the main quest, you will receive a living quarters, which is a safe place to store your items. Until then, you can use chests or other containers in towns or dungeons to store your items temporarily. Just make sure to keep an eye on your inventory to avoid losing valuable items.\n\n8. **Leveling Up in Diablo 3 2.0.1**: To level up in the new patch, you might need to focus on completing paragon levels and participating in activities that grant paragon experience. Additionally, you can try joining groups or playing in areas with higher-level content to gain more experience. If you're still having trouble, consider checking the game forums for tips or updates from the developers."}
Invalid JSON
None

Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  50%|█████     | 1/2 [00:02<00:02,  2.43s/it, est. speed input: 734.67 toks/s, output: 76.42 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:03<00:00,  1.74s/it, est. speed input: 809.00 toks/s, output: 129.92 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:03<00:00,  1.85s/it, est. speed input: 809.00 toks/s, output: 129.92 toks/s]
[rank0]:[W709 16:25:26.809328257 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/ae_rag_full_profile_test_8_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 16:25:29.742647_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 16:25:29.742647_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 16:25:29.742647_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:38,  3.32it/s]
  1%|          | 3/526 [00:00<01:24,  6.17it/s]
  1%|          | 5/526 [00:00<00:58,  8.96it/s]
  1%|▏         | 7/526 [00:00<00:45, 11.37it/s]
  2%|▏         | 9/526 [00:01<01:45,  4.89it/s]
  2%|▏         | 11/526 [00:01<01:20,  6.42it/s]
  2%|▏         | 13/526 [00:02<01:32,  5.53it/s]
  3%|▎         | 15/526 [00:02<01:17,  6.61it/s]
  3%|▎         | 16/526 [00:02<01:19,  6.41it/s]
  3%|▎         | 18/526 [00:02<01:03,  8.04it/s]
  4%|▍         | 20/526 [00:03<01:17,  6.49it/s]
  4%|▍         | 21/526 [00:04<02:51,  2.94it/s]
  4%|▍         | 22/526 [00:04<02:58,  2.82it/s]
  4%|▍         | 23/526 [00:05<03:42,  2.26it/s]
  5%|▍         | 24/526 [00:06<04:18,  1.94it/s]
  5%|▍         | 25/526 [00:07<05:29,  1.52it/s]
  5%|▍         | 26/526 [00:07<04:40,  1.78it/s]
  5%|▌         | 27/526 [00:07<03:42,  2.24it/s]
  5%|▌         | 28/526 [00:07<03:36,  2.30it/s]
  6%|▌         | 30/526 [00:09<04:47,  1.72it/s]
  6%|▌         | 31/526 [00:10<04:40,  1.76it/s]
  6%|▌         | 32/526 [00:10<03:59,  2.06it/s]
  6%|▋         | 33/526 [00:11<05:46,  1.42it/s]
  6%|▋         | 34/526 [00:12<05:59,  1.37it/s]
  7%|▋         | 35/526 [00:13<06:37,  1.23it/s]
  7%|▋         | 36/526 [00:13<05:09,  1.58it/s]
  7%|▋         | 37/526 [00:13<04:26,  1.83it/s]
  7%|▋         | 39/526 [00:14<02:36,  3.11it/s]
  8%|▊         | 40/526 [00:14<02:20,  3.47it/s]
  8%|▊         | 42/526 [00:14<01:47,  4.52it/s]
  8%|▊         | 43/526 [00:15<02:25,  3.31it/s]
  9%|▊         | 45/526 [00:15<01:43,  4.64it/s]
  9%|▊         | 46/526 [00:15<01:51,  4.31it/s]
  9%|▉         | 47/526 [00:15<02:09,  3.71it/s]
  9%|▉         | 48/526 [00:16<02:44,  2.91it/s]
 10%|▉         | 50/526 [00:16<02:07,  3.74it/s]
 10%|▉         | 52/526 [00:16<01:37,  4.84it/s]
 10%|█         | 53/526 [00:18<03:28,  2.27it/s]
 10%|█         | 54/526 [00:21<08:51,  1.13s/it]
 11%|█         | 56/526 [00:21<05:29,  1.43it/s]
 11%|█         | 58/526 [00:22<04:28,  1.75it/s]
 11%|█         | 59/526 [00:23<04:45,  1.63it/s]
 11%|█▏        | 60/526 [00:24<05:07,  1.51it/s]
 12%|█▏        | 61/526 [00:24<05:02,  1.54it/s]
 12%|█▏        | 62/526 [00:25<06:04,  1.27it/s]
 12%|█▏        | 63/526 [00:27<07:26,  1.04it/s]
 12%|█▏        | 64/526 [00:27<06:02,  1.28it/s]
 12%|█▏        | 65/526 [00:27<04:35,  1.67it/s]
 13%|█▎        | 66/526 [00:28<03:52,  1.98it/s]
 13%|█▎        | 67/526 [00:28<03:42,  2.07it/s]
 13%|█▎        | 68/526 [00:29<04:46,  1.60it/s]
 13%|█▎        | 69/526 [00:29<03:38,  2.09it/s]
 13%|█▎        | 70/526 [00:31<05:49,  1.31it/s]
 13%|█▎        | 71/526 [00:31<05:58,  1.27it/s]
 14%|█▎        | 72/526 [00:32<05:32,  1.37it/s]
 14%|█▍        | 73/526 [00:33<06:20,  1.19it/s]
 14%|█▍        | 74/526 [00:35<07:42,  1.02s/it]
 14%|█▍        | 75/526 [00:35<05:45,  1.31it/s]
 14%|█▍        | 76/526 [00:35<04:17,  1.74it/s]
 15%|█▍        | 77/526 [00:36<05:24,  1.38it/s]
 15%|█▍        | 78/526 [00:37<07:00,  1.07it/s]
 15%|█▌        | 79/526 [00:37<05:09,  1.45it/s]
 15%|█▌        | 80/526 [00:38<04:12,  1.77it/s]
 16%|█▌        | 82/526 [00:39<04:25,  1.67it/s]
 16%|█▌        | 84/526 [00:40<04:13,  1.75it/s]
 16%|█▌        | 85/526 [00:42<06:09,  1.19it/s]
 16%|█▋        | 86/526 [00:42<05:13,  1.40it/s]
 17%|█▋        | 87/526 [00:43<05:45,  1.27it/s]
 17%|█▋        | 88/526 [00:43<04:48,  1.52it/s]
 17%|█▋        | 89/526 [00:44<04:08,  1.76it/s]
 17%|█▋        | 90/526 [00:44<03:41,  1.97it/s]
 17%|█▋        | 91/526 [00:45<03:28,  2.09it/s]
 17%|█▋        | 92/526 [00:45<02:44,  2.64it/s]
 18%|█▊        | 93/526 [00:45<02:08,  3.36it/s]
 18%|█▊        | 95/526 [00:45<01:27,  4.94it/s]
 18%|█▊        | 96/526 [00:45<01:56,  3.68it/s]
 18%|█▊        | 97/526 [00:46<02:41,  2.65it/s]
 19%|█▊        | 98/526 [00:49<07:52,  1.10s/it]
 19%|█▉        | 99/526 [00:52<12:05,  1.70s/it]
 19%|█▉        | 101/526 [00:53<07:25,  1.05s/it]
 19%|█▉        | 102/526 [00:53<06:21,  1.11it/s]
 20%|█▉        | 103/526 [00:54<05:52,  1.20it/s]
 20%|█▉        | 104/526 [00:55<06:47,  1.04it/s]
 20%|██        | 106/526 [00:56<04:40,  1.50it/s]
 21%|██        | 108/526 [00:56<03:28,  2.00it/s]
 21%|██        | 109/526 [00:57<03:12,  2.16it/s]
 21%|██        | 110/526 [00:58<04:09,  1.67it/s]
 21%|██        | 111/526 [00:58<03:50,  1.80it/s]
 21%|██▏       | 112/526 [00:59<03:36,  1.91it/s]
 21%|██▏       | 113/526 [00:59<02:48,  2.45it/s]
 22%|██▏       | 114/526 [00:59<02:19,  2.96it/s]
 22%|██▏       | 115/526 [00:59<01:55,  3.57it/s]
 22%|██▏       | 116/526 [00:59<01:33,  4.39it/s]
 22%|██▏       | 117/526 [01:00<03:34,  1.91it/s]
 22%|██▏       | 118/526 [01:02<05:02,  1.35it/s]
 23%|██▎       | 119/526 [01:02<04:12,  1.61it/s]
 23%|██▎       | 120/526 [01:03<04:58,  1.36it/s]
 23%|██▎       | 121/526 [01:03<03:55,  1.72it/s]
 23%|██▎       | 122/526 [01:04<05:18,  1.27it/s]
 23%|██▎       | 123/526 [01:05<05:55,  1.13it/s]
 24%|██▎       | 124/526 [01:07<06:45,  1.01s/it]
 24%|██▍       | 125/526 [01:07<04:59,  1.34it/s]
 24%|██▍       | 127/526 [01:07<03:08,  2.12it/s]
 24%|██▍       | 128/526 [01:07<02:37,  2.52it/s]
 25%|██▍       | 129/526 [01:08<02:35,  2.55it/s]
 25%|██▍       | 130/526 [01:08<02:35,  2.55it/s]
 25%|██▍       | 131/526 [01:08<02:16,  2.88it/s]
 25%|██▌       | 132/526 [01:08<01:53,  3.46it/s]
 25%|██▌       | 133/526 [01:09<01:39,  3.95it/s]
 26%|██▌       | 135/526 [01:09<01:29,  4.38it/s]
 26%|██▌       | 136/526 [01:09<01:37,  3.98it/s]
 26%|██▌       | 138/526 [01:10<01:19,  4.86it/s]
 26%|██▋       | 139/526 [01:10<01:30,  4.29it/s]
 27%|██▋       | 140/526 [01:10<01:23,  4.65it/s]
 27%|██▋       | 141/526 [01:10<01:21,  4.72it/s]
 27%|██▋       | 142/526 [01:10<01:15,  5.09it/s]
 27%|██▋       | 143/526 [01:11<01:57,  3.26it/s]
 27%|██▋       | 144/526 [01:11<01:39,  3.83it/s]
 28%|██▊       | 145/526 [01:12<03:27,  1.83it/s]
 28%|██▊       | 146/526 [01:13<03:02,  2.09it/s]
 28%|██▊       | 147/526 [01:13<02:50,  2.22it/s]
 28%|██▊       | 149/526 [01:14<02:08,  2.93it/s]
 29%|██▊       | 150/526 [01:14<01:49,  3.44it/s]
 29%|██▊       | 151/526 [01:14<01:35,  3.94it/s]
 29%|██▉       | 152/526 [01:14<01:25,  4.38it/s]
 29%|██▉       | 154/526 [01:15<02:15,  2.74it/s]
 29%|██▉       | 155/526 [01:16<03:03,  2.02it/s]
 30%|██▉       | 156/526 [01:17<03:50,  1.60it/s]
 30%|██▉       | 157/526 [01:17<03:28,  1.77it/s]
 30%|███       | 159/526 [01:18<02:06,  2.90it/s]
 30%|███       | 160/526 [01:19<03:37,  1.69it/s]
 31%|███       | 161/526 [01:19<03:07,  1.94it/s]
 31%|███       | 162/526 [01:21<05:29,  1.11it/s]
 31%|███       | 164/526 [01:22<03:37,  1.66it/s]
 32%|███▏      | 166/526 [01:22<02:28,  2.42it/s]
 32%|███▏      | 167/526 [01:22<02:21,  2.54it/s]
 32%|███▏      | 168/526 [01:23<03:30,  1.70it/s]
 32%|███▏      | 169/526 [01:24<03:05,  1.92it/s]
 33%|███▎      | 171/526 [01:26<04:18,  1.37it/s]
 33%|███▎      | 172/526 [01:26<03:32,  1.67it/s]
 33%|███▎      | 173/526 [01:26<03:06,  1.89it/s]
 33%|███▎      | 174/526 [01:27<02:52,  2.05it/s]
 33%|███▎      | 175/526 [01:27<02:17,  2.55it/s]
 33%|███▎      | 176/526 [01:28<03:08,  1.85it/s]
 34%|███▎      | 177/526 [01:28<02:27,  2.37it/s]
 34%|███▍      | 178/526 [01:28<01:57,  2.95it/s]
 34%|███▍      | 179/526 [01:28<01:38,  3.54it/s]
 34%|███▍      | 180/526 [01:29<03:18,  1.75it/s]
 34%|███▍      | 181/526 [01:29<02:33,  2.24it/s]
 35%|███▍      | 182/526 [01:31<04:16,  1.34it/s]
 35%|███▍      | 183/526 [01:31<03:12,  1.78it/s]
 35%|███▍      | 184/526 [01:32<03:12,  1.78it/s]
 35%|███▌      | 186/526 [01:33<04:06,  1.38it/s]
 36%|███▌      | 187/526 [01:34<03:40,  1.54it/s]
 36%|███▌      | 188/526 [01:34<03:23,  1.66it/s]
 36%|███▌      | 190/526 [01:35<02:09,  2.59it/s]
 36%|███▋      | 191/526 [01:35<01:52,  2.98it/s]
 37%|███▋      | 192/526 [01:35<01:37,  3.43it/s]
 37%|███▋      | 193/526 [01:35<01:20,  4.12it/s]
 37%|███▋      | 194/526 [01:35<01:09,  4.75it/s]
 37%|███▋      | 195/526 [01:36<02:47,  1.98it/s]
 37%|███▋      | 196/526 [01:38<03:53,  1.41it/s]
 37%|███▋      | 197/526 [01:38<03:09,  1.74it/s]
 38%|███▊      | 198/526 [01:38<02:51,  1.92it/s]
 38%|███▊      | 199/526 [01:40<05:09,  1.06it/s]
 38%|███▊      | 200/526 [01:40<04:00,  1.35it/s]
 38%|███▊      | 201/526 [01:41<04:10,  1.30it/s]
 38%|███▊      | 202/526 [01:42<03:18,  1.63it/s]
 39%|███▊      | 203/526 [01:42<03:37,  1.49it/s]
 39%|███▉      | 205/526 [01:42<02:06,  2.54it/s]
 39%|███▉      | 206/526 [01:43<01:47,  2.99it/s]
 39%|███▉      | 207/526 [01:43<01:37,  3.28it/s]
 40%|███▉      | 210/526 [01:43<00:53,  5.91it/s]
 40%|████      | 212/526 [01:44<01:39,  3.14it/s]
 41%|████      | 214/526 [01:44<01:19,  3.92it/s]
 41%|████      | 215/526 [01:45<01:42,  3.04it/s]
 41%|████      | 216/526 [01:45<01:42,  3.02it/s]
 41%|████▏     | 217/526 [01:46<02:29,  2.06it/s]
 41%|████▏     | 218/526 [01:47<03:08,  1.64it/s]
 42%|████▏     | 219/526 [01:48<03:20,  1.53it/s]
 42%|████▏     | 220/526 [01:48<02:34,  1.99it/s]
 42%|████▏     | 222/526 [01:48<01:36,  3.17it/s]
 42%|████▏     | 223/526 [01:49<02:25,  2.08it/s]
 43%|████▎     | 224/526 [01:50<02:01,  2.48it/s]
 43%|████▎     | 225/526 [01:50<01:59,  2.52it/s]
 43%|████▎     | 227/526 [01:50<01:38,  3.05it/s]
 43%|████▎     | 228/526 [01:51<01:23,  3.56it/s]
 44%|████▎     | 229/526 [01:51<01:32,  3.20it/s]
 44%|████▎     | 230/526 [01:51<01:23,  3.54it/s]
 44%|████▍     | 231/526 [01:52<02:19,  2.11it/s]
 44%|████▍     | 232/526 [01:52<01:49,  2.69it/s]
 44%|████▍     | 233/526 [01:52<01:32,  3.16it/s]
 44%|████▍     | 234/526 [01:54<02:51,  1.70it/s]
 45%|████▍     | 235/526 [01:54<02:42,  1.79it/s]
 45%|████▍     | 236/526 [01:54<02:06,  2.29it/s]
 45%|████▌     | 237/526 [01:55<01:59,  2.42it/s]
 45%|████▌     | 238/526 [01:55<01:40,  2.86it/s]
 46%|████▌     | 240/526 [01:55<01:03,  4.48it/s]
 46%|████▌     | 241/526 [01:56<02:00,  2.37it/s]
 46%|████▌     | 243/526 [01:57<01:42,  2.76it/s]
 46%|████▋     | 244/526 [01:57<01:45,  2.67it/s]
 47%|████▋     | 245/526 [01:58<02:27,  1.90it/s]
 47%|████▋     | 246/526 [01:58<02:11,  2.14it/s]
 47%|████▋     | 247/526 [01:59<01:48,  2.57it/s]
 47%|████▋     | 248/526 [01:59<02:07,  2.19it/s]
 47%|████▋     | 249/526 [02:00<02:47,  1.65it/s]
 48%|████▊     | 250/526 [02:00<02:11,  2.10it/s]
 48%|████▊     | 251/526 [02:01<02:47,  1.64it/s]
 48%|████▊     | 252/526 [02:02<02:24,  1.90it/s]
 48%|████▊     | 253/526 [02:02<01:55,  2.36it/s]
 48%|████▊     | 255/526 [02:03<02:07,  2.13it/s]
 49%|████▊     | 256/526 [02:03<01:52,  2.40it/s]
 49%|████▉     | 257/526 [02:04<02:50,  1.57it/s]
 49%|████▉     | 258/526 [02:05<03:12,  1.39it/s]
 49%|████▉     | 259/526 [02:05<02:28,  1.80it/s]
 49%|████▉     | 260/526 [02:06<01:56,  2.29it/s]
 50%|████▉     | 261/526 [02:06<02:01,  2.18it/s]
 50%|████▉     | 262/526 [02:06<01:34,  2.80it/s]
 50%|█████     | 263/526 [02:07<02:20,  1.87it/s]
 50%|█████     | 264/526 [02:08<02:42,  1.61it/s]
 50%|█████     | 265/526 [02:08<02:05,  2.09it/s]
 51%|█████     | 266/526 [02:09<02:15,  1.92it/s]
 51%|█████     | 267/526 [02:09<02:22,  1.82it/s]
 51%|█████     | 268/526 [02:09<01:50,  2.34it/s]
 51%|█████     | 269/526 [02:10<01:33,  2.74it/s]
 51%|█████▏    | 270/526 [02:10<01:46,  2.41it/s]
 52%|█████▏    | 271/526 [02:10<01:28,  2.88it/s]
 52%|█████▏    | 272/526 [02:11<01:41,  2.49it/s]
 52%|█████▏    | 273/526 [02:12<02:25,  1.74it/s]
 52%|█████▏    | 274/526 [02:12<02:11,  1.91it/s]
 52%|█████▏    | 275/526 [02:16<05:32,  1.33s/it]
 52%|█████▏    | 276/526 [02:16<04:06,  1.01it/s]
 53%|█████▎    | 277/526 [02:16<03:06,  1.33it/s]
 53%|█████▎    | 278/526 [02:17<03:03,  1.35it/s]
 53%|█████▎    | 279/526 [02:20<06:03,  1.47s/it]
 53%|█████▎    | 280/526 [02:23<08:05,  1.98s/it]
 53%|█████▎    | 281/526 [02:26<09:31,  2.33s/it]
 54%|█████▎    | 282/526 [02:29<10:30,  2.58s/it]
 54%|█████▍    | 283/526 [02:32<11:10,  2.76s/it]
 54%|█████▍    | 284/526 [02:36<11:37,  2.88s/it]
 54%|█████▍    | 285/526 [02:36<08:38,  2.15s/it]
 54%|█████▍    | 286/526 [02:37<07:01,  1.76s/it]
 55%|█████▍    | 287/526 [02:37<05:06,  1.28s/it]
 55%|█████▍    | 288/526 [02:37<03:50,  1.03it/s]
 55%|█████▍    | 289/526 [02:37<02:53,  1.37it/s]
 55%|█████▌    | 291/526 [02:39<02:31,  1.56it/s]
 56%|█████▌    | 292/526 [02:39<02:04,  1.88it/s]
 56%|█████▌    | 293/526 [02:39<02:15,  1.72it/s]
 56%|█████▌    | 294/526 [02:40<01:58,  1.97it/s]
 56%|█████▌    | 295/526 [02:40<01:44,  2.21it/s]
 56%|█████▋    | 296/526 [02:40<01:35,  2.40it/s]
 57%|█████▋    | 298/526 [02:44<03:37,  1.05it/s]
 57%|█████▋    | 299/526 [02:47<05:34,  1.47s/it]
 57%|█████▋    | 300/526 [02:48<05:32,  1.47s/it]
 57%|█████▋    | 301/526 [02:49<05:04,  1.35s/it]
 57%|█████▋    | 302/526 [02:51<05:07,  1.37s/it]
 58%|█████▊    | 303/526 [02:52<05:12,  1.40s/it]
 58%|█████▊    | 304/526 [02:52<04:01,  1.09s/it]
 58%|█████▊    | 305/526 [02:54<04:25,  1.20s/it]
 58%|█████▊    | 306/526 [02:55<04:36,  1.26s/it]
 58%|█████▊    | 307/526 [02:57<04:49,  1.32s/it]
 59%|█████▊    | 308/526 [02:58<04:58,  1.37s/it]
 59%|█████▊    | 309/526 [02:59<03:45,  1.04s/it]
 59%|█████▉    | 310/526 [02:59<03:36,  1.00s/it]
 59%|█████▉    | 311/526 [03:00<02:45,  1.30it/s]
 59%|█████▉    | 312/526 [03:01<03:32,  1.01it/s]
 60%|█████▉    | 313/526 [03:03<04:02,  1.14s/it]
 60%|█████▉    | 314/526 [03:04<04:34,  1.29s/it]
 60%|█████▉    | 315/526 [03:07<06:29,  1.84s/it]
 60%|██████    | 316/526 [03:08<04:38,  1.32s/it]
 60%|██████    | 317/526 [03:08<04:07,  1.18s/it]
 60%|██████    | 318/526 [03:09<03:44,  1.08s/it]
 61%|██████    | 319/526 [03:10<02:59,  1.16it/s]
 61%|██████    | 320/526 [03:10<02:13,  1.54it/s]
 61%|██████    | 321/526 [03:11<03:16,  1.05it/s]
 61%|██████    | 322/526 [03:12<02:38,  1.29it/s]
 61%|██████▏   | 323/526 [03:12<02:04,  1.64it/s]
 62%|██████▏   | 324/526 [03:12<01:41,  1.99it/s]
 62%|██████▏   | 325/526 [03:13<01:26,  2.31it/s]
 62%|██████▏   | 326/526 [03:13<01:08,  2.93it/s]
 62%|██████▏   | 327/526 [03:13<01:07,  2.94it/s]
 62%|██████▏   | 328/526 [03:13<00:56,  3.49it/s]
 63%|██████▎   | 330/526 [03:13<00:36,  5.31it/s]
 63%|██████▎   | 331/526 [03:14<00:40,  4.87it/s]
 63%|██████▎   | 332/526 [03:14<00:57,  3.39it/s]
 63%|██████▎   | 333/526 [03:14<00:52,  3.69it/s]
 63%|██████▎   | 334/526 [03:16<01:47,  1.79it/s]
 64%|██████▎   | 335/526 [03:16<01:46,  1.79it/s]
 64%|██████▍   | 336/526 [03:17<02:26,  1.29it/s]
 64%|██████▍   | 337/526 [03:18<02:24,  1.31it/s]
 64%|██████▍   | 338/526 [03:19<02:16,  1.38it/s]
 64%|██████▍   | 339/526 [03:19<01:58,  1.58it/s]
 65%|██████▍   | 340/526 [03:22<04:19,  1.40s/it]
 65%|██████▍   | 341/526 [03:23<03:08,  1.02s/it]
 65%|██████▌   | 342/526 [03:23<02:37,  1.16it/s]
 65%|██████▌   | 343/526 [03:24<02:35,  1.17it/s]
 66%|██████▌   | 345/526 [03:31<06:09,  2.04s/it]
 66%|██████▌   | 346/526 [03:34<06:58,  2.32s/it]
 66%|██████▌   | 347/526 [03:41<10:20,  3.47s/it]
 66%|██████▌   | 348/526 [03:42<08:17,  2.80s/it]
 66%|██████▋   | 349/526 [03:42<06:19,  2.15s/it]
 67%|██████▋   | 350/526 [03:49<10:14,  3.49s/it]
 67%|██████▋   | 351/526 [03:52<09:55,  3.40s/it]
 67%|██████▋   | 352/526 [03:52<07:11,  2.48s/it]
 67%|██████▋   | 353/526 [03:53<05:11,  1.80s/it]
 67%|██████▋   | 355/526 [03:53<03:08,  1.10s/it]
 68%|██████▊   | 356/526 [03:53<02:26,  1.16it/s]
 68%|██████▊   | 357/526 [03:54<02:13,  1.27it/s]
 68%|██████▊   | 358/526 [03:54<02:03,  1.36it/s]
 68%|██████▊   | 359/526 [03:55<01:40,  1.66it/s]
 68%|██████▊   | 360/526 [03:55<01:17,  2.14it/s]
 69%|██████▊   | 361/526 [03:55<01:06,  2.49it/s]
 69%|██████▉   | 363/526 [03:56<01:01,  2.63it/s]
 69%|██████▉   | 364/526 [03:56<00:54,  2.97it/s]
 69%|██████▉   | 365/526 [03:57<01:05,  2.44it/s]
 70%|██████▉   | 366/526 [03:58<02:00,  1.33it/s]
 70%|██████▉   | 367/526 [03:58<01:32,  1.72it/s]
 70%|██████▉   | 368/526 [03:59<01:12,  2.17it/s]
 70%|███████   | 369/526 [03:59<01:10,  2.22it/s]
 70%|███████   | 370/526 [04:06<05:55,  2.28s/it]
 71%|███████   | 371/526 [04:12<09:17,  3.60s/it]
 71%|███████   | 372/526 [04:19<11:33,  4.50s/it]
 71%|███████   | 374/526 [04:19<06:16,  2.48s/it]
 71%|███████▏  | 375/526 [04:26<08:53,  3.53s/it]
 71%|███████▏  | 376/526 [04:26<06:36,  2.64s/it]
 72%|███████▏  | 377/526 [04:27<05:11,  2.09s/it]
 72%|███████▏  | 379/526 [04:27<03:08,  1.29s/it]
 72%|███████▏  | 380/526 [04:28<02:31,  1.04s/it]
 72%|███████▏  | 381/526 [04:34<05:55,  2.45s/it]
 73%|███████▎  | 382/526 [04:35<04:37,  1.93s/it]
 73%|███████▎  | 383/526 [04:35<03:36,  1.51s/it]
 73%|███████▎  | 384/526 [04:42<07:00,  2.96s/it]
 73%|███████▎  | 385/526 [04:48<09:30,  4.05s/it]
 73%|███████▎  | 386/526 [04:49<07:21,  3.16s/it]
 74%|███████▎  | 387/526 [04:50<05:20,  2.30s/it]
 74%|███████▍  | 388/526 [04:50<03:59,  1.74s/it]
 74%|███████▍  | 389/526 [04:51<03:12,  1.40s/it]
 74%|███████▍  | 390/526 [04:51<02:38,  1.17s/it]
 74%|███████▍  | 391/526 [04:51<01:56,  1.15it/s]
 75%|███████▍  | 392/526 [04:52<01:25,  1.56it/s]
 75%|███████▍  | 393/526 [04:52<01:24,  1.58it/s]
 75%|███████▍  | 394/526 [04:52<01:03,  2.09it/s]
 75%|███████▌  | 396/526 [04:52<00:39,  3.30it/s]
 75%|███████▌  | 397/526 [04:53<00:33,  3.82it/s]
 76%|███████▌  | 398/526 [04:53<00:33,  3.79it/s]
 76%|███████▌  | 399/526 [05:00<04:20,  2.05s/it]
 76%|███████▌  | 400/526 [05:00<03:09,  1.51s/it]
 76%|███████▌  | 401/526 [05:07<06:18,  3.03s/it]
 76%|███████▋  | 402/526 [05:07<04:44,  2.29s/it]
 77%|███████▋  | 403/526 [05:07<03:32,  1.73s/it]
 77%|███████▋  | 404/526 [05:08<02:35,  1.27s/it]
 77%|███████▋  | 405/526 [05:08<01:55,  1.04it/s]
 77%|███████▋  | 406/526 [05:13<04:18,  2.16s/it]
 78%|███████▊  | 408/526 [05:13<02:23,  1.22s/it]
 78%|███████▊  | 409/526 [05:14<02:04,  1.06s/it]
 78%|███████▊  | 410/526 [05:14<01:35,  1.21it/s]
 78%|███████▊  | 411/526 [05:21<04:41,  2.45s/it]
 78%|███████▊  | 412/526 [05:21<03:27,  1.82s/it]
 79%|███████▊  | 414/526 [05:21<01:58,  1.06s/it]
 79%|███████▉  | 415/526 [05:21<01:38,  1.12it/s]
 79%|███████▉  | 417/526 [05:22<01:08,  1.60it/s]
 79%|███████▉  | 418/526 [05:24<01:34,  1.14it/s]
 80%|███████▉  | 419/526 [05:24<01:15,  1.42it/s]
 80%|████████  | 421/526 [05:28<02:03,  1.18s/it]
 80%|████████  | 422/526 [05:28<01:37,  1.07it/s]
 80%|████████  | 423/526 [05:28<01:20,  1.27it/s]
 81%|████████  | 424/526 [05:28<01:03,  1.61it/s]
 81%|████████  | 425/526 [05:28<00:48,  2.07it/s]
 81%|████████  | 426/526 [05:28<00:41,  2.40it/s]
 81%|████████  | 427/526 [05:29<00:33,  2.95it/s]
 81%|████████▏ | 428/526 [05:29<00:26,  3.65it/s]
 82%|████████▏ | 429/526 [05:29<00:22,  4.23it/s]
 82%|████████▏ | 431/526 [05:30<00:35,  2.70it/s]
 82%|████████▏ | 433/526 [05:30<00:25,  3.63it/s]
 83%|████████▎ | 435/526 [05:33<00:59,  1.54it/s]
 83%|████████▎ | 436/526 [05:34<01:03,  1.41it/s]
 83%|████████▎ | 438/526 [05:35<00:56,  1.57it/s]
 83%|████████▎ | 439/526 [05:36<00:58,  1.48it/s]
 84%|████████▎ | 440/526 [05:36<00:58,  1.48it/s]
 84%|████████▍ | 442/526 [05:37<00:42,  1.97it/s]
 84%|████████▍ | 444/526 [05:39<00:52,  1.57it/s]
 85%|████████▍ | 445/526 [05:40<01:08,  1.18it/s]
 85%|████████▍ | 446/526 [05:40<00:56,  1.40it/s]
 85%|████████▍ | 447/526 [05:41<00:49,  1.59it/s]
 85%|████████▌ | 448/526 [05:41<00:40,  1.94it/s]
 86%|████████▌ | 450/526 [05:41<00:25,  3.01it/s]
 86%|████████▌ | 451/526 [05:41<00:21,  3.53it/s]
 86%|████████▌ | 453/526 [05:41<00:14,  5.00it/s]
 86%|████████▋ | 454/526 [05:42<00:20,  3.57it/s]
 87%|████████▋ | 456/526 [05:42<00:15,  4.50it/s]
 87%|████████▋ | 458/526 [05:43<00:13,  5.23it/s]
 87%|████████▋ | 459/526 [05:43<00:13,  5.03it/s]
 87%|████████▋ | 460/526 [05:43<00:18,  3.61it/s]
 88%|████████▊ | 461/526 [05:43<00:15,  4.18it/s]
 88%|████████▊ | 462/526 [05:44<00:14,  4.31it/s]
 88%|████████▊ | 463/526 [05:44<00:17,  3.68it/s]
 88%|████████▊ | 465/526 [05:44<00:13,  4.42it/s]
 89%|████████▊ | 466/526 [05:45<00:15,  3.83it/s]
 89%|████████▉ | 467/526 [05:45<00:18,  3.28it/s]
 89%|████████▉ | 468/526 [05:45<00:15,  3.86it/s]
 89%|████████▉ | 470/526 [05:45<00:10,  5.43it/s]
 90%|████████▉ | 471/526 [05:46<00:09,  6.03it/s]
 90%|████████▉ | 472/526 [05:46<00:12,  4.30it/s]
 90%|█████████ | 474/526 [05:46<00:08,  6.06it/s]
 90%|█████████ | 475/526 [05:47<00:16,  3.14it/s]
 90%|█████████ | 476/526 [05:47<00:16,  2.98it/s]
 91%|█████████ | 478/526 [05:47<00:10,  4.58it/s]
 91%|█████████ | 479/526 [05:48<00:17,  2.76it/s]
 91%|█████████▏| 480/526 [05:49<00:17,  2.67it/s]
 91%|█████████▏| 481/526 [05:50<00:29,  1.52it/s]
 92%|█████████▏| 482/526 [05:51<00:24,  1.77it/s]
 92%|█████████▏| 483/526 [05:51<00:20,  2.12it/s]
 92%|█████████▏| 484/526 [05:51<00:16,  2.47it/s]
 92%|█████████▏| 485/526 [05:51<00:14,  2.79it/s]
 92%|█████████▏| 486/526 [05:51<00:11,  3.37it/s]
 93%|█████████▎| 487/526 [05:52<00:10,  3.73it/s]
 93%|█████████▎| 489/526 [05:52<00:07,  4.85it/s]
 93%|█████████▎| 490/526 [05:52<00:07,  4.88it/s]
 93%|█████████▎| 491/526 [05:53<00:11,  3.09it/s]
 94%|█████████▎| 493/526 [05:56<00:32,  1.02it/s]
 94%|█████████▍| 495/526 [05:57<00:20,  1.49it/s]
 94%|█████████▍| 496/526 [05:57<00:16,  1.78it/s]
 94%|█████████▍| 497/526 [05:58<00:19,  1.46it/s]
 95%|█████████▍| 498/526 [06:00<00:26,  1.08it/s]
 95%|█████████▍| 499/526 [06:02<00:31,  1.17s/it]
 95%|█████████▌| 500/526 [06:02<00:23,  1.12it/s]
 95%|█████████▌| 501/526 [06:02<00:17,  1.42it/s]
 96%|█████████▌| 503/526 [06:02<00:10,  2.26it/s]
 96%|█████████▌| 504/526 [06:02<00:08,  2.49it/s]
 96%|█████████▌| 505/526 [06:03<00:08,  2.37it/s]
 96%|█████████▌| 506/526 [06:03<00:07,  2.72it/s]
 96%|█████████▋| 507/526 [06:03<00:05,  3.28it/s]
 97%|█████████▋| 508/526 [06:04<00:06,  2.92it/s]
 97%|█████████▋| 510/526 [06:05<00:06,  2.32it/s]
 97%|█████████▋| 511/526 [06:05<00:06,  2.17it/s]
 97%|█████████▋| 512/526 [06:05<00:05,  2.58it/s]
 98%|█████████▊| 513/526 [06:06<00:06,  1.98it/s]
 98%|█████████▊| 514/526 [06:07<00:05,  2.18it/s]
 98%|█████████▊| 515/526 [06:07<00:04,  2.25it/s]
 98%|█████████▊| 516/526 [06:07<00:03,  2.79it/s]
 98%|█████████▊| 517/526 [06:08<00:03,  2.69it/s]
 98%|█████████▊| 518/526 [06:08<00:02,  2.91it/s]
 99%|█████████▊| 519/526 [06:08<00:02,  3.49it/s]
 99%|█████████▉| 520/526 [06:09<00:02,  2.03it/s]
 99%|█████████▉| 521/526 [06:09<00:01,  2.65it/s]
 99%|█████████▉| 522/526 [06:12<00:05,  1.27s/it]
 99%|█████████▉| 523/526 [06:16<00:05,  1.89s/it]
100%|█████████▉| 524/526 [06:19<00:04,  2.35s/it]
100%|█████████▉| 525/526 [06:20<00:01,  1.75s/it]
100%|██████████| 526/526 [06:23<00:00,  2.23s/it]
100%|██████████| 526/526 [06:23<00:00,  1.37it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 16:25:29.742647_lp_processed_test.json', '--output_addr', 'data/out/rag/full_profile/lp_rag_full_profile_test_8_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '8', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.18 examples/s]
Generating train split: 526 examples [00:00, 709.89 examples/s]
INFO 07-09 16:32:19 config.py:510] This model supports multiple tasks: {'classify', 'reward', 'embed', 'generate', 'score'}. Defaulting to 'generate'.
INFO 07-09 16:32:19 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:32:20 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:32:21 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:32:22 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.59it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.52it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.58it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.59it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.58it/s]

INFO 07-09 16:46:29 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:46:31 worker.py:241] Memory profiling takes 2.13 seconds
INFO 07-09 16:46:31 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:46:31 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:46:31 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:46:31 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:46:34 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  2.96it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.34it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.49it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.56it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.61it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.64it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.66it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.67it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.66it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.67it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.69it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.71it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.72it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.72it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.73it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.73it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.78it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.64it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.45it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:04,  3.27it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:04,  3.43it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.55it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.64it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.71it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.76it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.80it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.84it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.85it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.86it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.89it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.91it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.91it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.82it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.86it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.91it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.70it/s]
INFO 07-09 16:46:44 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 16:46:44 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.50 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:31<4:33:49, 31.29s/it, est. speed input: 26.11 toks/s, output: 3.36 toks/s]
Processed prompts:   0%|          | 2/526 [00:31<1:54:09, 13.07s/it, est. speed input: 51.15 toks/s, output: 6.74 toks/s]
Processed prompts:   1%|          | 3/526 [00:31<1:03:27,  7.28s/it, est. speed input: 103.11 toks/s, output: 10.16 toks/s]
Processed prompts:   1%|          | 4/526 [00:32<39:19,  4.52s/it, est. speed input: 141.73 toks/s, output: 13.60 toks/s]  
Processed prompts:   1%|          | 5/526 [00:32<25:36,  2.95s/it, est. speed input: 194.95 toks/s, output: 17.07 toks/s]
Processed prompts:   1%|▏         | 7/526 [00:32<13:22,  1.55s/it, est. speed input: 269.86 toks/s, output: 23.95 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:32<10:04,  1.17s/it, est. speed input: 306.52 toks/s, output: 27.44 toks/s]
Processed prompts:   2%|▏         | 9/526 [00:33<07:57,  1.08it/s, est. speed input: 359.69 toks/s, output: 30.82 toks/s]
Processed prompts:   2%|▏         | 11/526 [00:33<04:48,  1.79it/s, est. speed input: 459.28 toks/s, output: 37.85 toks/s]
Processed prompts:   2%|▏         | 13/526 [00:33<03:31,  2.42it/s, est. speed input: 535.91 toks/s, output: 44.67 toks/s]
Processed prompts:   3%|▎         | 15/526 [00:34<02:55,  2.91it/s, est. speed input: 599.54 toks/s, output: 51.38 toks/s]
Processed prompts:   3%|▎         | 16/526 [00:34<02:31,  3.38it/s, est. speed input: 634.79 toks/s, output: 54.92 toks/s]
Processed prompts:   3%|▎         | 17/526 [00:34<02:26,  3.48it/s, est. speed input: 685.75 toks/s, output: 58.21 toks/s]
Processed prompts:   4%|▎         | 19/526 [00:34<01:48,  4.69it/s, est. speed input: 795.19 toks/s, output: 65.28 toks/s]
Processed prompts:   5%|▍         | 24/526 [00:35<01:20,  6.26it/s, est. speed input: 982.95 toks/s, output: 82.42 toks/s]
Processed prompts:   5%|▍         | 26/526 [00:35<01:12,  6.91it/s, est. speed input: 1073.12 toks/s, output: 89.29 toks/s]
Processed prompts:   6%|▌         | 29/526 [00:35<01:07,  7.34it/s, est. speed input: 1169.21 toks/s, output: 99.35 toks/s]
Processed prompts:   6%|▌         | 31/526 [00:36<01:07,  7.33it/s, est. speed input: 1226.37 toks/s, output: 105.92 toks/s]
Processed prompts:   6%|▌         | 32/526 [00:36<01:14,  6.63it/s, est. speed input: 1247.17 toks/s, output: 108.92 toks/s]
Processed prompts:   7%|▋         | 35/526 [00:36<01:04,  7.66it/s, est. speed input: 1348.92 toks/s, output: 119.03 toks/s]
Processed prompts:   7%|▋         | 37/526 [00:37<01:03,  7.65it/s, est. speed input: 1437.36 toks/s, output: 125.57 toks/s]
Processed prompts:   7%|▋         | 38/526 [00:37<01:13,  6.64it/s, est. speed input: 1489.71 toks/s, output: 128.42 toks/s]
Processed prompts:   7%|▋         | 39/526 [00:37<01:14,  6.49it/s, est. speed input: 1515.90 toks/s, output: 131.55 toks/s]
Processed prompts:   8%|▊         | 40/526 [00:37<01:34,  5.16it/s, est. speed input: 1539.20 toks/s, output: 134.07 toks/s]
Processed prompts:   8%|▊         | 43/526 [00:38<01:23,  5.75it/s, est. speed input: 1654.75 toks/s, output: 143.49 toks/s]
Processed prompts:   9%|▉         | 47/526 [00:38<01:20,  5.98it/s, est. speed input: 1774.24 toks/s, output: 155.69 toks/s]
Processed prompts:  10%|▉         | 52/526 [00:39<01:08,  6.95it/s, est. speed input: 1955.04 toks/s, output: 171.54 toks/s]
Processed prompts:  11%|█         | 56/526 [00:40<01:10,  6.65it/s, est. speed input: 2085.88 toks/s, output: 183.15 toks/s]
Processed prompts:  12%|█▏        | 61/526 [00:41<01:16,  6.04it/s, est. speed input: 2241.34 toks/s, output: 196.61 toks/s]
Processed prompts:  12%|█▏        | 63/526 [00:41<01:09,  6.70it/s, est. speed input: 2333.66 toks/s, output: 203.06 toks/s]
Processed prompts:  12%|█▏        | 65/526 [00:41<01:09,  6.60it/s, est. speed input: 2376.42 toks/s, output: 208.65 toks/s]
Processed prompts:  13%|█▎        | 68/526 [00:41<01:09,  6.64it/s, est. speed input: 2487.17 toks/s, output: 217.10 toks/s]
Processed prompts:  13%|█▎        | 69/526 [00:42<01:12,  6.27it/s, est. speed input: 2496.96 toks/s, output: 219.55 toks/s]
Processed prompts:  14%|█▍        | 73/526 [00:42<00:58,  7.69it/s, est. speed input: 2655.17 toks/s, output: 231.92 toks/s]
Processed prompts:  14%|█▍        | 76/526 [00:42<01:01,  7.33it/s, est. speed input: 2739.42 toks/s, output: 240.12 toks/s]
Processed prompts:  15%|█▌        | 81/526 [00:43<00:51,  8.65it/s, est. speed input: 2893.98 toks/s, output: 255.34 toks/s]
Processed prompts:  16%|█▋        | 86/526 [00:44<00:50,  8.63it/s, est. speed input: 3043.30 toks/s, output: 269.48 toks/s]
Processed prompts:  17%|█▋        | 90/526 [00:44<00:46,  9.34it/s, est. speed input: 3177.02 toks/s, output: 281.37 toks/s]
Processed prompts:  17%|█▋        | 92/526 [00:44<00:52,  8.25it/s, est. speed input: 3239.20 toks/s, output: 286.02 toks/s]
Processed prompts:  18%|█▊        | 96/526 [00:45<00:46,  9.29it/s, est. speed input: 3368.91 toks/s, output: 297.93 toks/s]
Processed prompts:  19%|█▉        | 102/526 [00:45<00:49,  8.56it/s, est. speed input: 3579.32 toks/s, output: 313.58 toks/s]
Processed prompts:  21%|██        | 109/526 [00:46<00:47,  8.87it/s, est. speed input: 3727.72 toks/s, output: 332.46 toks/s]
Processed prompts:  21%|██▏       | 112/526 [00:47<00:50,  8.14it/s, est. speed input: 3821.66 toks/s, output: 339.22 toks/s]
Processed prompts:  23%|██▎       | 119/526 [00:47<00:45,  9.03it/s, est. speed input: 3999.03 toks/s, output: 358.26 toks/s]
Processed prompts:  24%|██▍       | 125/526 [00:48<00:44,  8.99it/s, est. speed input: 4137.32 toks/s, output: 373.37 toks/s]
Processed prompts:  24%|██▍       | 127/526 [00:48<00:48,  8.22it/s, est. speed input: 4161.14 toks/s, output: 377.19 toks/s]
Processed prompts:  24%|██▍       | 128/526 [00:48<00:51,  7.67it/s, est. speed input: 4196.70 toks/s, output: 378.87 toks/s]
Processed prompts:  25%|██▍       | 131/526 [00:49<00:49,  7.91it/s, est. speed input: 4286.38 toks/s, output: 386.25 toks/s]
Processed prompts:  25%|██▌       | 133/526 [00:49<00:52,  7.50it/s, est. speed input: 4329.65 toks/s, output: 390.47 toks/s]
Processed prompts:  26%|██▋       | 139/526 [00:50<00:43,  8.81it/s, est. speed input: 4473.98 toks/s, output: 406.19 toks/s]
Processed prompts:  27%|██▋       | 143/526 [00:50<00:43,  8.90it/s, est. speed input: 4567.24 toks/s, output: 415.96 toks/s]
Processed prompts:  28%|██▊       | 146/526 [00:51<00:51,  7.44it/s, est. speed input: 4606.29 toks/s, output: 420.97 toks/s]
Processed prompts:  28%|██▊       | 148/526 [00:51<00:55,  6.87it/s, est. speed input: 4619.45 toks/s, output: 424.44 toks/s]
Processed prompts:  29%|██▉       | 155/526 [00:52<00:45,  8.09it/s, est. speed input: 4818.77 toks/s, output: 441.62 toks/s]
Processed prompts:  30%|███       | 158/526 [00:52<00:47,  7.73it/s, est. speed input: 4894.76 toks/s, output: 447.69 toks/s]
Processed prompts:  30%|███       | 159/526 [00:52<00:48,  7.53it/s, est. speed input: 4903.33 toks/s, output: 449.58 toks/s]
Processed prompts:  31%|███       | 163/526 [00:53<00:50,  7.12it/s, est. speed input: 4965.32 toks/s, output: 457.43 toks/s]
Processed prompts:  32%|███▏      | 169/526 [00:54<00:45,  7.77it/s, est. speed input: 5101.45 toks/s, output: 471.16 toks/s]
Processed prompts:  32%|███▏      | 170/526 [00:54<00:44,  7.93it/s, est. speed input: 5116.20 toks/s, output: 473.57 toks/s]
Processed prompts:  33%|███▎      | 173/526 [00:54<00:44,  7.89it/s, est. speed input: 5155.24 toks/s, output: 480.00 toks/s]
Processed prompts:  34%|███▎      | 177/526 [00:55<00:40,  8.64it/s, est. speed input: 5204.03 toks/s, output: 489.69 toks/s]
Processed prompts:  34%|███▍      | 178/526 [00:55<00:45,  7.57it/s, est. speed input: 5196.41 toks/s, output: 490.64 toks/s]
Processed prompts:  35%|███▍      | 182/526 [00:55<00:47,  7.24it/s, est. speed input: 5248.82 toks/s, output: 498.42 toks/s]
Processed prompts:  35%|███▍      | 184/526 [00:56<00:49,  6.92it/s, est. speed input: 5272.14 toks/s, output: 501.94 toks/s]
Processed prompts:  36%|███▌      | 187/526 [00:56<00:51,  6.53it/s, est. speed input: 5343.05 toks/s, output: 507.07 toks/s]
Processed prompts:  37%|███▋      | 192/526 [00:57<00:53,  6.25it/s, est. speed input: 5460.14 toks/s, output: 515.61 toks/s]
Processed prompts:  37%|███▋      | 194/526 [00:57<00:52,  6.34it/s, est. speed input: 5468.06 toks/s, output: 519.37 toks/s]
Processed prompts:  38%|███▊      | 199/526 [00:58<00:51,  6.38it/s, est. speed input: 5538.05 toks/s, output: 528.36 toks/s]
Processed prompts:  38%|███▊      | 201/526 [00:58<00:46,  7.04it/s, est. speed input: 5588.83 toks/s, output: 533.28 toks/s]
Processed prompts:  38%|███▊      | 202/526 [00:59<00:49,  6.55it/s, est. speed input: 5626.85 toks/s, output: 534.41 toks/s]
Processed prompts:  39%|███▉      | 205/526 [00:59<00:54,  5.94it/s, est. speed input: 5648.50 toks/s, output: 538.58 toks/s]
Processed prompts:  39%|███▉      | 206/526 [01:00<01:03,  5.06it/s, est. speed input: 5646.89 toks/s, output: 538.38 toks/s]
Processed prompts:  40%|███▉      | 208/526 [01:00<00:58,  5.45it/s, est. speed input: 5679.04 toks/s, output: 542.07 toks/s]
Processed prompts:  40%|████      | 213/526 [01:01<00:56,  5.54it/s, est. speed input: 5830.97 toks/s, output: 549.89 toks/s]
Processed prompts:  41%|████      | 216/526 [01:01<00:44,  7.02it/s, est. speed input: 5894.72 toks/s, output: 557.87 toks/s]
Processed prompts:  42%|████▏     | 219/526 [01:01<00:47,  6.46it/s, est. speed input: 5912.46 toks/s, output: 562.33 toks/s]
Processed prompts:  42%|████▏     | 222/526 [01:02<00:47,  6.38it/s, est. speed input: 5967.99 toks/s, output: 567.37 toks/s]
Processed prompts:  42%|████▏     | 223/526 [01:02<00:52,  5.79it/s, est. speed input: 5961.39 toks/s, output: 567.99 toks/s]
Processed prompts:  43%|████▎     | 225/526 [01:03<00:47,  6.30it/s, est. speed input: 5991.45 toks/s, output: 572.20 toks/s]
Processed prompts:  43%|████▎     | 226/526 [01:03<00:54,  5.54it/s, est. speed input: 5987.02 toks/s, output: 572.71 toks/s]
Processed prompts:  43%|████▎     | 228/526 [01:03<00:49,  6.07it/s, est. speed input: 6022.31 toks/s, output: 576.73 toks/s]
Processed prompts:  44%|████▎     | 229/526 [01:03<00:52,  5.71it/s, est. speed input: 6018.49 toks/s, output: 577.92 toks/s]
Processed prompts:  44%|████▎     | 230/526 [01:04<01:01,  4.84it/s, est. speed input: 6007.79 toks/s, output: 578.19 toks/s]
Processed prompts:  44%|████▍     | 233/526 [01:04<00:59,  4.88it/s, est. speed input: 6038.47 toks/s, output: 582.37 toks/s]
Processed prompts:  44%|████▍     | 234/526 [01:04<00:54,  5.36it/s, est. speed input: 6056.16 toks/s, output: 584.65 toks/s]
Processed prompts:  45%|████▍     | 235/526 [01:05<01:01,  4.77it/s, est. speed input: 6045.79 toks/s, output: 585.21 toks/s]
Processed prompts:  45%|████▌     | 237/526 [01:05<01:00,  4.77it/s, est. speed input: 6058.29 toks/s, output: 587.99 toks/s]
Processed prompts:  45%|████▌     | 239/526 [01:05<00:58,  4.87it/s, est. speed input: 6094.41 toks/s, output: 591.04 toks/s]
Processed prompts:  46%|████▌     | 240/526 [01:06<01:21,  3.52it/s, est. speed input: 6060.65 toks/s, output: 589.10 toks/s]
Processed prompts:  46%|████▌     | 241/526 [01:06<01:24,  3.36it/s, est. speed input: 6050.26 toks/s, output: 589.46 toks/s]
Processed prompts:  46%|████▌     | 242/526 [01:07<01:45,  2.68it/s, est. speed input: 6022.22 toks/s, output: 587.62 toks/s]
Processed prompts:  46%|████▌     | 243/526 [01:07<01:38,  2.88it/s, est. speed input: 6080.82 toks/s, output: 588.78 toks/s]
Processed prompts:  46%|████▋     | 244/526 [01:08<01:55,  2.45it/s, est. speed input: 6060.24 toks/s, output: 587.39 toks/s]
Processed prompts:  47%|████▋     | 245/526 [01:09<02:40,  1.75it/s, est. speed input: 5997.02 toks/s, output: 580.69 toks/s]
Processed prompts:  47%|████▋     | 246/526 [01:09<02:18,  2.02it/s, est. speed input: 5994.43 toks/s, output: 580.21 toks/s]
Processed prompts:  47%|████▋     | 249/526 [01:10<01:22,  3.37it/s, est. speed input: 6028.44 toks/s, output: 583.18 toks/s]
Processed prompts:  48%|████▊     | 252/526 [01:10<00:57,  4.78it/s, est. speed input: 6058.75 toks/s, output: 586.01 toks/s]
Processed prompts:  48%|████▊     | 254/526 [01:11<01:12,  3.77it/s, est. speed input: 6047.28 toks/s, output: 584.79 toks/s]
Processed prompts:  49%|████▊     | 256/526 [01:11<01:05,  4.14it/s, est. speed input: 6061.96 toks/s, output: 585.88 toks/s]
Processed prompts:  49%|████▉     | 258/526 [01:11<01:01,  4.35it/s, est. speed input: 6058.64 toks/s, output: 586.43 toks/s]
Processed prompts:  49%|████▉     | 259/526 [01:12<01:08,  3.89it/s, est. speed input: 6078.08 toks/s, output: 585.12 toks/s]
Processed prompts:  49%|████▉     | 260/526 [01:12<01:02,  4.24it/s, est. speed input: 6079.28 toks/s, output: 585.49 toks/s]
Processed prompts:  50%|████▉     | 261/526 [01:12<01:03,  4.18it/s, est. speed input: 6078.81 toks/s, output: 587.27 toks/s]
Processed prompts:  50%|█████     | 263/526 [01:13<01:04,  4.05it/s, est. speed input: 6082.29 toks/s, output: 587.15 toks/s]
Processed prompts:  50%|█████     | 264/526 [01:13<00:56,  4.63it/s, est. speed input: 6091.61 toks/s, output: 588.10 toks/s]
Processed prompts:  50%|█████     | 265/526 [01:13<01:00,  4.29it/s, est. speed input: 6107.37 toks/s, output: 588.10 toks/s]
Processed prompts:  51%|█████     | 268/526 [01:14<00:49,  5.26it/s, est. speed input: 6135.10 toks/s, output: 589.98 toks/s]
Processed prompts:  52%|█████▏    | 271/526 [01:14<00:46,  5.54it/s, est. speed input: 6170.48 toks/s, output: 591.27 toks/s]
Processed prompts:  52%|█████▏    | 273/526 [01:14<00:37,  6.78it/s, est. speed input: 6210.55 toks/s, output: 594.21 toks/s]
Processed prompts:  52%|█████▏    | 275/526 [01:14<00:30,  8.12it/s, est. speed input: 6254.03 toks/s, output: 596.59 toks/s]
Processed prompts:  53%|█████▎    | 280/526 [01:14<00:19, 12.51it/s, est. speed input: 6347.17 toks/s, output: 603.60 toks/s]
Processed prompts:  54%|█████▎    | 282/526 [01:15<00:18, 13.15it/s, est. speed input: 6385.40 toks/s, output: 606.57 toks/s]
Processed prompts:  55%|█████▍    | 289/526 [01:15<00:10, 22.12it/s, est. speed input: 6578.47 toks/s, output: 618.15 toks/s]
Processed prompts:  56%|█████▌    | 293/526 [01:15<00:09, 24.51it/s, est. speed input: 6680.60 toks/s, output: 625.27 toks/s]
Processed prompts:  56%|█████▋    | 297/526 [01:15<00:08, 26.59it/s, est. speed input: 6769.56 toks/s, output: 632.02 toks/s]
Processed prompts:  57%|█████▋    | 301/526 [01:15<00:07, 28.32it/s, est. speed input: 6865.29 toks/s, output: 638.29 toks/s]
Processed prompts:  58%|█████▊    | 305/526 [01:15<00:07, 29.73it/s, est. speed input: 6942.09 toks/s, output: 644.91 toks/s]
Processed prompts:  59%|█████▊    | 309/526 [01:15<00:07, 27.21it/s, est. speed input: 7030.18 toks/s, output: 651.50 toks/s]
Processed prompts:  60%|█████▉    | 313/526 [01:16<00:07, 29.19it/s, est. speed input: 7108.42 toks/s, output: 658.56 toks/s]
Processed prompts:  61%|██████▏   | 323/526 [01:16<00:04, 45.15it/s, est. speed input: 7336.06 toks/s, output: 678.46 toks/s]
Processed prompts:  62%|██████▏   | 328/526 [01:16<00:04, 45.58it/s, est. speed input: 7472.92 toks/s, output: 688.08 toks/s]
Processed prompts:  63%|██████▎   | 333/526 [01:16<00:04, 40.67it/s, est. speed input: 7600.18 toks/s, output: 698.12 toks/s]
Processed prompts:  64%|██████▍   | 338/526 [01:16<00:04, 42.56it/s, est. speed input: 7697.10 toks/s, output: 708.49 toks/s]
Processed prompts:  65%|██████▌   | 343/526 [01:16<00:04, 39.32it/s, est. speed input: 7778.74 toks/s, output: 717.10 toks/s]
Processed prompts:  67%|██████▋   | 351/526 [01:16<00:03, 44.01it/s, est. speed input: 7984.35 toks/s, output: 733.88 toks/s]
Processed prompts:  68%|██████▊   | 359/526 [01:16<00:03, 47.67it/s, est. speed input: 8179.09 toks/s, output: 749.13 toks/s]
Processed prompts:  70%|██████▉   | 368/526 [01:17<00:02, 52.77it/s, est. speed input: 8435.99 toks/s, output: 766.83 toks/s]
Processed prompts:  71%|███████   | 374/526 [01:17<00:03, 50.17it/s, est. speed input: 8573.51 toks/s, output: 779.50 toks/s]
Processed prompts:  73%|███████▎  | 383/526 [01:17<00:02, 50.36it/s, est. speed input: 8719.94 toks/s, output: 797.34 toks/s]
Processed prompts:  75%|███████▍  | 394/526 [01:17<00:02, 59.77it/s, est. speed input: 9001.83 toks/s, output: 821.76 toks/s]
Processed prompts:  76%|███████▋  | 402/526 [01:17<00:02, 61.25it/s, est. speed input: 9213.46 toks/s, output: 837.59 toks/s]
Processed prompts:  78%|███████▊  | 412/526 [01:17<00:01, 68.63it/s, est. speed input: 9465.27 toks/s, output: 856.65 toks/s]
Processed prompts:  80%|███████▉  | 420/526 [01:17<00:01, 70.24it/s, est. speed input: 9663.97 toks/s, output: 874.34 toks/s]
Processed prompts:  81%|████████▏ | 428/526 [01:18<00:01, 57.28it/s, est. speed input: 9859.27 toks/s, output: 891.45 toks/s]
Processed prompts:  83%|████████▎ | 435/526 [01:18<00:02, 44.17it/s, est. speed input: 9993.69 toks/s, output: 904.01 toks/s]
Processed prompts:  84%|████████▍ | 441/526 [01:18<00:02, 40.14it/s, est. speed input: 10098.60 toks/s, output: 918.29 toks/s]
Processed prompts:  85%|████████▍ | 447/526 [01:18<00:01, 42.01it/s, est. speed input: 10274.48 toks/s, output: 933.11 toks/s]
Processed prompts:  86%|████████▌ | 453/526 [01:18<00:01, 43.93it/s, est. speed input: 10440.97 toks/s, output: 946.07 toks/s]
Processed prompts:  87%|████████▋ | 458/526 [01:18<00:01, 43.92it/s, est. speed input: 10608.31 toks/s, output: 957.67 toks/s]
Processed prompts:  88%|████████▊ | 464/526 [01:18<00:01, 46.83it/s, est. speed input: 10781.47 toks/s, output: 970.87 toks/s]
Processed prompts:  89%|████████▉ | 469/526 [01:19<00:01, 47.35it/s, est. speed input: 10883.57 toks/s, output: 981.12 toks/s]
Processed prompts:  90%|█████████ | 475/526 [01:19<00:01, 35.08it/s, est. speed input: 11017.77 toks/s, output: 994.00 toks/s]
Processed prompts:  91%|█████████▏| 480/526 [01:19<00:01, 30.78it/s, est. speed input: 11084.69 toks/s, output: 1001.38 toks/s]
Processed prompts:  92%|█████████▏| 485/526 [01:19<00:01, 25.86it/s, est. speed input: 11171.52 toks/s, output: 1012.61 toks/s]
Processed prompts:  93%|█████████▎| 490/526 [01:19<00:01, 29.76it/s, est. speed input: 11298.13 toks/s, output: 1026.57 toks/s]
Processed prompts:  94%|█████████▍| 494/526 [01:20<00:01, 29.43it/s, est. speed input: 11384.19 toks/s, output: 1033.86 toks/s]
Processed prompts:  95%|█████████▍| 498/526 [01:20<00:01, 23.93it/s, est. speed input: 11476.59 toks/s, output: 1043.27 toks/s]
Processed prompts:  96%|█████████▌| 504/526 [01:20<00:00, 24.81it/s, est. speed input: 11557.84 toks/s, output: 1056.95 toks/s]
Processed prompts:  96%|█████████▋| 507/526 [01:20<00:00, 24.20it/s, est. speed input: 11618.13 toks/s, output: 1062.27 toks/s]
Processed prompts:  97%|█████████▋| 511/526 [01:20<00:00, 22.00it/s, est. speed input: 11740.75 toks/s, output: 1071.02 toks/s]
Processed prompts:  98%|█████████▊| 514/526 [01:21<00:01, 10.76it/s, est. speed input: 11696.44 toks/s, output: 1072.54 toks/s]
Processed prompts:  98%|█████████▊| 516/526 [01:22<00:01,  7.44it/s, est. speed input: 11641.63 toks/s, output: 1076.06 toks/s]
Processed prompts:  98%|█████████▊| 518/526 [01:22<00:01,  7.83it/s, est. speed input: 11678.18 toks/s, output: 1082.73 toks/s]
Processed prompts:  99%|█████████▉| 521/526 [01:22<00:00,  9.45it/s, est. speed input: 11766.62 toks/s, output: 1095.79 toks/s]
Processed prompts:  99%|█████████▉| 523/526 [01:22<00:00, 10.51it/s, est. speed input: 11821.96 toks/s, output: 1103.86 toks/s]
Processed prompts: 100%|█████████▉| 525/526 [01:23<00:00,  9.24it/s, est. speed input: 11860.47 toks/s, output: 1109.15 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:23<00:00,  6.31it/s, est. speed input: 11875.34 toks/s, output: 1110.87 toks/s]
[rank0]:[W709 16:48:10.154666977 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/lp_rag_full_profile_test_8_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 16:48:14.280883_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 16:48:14.280883_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 16:48:14.280883_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<03:03,  2.31it/s]
  0%|          | 2/424 [00:01<05:04,  1.39it/s]
  1%|          | 3/424 [00:01<03:04,  2.28it/s]
  1%|          | 4/424 [00:03<06:31,  1.07it/s]
  1%|          | 5/424 [00:03<04:49,  1.45it/s]
  2%|▏         | 7/424 [00:04<04:06,  1.69it/s]
  2%|▏         | 8/424 [00:05<04:10,  1.66it/s]
  2%|▏         | 9/424 [00:05<03:14,  2.14it/s]
  2%|▏         | 10/424 [00:05<02:51,  2.41it/s]
  3%|▎         | 11/424 [00:05<02:19,  2.96it/s]
  3%|▎         | 12/424 [00:05<02:14,  3.06it/s]
  3%|▎         | 13/424 [00:07<05:10,  1.32it/s]
  3%|▎         | 14/424 [00:07<03:58,  1.72it/s]
  4%|▎         | 15/424 [00:08<03:13,  2.11it/s]
  4%|▍         | 16/424 [00:08<03:26,  1.98it/s]
  4%|▍         | 17/424 [00:08<03:00,  2.25it/s]
  4%|▍         | 18/424 [00:09<02:35,  2.61it/s]
  4%|▍         | 19/424 [00:09<03:01,  2.23it/s]
  5%|▍         | 20/424 [00:09<02:27,  2.73it/s]
  5%|▍         | 21/424 [00:10<02:00,  3.35it/s]
  5%|▌         | 22/424 [00:10<02:41,  2.49it/s]
  5%|▌         | 23/424 [00:12<04:48,  1.39it/s]
  6%|▌         | 24/424 [00:12<04:35,  1.45it/s]
  6%|▌         | 25/424 [00:13<05:03,  1.31it/s]
  6%|▌         | 26/424 [00:14<04:45,  1.40it/s]
  6%|▋         | 27/424 [00:16<06:39,  1.01s/it]
  7%|▋         | 28/424 [00:16<05:51,  1.13it/s]
  7%|▋         | 29/424 [00:16<04:37,  1.42it/s]
  7%|▋         | 30/424 [00:17<03:35,  1.83it/s]
  7%|▋         | 31/424 [00:17<03:42,  1.77it/s]
  8%|▊         | 33/424 [00:17<02:11,  2.97it/s]
  8%|▊         | 34/424 [00:18<02:04,  3.14it/s]
  8%|▊         | 36/424 [00:18<01:22,  4.68it/s]
  9%|▊         | 37/424 [00:18<02:09,  2.98it/s]
  9%|▉         | 38/424 [00:19<02:03,  3.12it/s]
  9%|▉         | 40/424 [00:19<01:33,  4.12it/s]
 10%|▉         | 41/424 [00:19<01:33,  4.09it/s]
 10%|▉         | 42/424 [00:20<02:09,  2.96it/s]
 10%|█         | 43/424 [00:20<01:49,  3.48it/s]
 10%|█         | 44/424 [00:22<04:08,  1.53it/s]
 11%|█         | 45/424 [00:22<04:03,  1.56it/s]
 11%|█         | 46/424 [00:23<03:21,  1.87it/s]
 11%|█         | 47/424 [00:23<03:29,  1.80it/s]
 11%|█▏        | 48/424 [00:24<03:37,  1.73it/s]
 12%|█▏        | 49/424 [00:24<03:39,  1.71it/s]
 12%|█▏        | 51/424 [00:25<02:54,  2.14it/s]
 12%|█▏        | 52/424 [00:26<02:53,  2.14it/s]
 12%|█▎        | 53/424 [00:26<03:05,  2.00it/s]
 13%|█▎        | 54/424 [00:27<03:44,  1.65it/s]
 13%|█▎        | 55/424 [00:27<03:08,  1.95it/s]
 13%|█▎        | 56/424 [00:28<03:18,  1.85it/s]
 14%|█▎        | 58/424 [00:28<01:59,  3.06it/s]
 14%|█▍        | 59/424 [00:30<03:57,  1.54it/s]
 15%|█▍        | 62/424 [00:33<05:14,  1.15it/s]
 15%|█▍        | 63/424 [00:34<04:56,  1.22it/s]
 15%|█▌        | 64/424 [00:34<04:12,  1.43it/s]
 15%|█▌        | 65/424 [00:34<03:20,  1.79it/s]
 16%|█▌        | 66/424 [00:36<04:59,  1.20it/s]
 16%|█▌        | 67/424 [00:36<03:59,  1.49it/s]
 16%|█▌        | 68/424 [00:36<03:48,  1.56it/s]
 16%|█▋        | 69/424 [00:38<05:27,  1.09it/s]
 17%|█▋        | 70/424 [00:38<04:26,  1.33it/s]
 17%|█▋        | 71/424 [00:39<03:44,  1.57it/s]
 17%|█▋        | 72/424 [00:39<03:13,  1.82it/s]
 17%|█▋        | 73/424 [00:39<02:51,  2.04it/s]
 17%|█▋        | 74/424 [00:40<02:34,  2.26it/s]
 18%|█▊        | 75/424 [00:42<05:16,  1.10it/s]
 18%|█▊        | 77/424 [00:42<03:21,  1.72it/s]
 18%|█▊        | 78/424 [00:42<02:42,  2.13it/s]
 19%|█▉        | 80/424 [00:42<01:48,  3.17it/s]
 19%|█▉        | 81/424 [00:43<02:28,  2.31it/s]
 19%|█▉        | 82/424 [00:44<02:58,  1.91it/s]
 20%|█▉        | 83/424 [00:45<03:38,  1.56it/s]
 20%|█▉        | 84/424 [00:45<02:48,  2.02it/s]
 20%|██        | 85/424 [00:46<03:35,  1.57it/s]
 20%|██        | 86/424 [00:47<03:55,  1.43it/s]
 21%|██        | 87/424 [00:48<04:22,  1.29it/s]
 21%|██        | 88/424 [00:48<03:40,  1.52it/s]
 21%|██        | 89/424 [00:49<04:12,  1.33it/s]
 21%|██        | 90/424 [00:49<03:15,  1.71it/s]
 21%|██▏       | 91/424 [00:50<03:56,  1.41it/s]
 22%|██▏       | 92/424 [00:51<04:22,  1.26it/s]
 22%|██▏       | 93/424 [00:52<04:03,  1.36it/s]
 22%|██▏       | 94/424 [00:53<04:25,  1.24it/s]
 22%|██▏       | 95/424 [00:53<03:17,  1.66it/s]
 23%|██▎       | 96/424 [00:53<02:51,  1.91it/s]
 23%|██▎       | 98/424 [00:54<01:45,  3.10it/s]
 23%|██▎       | 99/424 [00:54<01:31,  3.56it/s]
 24%|██▎       | 100/424 [00:54<01:55,  2.81it/s]
 24%|██▍       | 101/424 [00:56<03:20,  1.61it/s]
 24%|██▍       | 102/424 [00:56<02:49,  1.90it/s]
 24%|██▍       | 103/424 [00:56<02:21,  2.27it/s]
 25%|██▍       | 104/424 [00:56<01:56,  2.76it/s]
 25%|██▍       | 105/424 [00:57<02:22,  2.23it/s]
 25%|██▌       | 106/424 [00:57<01:51,  2.86it/s]
 25%|██▌       | 107/424 [00:58<02:19,  2.27it/s]
 26%|██▌       | 109/424 [01:01<05:23,  1.03s/it]
 26%|██▌       | 110/424 [01:03<06:13,  1.19s/it]
 26%|██▌       | 111/424 [01:03<05:17,  1.01s/it]
 26%|██▋       | 112/424 [01:04<04:00,  1.30it/s]
 27%|██▋       | 114/424 [01:04<02:23,  2.16it/s]
 27%|██▋       | 116/424 [01:04<01:40,  3.07it/s]
 28%|██▊       | 118/424 [01:04<01:19,  3.87it/s]
 28%|██▊       | 119/424 [01:04<01:14,  4.09it/s]
 29%|██▊       | 121/424 [01:05<01:00,  4.98it/s]
 29%|██▉       | 122/424 [01:11<07:46,  1.55s/it]
 29%|██▉       | 123/424 [01:18<13:48,  2.75s/it]
 29%|██▉       | 124/424 [01:25<18:45,  3.75s/it]
 29%|██▉       | 125/424 [01:32<22:36,  4.54s/it]
 30%|██▉       | 126/424 [01:39<25:41,  5.17s/it]
 30%|██▉       | 127/424 [01:45<27:53,  5.63s/it]
 30%|███       | 128/424 [01:46<21:13,  4.30s/it]
 30%|███       | 129/424 [01:47<16:20,  3.32s/it]
 31%|███       | 130/424 [01:48<12:49,  2.62s/it]
 31%|███       | 131/424 [01:49<10:23,  2.13s/it]
 31%|███       | 132/424 [01:50<07:57,  1.64s/it]
 31%|███▏      | 133/424 [01:50<06:31,  1.35s/it]
 32%|███▏      | 134/424 [01:50<04:43,  1.02it/s]
 32%|███▏      | 135/424 [01:51<03:34,  1.35it/s]
 32%|███▏      | 136/424 [01:51<02:45,  1.75it/s]
 32%|███▏      | 137/424 [01:51<02:11,  2.18it/s]
 33%|███▎      | 138/424 [01:51<01:46,  2.68it/s]
 33%|███▎      | 139/424 [01:51<01:29,  3.18it/s]
 33%|███▎      | 140/424 [01:51<01:12,  3.93it/s]
 33%|███▎      | 141/424 [01:52<01:05,  4.34it/s]
 33%|███▎      | 142/424 [01:52<01:01,  4.59it/s]
 34%|███▎      | 143/424 [01:52<00:58,  4.81it/s]
 34%|███▍      | 144/424 [01:52<00:56,  4.98it/s]
 34%|███▍      | 145/424 [01:52<00:53,  5.23it/s]
 34%|███▍      | 146/424 [01:53<00:51,  5.39it/s]
 35%|███▍      | 147/424 [01:53<00:50,  5.45it/s]
 35%|███▍      | 148/424 [01:53<00:50,  5.47it/s]
 35%|███▌      | 149/424 [01:53<00:50,  5.48it/s]
 35%|███▌      | 150/424 [01:53<00:50,  5.46it/s]
 36%|███▌      | 151/424 [01:53<00:50,  5.44it/s]
 36%|███▌      | 152/424 [01:54<00:49,  5.48it/s]
 36%|███▌      | 153/424 [01:54<00:49,  5.48it/s]
 36%|███▋      | 154/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 155/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 156/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 157/424 [01:55<00:48,  5.53it/s]
 37%|███▋      | 158/424 [01:55<00:48,  5.52it/s]
 38%|███▊      | 159/424 [01:55<00:48,  5.50it/s]
 38%|███▊      | 160/424 [01:57<02:58,  1.48it/s]
 38%|███▊      | 161/424 [01:57<02:19,  1.89it/s]
 38%|███▊      | 162/424 [01:57<01:51,  2.34it/s]
 38%|███▊      | 163/424 [01:57<01:31,  2.85it/s]
 39%|███▊      | 164/424 [01:57<01:18,  3.31it/s]
 39%|███▉      | 165/424 [01:58<01:08,  3.77it/s]
 39%|███▉      | 166/424 [01:58<00:57,  4.52it/s]
 39%|███▉      | 167/424 [01:58<00:54,  4.74it/s]
 40%|███▉      | 168/424 [01:58<01:01,  4.17it/s]
 40%|███▉      | 169/424 [01:59<01:08,  3.71it/s]
 40%|████      | 170/424 [01:59<01:11,  3.54it/s]
 40%|████      | 171/424 [01:59<01:22,  3.06it/s]
 41%|████      | 172/424 [01:59<01:07,  3.76it/s]
 41%|████      | 174/424 [02:00<01:28,  2.84it/s]
 41%|████▏     | 175/424 [02:00<01:12,  3.42it/s]
 42%|████▏     | 176/424 [02:01<01:03,  3.90it/s]
 42%|████▏     | 177/424 [02:01<00:56,  4.37it/s]
 42%|████▏     | 178/424 [02:01<01:00,  4.05it/s]
 42%|████▏     | 179/424 [02:01<01:00,  4.07it/s]
 42%|████▏     | 180/424 [02:02<01:10,  3.49it/s]
 43%|████▎     | 181/424 [02:02<00:59,  4.06it/s]
 43%|████▎     | 182/424 [02:02<00:57,  4.22it/s]
 43%|████▎     | 183/424 [02:02<00:56,  4.28it/s]
 43%|████▎     | 184/424 [02:03<01:17,  3.10it/s]
 44%|████▎     | 185/424 [02:03<01:37,  2.44it/s]
 44%|████▍     | 186/424 [02:04<01:42,  2.33it/s]
 44%|████▍     | 187/424 [02:04<01:36,  2.46it/s]
 44%|████▍     | 188/424 [02:05<01:34,  2.49it/s]
 45%|████▍     | 189/424 [02:06<02:58,  1.32it/s]
 45%|████▍     | 190/424 [02:10<06:53,  1.77s/it]
 45%|████▌     | 191/424 [02:11<05:14,  1.35s/it]
 45%|████▌     | 192/424 [02:12<05:34,  1.44s/it]
 46%|████▌     | 194/424 [02:13<03:23,  1.13it/s]
 46%|████▌     | 196/424 [02:13<02:29,  1.53it/s]
 46%|████▋     | 197/424 [02:14<02:09,  1.76it/s]
 47%|████▋     | 198/424 [02:14<01:48,  2.08it/s]
 47%|████▋     | 199/424 [02:15<02:04,  1.81it/s]
 47%|████▋     | 200/424 [02:15<01:42,  2.18it/s]
 47%|████▋     | 201/424 [02:17<02:54,  1.28it/s]
 48%|████▊     | 202/424 [02:17<02:15,  1.63it/s]
 48%|████▊     | 203/424 [02:18<03:23,  1.09it/s]
 48%|████▊     | 204/424 [02:22<05:45,  1.57s/it]
 48%|████▊     | 205/424 [02:22<04:37,  1.27s/it]
 49%|████▊     | 206/424 [02:25<06:31,  1.80s/it]
 49%|████▉     | 207/424 [02:25<04:52,  1.35s/it]
 49%|████▉     | 208/424 [02:26<03:44,  1.04s/it]
 49%|████▉     | 209/424 [02:26<02:48,  1.27it/s]
 50%|████▉     | 210/424 [02:26<02:17,  1.56it/s]
 50%|█████     | 212/424 [02:26<01:21,  2.61it/s]
 50%|█████     | 213/424 [02:27<01:28,  2.39it/s]
 50%|█████     | 214/424 [02:27<01:35,  2.20it/s]
 51%|█████     | 215/424 [02:28<01:56,  1.79it/s]
 51%|█████     | 216/424 [02:28<01:32,  2.24it/s]
 51%|█████     | 217/424 [02:29<01:18,  2.65it/s]
 51%|█████▏    | 218/424 [02:29<01:11,  2.86it/s]
 52%|█████▏    | 219/424 [02:29<01:06,  3.09it/s]
 52%|█████▏    | 220/424 [02:30<01:36,  2.10it/s]
 52%|█████▏    | 221/424 [02:30<01:26,  2.35it/s]
 52%|█████▏    | 222/424 [02:31<01:19,  2.55it/s]
 53%|█████▎    | 223/424 [02:31<01:11,  2.80it/s]
 53%|█████▎    | 224/424 [02:31<01:08,  2.93it/s]
 53%|█████▎    | 225/424 [02:33<02:21,  1.40it/s]
 54%|█████▎    | 227/424 [02:33<01:31,  2.14it/s]
 54%|█████▍    | 229/424 [02:33<01:02,  3.11it/s]
 54%|█████▍    | 230/424 [02:37<03:05,  1.05it/s]
 54%|█████▍    | 231/424 [02:37<02:45,  1.17it/s]
 55%|█████▍    | 232/424 [02:37<02:07,  1.51it/s]
 55%|█████▍    | 233/424 [02:39<02:56,  1.08it/s]
 55%|█████▌    | 234/424 [02:46<08:12,  2.59s/it]
 55%|█████▌    | 235/424 [02:47<06:35,  2.09s/it]
 56%|█████▌    | 236/424 [02:47<04:59,  1.59s/it]
 56%|█████▌    | 238/424 [02:47<02:48,  1.10it/s]
 57%|█████▋    | 240/424 [02:49<02:44,  1.12it/s]
 57%|█████▋    | 241/424 [02:50<02:40,  1.14it/s]
 57%|█████▋    | 242/424 [02:50<02:07,  1.42it/s]
 57%|█████▋    | 243/424 [02:50<01:52,  1.61it/s]
 58%|█████▊    | 244/424 [02:51<01:53,  1.58it/s]
 58%|█████▊    | 245/424 [02:51<01:27,  2.03it/s]
 58%|█████▊    | 246/424 [02:51<01:18,  2.27it/s]
 58%|█████▊    | 247/424 [02:53<02:19,  1.27it/s]
 58%|█████▊    | 248/424 [02:53<01:44,  1.69it/s]
 59%|█████▊    | 249/424 [02:53<01:18,  2.22it/s]
 59%|█████▉    | 250/424 [02:54<01:29,  1.95it/s]
 59%|█████▉    | 251/424 [02:54<01:11,  2.43it/s]
 59%|█████▉    | 252/424 [02:54<00:55,  3.11it/s]
 60%|█████▉    | 253/424 [02:54<00:44,  3.87it/s]
 60%|█████▉    | 254/424 [02:54<00:36,  4.66it/s]
 60%|██████    | 255/424 [02:55<00:30,  5.49it/s]
 60%|██████    | 256/424 [02:55<00:27,  6.22it/s]
 61%|██████    | 257/424 [02:55<00:24,  6.92it/s]
 61%|██████    | 258/424 [02:55<00:22,  7.46it/s]
 61%|██████    | 259/424 [02:55<00:29,  5.54it/s]
 61%|██████▏   | 260/424 [02:56<01:07,  2.42it/s]
 62%|██████▏   | 262/424 [02:56<00:41,  3.89it/s]
 62%|██████▏   | 263/424 [02:57<01:10,  2.30it/s]
 62%|██████▏   | 264/424 [02:57<00:56,  2.86it/s]
 63%|██████▎   | 266/424 [02:58<00:47,  3.31it/s]
 63%|██████▎   | 267/424 [02:58<00:40,  3.88it/s]
 63%|██████▎   | 268/424 [02:58<00:34,  4.52it/s]
 63%|██████▎   | 269/424 [02:59<00:58,  2.64it/s]
 64%|██████▎   | 270/424 [02:59<00:46,  3.29it/s]
 64%|██████▍   | 272/424 [02:59<00:30,  4.94it/s]
 64%|██████▍   | 273/424 [02:59<00:30,  4.96it/s]
 65%|██████▍   | 275/424 [02:59<00:21,  6.96it/s]
 65%|██████▌   | 277/424 [03:00<00:17,  8.28it/s]
 66%|██████▌   | 279/424 [03:01<00:40,  3.60it/s]
 66%|██████▌   | 280/424 [03:01<00:43,  3.30it/s]
 66%|██████▋   | 281/424 [03:02<00:46,  3.10it/s]
 67%|██████▋   | 283/424 [03:05<01:55,  1.22it/s]
 67%|██████▋   | 284/424 [03:05<01:33,  1.49it/s]
 67%|██████▋   | 285/424 [03:05<01:14,  1.86it/s]
 68%|██████▊   | 287/424 [03:05<00:56,  2.44it/s]
 68%|██████▊   | 288/424 [03:06<00:53,  2.53it/s]
 68%|██████▊   | 289/424 [03:06<00:49,  2.73it/s]
 69%|██████▊   | 291/424 [03:06<00:36,  3.67it/s]
 69%|██████▉   | 292/424 [03:06<00:30,  4.28it/s]
 69%|██████▉   | 293/424 [03:10<02:05,  1.04it/s]
 70%|██████▉   | 295/424 [03:10<01:35,  1.35it/s]
 70%|██████▉   | 296/424 [03:11<01:16,  1.66it/s]
 70%|███████   | 297/424 [03:11<01:09,  1.82it/s]
 70%|███████   | 298/424 [03:11<00:58,  2.14it/s]
 71%|███████   | 299/424 [03:11<00:48,  2.57it/s]
 71%|███████   | 301/424 [03:12<00:35,  3.46it/s]
 71%|███████   | 302/424 [03:19<03:44,  1.84s/it]
 71%|███████▏  | 303/424 [03:19<02:58,  1.47s/it]
 72%|███████▏  | 304/424 [03:19<02:15,  1.13s/it]
 72%|███████▏  | 305/424 [03:19<01:48,  1.10it/s]
 72%|███████▏  | 306/424 [03:20<01:30,  1.30it/s]
 73%|███████▎  | 308/424 [03:20<00:58,  1.98it/s]
 73%|███████▎  | 309/424 [03:21<00:58,  1.95it/s]
 73%|███████▎  | 310/424 [03:22<01:12,  1.57it/s]
 74%|███████▎  | 312/424 [03:22<00:47,  2.38it/s]
 74%|███████▍  | 313/424 [03:22<00:41,  2.67it/s]
 74%|███████▍  | 314/424 [03:23<00:42,  2.61it/s]
 74%|███████▍  | 315/424 [03:24<01:07,  1.62it/s]
 75%|███████▍  | 316/424 [03:24<00:51,  2.09it/s]
 75%|███████▍  | 317/424 [03:25<01:17,  1.38it/s]
 75%|███████▌  | 318/424 [03:27<01:34,  1.12it/s]
 75%|███████▌  | 319/424 [03:27<01:16,  1.37it/s]
 75%|███████▌  | 320/424 [03:27<00:59,  1.74it/s]
 76%|███████▌  | 322/424 [03:27<00:35,  2.86it/s]
 76%|███████▌  | 323/424 [03:28<00:31,  3.23it/s]
 76%|███████▋  | 324/424 [03:28<00:27,  3.68it/s]
 77%|███████▋  | 325/424 [03:28<00:24,  4.06it/s]
 77%|███████▋  | 326/424 [03:35<03:23,  2.07s/it]
 77%|███████▋  | 327/424 [03:36<03:00,  1.86s/it]
 77%|███████▋  | 328/424 [03:37<02:28,  1.55s/it]
 78%|███████▊  | 329/424 [03:37<01:55,  1.21s/it]
 78%|███████▊  | 330/424 [03:39<01:57,  1.25s/it]
 78%|███████▊  | 331/424 [03:39<01:25,  1.09it/s]
 79%|███████▊  | 333/424 [03:40<01:16,  1.19it/s]
 79%|███████▉  | 334/424 [03:41<01:05,  1.37it/s]
 79%|███████▉  | 335/424 [03:41<01:02,  1.42it/s]
 79%|███████▉  | 336/424 [03:43<01:32,  1.05s/it]
 79%|███████▉  | 337/424 [03:50<03:50,  2.65s/it]
 80%|███████▉  | 338/424 [03:50<02:53,  2.02s/it]
 80%|███████▉  | 339/424 [03:51<02:24,  1.70s/it]
 80%|████████  | 340/424 [03:58<04:28,  3.20s/it]
 80%|████████  | 341/424 [04:00<03:48,  2.75s/it]
 81%|████████  | 342/424 [04:01<03:18,  2.42s/it]
 81%|████████  | 343/424 [04:02<02:21,  1.75s/it]
 81%|████████  | 344/424 [04:02<01:55,  1.44s/it]
 81%|████████▏ | 345/424 [04:02<01:22,  1.04s/it]
 82%|████████▏ | 346/424 [04:03<01:06,  1.17it/s]
 82%|████████▏ | 347/424 [04:04<01:02,  1.23it/s]
 83%|████████▎ | 350/424 [04:04<00:38,  1.91it/s]
 83%|████████▎ | 352/424 [04:11<01:49,  1.52s/it]
 83%|████████▎ | 353/424 [04:12<01:34,  1.33s/it]
 83%|████████▎ | 354/424 [04:13<01:27,  1.25s/it]
 84%|████████▎ | 355/424 [04:13<01:08,  1.01it/s]
 84%|████████▍ | 356/424 [04:15<01:18,  1.15s/it]
 84%|████████▍ | 357/424 [04:15<01:13,  1.09s/it]
 84%|████████▍ | 358/424 [04:16<01:11,  1.08s/it]
 85%|████████▍ | 359/424 [04:18<01:09,  1.06s/it]
 85%|████████▍ | 360/424 [04:18<00:52,  1.21it/s]
 85%|████████▌ | 361/424 [04:18<00:40,  1.55it/s]
 85%|████████▌ | 362/424 [04:18<00:34,  1.79it/s]
 86%|████████▌ | 363/424 [04:25<02:24,  2.36s/it]
 86%|████████▌ | 364/424 [04:25<01:46,  1.78s/it]
 86%|████████▌ | 365/424 [04:26<01:17,  1.31s/it]
 86%|████████▋ | 366/424 [04:26<00:55,  1.05it/s]
 87%|████████▋ | 367/424 [04:26<00:39,  1.43it/s]
 87%|████████▋ | 368/424 [04:33<02:21,  2.53s/it]
 87%|████████▋ | 369/424 [04:33<01:43,  1.88s/it]
 87%|████████▋ | 370/424 [04:33<01:12,  1.35s/it]
 88%|████████▊ | 372/424 [04:33<00:40,  1.30it/s]
 88%|████████▊ | 373/424 [04:33<00:32,  1.58it/s]
 88%|████████▊ | 374/424 [04:34<00:36,  1.38it/s]
 89%|████████▊ | 376/424 [04:35<00:27,  1.74it/s]
 89%|████████▉ | 377/424 [04:37<00:34,  1.34it/s]
 89%|████████▉ | 378/424 [04:37<00:27,  1.68it/s]
 89%|████████▉ | 379/424 [04:37<00:26,  1.70it/s]
 90%|████████▉ | 380/424 [04:39<00:37,  1.17it/s]
 90%|█████████ | 382/424 [04:40<00:33,  1.26it/s]
 91%|█████████ | 384/424 [04:41<00:21,  1.84it/s]
 91%|█████████ | 385/424 [04:41<00:18,  2.14it/s]
 91%|█████████▏| 387/424 [04:41<00:11,  3.23it/s]
 92%|█████████▏| 388/424 [04:41<00:13,  2.68it/s]
 92%|█████████▏| 389/424 [04:46<00:44,  1.28s/it]
 92%|█████████▏| 390/424 [04:46<00:34,  1.01s/it]
 92%|█████████▏| 391/424 [04:46<00:25,  1.28it/s]
 92%|█████████▏| 392/424 [04:46<00:19,  1.67it/s]
 93%|█████████▎| 393/424 [04:47<00:19,  1.59it/s]
 93%|█████████▎| 394/424 [04:47<00:19,  1.57it/s]
 93%|█████████▎| 395/424 [04:49<00:27,  1.06it/s]
 93%|█████████▎| 396/424 [04:50<00:26,  1.05it/s]
 94%|█████████▎| 397/424 [04:51<00:28,  1.05s/it]
 94%|█████████▍| 398/424 [04:53<00:29,  1.12s/it]
 94%|█████████▍| 399/424 [04:53<00:22,  1.11it/s]
 94%|█████████▍| 400/424 [04:54<00:19,  1.24it/s]
 95%|█████████▍| 401/424 [04:54<00:14,  1.56it/s]
 95%|█████████▍| 402/424 [04:57<00:30,  1.41s/it]
 95%|█████████▌| 403/424 [05:00<00:36,  1.76s/it]
 95%|█████████▌| 404/424 [05:00<00:25,  1.29s/it]
 96%|█████████▌| 405/424 [05:00<00:19,  1.03s/it]
 96%|█████████▌| 406/424 [05:00<00:13,  1.33it/s]
 96%|█████████▌| 407/424 [05:02<00:15,  1.09it/s]
 96%|█████████▌| 408/424 [05:03<00:15,  1.06it/s]
 96%|█████████▋| 409/424 [05:05<00:21,  1.43s/it]
 97%|█████████▋| 410/424 [05:06<00:15,  1.10s/it]
 97%|█████████▋| 411/424 [05:07<00:13,  1.05s/it]
 97%|█████████▋| 412/424 [05:07<00:09,  1.29it/s]
 97%|█████████▋| 413/424 [05:08<00:11,  1.04s/it]
 98%|█████████▊| 415/424 [05:10<00:08,  1.09it/s]
 98%|█████████▊| 416/424 [05:11<00:06,  1.17it/s]
 98%|█████████▊| 417/424 [05:11<00:05,  1.27it/s]
 99%|█████████▊| 418/424 [05:15<00:10,  1.72s/it]
 99%|█████████▉| 419/424 [05:16<00:07,  1.42s/it]
 99%|█████████▉| 420/424 [05:18<00:05,  1.48s/it]
 99%|█████████▉| 421/424 [05:19<00:04,  1.33s/it]
100%|█████████▉| 422/424 [05:19<00:01,  1.01it/s]
100%|█████████▉| 423/424 [05:23<00:01,  1.91s/it]
100%|██████████| 424/424 [05:24<00:00,  1.64s/it]
100%|██████████| 424/424 [05:24<00:00,  1.31it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 16:48:14.280883_sc_processed_test.json', '--output_addr', 'data/out/rag/full_profile/sc_rag_full_profile_test_8_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '8', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  3.76 examples/s]
Generating train split: 424 examples [00:00, 726.72 examples/s]
INFO 07-09 16:54:06 config.py:510] This model supports multiple tasks: {'reward', 'score', 'classify', 'generate', 'embed'}. Defaulting to 'generate'.
INFO 07-09 16:54:06 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:54:07 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:54:08 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:54:08 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.58it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.51it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.57it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.58it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.57it/s]

INFO 07-09 16:54:17 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 16:54:19 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-09 16:54:19 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 16:54:19 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 16:54:19 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 16:54:19 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 16:54:22 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:11,  3.05it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.36it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:09,  3.47it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.49it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.48it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:08,  3.53it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:07,  3.57it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.59it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.59it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.62it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.65it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.67it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.55it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.60it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.63it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.66it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.72it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.76it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.79it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.81it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.81it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.82it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.84it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.85it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.87it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.88it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.88it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.89it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.91it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.91it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.92it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.94it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.87it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.91it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.93it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.74it/s]
INFO 07-09 16:54:32 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-09 16:54:32 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.32 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:32<3:45:43, 32.02s/it, est. speed input: 47.13 toks/s, output: 2.19 toks/s]
Processed prompts:   0%|          | 2/424 [00:34<1:42:20, 14.55s/it, est. speed input: 138.63 toks/s, output: 5.15 toks/s]
Processed prompts:   1%|          | 3/424 [00:34<56:25,  8.04s/it, est. speed input: 237.42 toks/s, output: 8.29 toks/s]  
Processed prompts:   1%|          | 5/424 [00:34<24:59,  3.58s/it, est. speed input: 312.65 toks/s, output: 14.59 toks/s]
Processed prompts:   2%|▏         | 8/424 [00:35<11:54,  1.72s/it, est. speed input: 423.92 toks/s, output: 24.02 toks/s]
Processed prompts:   2%|▏         | 9/424 [00:35<09:45,  1.41s/it, est. speed input: 456.14 toks/s, output: 27.20 toks/s]
Processed prompts:   3%|▎         | 11/424 [00:35<06:26,  1.07it/s, est. speed input: 577.10 toks/s, output: 33.70 toks/s]
Processed prompts:   3%|▎         | 13/424 [00:36<04:21,  1.57it/s, est. speed input: 672.87 toks/s, output: 40.27 toks/s]
Processed prompts:   3%|▎         | 14/424 [00:36<03:46,  1.81it/s, est. speed input: 704.23 toks/s, output: 43.42 toks/s]
Processed prompts:   4%|▍         | 19/424 [00:37<02:04,  3.25it/s, est. speed input: 888.06 toks/s, output: 59.29 toks/s]
Processed prompts:   5%|▌         | 22/424 [00:37<01:36,  4.17it/s, est. speed input: 993.38 toks/s, output: 68.86 toks/s]
Processed prompts:   6%|▌         | 25/424 [00:37<01:22,  4.83it/s, est. speed input: 1157.87 toks/s, output: 78.13 toks/s]
Processed prompts:   7%|▋         | 28/424 [00:38<01:06,  5.96it/s, est. speed input: 1292.41 toks/s, output: 87.67 toks/s]
Processed prompts:   7%|▋         | 30/424 [00:38<01:10,  5.56it/s, est. speed input: 1336.19 toks/s, output: 93.38 toks/s]
Processed prompts:   8%|▊         | 32/424 [00:38<01:06,  5.93it/s, est. speed input: 1411.71 toks/s, output: 99.52 toks/s]
Processed prompts:   8%|▊         | 35/424 [00:39<01:04,  6.05it/s, est. speed input: 1590.36 toks/s, output: 108.44 toks/s]
Processed prompts:   8%|▊         | 36/424 [00:39<01:07,  5.72it/s, est. speed input: 1620.94 toks/s, output: 111.19 toks/s]
Processed prompts:   9%|▉         | 38/424 [00:39<00:59,  6.53it/s, est. speed input: 1675.09 toks/s, output: 117.42 toks/s]
Processed prompts:   9%|▉         | 39/424 [00:39<01:02,  6.11it/s, est. speed input: 1692.98 toks/s, output: 120.20 toks/s]
Processed prompts:   9%|▉         | 40/424 [00:39<01:00,  6.37it/s, est. speed input: 1748.28 toks/s, output: 123.24 toks/s]
Processed prompts:  10%|▉         | 42/424 [00:40<01:04,  5.93it/s, est. speed input: 1894.16 toks/s, output: 128.90 toks/s]
Processed prompts:  10%|█         | 43/424 [00:40<01:06,  5.72it/s, est. speed input: 1908.25 toks/s, output: 131.69 toks/s]
Processed prompts:  11%|█         | 46/424 [00:40<01:01,  6.17it/s, est. speed input: 2025.55 toks/s, output: 140.47 toks/s]
Processed prompts:  11%|█▏        | 48/424 [00:41<00:57,  6.56it/s, est. speed input: 2099.61 toks/s, output: 146.39 toks/s]
Processed prompts:  12%|█▏        | 50/424 [00:41<01:02,  5.98it/s, est. speed input: 2210.78 toks/s, output: 151.77 toks/s]
Processed prompts:  13%|█▎        | 56/424 [00:42<00:44,  8.20it/s, est. speed input: 2517.73 toks/s, output: 170.10 toks/s]
Processed prompts:  14%|█▎        | 58/424 [00:42<00:52,  6.96it/s, est. speed input: 2584.43 toks/s, output: 175.07 toks/s]
Processed prompts:  15%|█▍        | 62/424 [00:42<00:43,  8.40it/s, est. speed input: 2744.73 toks/s, output: 187.31 toks/s]
Processed prompts:  16%|█▌        | 66/424 [00:43<00:47,  7.47it/s, est. speed input: 2904.32 toks/s, output: 197.96 toks/s]
Processed prompts:  17%|█▋        | 70/424 [00:44<00:44,  7.99it/s, est. speed input: 3137.92 toks/s, output: 209.40 toks/s]
Processed prompts:  17%|█▋        | 72/424 [00:44<00:50,  6.97it/s, est. speed input: 3180.75 toks/s, output: 214.05 toks/s]
Processed prompts:  18%|█▊        | 75/424 [00:44<00:46,  7.55it/s, est. speed input: 3324.10 toks/s, output: 222.68 toks/s]
Processed prompts:  19%|█▉        | 80/424 [00:45<00:44,  7.71it/s, est. speed input: 3429.82 toks/s, output: 236.35 toks/s]
Processed prompts:  20%|█▉        | 83/424 [00:45<00:44,  7.71it/s, est. speed input: 3543.62 toks/s, output: 244.39 toks/s]
Processed prompts:  21%|██        | 87/424 [00:46<00:50,  6.70it/s, est. speed input: 3685.12 toks/s, output: 253.68 toks/s]
Processed prompts:  21%|██        | 89/424 [00:46<00:48,  6.91it/s, est. speed input: 3729.38 toks/s, output: 258.96 toks/s]
Processed prompts:  22%|██▏       | 95/424 [00:47<00:43,  7.58it/s, est. speed input: 3872.77 toks/s, output: 274.88 toks/s]
Processed prompts:  23%|██▎       | 98/424 [00:47<00:42,  7.58it/s, est. speed input: 3934.99 toks/s, output: 282.49 toks/s]
Processed prompts:  24%|██▍       | 102/424 [00:48<00:41,  7.83it/s, est. speed input: 4080.96 toks/s, output: 292.88 toks/s]
Processed prompts:  24%|██▍       | 103/424 [00:48<00:44,  7.21it/s, est. speed input: 4099.78 toks/s, output: 294.78 toks/s]
Processed prompts:  25%|██▌       | 106/424 [00:48<00:41,  7.60it/s, est. speed input: 4150.87 toks/s, output: 302.58 toks/s]
Processed prompts:  26%|██▌       | 110/424 [00:49<00:43,  7.27it/s, est. speed input: 4249.42 toks/s, output: 312.07 toks/s]
Processed prompts:  27%|██▋       | 114/424 [00:49<00:36,  8.61it/s, est. speed input: 4352.69 toks/s, output: 323.28 toks/s]
Processed prompts:  27%|██▋       | 116/424 [00:50<00:37,  8.32it/s, est. speed input: 4421.10 toks/s, output: 328.08 toks/s]
Processed prompts:  28%|██▊       | 119/424 [00:50<00:33,  9.10it/s, est. speed input: 4518.13 toks/s, output: 336.26 toks/s]
Processed prompts:  29%|██▉       | 123/424 [00:50<00:36,  8.17it/s, est. speed input: 4602.87 toks/s, output: 345.50 toks/s]
Processed prompts:  29%|██▉       | 124/424 [00:51<00:36,  8.30it/s, est. speed input: 4633.29 toks/s, output: 348.07 toks/s]
Processed prompts:  30%|██▉       | 127/424 [00:51<00:37,  7.90it/s, est. speed input: 4759.52 toks/s, output: 355.06 toks/s]
Processed prompts:  31%|███       | 130/424 [00:51<00:39,  7.50it/s, est. speed input: 4788.02 toks/s, output: 361.83 toks/s]
Processed prompts:  31%|███▏      | 133/424 [00:52<00:35,  8.18it/s, est. speed input: 4845.38 toks/s, output: 369.64 toks/s]
Processed prompts:  32%|███▏      | 135/424 [00:52<00:42,  6.86it/s, est. speed input: 4875.83 toks/s, output: 373.06 toks/s]
Processed prompts:  32%|███▏      | 136/424 [00:52<00:40,  7.10it/s, est. speed input: 4883.40 toks/s, output: 375.59 toks/s]
Processed prompts:  33%|███▎      | 139/424 [00:53<00:45,  6.29it/s, est. speed input: 4963.96 toks/s, output: 381.46 toks/s]
Processed prompts:  34%|███▎      | 143/424 [00:53<00:43,  6.49it/s, est. speed input: 5004.90 toks/s, output: 390.37 toks/s]
Processed prompts:  34%|███▍      | 146/424 [00:54<00:43,  6.33it/s, est. speed input: 5086.94 toks/s, output: 396.56 toks/s]
Processed prompts:  35%|███▌      | 150/424 [00:54<00:37,  7.25it/s, est. speed input: 5202.53 toks/s, output: 406.55 toks/s]
Processed prompts:  37%|███▋      | 155/424 [00:55<00:37,  7.11it/s, est. speed input: 5299.19 toks/s, output: 417.38 toks/s]
Processed prompts:  37%|███▋      | 156/424 [00:55<00:36,  7.29it/s, est. speed input: 5323.36 toks/s, output: 419.83 toks/s]
Processed prompts:  37%|███▋      | 158/424 [00:56<00:39,  6.81it/s, est. speed input: 5383.77 toks/s, output: 423.61 toks/s]
Processed prompts:  38%|███▊      | 161/424 [00:56<00:42,  6.13it/s, est. speed input: 5397.89 toks/s, output: 428.87 toks/s]
Processed prompts:  39%|███▉      | 165/424 [00:57<00:39,  6.61it/s, est. speed input: 5449.40 toks/s, output: 437.86 toks/s]
Processed prompts:  40%|███▉      | 168/424 [00:57<00:36,  7.09it/s, est. speed input: 5519.36 toks/s, output: 444.93 toks/s]
Processed prompts:  40%|████      | 170/424 [00:57<00:32,  7.70it/s, est. speed input: 5579.02 toks/s, output: 450.06 toks/s]
Processed prompts:  42%|████▏     | 176/424 [00:57<00:19, 12.99it/s, est. speed input: 5801.33 toks/s, output: 468.69 toks/s]
Processed prompts:  42%|████▏     | 180/424 [00:57<00:15, 16.07it/s, est. speed input: 5893.51 toks/s, output: 480.93 toks/s]
Processed prompts:  43%|████▎     | 183/424 [00:58<00:13, 17.68it/s, est. speed input: 5961.88 toks/s, output: 489.91 toks/s]
Processed prompts:  44%|████▍     | 187/424 [00:58<00:11, 20.92it/s, est. speed input: 6097.52 toks/s, output: 502.35 toks/s]
Processed prompts:  46%|████▌     | 193/424 [00:58<00:08, 27.65it/s, est. speed input: 6327.75 toks/s, output: 521.61 toks/s]
Processed prompts:  47%|████▋     | 198/424 [00:58<00:07, 31.45it/s, est. speed input: 6505.90 toks/s, output: 537.61 toks/s]
Processed prompts:  48%|████▊     | 203/424 [00:58<00:06, 34.64it/s, est. speed input: 6602.07 toks/s, output: 553.75 toks/s]
Processed prompts:  50%|█████     | 212/424 [00:58<00:04, 47.02it/s, est. speed input: 6901.05 toks/s, output: 583.86 toks/s]
Processed prompts:  51%|█████▏    | 218/424 [00:58<00:06, 32.89it/s, est. speed input: 7034.27 toks/s, output: 601.93 toks/s]
Processed prompts:  53%|█████▎    | 223/424 [00:59<00:07, 26.01it/s, est. speed input: 7166.03 toks/s, output: 616.83 toks/s]
Processed prompts:  54%|█████▎    | 227/424 [00:59<00:06, 28.30it/s, est. speed input: 7298.28 toks/s, output: 630.41 toks/s]
Processed prompts:  54%|█████▍    | 231/424 [00:59<00:08, 23.85it/s, est. speed input: 7360.00 toks/s, output: 642.66 toks/s]
Processed prompts:  56%|█████▌    | 237/424 [00:59<00:06, 27.98it/s, est. speed input: 7518.84 toks/s, output: 663.66 toks/s]
Processed prompts:  57%|█████▋    | 241/424 [01:00<00:13, 14.06it/s, est. speed input: 7564.59 toks/s, output: 668.97 toks/s]
Processed prompts:  58%|█████▊    | 244/424 [01:01<00:17, 10.09it/s, est. speed input: 7574.60 toks/s, output: 668.35 toks/s]
Processed prompts:  58%|█████▊    | 246/424 [01:01<00:18,  9.80it/s, est. speed input: 7606.61 toks/s, output: 672.03 toks/s]
Processed prompts:  58%|█████▊    | 248/424 [01:01<00:18,  9.55it/s, est. speed input: 7603.94 toks/s, output: 675.07 toks/s]
Processed prompts:  59%|█████▉    | 250/424 [01:01<00:16, 10.25it/s, est. speed input: 7629.63 toks/s, output: 677.53 toks/s]
Processed prompts:  59%|█████▉    | 252/424 [01:01<00:16, 10.40it/s, est. speed input: 7656.81 toks/s, output: 680.47 toks/s]
Processed prompts:  60%|█████▉    | 254/424 [01:01<00:15, 11.22it/s, est. speed input: 7715.11 toks/s, output: 683.40 toks/s]
Processed prompts:  61%|██████    | 257/424 [01:02<00:12, 13.56it/s, est. speed input: 7774.80 toks/s, output: 688.77 toks/s]
Processed prompts:  62%|██████▏   | 262/424 [01:02<00:09, 17.74it/s, est. speed input: 7869.87 toks/s, output: 700.73 toks/s]
Processed prompts:  64%|██████▎   | 270/424 [01:02<00:05, 25.82it/s, est. speed input: 8128.00 toks/s, output: 718.27 toks/s]
Processed prompts:  65%|██████▍   | 275/424 [01:02<00:05, 28.82it/s, est. speed input: 8242.79 toks/s, output: 729.01 toks/s]
Processed prompts:  66%|██████▌   | 280/424 [01:02<00:04, 31.47it/s, est. speed input: 8351.02 toks/s, output: 740.11 toks/s]
Processed prompts:  67%|██████▋   | 286/424 [01:02<00:03, 35.77it/s, est. speed input: 8503.78 toks/s, output: 753.22 toks/s]
Processed prompts:  69%|██████▉   | 292/424 [01:02<00:03, 39.23it/s, est. speed input: 8651.51 toks/s, output: 768.30 toks/s]
Processed prompts:  70%|███████   | 297/424 [01:03<00:03, 37.04it/s, est. speed input: 8817.00 toks/s, output: 779.18 toks/s]
Processed prompts:  71%|███████   | 302/424 [01:03<00:03, 39.25it/s, est. speed input: 8912.72 toks/s, output: 790.08 toks/s]
Processed prompts:  73%|███████▎  | 308/424 [01:03<00:02, 43.31it/s, est. speed input: 9075.63 toks/s, output: 804.27 toks/s]
Processed prompts:  74%|███████▍  | 313/424 [01:03<00:02, 44.51it/s, est. speed input: 9190.61 toks/s, output: 818.25 toks/s]
Processed prompts:  75%|███████▌  | 318/424 [01:03<00:02, 42.13it/s, est. speed input: 9316.13 toks/s, output: 828.74 toks/s]
Processed prompts:  76%|███████▌  | 323/424 [01:03<00:02, 40.88it/s, est. speed input: 9425.61 toks/s, output: 844.63 toks/s]
Processed prompts:  77%|███████▋  | 328/424 [01:03<00:02, 37.60it/s, est. speed input: 9544.43 toks/s, output: 855.06 toks/s]
Processed prompts:  79%|███████▉  | 334/424 [01:03<00:02, 40.60it/s, est. speed input: 9700.91 toks/s, output: 868.43 toks/s]
Processed prompts:  80%|███████▉  | 339/424 [01:04<00:02, 38.30it/s, est. speed input: 9826.22 toks/s, output: 878.96 toks/s]
Processed prompts:  82%|████████▏ | 346/424 [01:04<00:01, 44.15it/s, est. speed input: 10034.61 toks/s, output: 899.22 toks/s]
Processed prompts:  83%|████████▎ | 354/424 [01:04<00:01, 51.51it/s, est. speed input: 10301.38 toks/s, output: 919.93 toks/s]
Processed prompts:  85%|████████▌ | 361/424 [01:04<00:01, 52.26it/s, est. speed input: 10520.83 toks/s, output: 937.95 toks/s]
Processed prompts:  87%|████████▋ | 367/424 [01:04<00:01, 54.18it/s, est. speed input: 10654.85 toks/s, output: 958.65 toks/s]
Processed prompts:  89%|████████▊ | 376/424 [01:04<00:00, 61.24it/s, est. speed input: 10941.49 toks/s, output: 987.98 toks/s]
Processed prompts:  90%|█████████ | 383/424 [01:04<00:00, 62.21it/s, est. speed input: 11120.53 toks/s, output: 1007.37 toks/s]
Processed prompts:  92%|█████████▏| 390/424 [01:04<00:00, 57.84it/s, est. speed input: 11380.68 toks/s, output: 1026.08 toks/s]
Processed prompts:  93%|█████████▎| 396/424 [01:05<00:00, 56.48it/s, est. speed input: 11528.83 toks/s, output: 1042.48 toks/s]
Processed prompts:  95%|█████████▌| 403/424 [01:05<00:00, 54.99it/s, est. speed input: 11708.84 toks/s, output: 1065.49 toks/s]
Processed prompts:  96%|█████████▋| 409/424 [01:05<00:00, 47.33it/s, est. speed input: 11863.91 toks/s, output: 1082.82 toks/s]
Processed prompts:  98%|█████████▊| 414/424 [01:05<00:00, 43.00it/s, est. speed input: 11958.52 toks/s, output: 1100.63 toks/s]
Processed prompts:  99%|█████████▉| 419/424 [01:05<00:00, 25.50it/s, est. speed input: 12029.66 toks/s, output: 1116.84 toks/s]
Processed prompts: 100%|█████████▉| 423/424 [01:07<00:00,  9.23it/s, est. speed input: 11926.31 toks/s, output: 1114.86 toks/s]
Processed prompts: 100%|██████████| 424/424 [01:09<00:00,  6.11it/s, est. speed input: 11612.73 toks/s, output: 1089.40 toks/s]
[rank0]:[W709 16:55:44.700336646 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/sc_rag_full_profile_test_8_output.json
Cleaned temporary files.
Keeping ['lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-09 16:55:47.649836_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-09 16:55:47.649836_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-09 16:55:47.649836_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<01:36,  4.15it/s]
  1%|          | 3/401 [00:00<01:42,  3.90it/s]
  1%|          | 4/401 [00:01<03:04,  2.15it/s]
  1%|          | 5/401 [00:02<03:58,  1.66it/s]
  1%|▏         | 6/401 [00:03<04:28,  1.47it/s]
  2%|▏         | 7/401 [00:04<04:52,  1.35it/s]
  2%|▏         | 8/401 [00:05<05:04,  1.29it/s]
  2%|▏         | 9/401 [00:05<05:11,  1.26it/s]
  2%|▏         | 10/401 [00:06<03:53,  1.67it/s]
  3%|▎         | 11/401 [00:07<05:14,  1.24it/s]
  3%|▎         | 13/401 [00:08<04:44,  1.36it/s]
  3%|▎         | 14/401 [00:09<04:20,  1.48it/s]
  4%|▍         | 17/401 [00:09<02:14,  2.85it/s]
  4%|▍         | 18/401 [00:10<03:24,  1.87it/s]
  5%|▍         | 19/401 [00:11<04:25,  1.44it/s]
  5%|▍         | 20/401 [00:14<07:14,  1.14s/it]
  5%|▌         | 22/401 [00:17<07:39,  1.21s/it]
  6%|▌         | 23/401 [00:18<07:43,  1.23s/it]
  6%|▌         | 24/401 [00:20<09:43,  1.55s/it]
  6%|▋         | 26/401 [00:20<05:51,  1.07it/s]
  7%|▋         | 27/401 [00:23<08:07,  1.30s/it]
  7%|▋         | 29/401 [00:23<05:01,  1.23it/s]
  7%|▋         | 30/401 [00:23<04:07,  1.50it/s]
  8%|▊         | 31/401 [00:24<04:06,  1.50it/s]
  8%|▊         | 33/401 [00:25<03:16,  1.87it/s]
  8%|▊         | 34/401 [00:25<02:45,  2.21it/s]
  9%|▉         | 36/401 [00:25<01:49,  3.34it/s]
  9%|▉         | 38/401 [00:25<01:18,  4.60it/s]
 10%|▉         | 40/401 [00:25<01:02,  5.74it/s]
 10%|█         | 42/401 [00:26<01:02,  5.73it/s]
 11%|█         | 43/401 [00:26<01:03,  5.63it/s]
 11%|█         | 44/401 [00:26<00:57,  6.16it/s]
 11%|█▏        | 46/401 [00:26<00:54,  6.48it/s]
 12%|█▏        | 47/401 [00:26<00:55,  6.36it/s]
 12%|█▏        | 48/401 [00:27<01:03,  5.54it/s]
 12%|█▏        | 49/401 [00:27<01:02,  5.68it/s]
 13%|█▎        | 53/401 [00:27<00:39,  8.92it/s]
 14%|█▎        | 55/401 [00:28<00:57,  6.06it/s]
 14%|█▍        | 56/401 [00:28<00:55,  6.18it/s]
 14%|█▍        | 57/401 [00:28<00:51,  6.62it/s]
 15%|█▍        | 59/401 [00:28<01:08,  4.97it/s]
 15%|█▍        | 60/401 [00:29<01:04,  5.32it/s]
 15%|█▌        | 62/401 [00:29<00:58,  5.83it/s]
 16%|█▌        | 63/401 [00:29<00:57,  5.84it/s]
 16%|█▌        | 64/401 [00:29<00:57,  5.90it/s]
 16%|█▌        | 65/401 [00:29<00:56,  5.91it/s]
 16%|█▋        | 66/401 [00:30<00:54,  6.15it/s]
 17%|█▋        | 68/401 [00:30<00:38,  8.57it/s]
 17%|█▋        | 70/401 [00:30<00:33,  9.75it/s]
 18%|█▊        | 72/401 [00:30<00:33,  9.93it/s]
 18%|█▊        | 74/401 [00:30<00:30, 10.76it/s]
 19%|█▉        | 76/401 [00:30<00:31, 10.23it/s]
 19%|█▉        | 78/401 [00:30<00:29, 11.04it/s]
 20%|█▉        | 80/401 [00:31<00:30, 10.47it/s]
 20%|██        | 82/401 [00:31<00:28, 11.19it/s]
 21%|██        | 84/401 [00:31<00:29, 10.66it/s]
 21%|██▏       | 86/401 [00:31<00:27, 11.41it/s]
 22%|██▏       | 88/401 [00:32<00:49,  6.30it/s]
 22%|██▏       | 89/401 [00:32<00:48,  6.39it/s]
 23%|██▎       | 91/401 [00:32<00:38,  8.09it/s]
 23%|██▎       | 93/401 [00:32<00:35,  8.57it/s]
 24%|██▎       | 95/401 [00:33<00:39,  7.74it/s]
 24%|██▍       | 96/401 [00:33<00:38,  7.98it/s]
 24%|██▍       | 97/401 [00:33<00:37,  8.21it/s]
 24%|██▍       | 98/401 [00:33<00:36,  8.20it/s]
 25%|██▍       | 100/401 [00:33<00:28, 10.62it/s]
 25%|██▌       | 102/401 [00:33<00:24, 12.46it/s]
 26%|██▌       | 104/401 [00:34<00:34,  8.65it/s]
 26%|██▋       | 106/401 [00:34<00:29, 10.01it/s]
 27%|██▋       | 108/401 [00:34<00:31,  9.20it/s]
 27%|██▋       | 110/401 [00:34<00:27, 10.45it/s]
 28%|██▊       | 112/401 [00:34<00:28, 10.07it/s]
 28%|██▊       | 114/401 [00:34<00:28, 10.07it/s]
 29%|██▉       | 116/401 [00:35<00:26, 10.96it/s]
 29%|██▉       | 118/401 [00:35<00:28, 10.06it/s]
 30%|██▉       | 120/401 [00:35<00:26, 10.74it/s]
 30%|███       | 122/401 [00:35<00:24, 11.24it/s]
 31%|███       | 124/401 [00:35<00:29,  9.38it/s]
 31%|███▏      | 126/401 [00:36<00:34,  8.06it/s]
 32%|███▏      | 127/401 [00:36<00:35,  7.82it/s]
 32%|███▏      | 128/401 [00:36<00:35,  7.66it/s]
 32%|███▏      | 129/401 [00:36<00:33,  8.01it/s]
 32%|███▏      | 130/401 [00:36<00:35,  7.64it/s]
 33%|███▎      | 133/401 [00:37<00:44,  6.07it/s]
 33%|███▎      | 134/401 [00:37<00:40,  6.52it/s]
 34%|███▎      | 135/401 [00:37<00:38,  6.98it/s]
 34%|███▍      | 136/401 [00:37<00:35,  7.44it/s]
 34%|███▍      | 138/401 [00:37<00:30,  8.70it/s]
 35%|███▍      | 140/401 [00:38<00:24, 10.84it/s]
 35%|███▌      | 142/401 [00:38<00:30,  8.57it/s]
 36%|███▌      | 144/401 [00:38<00:35,  7.22it/s]
 36%|███▋      | 146/401 [00:38<00:29,  8.79it/s]
 37%|███▋      | 148/401 [00:39<00:40,  6.20it/s]
 37%|███▋      | 149/401 [00:39<00:38,  6.63it/s]
 37%|███▋      | 150/401 [00:39<00:35,  7.05it/s]
 38%|███▊      | 151/401 [00:39<00:35,  7.01it/s]
 38%|███▊      | 152/401 [00:39<00:33,  7.50it/s]
 38%|███▊      | 153/401 [00:40<00:40,  6.05it/s]
 38%|███▊      | 154/401 [00:40<00:39,  6.27it/s]
 39%|███▊      | 155/401 [00:40<00:38,  6.42it/s]
 39%|███▉      | 156/401 [00:40<00:37,  6.54it/s]
 39%|███▉      | 157/401 [00:40<00:36,  6.64it/s]
 40%|███▉      | 159/401 [00:40<00:26,  9.04it/s]
 40%|███▉      | 160/401 [00:41<00:33,  7.11it/s]
 40%|████      | 162/401 [00:41<00:27,  8.75it/s]
 41%|████      | 164/401 [00:41<00:22, 10.74it/s]
 41%|████▏     | 166/401 [00:41<00:22, 10.24it/s]
 42%|████▏     | 168/401 [00:41<00:22, 10.18it/s]
 42%|████▏     | 170/401 [00:41<00:23,  9.92it/s]
 43%|████▎     | 172/401 [00:42<00:29,  7.84it/s]
 43%|████▎     | 173/401 [00:42<00:28,  8.09it/s]
 43%|████▎     | 174/401 [00:42<00:27,  8.33it/s]
 44%|████▎     | 175/401 [00:42<00:26,  8.51it/s]
 44%|████▍     | 176/401 [00:42<00:25,  8.67it/s]
 44%|████▍     | 177/401 [00:42<00:27,  8.08it/s]
 44%|████▍     | 178/401 [00:42<00:26,  8.36it/s]
 45%|████▍     | 179/401 [00:43<00:25,  8.61it/s]
 45%|████▍     | 180/401 [00:43<00:24,  8.92it/s]
 45%|████▌     | 181/401 [00:43<00:24,  9.15it/s]
 45%|████▌     | 182/401 [00:43<00:23,  9.19it/s]
 46%|████▌     | 184/401 [00:43<00:19, 11.07it/s]
 46%|████▋     | 186/401 [00:43<00:17, 12.31it/s]
 47%|████▋     | 188/401 [00:43<00:18, 11.40it/s]
 47%|████▋     | 190/401 [00:44<00:17, 12.36it/s]
 48%|████▊     | 192/401 [00:44<00:41,  5.06it/s]
 48%|████▊     | 193/401 [00:45<00:38,  5.40it/s]
 48%|████▊     | 194/401 [00:45<00:41,  4.95it/s]
 49%|████▉     | 196/401 [00:45<00:45,  4.48it/s]
 49%|████▉     | 197/401 [00:47<01:58,  1.73it/s]
 50%|████▉     | 199/401 [00:48<01:32,  2.18it/s]
 50%|████▉     | 200/401 [00:48<01:31,  2.20it/s]
 50%|█████     | 201/401 [00:49<01:30,  2.20it/s]
 50%|█████     | 202/401 [00:49<01:29,  2.23it/s]
 51%|█████     | 203/401 [00:50<01:29,  2.22it/s]
 51%|█████     | 204/401 [00:50<01:28,  2.22it/s]
 51%|█████▏    | 206/401 [00:50<01:09,  2.80it/s]
 52%|█████▏    | 207/401 [00:51<01:13,  2.64it/s]
 52%|█████▏    | 208/401 [00:51<01:16,  2.52it/s]
 52%|█████▏    | 209/401 [00:52<01:15,  2.53it/s]
 52%|█████▏    | 210/401 [00:52<01:17,  2.45it/s]
 53%|█████▎    | 211/401 [00:53<01:25,  2.21it/s]
 53%|█████▎    | 212/401 [00:53<01:16,  2.48it/s]
 53%|█████▎    | 213/401 [00:54<01:24,  2.22it/s]
 53%|█████▎    | 214/401 [00:55<02:17,  1.36it/s]
 54%|█████▎    | 215/401 [00:55<01:47,  1.74it/s]
 54%|█████▍    | 216/401 [00:56<01:57,  1.57it/s]
 54%|█████▍    | 218/401 [00:56<01:13,  2.51it/s]
 55%|█████▍    | 219/401 [00:56<01:03,  2.86it/s]
 55%|█████▍    | 220/401 [00:57<00:56,  3.21it/s]
 55%|█████▌    | 221/401 [00:57<01:07,  2.68it/s]
 55%|█████▌    | 222/401 [00:57<00:58,  3.07it/s]
 56%|█████▌    | 224/401 [00:58<00:45,  3.85it/s]
 56%|█████▌    | 225/401 [00:58<00:39,  4.51it/s]
 56%|█████▋    | 226/401 [00:58<00:33,  5.24it/s]
 57%|█████▋    | 228/401 [00:59<00:43,  3.94it/s]
 57%|█████▋    | 229/401 [00:59<00:40,  4.25it/s]
 57%|█████▋    | 230/401 [00:59<00:39,  4.38it/s]
 58%|█████▊    | 231/401 [00:59<00:35,  4.81it/s]
 58%|█████▊    | 232/401 [00:59<00:38,  4.44it/s]
 58%|█████▊    | 234/401 [01:03<02:15,  1.23it/s]
 59%|█████▊    | 235/401 [01:03<01:54,  1.45it/s]
 59%|█████▉    | 236/401 [01:03<01:29,  1.84it/s]
 59%|█████▉    | 237/401 [01:03<01:17,  2.13it/s]
 59%|█████▉    | 238/401 [01:03<01:02,  2.59it/s]
 60%|█████▉    | 239/401 [01:04<00:54,  2.98it/s]
 60%|██████    | 241/401 [01:04<00:33,  4.77it/s]
 61%|██████    | 243/401 [01:04<00:39,  3.98it/s]
 61%|██████    | 244/401 [01:05<00:42,  3.74it/s]
 61%|██████▏   | 246/401 [01:05<00:32,  4.81it/s]
 62%|██████▏   | 247/401 [01:05<00:31,  4.84it/s]
 62%|██████▏   | 248/401 [01:05<00:27,  5.47it/s]
 62%|██████▏   | 249/401 [01:06<00:54,  2.77it/s]
 63%|██████▎   | 254/401 [01:06<00:21,  6.96it/s]
 64%|██████▍   | 256/401 [01:07<00:39,  3.65it/s]
 65%|██████▍   | 260/401 [01:08<00:23,  5.93it/s]
 65%|██████▌   | 262/401 [01:08<00:25,  5.40it/s]
 66%|██████▌   | 265/401 [01:08<00:18,  7.40it/s]
 67%|██████▋   | 268/401 [01:08<00:14,  9.34it/s]
 67%|██████▋   | 270/401 [01:09<00:21,  6.02it/s]
 68%|██████▊   | 273/401 [01:09<00:16,  7.95it/s]
 69%|██████▊   | 275/401 [01:09<00:14,  8.79it/s]
 69%|██████▉   | 277/401 [01:10<00:16,  7.33it/s]
 70%|██████▉   | 279/401 [01:10<00:15,  8.10it/s]
 70%|███████   | 281/401 [01:10<00:15,  7.72it/s]
 71%|███████   | 283/401 [01:11<00:17,  6.86it/s]
 71%|███████   | 285/401 [01:11<00:14,  7.79it/s]
 72%|███████▏  | 288/401 [01:11<00:10, 10.29it/s]
 73%|███████▎  | 291/401 [01:11<00:12,  8.51it/s]
 73%|███████▎  | 293/401 [01:12<00:22,  4.88it/s]
 73%|███████▎  | 294/401 [01:13<00:27,  3.89it/s]
 74%|███████▍  | 296/401 [01:13<00:21,  4.89it/s]
 75%|███████▍  | 299/401 [01:14<00:24,  4.20it/s]
 75%|███████▌  | 301/401 [01:14<00:18,  5.27it/s]
 76%|███████▌  | 304/401 [01:15<00:18,  5.11it/s]
 76%|███████▋  | 306/401 [01:15<00:15,  6.19it/s]
 77%|███████▋  | 308/401 [01:15<00:14,  6.45it/s]
 77%|███████▋  | 309/401 [01:15<00:17,  5.37it/s]
 78%|███████▊  | 311/401 [01:15<00:13,  6.45it/s]
 78%|███████▊  | 312/401 [01:16<00:12,  6.90it/s]
 78%|███████▊  | 314/401 [01:16<00:10,  8.44it/s]
 79%|███████▉  | 317/401 [01:16<00:07, 11.65it/s]
 80%|███████▉  | 319/401 [01:16<00:07, 10.32it/s]
 80%|████████  | 321/401 [01:16<00:09,  8.08it/s]
 81%|████████  | 323/401 [01:17<00:14,  5.30it/s]
 81%|████████  | 324/401 [01:18<00:18,  4.14it/s]
 81%|████████  | 325/401 [01:18<00:22,  3.40it/s]
 81%|████████▏ | 326/401 [01:18<00:20,  3.75it/s]
 82%|████████▏ | 328/401 [01:19<00:14,  5.13it/s]
 82%|████████▏ | 329/401 [01:20<00:31,  2.32it/s]
 82%|████████▏ | 330/401 [01:20<00:31,  2.25it/s]
 83%|████████▎ | 331/401 [01:20<00:26,  2.69it/s]
 83%|████████▎ | 332/401 [01:21<00:28,  2.46it/s]
 83%|████████▎ | 333/401 [01:21<00:29,  2.31it/s]
 84%|████████▎ | 335/401 [01:22<00:23,  2.76it/s]
 84%|████████▍ | 336/401 [01:22<00:25,  2.52it/s]
 84%|████████▍ | 338/401 [01:23<00:16,  3.78it/s]
 85%|████████▌ | 341/401 [01:23<00:10,  5.89it/s]
 86%|████████▌ | 343/401 [01:23<00:08,  6.90it/s]
 86%|████████▌ | 344/401 [01:23<00:08,  6.46it/s]
 86%|████████▋ | 346/401 [01:23<00:08,  6.87it/s]
 87%|████████▋ | 348/401 [01:24<00:09,  5.61it/s]
 87%|████████▋ | 350/401 [01:25<00:11,  4.56it/s]
 88%|████████▊ | 351/401 [01:25<00:13,  3.70it/s]
 89%|████████▊ | 355/401 [01:25<00:06,  6.67it/s]
 89%|████████▉ | 357/401 [01:26<00:09,  4.50it/s]
 90%|████████▉ | 359/401 [01:27<00:11,  3.70it/s]
 90%|████████▉ | 360/401 [01:28<00:14,  2.87it/s]
 90%|█████████ | 361/401 [01:28<00:12,  3.17it/s]
 91%|█████████ | 363/401 [01:28<00:08,  4.38it/s]
 91%|█████████ | 365/401 [01:28<00:06,  5.20it/s]
 92%|█████████▏| 367/401 [01:28<00:05,  5.99it/s]
 92%|█████████▏| 369/401 [01:29<00:05,  6.02it/s]
 92%|█████████▏| 370/401 [01:29<00:05,  5.88it/s]
 93%|█████████▎| 371/401 [01:29<00:05,  5.82it/s]
 93%|█████████▎| 373/401 [01:29<00:04,  6.61it/s]
 93%|█████████▎| 374/401 [01:29<00:04,  6.34it/s]
 94%|█████████▎| 375/401 [01:30<00:04,  6.16it/s]
 94%|█████████▍| 376/401 [01:30<00:06,  3.89it/s]
 94%|█████████▍| 378/401 [01:31<00:06,  3.56it/s]
 95%|█████████▍| 379/401 [01:31<00:07,  3.00it/s]
 95%|█████████▍| 380/401 [01:32<00:06,  3.38it/s]
 95%|█████████▌| 382/401 [01:32<00:05,  3.43it/s]
 96%|█████████▌| 383/401 [01:33<00:06,  2.88it/s]
 96%|█████████▌| 384/401 [01:33<00:06,  2.72it/s]
 96%|█████████▌| 385/401 [01:34<00:06,  2.49it/s]
 97%|█████████▋| 387/401 [01:34<00:05,  2.42it/s]
 97%|█████████▋| 389/401 [01:35<00:03,  3.39it/s]
 97%|█████████▋| 390/401 [01:35<00:03,  3.25it/s]
 98%|█████████▊| 393/401 [01:35<00:01,  5.49it/s]
 98%|█████████▊| 394/401 [01:35<00:01,  5.20it/s]
 99%|█████████▊| 395/401 [01:36<00:01,  4.51it/s]
 99%|█████████▉| 397/401 [01:36<00:00,  5.08it/s]
100%|█████████▉| 399/401 [01:36<00:00,  4.58it/s]
100%|██████████| 401/401 [01:37<00:00,  5.75it/s]
100%|██████████| 401/401 [01:37<00:00,  4.13it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-09 16:55:47.649836_ae_processed_test.json', '--output_addr', 'data/out/rag/asym/ae_rag_lp_sc_test_8_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '8', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  9.18 examples/s]
Generating train split: 401 examples [00:00, 1687.25 examples/s]
INFO 07-09 16:57:50 config.py:510] This model supports multiple tasks: {'classify', 'score', 'reward', 'embed', 'generate'}. Defaulting to 'generate'.
INFO 07-09 16:57:50 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-09 16:57:51 selector.py:120] Using Flash Attention backend.
INFO 07-09 16:57:53 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-09 16:57:53 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.60it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.54it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.61it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.62it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.61it/s]

INFO 07-09 17:38:30 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-09 17:38:32 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-09 17:38:32 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-09 17:38:32 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-09 17:38:32 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-09 17:38:32 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-09 17:38:35 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:10,  3.15it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.48it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:08,  3.61it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.67it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.71it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.69it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:08,  3.49it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:08,  3.36it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:08,  3.23it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:07,  3.32it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.45it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.55it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:06,  3.62it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.67it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.71it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.74it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.80it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.84it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.87it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.90it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.92it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:06<00:03,  3.93it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.95it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.96it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.97it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:07<00:02,  3.98it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.99it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.99it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  4.01it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:08<00:01,  3.88it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.58it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  3.49it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:09<00:00,  3.32it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:09<00:00,  3.43it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.59it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.68it/s]
INFO 07-09 17:38:44 model_runner.py:1535] Graph capturing finished in 10 secs, took 0.22 GiB
INFO 07-09 17:38:44 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.49 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:30<3:20:59, 30.15s/it, est. speed input: 44.84 toks/s, output: 2.72 toks/s]
Processed prompts:   0%|          | 2/401 [00:30<1:24:10, 12.66s/it, est. speed input: 77.64 toks/s, output: 5.56 toks/s]
Processed prompts:   1%|          | 3/401 [00:30<46:31,  7.01s/it, est. speed input: 147.14 toks/s, output: 8.49 toks/s] 
Processed prompts:   1%|          | 4/401 [00:31<29:29,  4.46s/it, est. speed input: 188.49 toks/s, output: 11.53 toks/s]
Processed prompts:   1%|          | 5/401 [00:31<19:04,  2.89s/it, est. speed input: 230.71 toks/s, output: 14.69 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:31<13:20,  2.03s/it, est. speed input: 269.44 toks/s, output: 17.77 toks/s]
Processed prompts:   2%|▏         | 7/401 [00:32<09:27,  1.44s/it, est. speed input: 295.94 toks/s, output: 20.94 toks/s]
Processed prompts:   2%|▏         | 9/401 [00:32<05:35,  1.17it/s, est. speed input: 356.46 toks/s, output: 27.28 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:32<04:26,  1.47it/s, est. speed input: 431.95 toks/s, output: 30.56 toks/s]
Processed prompts:   3%|▎         | 12/401 [00:33<02:57,  2.20it/s, est. speed input: 500.08 toks/s, output: 37.13 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:33<02:07,  3.04it/s, est. speed input: 580.97 toks/s, output: 43.74 toks/s]
Processed prompts:   4%|▍         | 17/401 [00:33<01:32,  4.16it/s, est. speed input: 804.21 toks/s, output: 53.55 toks/s]
Processed prompts:   5%|▍         | 19/401 [00:33<01:13,  5.17it/s, est. speed input: 882.10 toks/s, output: 60.24 toks/s]
Processed prompts:   5%|▌         | 22/401 [00:34<01:00,  6.27it/s, est. speed input: 957.85 toks/s, output: 70.07 toks/s]
Processed prompts:   6%|▌         | 25/401 [00:34<00:57,  6.49it/s, est. speed input: 1099.49 toks/s, output: 79.67 toks/s]
Processed prompts:   7%|▋         | 29/401 [00:35<00:51,  7.28it/s, est. speed input: 1289.47 toks/s, output: 92.71 toks/s]
Processed prompts:   8%|▊         | 32/401 [00:35<00:43,  8.56it/s, est. speed input: 1404.41 toks/s, output: 102.75 toks/s]
Processed prompts:   8%|▊         | 34/401 [00:35<00:44,  8.17it/s, est. speed input: 1500.85 toks/s, output: 109.00 toks/s]
Processed prompts:   9%|▉         | 36/401 [00:35<00:42,  8.50it/s, est. speed input: 1559.24 toks/s, output: 115.46 toks/s]
Processed prompts:   9%|▉         | 38/401 [00:36<00:55,  6.58it/s, est. speed input: 1601.25 toks/s, output: 120.90 toks/s]
Processed prompts:  10%|█         | 41/401 [00:36<00:50,  7.14it/s, est. speed input: 1687.57 toks/s, output: 130.25 toks/s]
Processed prompts:  10%|█         | 42/401 [00:36<00:53,  6.72it/s, est. speed input: 1719.13 toks/s, output: 133.07 toks/s]
Processed prompts:  11%|█         | 44/401 [00:37<00:56,  6.34it/s, est. speed input: 1813.19 toks/s, output: 138.82 toks/s]
Processed prompts:  12%|█▏        | 47/401 [00:37<00:48,  7.33it/s, est. speed input: 1895.15 toks/s, output: 148.20 toks/s]
Processed prompts:  12%|█▏        | 50/401 [00:37<00:43,  8.08it/s, est. speed input: 2019.07 toks/s, output: 157.53 toks/s]
Processed prompts:  13%|█▎        | 53/401 [00:38<00:54,  6.39it/s, est. speed input: 2154.10 toks/s, output: 165.23 toks/s]
Processed prompts:  15%|█▍        | 59/401 [00:39<00:47,  7.27it/s, est. speed input: 2379.11 toks/s, output: 182.82 toks/s]
Processed prompts:  15%|█▍        | 60/401 [00:39<00:49,  6.91it/s, est. speed input: 2423.77 toks/s, output: 185.32 toks/s]
Processed prompts:  16%|█▌        | 65/401 [00:39<00:41,  8.12it/s, est. speed input: 2639.06 toks/s, output: 200.24 toks/s]
Processed prompts:  17%|█▋        | 67/401 [00:40<00:43,  7.62it/s, est. speed input: 2691.66 toks/s, output: 205.45 toks/s]
Processed prompts:  18%|█▊        | 74/401 [00:41<00:42,  7.68it/s, est. speed input: 2932.61 toks/s, output: 224.50 toks/s]
Processed prompts:  20%|██        | 81/401 [00:41<00:41,  7.75it/s, est. speed input: 3189.99 toks/s, output: 242.96 toks/s]
Processed prompts:  21%|██        | 85/401 [00:42<00:38,  8.10it/s, est. speed input: 3271.81 toks/s, output: 253.75 toks/s]
Processed prompts:  22%|██▏       | 87/401 [00:42<00:43,  7.19it/s, est. speed input: 3291.18 toks/s, output: 257.70 toks/s]
Processed prompts:  22%|██▏       | 88/401 [00:42<00:43,  7.17it/s, est. speed input: 3336.87 toks/s, output: 260.17 toks/s]
Processed prompts:  23%|██▎       | 92/401 [00:43<00:47,  6.55it/s, est. speed input: 3497.39 toks/s, output: 269.09 toks/s]
Processed prompts:  23%|██▎       | 94/401 [00:43<00:43,  7.04it/s, est. speed input: 3546.00 toks/s, output: 274.45 toks/s]
Processed prompts:  24%|██▎       | 95/401 [00:44<00:47,  6.50it/s, est. speed input: 3575.88 toks/s, output: 276.30 toks/s]
Processed prompts:  24%|██▍       | 97/401 [00:44<00:39,  7.68it/s, est. speed input: 3622.30 toks/s, output: 282.11 toks/s]
Processed prompts:  26%|██▌       | 103/401 [00:44<00:37,  7.89it/s, est. speed input: 3785.57 toks/s, output: 297.09 toks/s]
Processed prompts:  26%|██▋       | 106/401 [00:45<00:35,  8.28it/s, est. speed input: 3870.38 toks/s, output: 304.85 toks/s]
Processed prompts:  27%|██▋       | 109/401 [00:45<00:38,  7.55it/s, est. speed input: 3952.37 toks/s, output: 311.41 toks/s]
Processed prompts:  28%|██▊       | 112/401 [00:46<00:36,  7.95it/s, est. speed input: 4030.95 toks/s, output: 318.98 toks/s]
Processed prompts:  29%|██▉       | 116/401 [00:46<00:41,  6.88it/s, est. speed input: 4155.11 toks/s, output: 326.97 toks/s]
Processed prompts:  30%|██▉       | 120/401 [00:47<00:39,  7.19it/s, est. speed input: 4263.28 toks/s, output: 336.33 toks/s]
Processed prompts:  32%|███▏      | 127/401 [00:48<00:37,  7.28it/s, est. speed input: 4483.66 toks/s, output: 351.94 toks/s]
Processed prompts:  33%|███▎      | 131/401 [00:48<00:35,  7.65it/s, est. speed input: 4584.77 toks/s, output: 361.35 toks/s]
Processed prompts:  34%|███▎      | 135/401 [00:49<00:36,  7.27it/s, est. speed input: 4653.23 toks/s, output: 369.38 toks/s]
Processed prompts:  35%|███▍      | 139/401 [00:49<00:32,  8.02it/s, est. speed input: 4745.47 toks/s, output: 379.21 toks/s]
Processed prompts:  35%|███▌      | 141/401 [00:50<00:36,  7.14it/s, est. speed input: 4778.43 toks/s, output: 382.24 toks/s]
Processed prompts:  37%|███▋      | 148/401 [00:50<00:26,  9.40it/s, est. speed input: 4947.98 toks/s, output: 400.73 toks/s]
Processed prompts:  38%|███▊      | 153/401 [00:50<00:19, 12.48it/s, est. speed input: 5096.28 toks/s, output: 415.61 toks/s]
Processed prompts:  40%|████      | 162/401 [00:50<00:11, 20.01it/s, est. speed input: 5370.40 toks/s, output: 443.42 toks/s]
Processed prompts:  42%|████▏     | 167/401 [00:50<00:10, 23.26it/s, est. speed input: 5526.57 toks/s, output: 458.57 toks/s]
Processed prompts:  43%|████▎     | 174/401 [00:51<00:07, 29.56it/s, est. speed input: 5716.58 toks/s, output: 480.41 toks/s]
Processed prompts:  45%|████▍     | 179/401 [00:51<00:06, 32.30it/s, est. speed input: 5880.63 toks/s, output: 495.91 toks/s]
Processed prompts:  46%|████▌     | 184/401 [00:51<00:06, 34.90it/s, est. speed input: 6014.11 toks/s, output: 511.57 toks/s]
Processed prompts:  47%|████▋     | 189/401 [00:51<00:06, 33.74it/s, est. speed input: 6157.87 toks/s, output: 526.87 toks/s]
Processed prompts:  48%|████▊     | 194/401 [00:51<00:06, 33.22it/s, est. speed input: 6378.23 toks/s, output: 542.38 toks/s]
Processed prompts:  49%|████▉     | 198/401 [00:51<00:05, 34.46it/s, est. speed input: 6451.82 toks/s, output: 555.17 toks/s]
Processed prompts:  51%|█████     | 204/401 [00:51<00:04, 40.32it/s, est. speed input: 6662.30 toks/s, output: 575.01 toks/s]
Processed prompts:  53%|█████▎    | 213/401 [00:52<00:04, 42.53it/s, est. speed input: 6981.71 toks/s, output: 604.62 toks/s]
Processed prompts:  54%|█████▍    | 218/401 [00:52<00:04, 40.34it/s, est. speed input: 7192.85 toks/s, output: 620.93 toks/s]
Processed prompts:  56%|█████▌    | 223/401 [00:52<00:05, 35.57it/s, est. speed input: 7335.40 toks/s, output: 636.92 toks/s]
Processed prompts:  57%|█████▋    | 230/401 [00:52<00:04, 39.72it/s, est. speed input: 7578.35 toks/s, output: 661.21 toks/s]
Processed prompts:  59%|█████▊    | 235/401 [00:52<00:05, 30.70it/s, est. speed input: 7740.89 toks/s, output: 676.70 toks/s]
Processed prompts:  60%|█████▉    | 239/401 [00:52<00:05, 30.60it/s, est. speed input: 7817.94 toks/s, output: 690.44 toks/s]
Processed prompts:  61%|██████    | 243/401 [00:53<00:06, 23.03it/s, est. speed input: 7937.71 toks/s, output: 702.22 toks/s]
Processed prompts:  62%|██████▏   | 248/401 [00:53<00:07, 21.82it/s, est. speed input: 8049.13 toks/s, output: 716.91 toks/s]
Processed prompts:  63%|██████▎   | 251/401 [00:54<00:11, 12.91it/s, est. speed input: 8031.69 toks/s, output: 717.35 toks/s]
Processed prompts:  63%|██████▎   | 253/401 [00:54<00:17,  8.55it/s, est. speed input: 8059.13 toks/s, output: 713.46 toks/s]
Processed prompts:  64%|██████▍   | 258/401 [00:54<00:11, 12.06it/s, est. speed input: 8191.78 toks/s, output: 723.47 toks/s]
Processed prompts:  65%|██████▌   | 262/401 [00:54<00:09, 14.84it/s, est. speed input: 8345.25 toks/s, output: 730.05 toks/s]
Processed prompts:  66%|██████▌   | 265/401 [00:55<00:08, 16.41it/s, est. speed input: 8440.25 toks/s, output: 734.97 toks/s]
Processed prompts:  67%|██████▋   | 269/401 [00:55<00:07, 18.37it/s, est. speed input: 8490.16 toks/s, output: 741.88 toks/s]
Processed prompts:  68%|██████▊   | 272/401 [00:55<00:06, 19.67it/s, est. speed input: 8527.48 toks/s, output: 747.59 toks/s]
Processed prompts:  69%|██████▊   | 275/401 [00:55<00:06, 19.76it/s, est. speed input: 8628.15 toks/s, output: 752.06 toks/s]
Processed prompts:  69%|██████▉   | 278/401 [00:55<00:07, 16.75it/s, est. speed input: 8651.63 toks/s, output: 755.59 toks/s]
Processed prompts:  71%|███████   | 284/401 [00:55<00:04, 24.26it/s, est. speed input: 8895.06 toks/s, output: 770.19 toks/s]
Processed prompts:  73%|███████▎  | 292/401 [00:56<00:03, 27.82it/s, est. speed input: 9082.19 toks/s, output: 789.48 toks/s]
Processed prompts:  74%|███████▍  | 296/401 [00:56<00:03, 30.06it/s, est. speed input: 9216.45 toks/s, output: 798.87 toks/s]
Processed prompts:  76%|███████▌  | 304/401 [00:56<00:02, 38.26it/s, est. speed input: 9429.89 toks/s, output: 819.09 toks/s]
Processed prompts:  78%|███████▊  | 313/401 [00:56<00:02, 41.95it/s, est. speed input: 9674.29 toks/s, output: 841.36 toks/s]
Processed prompts:  80%|████████  | 322/401 [00:56<00:01, 50.12it/s, est. speed input: 9834.54 toks/s, output: 866.37 toks/s]
Processed prompts:  83%|████████▎ | 331/401 [00:56<00:01, 54.08it/s, est. speed input: 10107.38 toks/s, output: 889.37 toks/s]
Processed prompts:  84%|████████▍ | 337/401 [00:56<00:01, 51.45it/s, est. speed input: 10289.32 toks/s, output: 904.73 toks/s]
Processed prompts:  86%|████████▌ | 345/401 [00:56<00:00, 57.93it/s, est. speed input: 10490.79 toks/s, output: 928.64 toks/s]
Processed prompts:  89%|████████▉ | 356/401 [00:57<00:00, 67.56it/s, est. speed input: 10830.77 toks/s, output: 964.28 toks/s]
Processed prompts:  91%|█████████ | 364/401 [00:57<00:00, 69.35it/s, est. speed input: 11149.75 toks/s, output: 987.24 toks/s]
Processed prompts:  93%|█████████▎| 372/401 [00:57<00:00, 63.43it/s, est. speed input: 11443.79 toks/s, output: 1015.44 toks/s]
Processed prompts:  95%|█████████▍| 380/401 [00:57<00:00, 66.56it/s, est. speed input: 11727.09 toks/s, output: 1043.42 toks/s]
Processed prompts:  97%|█████████▋| 387/401 [00:57<00:00, 55.95it/s, est. speed input: 11865.76 toks/s, output: 1067.80 toks/s]
Processed prompts:  98%|█████████▊| 393/401 [00:57<00:00, 44.03it/s, est. speed input: 12038.62 toks/s, output: 1086.16 toks/s]
Processed prompts:  99%|█████████▉| 398/401 [00:58<00:00, 14.46it/s, est. speed input: 12007.69 toks/s, output: 1089.36 toks/s]
Processed prompts: 100%|██████████| 401/401 [00:59<00:00,  6.71it/s, est. speed input: 12024.13 toks/s, output: 1095.52 toks/s]
[rank0]:[W709 17:39:47.584512917 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/asym/ae_rag_lp_sc_test_8_output.json
Cleaned temporary files.
