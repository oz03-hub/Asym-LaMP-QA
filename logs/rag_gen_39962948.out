Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 10:41:36.343970_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 10:41:36.343970_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 10:41:36.343970_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<02:02,  3.26it/s]
  0%|          | 2/401 [00:00<01:51,  3.58it/s]
  1%|          | 3/401 [00:03<08:42,  1.31s/it]
  1%|          | 4/401 [00:04<09:02,  1.37s/it]
  1%|          | 5/401 [00:06<09:17,  1.41s/it]
  1%|▏         | 6/401 [00:07<09:33,  1.45s/it]
  2%|▏         | 7/401 [00:09<09:45,  1.49s/it]
  2%|▏         | 8/401 [00:10<09:41,  1.48s/it]
  2%|▏         | 9/401 [00:12<09:45,  1.49s/it]
  2%|▏         | 10/401 [00:12<07:44,  1.19s/it]
  3%|▎         | 11/401 [00:14<08:48,  1.35s/it]
  3%|▎         | 13/401 [00:16<07:19,  1.13s/it]
  3%|▎         | 14/401 [00:19<11:26,  1.77s/it]
  4%|▎         | 15/401 [00:19<08:38,  1.34s/it]
  4%|▍         | 17/401 [00:20<05:17,  1.21it/s]
  4%|▍         | 18/401 [00:21<06:36,  1.04s/it]
  5%|▍         | 19/401 [00:23<07:45,  1.22s/it]
  5%|▍         | 20/401 [00:27<12:49,  2.02s/it]
  5%|▌         | 21/401 [00:28<09:44,  1.54s/it]
  5%|▌         | 22/401 [00:32<14:26,  2.29s/it]
  6%|▌         | 23/401 [00:34<13:24,  2.13s/it]
  6%|▌         | 24/401 [00:38<17:27,  2.78s/it]
  6%|▌         | 25/401 [00:38<12:31,  2.00s/it]
  6%|▋         | 26/401 [00:38<09:14,  1.48s/it]
  7%|▋         | 27/401 [00:43<14:20,  2.30s/it]
  7%|▋         | 28/401 [00:43<10:37,  1.71s/it]
  7%|▋         | 29/401 [00:43<07:38,  1.23s/it]
  7%|▋         | 30/401 [00:45<08:16,  1.34s/it]
  8%|▊         | 31/401 [00:46<07:55,  1.29s/it]
  8%|▊         | 32/401 [00:46<05:53,  1.04it/s]
  8%|▊         | 33/401 [00:47<06:15,  1.02s/it]
  8%|▊         | 34/401 [00:49<08:09,  1.34s/it]
  9%|▊         | 35/401 [00:49<05:54,  1.03it/s]
  9%|▉         | 37/401 [00:50<03:46,  1.61it/s]
 10%|▉         | 39/401 [00:51<03:47,  1.59it/s]
 10%|▉         | 40/401 [00:51<03:04,  1.96it/s]
 10%|█         | 41/401 [00:53<04:29,  1.33it/s]
 10%|█         | 42/401 [00:53<03:45,  1.59it/s]
 11%|█         | 43/401 [00:53<03:14,  1.84it/s]
 11%|█         | 44/401 [00:54<04:02,  1.47it/s]
 11%|█▏        | 46/401 [00:55<02:55,  2.02it/s]
 12%|█▏        | 47/401 [00:57<05:09,  1.14it/s]
 12%|█▏        | 48/401 [00:57<04:29,  1.31it/s]
 12%|█▏        | 49/401 [00:58<03:52,  1.51it/s]
 12%|█▏        | 50/401 [00:59<04:07,  1.42it/s]
 13%|█▎        | 51/401 [00:59<03:42,  1.57it/s]
 13%|█▎        | 53/401 [01:00<02:49,  2.05it/s]
 13%|█▎        | 54/401 [01:00<02:29,  2.32it/s]
 14%|█▎        | 55/401 [01:03<06:23,  1.11s/it]
 14%|█▍        | 56/401 [01:05<07:22,  1.28s/it]
 14%|█▍        | 57/401 [01:06<07:09,  1.25s/it]
 14%|█▍        | 58/401 [01:06<05:19,  1.08it/s]
 15%|█▍        | 59/401 [01:09<08:37,  1.51s/it]
 15%|█▍        | 60/401 [01:10<07:16,  1.28s/it]
 15%|█▌        | 61/401 [01:10<05:52,  1.04s/it]
 15%|█▌        | 62/401 [01:10<04:39,  1.21it/s]
 16%|█▌        | 63/401 [01:11<04:05,  1.37it/s]
 16%|█▌        | 64/401 [01:11<03:42,  1.52it/s]
 16%|█▌        | 65/401 [01:12<03:26,  1.63it/s]
 16%|█▋        | 66/401 [01:13<04:56,  1.13it/s]
 17%|█▋        | 67/401 [01:14<04:01,  1.38it/s]
 17%|█▋        | 68/401 [01:14<03:10,  1.75it/s]
 17%|█▋        | 69/401 [01:14<02:23,  2.32it/s]
 17%|█▋        | 70/401 [01:15<03:41,  1.50it/s]
 18%|█▊        | 71/401 [01:16<03:09,  1.74it/s]
 18%|█▊        | 72/401 [01:17<04:01,  1.36it/s]
 18%|█▊        | 73/401 [01:17<03:21,  1.63it/s]
 18%|█▊        | 74/401 [01:18<04:07,  1.32it/s]
 19%|█▊        | 75/401 [01:19<04:39,  1.17it/s]
 19%|█▉        | 76/401 [01:20<04:54,  1.10it/s]
 19%|█▉        | 77/401 [01:21<05:14,  1.03it/s]
 19%|█▉        | 78/401 [01:22<03:57,  1.36it/s]
 20%|█▉        | 79/401 [01:23<04:59,  1.08it/s]
 20%|█▉        | 80/401 [01:24<05:10,  1.04it/s]
 20%|██        | 81/401 [01:25<04:55,  1.08it/s]
 20%|██        | 82/401 [01:26<05:07,  1.04it/s]
 21%|██        | 83/401 [01:27<05:13,  1.01it/s]
 21%|██        | 84/401 [01:28<05:34,  1.06s/it]
 21%|██        | 85/401 [01:29<04:30,  1.17it/s]
 21%|██▏       | 86/401 [01:30<04:49,  1.09it/s]
 22%|██▏       | 87/401 [01:33<08:19,  1.59s/it]
 22%|██▏       | 88/401 [01:34<07:29,  1.43s/it]
 22%|██▏       | 89/401 [01:35<07:34,  1.46s/it]
 22%|██▏       | 90/401 [01:36<05:37,  1.09s/it]
 23%|██▎       | 91/401 [01:36<04:10,  1.24it/s]
 23%|██▎       | 92/401 [01:37<04:30,  1.14it/s]
 23%|██▎       | 93/401 [01:37<03:28,  1.48it/s]
 23%|██▎       | 94/401 [01:39<05:31,  1.08s/it]
 24%|██▎       | 95/401 [01:40<06:01,  1.18s/it]
 24%|██▍       | 96/401 [01:42<05:55,  1.16s/it]
 24%|██▍       | 97/401 [01:43<05:45,  1.14s/it]
 24%|██▍       | 98/401 [01:43<04:40,  1.08it/s]
 25%|██▍       | 99/401 [01:43<03:31,  1.43it/s]
 25%|██▍       | 100/401 [01:44<02:55,  1.72it/s]
 25%|██▌       | 101/401 [01:44<03:14,  1.54it/s]
 25%|██▌       | 102/401 [01:45<02:29,  2.00it/s]
 26%|██▌       | 103/401 [01:45<02:23,  2.08it/s]
 26%|██▌       | 104/401 [01:46<03:24,  1.45it/s]
 26%|██▌       | 105/401 [01:47<03:50,  1.28it/s]
 27%|██▋       | 107/401 [01:48<02:42,  1.81it/s]
 27%|██▋       | 108/401 [01:48<02:15,  2.17it/s]
 27%|██▋       | 109/401 [01:49<03:08,  1.55it/s]
 27%|██▋       | 110/401 [01:49<02:25,  2.01it/s]
 28%|██▊       | 111/401 [01:50<03:19,  1.46it/s]
 28%|██▊       | 112/401 [01:51<03:45,  1.28it/s]
 28%|██▊       | 113/401 [01:52<03:41,  1.30it/s]
 28%|██▊       | 114/401 [01:53<03:35,  1.33it/s]
 29%|██▊       | 115/401 [01:53<02:52,  1.66it/s]
 29%|██▉       | 116/401 [01:54<03:33,  1.34it/s]
 29%|██▉       | 117/401 [01:55<03:12,  1.48it/s]
 29%|██▉       | 118/401 [01:55<02:31,  1.87it/s]
 30%|██▉       | 119/401 [01:56<03:29,  1.35it/s]
 30%|██▉       | 120/401 [01:56<02:44,  1.71it/s]
 30%|███       | 121/401 [01:57<02:16,  2.05it/s]
 30%|███       | 122/401 [01:57<02:30,  1.85it/s]
 31%|███       | 123/401 [01:59<03:42,  1.25it/s]
 31%|███       | 124/401 [02:00<04:42,  1.02s/it]
 31%|███       | 125/401 [02:02<05:13,  1.14s/it]
 31%|███▏      | 126/401 [02:02<03:58,  1.15it/s]
 32%|███▏      | 127/401 [02:03<04:44,  1.04s/it]
 32%|███▏      | 128/401 [02:05<05:25,  1.19s/it]
 32%|███▏      | 129/401 [02:06<05:21,  1.18s/it]
 32%|███▏      | 130/401 [02:07<05:37,  1.25s/it]
 33%|███▎      | 131/401 [02:08<05:14,  1.17s/it]
 33%|███▎      | 132/401 [02:09<04:02,  1.11it/s]
 33%|███▎      | 133/401 [02:12<06:55,  1.55s/it]
 33%|███▎      | 134/401 [02:13<06:19,  1.42s/it]
 34%|███▎      | 135/401 [02:14<05:49,  1.31s/it]
 34%|███▍      | 136/401 [02:15<05:29,  1.24s/it]
 34%|███▍      | 137/401 [02:15<04:02,  1.09it/s]
 34%|███▍      | 138/401 [02:16<04:13,  1.04it/s]
 35%|███▍      | 139/401 [02:17<04:03,  1.08it/s]
 35%|███▍      | 140/401 [02:17<03:08,  1.39it/s]
 35%|███▌      | 141/401 [02:19<04:39,  1.08s/it]
 35%|███▌      | 142/401 [02:21<05:09,  1.20s/it]
 36%|███▌      | 143/401 [02:21<04:09,  1.03it/s]
 36%|███▌      | 144/401 [02:22<04:14,  1.01it/s]
 36%|███▌      | 145/401 [02:22<03:19,  1.29it/s]
 36%|███▋      | 146/401 [02:23<03:38,  1.17it/s]
 37%|███▋      | 147/401 [02:24<03:52,  1.09it/s]
 37%|███▋      | 148/401 [02:25<03:13,  1.31it/s]
 37%|███▋      | 149/401 [02:26<03:37,  1.16it/s]
 37%|███▋      | 150/401 [02:27<03:49,  1.09it/s]
 38%|███▊      | 151/401 [02:29<04:39,  1.12s/it]
 38%|███▊      | 152/401 [02:30<04:32,  1.09s/it]
 38%|███▊      | 153/401 [02:30<03:43,  1.11it/s]
 38%|███▊      | 154/401 [02:31<03:12,  1.29it/s]
 39%|███▊      | 155/401 [02:32<03:57,  1.04it/s]
 39%|███▉      | 156/401 [02:34<04:38,  1.14s/it]
 39%|███▉      | 157/401 [02:35<05:03,  1.24s/it]
 40%|███▉      | 159/401 [02:36<03:44,  1.08it/s]
 40%|███▉      | 160/401 [02:37<03:13,  1.24it/s]
 40%|████      | 162/401 [02:38<02:55,  1.36it/s]
 41%|████      | 163/401 [02:39<03:04,  1.29it/s]
 41%|████      | 164/401 [02:40<03:09,  1.25it/s]
 41%|████      | 165/401 [02:41<03:23,  1.16it/s]
 41%|████▏     | 166/401 [02:42<03:34,  1.09it/s]
 42%|████▏     | 167/401 [02:42<02:44,  1.42it/s]
 42%|████▏     | 168/401 [02:43<03:17,  1.18it/s]
 42%|████▏     | 169/401 [02:44<03:26,  1.13it/s]
 42%|████▏     | 170/401 [02:45<03:44,  1.03it/s]
 43%|████▎     | 171/401 [02:46<03:56,  1.03s/it]
 43%|████▎     | 172/401 [02:47<03:15,  1.17it/s]
 43%|████▎     | 173/401 [02:48<03:27,  1.10it/s]
 43%|████▎     | 174/401 [02:49<03:43,  1.02it/s]
 44%|████▎     | 175/401 [02:50<03:42,  1.01it/s]
 44%|████▍     | 176/401 [02:51<03:50,  1.03s/it]
 44%|████▍     | 177/401 [02:53<04:21,  1.17s/it]
 44%|████▍     | 178/401 [02:54<04:13,  1.13s/it]
 45%|████▍     | 179/401 [02:55<04:08,  1.12s/it]
 45%|████▍     | 180/401 [02:56<04:11,  1.14s/it]
 45%|████▌     | 181/401 [02:57<04:05,  1.12s/it]
 45%|████▌     | 182/401 [02:58<04:02,  1.11s/it]
 46%|████▌     | 183/401 [03:02<06:52,  1.89s/it]
 46%|████▌     | 184/401 [03:06<08:45,  2.42s/it]
 46%|████▌     | 185/401 [03:09<10:06,  2.81s/it]
 46%|████▋     | 186/401 [03:13<11:01,  3.08s/it]
 47%|████▋     | 187/401 [03:17<11:38,  3.26s/it]
 47%|████▋     | 188/401 [03:17<08:21,  2.35s/it]
 47%|████▋     | 189/401 [03:21<09:48,  2.78s/it]
 47%|████▋     | 190/401 [03:24<10:46,  3.07s/it]
 48%|████▊     | 191/401 [03:26<09:27,  2.70s/it]
 48%|████▊     | 192/401 [03:28<08:31,  2.45s/it]
 48%|████▊     | 193/401 [03:28<06:08,  1.77s/it]
 48%|████▊     | 194/401 [03:29<04:34,  1.33s/it]
 49%|████▊     | 195/401 [03:32<07:02,  2.05s/it]
 49%|████▉     | 196/401 [03:34<06:47,  1.99s/it]
 49%|████▉     | 197/401 [03:36<06:51,  2.02s/it]
 49%|████▉     | 198/401 [03:40<08:30,  2.51s/it]
 50%|████▉     | 199/401 [03:42<07:48,  2.32s/it]
 50%|████▉     | 200/401 [03:44<07:18,  2.18s/it]
 50%|█████     | 201/401 [03:45<06:58,  2.09s/it]
 50%|█████     | 202/401 [03:47<06:44,  2.03s/it]
 51%|█████     | 203/401 [03:49<06:32,  1.98s/it]
 51%|█████     | 204/401 [03:51<06:25,  1.96s/it]
 51%|█████     | 205/401 [03:51<04:36,  1.41s/it]
 51%|█████▏    | 206/401 [03:53<05:01,  1.55s/it]
 52%|█████▏    | 207/401 [03:55<05:21,  1.66s/it]
 52%|█████▏    | 208/401 [03:57<05:27,  1.70s/it]
 52%|█████▏    | 209/401 [03:57<04:12,  1.31s/it]
 52%|█████▏    | 210/401 [03:59<04:44,  1.49s/it]
 53%|█████▎    | 211/401 [04:00<04:03,  1.28s/it]
 53%|█████▎    | 212/401 [04:01<03:24,  1.08s/it]
 53%|█████▎    | 213/401 [04:01<03:09,  1.01s/it]
 53%|█████▎    | 214/401 [04:03<03:56,  1.27s/it]
 54%|█████▎    | 215/401 [04:04<03:30,  1.13s/it]
 54%|█████▍    | 216/401 [04:05<03:41,  1.20s/it]
 54%|█████▍    | 218/401 [04:06<02:30,  1.22it/s]
 55%|█████▍    | 219/401 [04:07<02:25,  1.25it/s]
 55%|█████▍    | 220/401 [04:08<02:20,  1.29it/s]
 55%|█████▌    | 221/401 [04:11<04:03,  1.35s/it]
 55%|█████▌    | 222/401 [04:11<03:27,  1.16s/it]
 56%|█████▌    | 223/401 [04:11<02:34,  1.15it/s]
 56%|█████▌    | 224/401 [04:12<02:08,  1.38it/s]
 56%|█████▌    | 225/401 [04:12<01:37,  1.80it/s]
 56%|█████▋    | 226/401 [04:12<01:15,  2.32it/s]
 57%|█████▋    | 227/401 [04:12<01:05,  2.67it/s]
 57%|█████▋    | 228/401 [04:13<01:20,  2.15it/s]
 57%|█████▋    | 229/401 [04:13<01:05,  2.62it/s]
 57%|█████▋    | 230/401 [04:15<02:20,  1.22it/s]
 58%|█████▊    | 231/401 [04:15<01:48,  1.56it/s]
 58%|█████▊    | 232/401 [04:16<01:45,  1.60it/s]
 58%|█████▊    | 234/401 [04:20<03:32,  1.27s/it]
 59%|█████▊    | 235/401 [04:20<02:52,  1.04s/it]
 59%|█████▉    | 236/401 [04:20<02:12,  1.24it/s]
 59%|█████▉    | 237/401 [04:21<02:03,  1.32it/s]
 59%|█████▉    | 238/401 [04:21<01:52,  1.45it/s]
 60%|█████▉    | 239/401 [04:22<01:51,  1.45it/s]
 60%|█████▉    | 240/401 [04:22<01:28,  1.82it/s]
 60%|██████    | 242/401 [04:23<00:56,  2.80it/s]
 61%|██████    | 243/401 [04:23<01:13,  2.15it/s]
 61%|██████    | 244/401 [04:24<01:10,  2.22it/s]
 61%|██████    | 245/401 [04:24<00:57,  2.74it/s]
 61%|██████▏   | 246/401 [04:25<01:11,  2.16it/s]
 62%|██████▏   | 247/401 [04:25<01:20,  1.91it/s]
 62%|██████▏   | 248/401 [04:25<01:02,  2.47it/s]
 62%|██████▏   | 249/401 [04:27<01:49,  1.39it/s]
 63%|██████▎   | 251/401 [04:27<01:12,  2.07it/s]
 63%|██████▎   | 252/401 [04:27<00:58,  2.53it/s]
 63%|██████▎   | 254/401 [04:28<00:45,  3.22it/s]
 64%|██████▎   | 255/401 [04:30<01:30,  1.61it/s]
 64%|██████▍   | 256/401 [04:30<01:20,  1.81it/s]
 64%|██████▍   | 257/401 [04:30<01:11,  2.00it/s]
 64%|██████▍   | 258/401 [04:31<01:05,  2.17it/s]
 65%|██████▍   | 259/401 [04:31<00:59,  2.37it/s]
 65%|██████▌   | 261/401 [04:32<00:55,  2.54it/s]
 65%|██████▌   | 262/401 [04:32<00:53,  2.58it/s]
 66%|██████▌   | 263/401 [04:32<00:52,  2.63it/s]
 66%|██████▌   | 264/401 [04:33<00:45,  3.00it/s]
 66%|██████▌   | 265/401 [04:33<00:45,  2.97it/s]
 66%|██████▋   | 266/401 [04:33<00:45,  2.97it/s]
 67%|██████▋   | 267/401 [04:33<00:38,  3.47it/s]
 67%|██████▋   | 268/401 [04:34<00:34,  3.83it/s]
 67%|██████▋   | 269/401 [04:34<00:48,  2.74it/s]
 67%|██████▋   | 270/401 [04:35<00:57,  2.27it/s]
 68%|██████▊   | 272/401 [04:35<00:38,  3.35it/s]
 68%|██████▊   | 273/401 [04:35<00:33,  3.77it/s]
 68%|██████▊   | 274/401 [04:35<00:29,  4.35it/s]
 69%|██████▊   | 275/401 [04:35<00:25,  4.90it/s]
 69%|██████▉   | 276/401 [04:36<00:24,  5.19it/s]
 69%|██████▉   | 277/401 [04:36<00:35,  3.47it/s]
 69%|██████▉   | 278/401 [04:36<00:30,  4.01it/s]
 70%|██████▉   | 279/401 [04:36<00:26,  4.68it/s]
 70%|██████▉   | 280/401 [04:37<00:32,  3.68it/s]
 70%|███████   | 281/401 [04:37<00:27,  4.32it/s]
 70%|███████   | 282/401 [04:37<00:23,  5.07it/s]
 71%|███████   | 283/401 [04:38<00:36,  3.20it/s]
 71%|███████   | 284/401 [04:38<00:38,  3.03it/s]
 71%|███████   | 285/401 [04:38<00:34,  3.36it/s]
 71%|███████▏  | 286/401 [04:39<00:35,  3.20it/s]
 72%|███████▏  | 287/401 [04:39<00:35,  3.18it/s]
 72%|███████▏  | 288/401 [04:39<00:29,  3.77it/s]
 72%|███████▏  | 289/401 [04:39<00:28,  3.97it/s]
 73%|███████▎  | 291/401 [04:40<00:27,  4.03it/s]
 73%|███████▎  | 292/401 [04:41<01:00,  1.80it/s]
 73%|███████▎  | 293/401 [04:42<01:12,  1.49it/s]
 73%|███████▎  | 294/401 [04:45<02:24,  1.35s/it]
 74%|███████▎  | 295/401 [04:46<01:46,  1.01s/it]
 74%|███████▍  | 296/401 [04:47<01:44,  1.00it/s]
 74%|███████▍  | 297/401 [04:47<01:18,  1.32it/s]
 74%|███████▍  | 298/401 [04:47<01:06,  1.55it/s]
 75%|███████▍  | 299/401 [04:49<01:31,  1.12it/s]
 75%|███████▍  | 300/401 [04:50<01:31,  1.11it/s]
 75%|███████▌  | 301/401 [04:50<01:08,  1.46it/s]
 75%|███████▌  | 302/401 [04:50<00:51,  1.93it/s]
 76%|███████▌  | 303/401 [04:51<01:02,  1.56it/s]
 76%|███████▌  | 304/401 [04:51<01:02,  1.54it/s]
 76%|███████▌  | 305/401 [04:53<01:19,  1.21it/s]
 76%|███████▋  | 306/401 [04:54<01:18,  1.20it/s]
 77%|███████▋  | 307/401 [04:54<01:22,  1.14it/s]
 77%|███████▋  | 308/401 [04:55<01:09,  1.34it/s]
 77%|███████▋  | 309/401 [04:56<01:05,  1.41it/s]
 77%|███████▋  | 310/401 [04:56<00:56,  1.61it/s]
 78%|███████▊  | 311/401 [04:57<01:02,  1.45it/s]
 78%|███████▊  | 312/401 [04:57<00:54,  1.64it/s]
 78%|███████▊  | 313/401 [04:57<00:42,  2.06it/s]
 78%|███████▊  | 314/401 [04:58<00:40,  2.15it/s]
 79%|███████▊  | 315/401 [04:58<00:36,  2.34it/s]
 79%|███████▉  | 316/401 [04:58<00:29,  2.86it/s]
 79%|███████▉  | 317/401 [05:00<00:59,  1.42it/s]
 79%|███████▉  | 318/401 [05:00<00:54,  1.53it/s]
 80%|███████▉  | 319/401 [05:01<00:45,  1.82it/s]
 80%|███████▉  | 320/401 [05:01<00:44,  1.83it/s]
 80%|████████  | 321/401 [05:02<00:42,  1.90it/s]
 80%|████████  | 322/401 [05:02<00:40,  1.94it/s]
 81%|████████  | 323/401 [05:06<01:52,  1.44s/it]
 81%|████████  | 324/401 [05:09<02:40,  2.09s/it]
 81%|████████  | 325/401 [05:13<03:13,  2.55s/it]
 81%|████████▏ | 326/401 [05:14<02:35,  2.07s/it]
 82%|████████▏ | 327/401 [05:15<02:07,  1.72s/it]
 82%|████████▏ | 328/401 [05:15<01:39,  1.36s/it]
 82%|████████▏ | 329/401 [05:17<01:45,  1.46s/it]
 82%|████████▏ | 330/401 [05:21<02:28,  2.09s/it]
 83%|████████▎ | 331/401 [05:22<02:03,  1.76s/it]
 83%|████████▎ | 332/401 [05:25<02:40,  2.32s/it]
 83%|████████▎ | 333/401 [05:29<03:05,  2.73s/it]
 83%|████████▎ | 334/401 [05:29<02:16,  2.03s/it]
 84%|████████▎ | 335/401 [05:33<02:46,  2.52s/it]
 84%|████████▍ | 336/401 [05:37<03:05,  2.86s/it]
 84%|████████▍ | 337/401 [05:38<02:29,  2.34s/it]
 84%|████████▍ | 338/401 [05:38<01:53,  1.81s/it]
 85%|████████▍ | 339/401 [05:39<01:28,  1.43s/it]
 85%|████████▍ | 340/401 [05:39<01:04,  1.05s/it]
 85%|████████▌ | 341/401 [05:39<00:46,  1.30it/s]
 85%|████████▌ | 342/401 [05:40<00:37,  1.57it/s]
 86%|████████▌ | 343/401 [05:40<00:35,  1.66it/s]
 86%|████████▌ | 344/401 [05:41<00:30,  1.86it/s]
 86%|████████▌ | 345/401 [05:42<00:45,  1.22it/s]
 86%|████████▋ | 346/401 [05:42<00:38,  1.44it/s]
 87%|████████▋ | 347/401 [05:43<00:32,  1.67it/s]
 87%|████████▋ | 348/401 [05:43<00:28,  1.83it/s]
 87%|████████▋ | 349/401 [05:43<00:23,  2.17it/s]
 87%|████████▋ | 350/401 [05:47<01:05,  1.28s/it]
 88%|████████▊ | 351/401 [05:50<01:37,  1.95s/it]
 88%|████████▊ | 352/401 [05:50<01:10,  1.43s/it]
 88%|████████▊ | 353/401 [05:54<01:44,  2.17s/it]
 89%|████████▊ | 355/401 [05:55<00:58,  1.28s/it]
 89%|████████▉ | 356/401 [05:58<01:18,  1.75s/it]
 89%|████████▉ | 357/401 [05:59<01:05,  1.48s/it]
 89%|████████▉ | 358/401 [06:00<01:00,  1.40s/it]
 90%|████████▉ | 359/401 [06:01<00:54,  1.30s/it]
 90%|████████▉ | 360/401 [06:02<00:49,  1.21s/it]
 90%|█████████ | 361/401 [06:02<00:40,  1.00s/it]
 90%|█████████ | 362/401 [06:03<00:30,  1.26it/s]
 91%|█████████ | 363/401 [06:03<00:24,  1.54it/s]
 91%|█████████ | 364/401 [06:03<00:19,  1.94it/s]
 91%|█████████ | 365/401 [06:05<00:31,  1.13it/s]
 91%|█████████▏| 366/401 [06:05<00:24,  1.44it/s]
 92%|█████████▏| 367/401 [06:06<00:21,  1.55it/s]
 92%|█████████▏| 368/401 [06:06<00:16,  2.03it/s]
 92%|█████████▏| 369/401 [06:06<00:13,  2.29it/s]
 92%|█████████▏| 370/401 [06:08<00:25,  1.21it/s]
 93%|█████████▎| 371/401 [06:10<00:33,  1.11s/it]
 93%|█████████▎| 372/401 [06:10<00:23,  1.22it/s]
 93%|█████████▎| 373/401 [06:12<00:31,  1.11s/it]
 93%|█████████▎| 374/401 [06:13<00:36,  1.34s/it]
 94%|█████████▎| 375/401 [06:15<00:38,  1.47s/it]
 94%|█████████▍| 376/401 [06:18<00:49,  1.97s/it]
 94%|█████████▍| 377/401 [06:19<00:36,  1.51s/it]
 94%|█████████▍| 378/401 [06:22<00:46,  2.02s/it]
 95%|█████████▍| 379/401 [06:26<00:54,  2.49s/it]
 95%|█████████▍| 380/401 [06:27<00:47,  2.28s/it]
 95%|█████████▌| 382/401 [06:31<00:37,  1.98s/it]
 96%|█████████▌| 383/401 [06:34<00:40,  2.28s/it]
 96%|█████████▌| 384/401 [06:36<00:39,  2.34s/it]
 96%|█████████▌| 385/401 [06:40<00:42,  2.65s/it]
 96%|█████████▋| 386/401 [06:41<00:32,  2.16s/it]
 97%|█████████▋| 387/401 [06:42<00:26,  1.92s/it]
 97%|█████████▋| 388/401 [06:43<00:22,  1.70s/it]
 97%|█████████▋| 389/401 [06:44<00:16,  1.35s/it]
 97%|█████████▋| 390/401 [06:44<00:12,  1.13s/it]
 98%|█████████▊| 391/401 [06:45<00:08,  1.14it/s]
 98%|█████████▊| 392/401 [06:46<00:08,  1.05it/s]
 98%|█████████▊| 393/401 [06:46<00:05,  1.35it/s]
 98%|█████████▊| 394/401 [06:46<00:04,  1.66it/s]
 99%|█████████▊| 395/401 [06:47<00:03,  1.91it/s]
 99%|█████████▉| 396/401 [06:50<00:07,  1.45s/it]
 99%|█████████▉| 397/401 [06:50<00:04,  1.11s/it]
 99%|█████████▉| 398/401 [06:54<00:05,  1.87s/it]
100%|█████████▉| 399/401 [06:58<00:04,  2.35s/it]
100%|█████████▉| 400/401 [06:58<00:01,  1.71s/it]
100%|██████████| 401/401 [06:58<00:00,  1.24s/it]
100%|██████████| 401/401 [06:58<00:00,  1.04s/it]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 10:41:36.343970_ae_processed_test.json', '--output_addr', 'data/out/rag/full_profile/ae_rag_full_profile_test_10_limit_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  9.70 examples/s]
Generating train split: 401 examples [00:00, 1966.59 examples/s]
INFO 07-15 10:49:08 config.py:510] This model supports multiple tasks: {'score', 'classify', 'embed', 'reward', 'generate'}. Defaulting to 'generate'.
INFO 07-15 10:49:08 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 10:49:10 selector.py:120] Using Flash Attention backend.
INFO 07-15 10:49:11 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 10:49:11 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.46it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.39it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.44it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.41it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.41it/s]

INFO 07-15 10:49:14 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 10:49:16 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-15 10:49:16 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 10:49:16 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 10:49:16 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 10:49:16 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 10:49:19 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:13,  2.61it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.78it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:11,  2.80it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:11,  2.71it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:11,  2.69it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:10,  2.69it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:10,  2.72it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.71it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:09,  2.74it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:04<00:12,  1.96it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:04<00:11,  2.14it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:10,  2.26it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:05<00:09,  2.37it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:05<00:08,  2.46it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:06<00:07,  2.52it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:06<00:07,  2.55it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:06<00:06,  2.60it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:07<00:06,  2.64it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:07<00:06,  2.66it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:07<00:05,  2.68it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:08<00:05,  2.69it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:08<00:04,  2.70it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:08<00:04,  2.72it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:09<00:04,  2.73it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:09<00:03,  2.74it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:10<00:03,  2.73it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:10<00:02,  2.70it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:10<00:02,  2.70it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:11<00:02,  2.72it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:11<00:01,  2.74it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:11<00:01,  2.75it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:12<00:01,  2.77it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:12<00:00,  2.74it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:12<00:00,  2.76it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:13<00:00,  2.78it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:13<00:00,  2.63it/s]
INFO 07-15 10:49:33 model_runner.py:1535] Graph capturing finished in 13 secs, took 0.22 GiB
INFO 07-15 10:49:33 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 18.49 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:36<4:01:17, 36.19s/it, est. speed input: 57.77 toks/s, output: 2.49 toks/s]
Processed prompts:   0%|          | 2/401 [00:36<1:40:17, 15.08s/it, est. speed input: 101.95 toks/s, output: 5.01 toks/s]
Processed prompts:   1%|          | 3/401 [00:37<56:01,  8.45s/it, est. speed input: 143.39 toks/s, output: 7.64 toks/s]  
Processed prompts:   1%|          | 5/401 [00:37<25:30,  3.87s/it, est. speed input: 245.76 toks/s, output: 12.98 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:38<18:46,  2.85s/it, est. speed input: 342.35 toks/s, output: 15.72 toks/s]
Processed prompts:   2%|▏         | 9/401 [00:38<09:00,  1.38s/it, est. speed input: 486.61 toks/s, output: 24.01 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:38<07:33,  1.16s/it, est. speed input: 521.37 toks/s, output: 26.73 toks/s]
Processed prompts:   3%|▎         | 13/401 [00:39<04:25,  1.46it/s, est. speed input: 676.47 toks/s, output: 35.12 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:39<04:02,  1.60it/s, est. speed input: 717.22 toks/s, output: 37.75 toks/s]
Processed prompts:   4%|▎         | 15/401 [00:39<03:23,  1.90it/s, est. speed input: 753.94 toks/s, output: 40.60 toks/s]
Processed prompts:   4%|▍         | 18/401 [00:40<02:12,  2.89it/s, est. speed input: 859.74 toks/s, output: 49.03 toks/s]
Processed prompts:   5%|▍         | 20/401 [00:40<01:47,  3.53it/s, est. speed input: 940.06 toks/s, output: 54.64 toks/s]
Processed prompts:   5%|▌         | 22/401 [00:40<01:26,  4.39it/s, est. speed input: 1083.38 toks/s, output: 60.36 toks/s]
Processed prompts:   6%|▌         | 24/401 [00:41<01:19,  4.77it/s, est. speed input: 1172.47 toks/s, output: 65.86 toks/s]
Processed prompts:   6%|▌         | 25/401 [00:41<01:13,  5.10it/s, est. speed input: 1224.27 toks/s, output: 68.67 toks/s]
Processed prompts:   7%|▋         | 27/401 [00:41<01:12,  5.13it/s, est. speed input: 1280.79 toks/s, output: 74.05 toks/s]
Processed prompts:   7%|▋         | 30/401 [00:41<00:56,  6.62it/s, est. speed input: 1388.60 toks/s, output: 82.60 toks/s]
Processed prompts:   9%|▉         | 36/401 [00:42<00:51,  7.05it/s, est. speed input: 1660.40 toks/s, output: 98.86 toks/s]
Processed prompts:  10%|▉         | 39/401 [00:43<00:56,  6.38it/s, est. speed input: 1777.98 toks/s, output: 106.41 toks/s]
Processed prompts:  11%|█         | 44/401 [00:44<01:03,  5.67it/s, est. speed input: 1945.22 toks/s, output: 118.50 toks/s]
Processed prompts:  12%|█▏        | 48/401 [00:44<00:52,  6.70it/s, est. speed input: 2077.39 toks/s, output: 129.28 toks/s]
Processed prompts:  12%|█▏        | 50/401 [00:45<00:58,  6.03it/s, est. speed input: 2159.42 toks/s, output: 133.78 toks/s]
Processed prompts:  13%|█▎        | 53/401 [00:45<01:01,  5.69it/s, est. speed input: 2283.29 toks/s, output: 140.81 toks/s]
Processed prompts:  14%|█▎        | 55/401 [00:46<01:04,  5.34it/s, est. speed input: 2316.13 toks/s, output: 145.26 toks/s]
Processed prompts:  14%|█▍        | 58/401 [00:46<00:57,  5.94it/s, est. speed input: 2453.58 toks/s, output: 152.84 toks/s]
Processed prompts:  16%|█▌        | 63/401 [00:47<00:55,  6.09it/s, est. speed input: 2637.01 toks/s, output: 164.72 toks/s]
Processed prompts:  16%|█▌        | 65/401 [00:47<00:52,  6.34it/s, est. speed input: 2683.02 toks/s, output: 169.62 toks/s]
Processed prompts:  17%|█▋        | 69/401 [00:48<00:51,  6.42it/s, est. speed input: 2759.70 toks/s, output: 179.00 toks/s]
Processed prompts:  18%|█▊        | 72/401 [00:48<00:55,  5.96it/s, est. speed input: 2870.24 toks/s, output: 185.41 toks/s]
Processed prompts:  19%|█▉        | 76/401 [00:49<01:00,  5.33it/s, est. speed input: 3010.11 toks/s, output: 193.40 toks/s]
Processed prompts:  20%|█▉        | 79/401 [00:50<00:55,  5.84it/s, est. speed input: 3147.63 toks/s, output: 200.44 toks/s]
Processed prompts:  21%|██▏       | 86/401 [00:51<00:55,  5.70it/s, est. speed input: 3334.31 toks/s, output: 214.97 toks/s]
Processed prompts:  22%|██▏       | 90/401 [00:52<00:52,  5.97it/s, est. speed input: 3506.18 toks/s, output: 223.62 toks/s]
Processed prompts:  23%|██▎       | 93/401 [00:52<00:58,  5.27it/s, est. speed input: 3576.10 toks/s, output: 228.51 toks/s]
Processed prompts:  24%|██▍       | 98/401 [00:53<00:48,  6.30it/s, est. speed input: 3694.41 toks/s, output: 240.01 toks/s]
Processed prompts:  25%|██▌       | 101/401 [00:53<00:49,  6.06it/s, est. speed input: 3815.54 toks/s, output: 245.74 toks/s]
Processed prompts:  26%|██▌       | 103/401 [00:54<00:49,  6.05it/s, est. speed input: 3852.98 toks/s, output: 249.69 toks/s]
Processed prompts:  26%|██▋       | 106/401 [00:54<00:50,  5.79it/s, est. speed input: 3948.92 toks/s, output: 255.25 toks/s]
Processed prompts:  28%|██▊       | 112/401 [00:55<00:47,  6.13it/s, est. speed input: 4079.85 toks/s, output: 267.25 toks/s]
Processed prompts:  28%|██▊       | 113/401 [00:56<00:49,  5.79it/s, est. speed input: 4087.00 toks/s, output: 268.70 toks/s]
Processed prompts:  28%|██▊       | 114/401 [00:56<00:50,  5.64it/s, est. speed input: 4102.84 toks/s, output: 270.41 toks/s]
Processed prompts:  29%|██▉       | 118/401 [00:57<00:52,  5.39it/s, est. speed input: 4202.86 toks/s, output: 277.42 toks/s]
Processed prompts:  30%|███       | 122/401 [00:57<00:49,  5.63it/s, est. speed input: 4286.16 toks/s, output: 284.96 toks/s]
Processed prompts:  31%|███▏      | 126/401 [00:58<00:49,  5.50it/s, est. speed input: 4398.46 toks/s, output: 291.90 toks/s]
Processed prompts:  32%|███▏      | 129/401 [00:58<00:48,  5.56it/s, est. speed input: 4460.03 toks/s, output: 297.33 toks/s]
Processed prompts:  34%|███▍      | 137/401 [01:00<00:43,  6.14it/s, est. speed input: 4640.51 toks/s, output: 312.71 toks/s]
Processed prompts:  36%|███▌      | 144/401 [01:01<00:39,  6.56it/s, est. speed input: 4931.26 toks/s, output: 326.19 toks/s]
Processed prompts:  37%|███▋      | 149/401 [01:01<00:29,  8.44it/s, est. speed input: 5031.36 toks/s, output: 338.47 toks/s]
Processed prompts:  39%|███▊      | 155/401 [01:01<00:21, 11.38it/s, est. speed input: 5194.00 toks/s, output: 353.50 toks/s]
Processed prompts:  40%|████      | 162/401 [01:01<00:15, 15.70it/s, est. speed input: 5380.02 toks/s, output: 371.31 toks/s]
Processed prompts:  43%|████▎     | 171/401 [01:01<00:10, 22.47it/s, est. speed input: 5716.34 toks/s, output: 394.71 toks/s]
Processed prompts:  45%|████▍     | 179/401 [01:01<00:07, 28.49it/s, est. speed input: 5948.05 toks/s, output: 415.59 toks/s]
Processed prompts:  48%|████▊     | 192/401 [01:01<00:04, 41.97it/s, est. speed input: 6449.98 toks/s, output: 450.35 toks/s]
Processed prompts:  50%|████▉     | 200/401 [01:02<00:04, 47.03it/s, est. speed input: 6673.16 toks/s, output: 471.62 toks/s]
Processed prompts:  52%|█████▏    | 207/401 [01:02<00:04, 45.21it/s, est. speed input: 6885.97 toks/s, output: 489.99 toks/s]
Processed prompts:  53%|█████▎    | 213/401 [01:02<00:04, 38.79it/s, est. speed input: 7013.29 toks/s, output: 505.43 toks/s]
Processed prompts:  55%|█████▍    | 219/401 [01:02<00:04, 41.94it/s, est. speed input: 7186.46 toks/s, output: 521.86 toks/s]
Processed prompts:  56%|█████▌    | 225/401 [01:02<00:05, 34.01it/s, est. speed input: 7355.50 toks/s, output: 537.33 toks/s]
Processed prompts:  57%|█████▋    | 230/401 [01:02<00:05, 33.41it/s, est. speed input: 7463.27 toks/s, output: 551.04 toks/s]
Processed prompts:  58%|█████▊    | 234/401 [01:03<00:05, 31.46it/s, est. speed input: 7601.51 toks/s, output: 561.83 toks/s]
Processed prompts:  59%|█████▉    | 238/401 [01:03<00:05, 27.54it/s, est. speed input: 7751.11 toks/s, output: 572.40 toks/s]
Processed prompts:  60%|██████    | 242/401 [01:03<00:06, 23.29it/s, est. speed input: 7854.31 toks/s, output: 580.76 toks/s]
Processed prompts:  61%|██████    | 245/401 [01:03<00:08, 18.25it/s, est. speed input: 7932.23 toks/s, output: 587.80 toks/s]
Processed prompts:  62%|██████▏   | 248/401 [01:04<00:13, 10.96it/s, est. speed input: 7939.12 toks/s, output: 592.06 toks/s]
Processed prompts:  62%|██████▏   | 250/401 [01:04<00:13, 10.83it/s, est. speed input: 7966.46 toks/s, output: 597.20 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [01:04<00:13, 10.74it/s, est. speed input: 7997.08 toks/s, output: 602.43 toks/s]
Processed prompts:  63%|██████▎   | 254/401 [01:05<00:21,  6.75it/s, est. speed input: 8030.52 toks/s, output: 603.59 toks/s]
Processed prompts:  64%|██████▍   | 256/401 [01:06<00:23,  6.09it/s, est. speed input: 8032.67 toks/s, output: 605.91 toks/s]
Processed prompts:  65%|██████▍   | 259/401 [01:06<00:19,  7.14it/s, est. speed input: 8072.47 toks/s, output: 609.38 toks/s]
Processed prompts:  65%|██████▌   | 261/401 [01:06<00:17,  8.14it/s, est. speed input: 8129.29 toks/s, output: 612.56 toks/s]
Processed prompts:  66%|██████▌   | 263/401 [01:06<00:15,  8.69it/s, est. speed input: 8154.54 toks/s, output: 614.51 toks/s]
Processed prompts:  66%|██████▋   | 266/401 [01:06<00:12, 11.06it/s, est. speed input: 8235.80 toks/s, output: 619.49 toks/s]
Processed prompts:  67%|██████▋   | 270/401 [01:07<00:11, 11.03it/s, est. speed input: 8302.28 toks/s, output: 624.58 toks/s]
Processed prompts:  68%|██████▊   | 272/401 [01:07<00:11, 11.69it/s, est. speed input: 8333.63 toks/s, output: 627.66 toks/s]
Processed prompts:  68%|██████▊   | 274/401 [01:07<00:10, 12.36it/s, est. speed input: 8368.71 toks/s, output: 631.19 toks/s]
Processed prompts:  69%|██████▉   | 278/401 [01:07<00:07, 16.55it/s, est. speed input: 8543.04 toks/s, output: 640.96 toks/s]
Processed prompts:  70%|███████   | 282/401 [01:07<00:05, 20.25it/s, est. speed input: 8735.69 toks/s, output: 648.58 toks/s]
Processed prompts:  71%|███████   | 285/401 [01:07<00:05, 21.43it/s, est. speed input: 8802.02 toks/s, output: 654.37 toks/s]
Processed prompts:  73%|███████▎  | 292/401 [01:07<00:03, 31.20it/s, est. speed input: 9017.34 toks/s, output: 667.93 toks/s]
Processed prompts:  74%|███████▍  | 298/401 [01:07<00:02, 36.89it/s, est. speed input: 9272.89 toks/s, output: 679.68 toks/s]
Processed prompts:  76%|███████▌  | 303/401 [01:08<00:02, 33.38it/s, est. speed input: 9446.37 toks/s, output: 690.96 toks/s]
Processed prompts:  77%|███████▋  | 308/401 [01:08<00:02, 36.66it/s, est. speed input: 9602.29 toks/s, output: 701.44 toks/s]
Processed prompts:  78%|███████▊  | 313/401 [01:08<00:02, 39.63it/s, est. speed input: 9777.81 toks/s, output: 712.11 toks/s]
Processed prompts:  80%|███████▉  | 320/401 [01:08<00:01, 43.84it/s, est. speed input: 10002.15 toks/s, output: 727.81 toks/s]
Processed prompts:  81%|████████  | 325/401 [01:08<00:01, 42.38it/s, est. speed input: 10156.48 toks/s, output: 738.76 toks/s]
Processed prompts:  83%|████████▎ | 332/401 [01:08<00:01, 46.56it/s, est. speed input: 10399.54 toks/s, output: 755.63 toks/s]
Processed prompts:  84%|████████▍ | 337/401 [01:08<00:01, 45.31it/s, est. speed input: 10529.67 toks/s, output: 767.59 toks/s]
Processed prompts:  87%|████████▋ | 350/401 [01:09<00:00, 61.37it/s, est. speed input: 10907.50 toks/s, output: 801.33 toks/s]
Processed prompts:  90%|█████████ | 361/401 [01:09<00:00, 65.73it/s, est. speed input: 11259.67 toks/s, output: 829.01 toks/s]
Processed prompts:  92%|█████████▏| 368/401 [01:09<00:00, 62.22it/s, est. speed input: 11523.03 toks/s, output: 847.90 toks/s]
Processed prompts:  94%|█████████▍| 377/401 [01:09<00:00, 63.66it/s, est. speed input: 11830.40 toks/s, output: 871.89 toks/s]
Processed prompts:  96%|█████████▌| 384/401 [01:09<00:00, 56.59it/s, est. speed input: 12027.33 toks/s, output: 891.21 toks/s]
Processed prompts:  97%|█████████▋| 390/401 [01:10<00:00, 32.81it/s, est. speed input: 12210.25 toks/s, output: 905.08 toks/s]
Processed prompts:  99%|█████████▊| 395/401 [01:12<00:00,  8.63it/s, est. speed input: 12083.44 toks/s, output: 904.13 toks/s]
Processed prompts: 100%|█████████▉| 399/401 [01:12<00:00,  8.47it/s, est. speed input: 12128.48 toks/s, output: 921.19 toks/s]
Processed prompts: 100%|██████████| 401/401 [01:13<00:00,  5.45it/s, est. speed input: 12056.90 toks/s, output: 921.43 toks/s]
[rank0]:[W715 10:50:50.013766529 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/ae_rag_full_profile_test_10_limit_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 10:50:54.095205_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 10:50:54.095205_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 10:50:54.095205_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:41,  3.25it/s]
  1%|          | 3/526 [00:00<01:24,  6.21it/s]
  1%|          | 5/526 [00:00<01:03,  8.25it/s]
  1%|▏         | 7/526 [00:00<00:49, 10.48it/s]
  2%|▏         | 9/526 [00:01<01:52,  4.60it/s]
  2%|▏         | 11/526 [00:01<01:25,  6.05it/s]
  2%|▏         | 13/526 [00:02<01:40,  5.13it/s]
  3%|▎         | 15/526 [00:02<01:24,  6.08it/s]
  3%|▎         | 16/526 [00:02<01:25,  5.96it/s]
  3%|▎         | 18/526 [00:02<01:08,  7.45it/s]
  4%|▎         | 19/526 [00:02<01:08,  7.35it/s]
  4%|▍         | 20/526 [00:03<01:27,  5.80it/s]
  4%|▍         | 21/526 [00:04<03:28,  2.42it/s]
  4%|▍         | 22/526 [00:04<03:28,  2.41it/s]
  4%|▍         | 23/526 [00:05<04:15,  1.97it/s]
  5%|▍         | 24/526 [00:06<04:48,  1.74it/s]
  5%|▍         | 25/526 [00:07<06:02,  1.38it/s]
  5%|▍         | 26/526 [00:07<05:02,  1.65it/s]
  5%|▌         | 27/526 [00:07<03:57,  2.10it/s]
  5%|▌         | 28/526 [00:08<03:47,  2.19it/s]
  6%|▌         | 30/526 [00:09<04:59,  1.66it/s]
  6%|▌         | 31/526 [00:10<04:50,  1.71it/s]
  6%|▌         | 32/526 [00:10<04:06,  2.00it/s]
  6%|▋         | 33/526 [00:12<06:11,  1.33it/s]
  6%|▋         | 34/526 [00:13<06:33,  1.25it/s]
  7%|▋         | 35/526 [00:14<07:14,  1.13it/s]
  7%|▋         | 36/526 [00:14<05:37,  1.45it/s]
  7%|▋         | 37/526 [00:14<04:48,  1.69it/s]
  7%|▋         | 39/526 [00:14<02:49,  2.88it/s]
  8%|▊         | 40/526 [00:15<02:30,  3.23it/s]
  8%|▊         | 42/526 [00:15<01:54,  4.23it/s]
  8%|▊         | 43/526 [00:15<02:34,  3.12it/s]
  9%|▊         | 45/526 [00:16<01:50,  4.36it/s]
  9%|▊         | 46/526 [00:16<01:56,  4.13it/s]
  9%|▉         | 47/526 [00:16<02:14,  3.57it/s]
  9%|▉         | 48/526 [00:17<02:51,  2.79it/s]
  9%|▉         | 49/526 [00:17<02:19,  3.41it/s]
 10%|▉         | 50/526 [00:17<02:22,  3.34it/s]
 10%|▉         | 52/526 [00:18<01:44,  4.51it/s]
 10%|█         | 53/526 [00:19<03:56,  2.00it/s]
 10%|█         | 54/526 [00:22<09:56,  1.26s/it]
 11%|█         | 56/526 [00:23<05:56,  1.32it/s]
 11%|█         | 58/526 [00:23<04:45,  1.64it/s]
 11%|█         | 59/526 [00:24<05:02,  1.55it/s]
 11%|█▏        | 60/526 [00:25<05:38,  1.38it/s]
 12%|█▏        | 61/526 [00:26<05:34,  1.39it/s]
 12%|█▏        | 62/526 [00:27<06:33,  1.18it/s]
 12%|█▏        | 63/526 [00:28<07:57,  1.03s/it]
 12%|█▏        | 64/526 [00:29<06:25,  1.20it/s]
 12%|█▏        | 65/526 [00:29<04:53,  1.57it/s]
 13%|█▎        | 66/526 [00:29<04:08,  1.85it/s]
 13%|█▎        | 67/526 [00:30<03:56,  1.94it/s]
 13%|█▎        | 68/526 [00:31<05:01,  1.52it/s]
 13%|█▎        | 69/526 [00:31<03:50,  1.98it/s]
 13%|█▎        | 70/526 [00:32<06:13,  1.22it/s]
 13%|█▎        | 71/526 [00:33<06:35,  1.15it/s]
 14%|█▎        | 72/526 [00:34<06:00,  1.26it/s]
 14%|█▍        | 73/526 [00:35<06:45,  1.12it/s]
 14%|█▍        | 74/526 [00:37<08:13,  1.09s/it]
 14%|█▍        | 75/526 [00:37<06:09,  1.22it/s]
 14%|█▍        | 76/526 [00:37<04:38,  1.61it/s]
 15%|█▍        | 77/526 [00:38<05:46,  1.29it/s]
 15%|█▍        | 78/526 [00:40<07:34,  1.01s/it]
 15%|█▌        | 79/526 [00:40<05:34,  1.34it/s]
 15%|█▌        | 80/526 [00:40<04:32,  1.64it/s]
 16%|█▌        | 82/526 [00:41<04:40,  1.58it/s]
 16%|█▌        | 84/526 [00:43<04:24,  1.67it/s]
 16%|█▌        | 85/526 [00:44<06:21,  1.16it/s]
 16%|█▋        | 86/526 [00:45<05:24,  1.36it/s]
 17%|█▋        | 87/526 [00:46<06:00,  1.22it/s]
 17%|█▋        | 88/526 [00:46<05:01,  1.45it/s]
 17%|█▋        | 89/526 [00:46<04:19,  1.69it/s]
 17%|█▋        | 90/526 [00:47<03:56,  1.84it/s]
 17%|█▋        | 91/526 [00:47<03:40,  1.97it/s]
 17%|█▋        | 92/526 [00:47<02:53,  2.49it/s]
 18%|█▊        | 93/526 [00:47<02:16,  3.18it/s]
 18%|█▊        | 95/526 [00:48<01:32,  4.68it/s]
 18%|█▊        | 96/526 [00:48<02:07,  3.37it/s]
 18%|█▊        | 97/526 [00:49<02:52,  2.49it/s]
 19%|█▊        | 98/526 [00:52<08:14,  1.16s/it]
 19%|█▉        | 99/526 [00:56<13:02,  1.83s/it]
 19%|█▉        | 101/526 [00:56<08:00,  1.13s/it]
 19%|█▉        | 102/526 [00:57<06:49,  1.04it/s]
 20%|█▉        | 103/526 [00:57<06:16,  1.12it/s]
 20%|█▉        | 104/526 [00:59<07:37,  1.08s/it]
 20%|█▉        | 105/526 [00:59<05:41,  1.23it/s]
 20%|██        | 106/526 [01:00<05:09,  1.36it/s]
 21%|██        | 108/526 [01:00<03:33,  1.95it/s]
 21%|██        | 109/526 [01:00<03:16,  2.13it/s]
 21%|██        | 110/526 [01:01<04:19,  1.60it/s]
 21%|██        | 111/526 [01:02<03:57,  1.74it/s]
 21%|██▏       | 112/526 [01:02<03:48,  1.81it/s]
 21%|██▏       | 113/526 [01:03<02:57,  2.32it/s]
 22%|██▏       | 114/526 [01:03<02:33,  2.69it/s]
 22%|██▏       | 115/526 [01:03<02:07,  3.22it/s]
 22%|██▏       | 116/526 [01:03<01:44,  3.92it/s]
 22%|██▏       | 117/526 [01:04<03:45,  1.81it/s]
 22%|██▏       | 118/526 [01:06<05:14,  1.30it/s]
 23%|██▎       | 119/526 [01:06<04:22,  1.55it/s]
 23%|██▎       | 120/526 [01:07<05:13,  1.30it/s]
 23%|██▎       | 121/526 [01:07<04:09,  1.62it/s]
 23%|██▎       | 122/526 [01:09<05:35,  1.20it/s]
 23%|██▎       | 123/526 [01:10<06:15,  1.07it/s]
 24%|██▎       | 124/526 [01:11<07:32,  1.12s/it]
 24%|██▍       | 125/526 [01:11<05:35,  1.19it/s]
 24%|██▍       | 127/526 [01:12<03:29,  1.91it/s]
 24%|██▍       | 128/526 [01:12<02:54,  2.29it/s]
 25%|██▍       | 129/526 [01:12<02:49,  2.34it/s]
 25%|██▍       | 130/526 [01:13<02:45,  2.39it/s]
 25%|██▍       | 131/526 [01:13<02:27,  2.68it/s]
 25%|██▌       | 132/526 [01:13<02:02,  3.22it/s]
 25%|██▌       | 133/526 [01:13<01:45,  3.71it/s]
 26%|██▌       | 135/526 [01:14<01:33,  4.17it/s]
 26%|██▌       | 136/526 [01:14<01:42,  3.81it/s]
 26%|██▌       | 138/526 [01:14<01:28,  4.39it/s]
 26%|██▋       | 139/526 [01:15<01:38,  3.94it/s]
 27%|██▋       | 140/526 [01:15<01:29,  4.29it/s]
 27%|██▋       | 141/526 [01:15<01:27,  4.41it/s]
 27%|██▋       | 142/526 [01:15<01:20,  4.79it/s]
 27%|██▋       | 143/526 [01:16<02:03,  3.11it/s]
 27%|██▋       | 144/526 [01:16<01:44,  3.64it/s]
 28%|██▊       | 145/526 [01:17<03:35,  1.77it/s]
 28%|██▊       | 146/526 [01:18<03:12,  1.98it/s]
 28%|██▊       | 147/526 [01:18<03:02,  2.08it/s]
 28%|██▊       | 149/526 [01:19<02:16,  2.76it/s]
 29%|██▊       | 150/526 [01:19<01:55,  3.25it/s]
 29%|██▊       | 151/526 [01:19<01:41,  3.69it/s]
 29%|██▉       | 152/526 [01:19<01:31,  4.08it/s]
 29%|██▉       | 154/526 [01:20<02:34,  2.41it/s]
 29%|██▉       | 155/526 [01:21<03:23,  1.83it/s]
 30%|██▉       | 156/526 [01:22<04:09,  1.48it/s]
 30%|██▉       | 157/526 [01:23<03:48,  1.61it/s]
 30%|███       | 159/526 [01:23<02:18,  2.64it/s]
 30%|███       | 160/526 [01:25<04:01,  1.52it/s]
 31%|███       | 161/526 [01:25<03:27,  1.76it/s]
 31%|███       | 162/526 [01:27<05:48,  1.04it/s]
 31%|███       | 164/526 [01:27<03:49,  1.58it/s]
 32%|███▏      | 166/526 [01:28<02:37,  2.29it/s]
 32%|███▏      | 167/526 [01:28<02:29,  2.41it/s]
 32%|███▏      | 168/526 [01:29<03:40,  1.63it/s]
 32%|███▏      | 169/526 [01:29<03:13,  1.85it/s]
 33%|███▎      | 171/526 [01:32<04:32,  1.30it/s]
 33%|███▎      | 172/526 [01:32<03:44,  1.57it/s]
 33%|███▎      | 173/526 [01:32<03:19,  1.77it/s]
 33%|███▎      | 174/526 [01:33<03:03,  1.92it/s]
 33%|███▎      | 175/526 [01:33<02:26,  2.39it/s]
 33%|███▎      | 176/526 [01:34<03:18,  1.77it/s]
 34%|███▎      | 177/526 [01:34<02:35,  2.25it/s]
 34%|███▍      | 178/526 [01:34<02:05,  2.78it/s]
 34%|███▍      | 179/526 [01:34<01:43,  3.34it/s]
 34%|███▍      | 180/526 [01:35<03:28,  1.66it/s]
 34%|███▍      | 181/526 [01:36<02:41,  2.14it/s]
 35%|███▍      | 182/526 [01:37<04:31,  1.27it/s]
 35%|███▍      | 183/526 [01:37<03:22,  1.69it/s]
 35%|███▍      | 184/526 [01:38<03:22,  1.69it/s]
 35%|███▌      | 186/526 [01:40<04:17,  1.32it/s]
 36%|███▌      | 187/526 [01:40<03:49,  1.47it/s]
 36%|███▌      | 188/526 [01:41<03:36,  1.56it/s]
 36%|███▌      | 190/526 [01:41<02:20,  2.40it/s]
 36%|███▋      | 191/526 [01:41<02:01,  2.77it/s]
 37%|███▋      | 192/526 [01:41<01:44,  3.20it/s]
 37%|███▋      | 193/526 [01:41<01:26,  3.85it/s]
 37%|███▋      | 194/526 [01:42<01:14,  4.45it/s]
 37%|███▋      | 195/526 [01:43<02:59,  1.85it/s]
 37%|███▋      | 196/526 [01:44<04:07,  1.33it/s]
 37%|███▋      | 197/526 [01:44<03:19,  1.65it/s]
 38%|███▊      | 198/526 [01:45<03:00,  1.82it/s]
 38%|███▊      | 199/526 [01:47<05:25,  1.01it/s]
 38%|███▊      | 200/526 [01:47<04:12,  1.29it/s]
 38%|███▊      | 201/526 [01:48<04:20,  1.25it/s]
 38%|███▊      | 202/526 [01:48<03:27,  1.56it/s]
 39%|███▊      | 203/526 [01:49<03:54,  1.38it/s]
 39%|███▉      | 205/526 [01:49<02:16,  2.35it/s]
 39%|███▉      | 206/526 [01:49<01:55,  2.78it/s]
 39%|███▉      | 207/526 [01:50<01:44,  3.06it/s]
 40%|███▉      | 210/526 [01:50<00:57,  5.53it/s]
 40%|████      | 211/526 [01:51<01:53,  2.79it/s]
 40%|████      | 212/526 [01:51<01:46,  2.96it/s]
 41%|████      | 214/526 [01:51<01:19,  3.90it/s]
 41%|████      | 215/526 [01:52<01:47,  2.89it/s]
 41%|████      | 216/526 [01:52<01:47,  2.89it/s]
 41%|████▏     | 217/526 [01:53<02:39,  1.93it/s]
 41%|████▏     | 218/526 [01:55<03:23,  1.51it/s]
 42%|████▏     | 219/526 [01:55<03:33,  1.44it/s]
 42%|████▏     | 220/526 [01:55<02:42,  1.89it/s]
 42%|████▏     | 222/526 [01:56<01:42,  2.97it/s]
 42%|████▏     | 223/526 [01:57<02:36,  1.93it/s]
 43%|████▎     | 224/526 [01:57<02:09,  2.33it/s]
 43%|████▎     | 225/526 [01:57<02:09,  2.33it/s]
 43%|████▎     | 227/526 [01:58<01:44,  2.86it/s]
 43%|████▎     | 228/526 [01:58<01:28,  3.36it/s]
 44%|████▎     | 229/526 [01:58<01:37,  3.05it/s]
 44%|████▎     | 230/526 [01:59<01:27,  3.40it/s]
 44%|████▍     | 231/526 [02:00<02:30,  1.96it/s]
 44%|████▍     | 232/526 [02:00<01:57,  2.50it/s]
 44%|████▍     | 233/526 [02:00<01:38,  2.96it/s]
 44%|████▍     | 234/526 [02:01<03:02,  1.60it/s]
 45%|████▍     | 235/526 [02:02<02:51,  1.70it/s]
 45%|████▍     | 236/526 [02:02<02:13,  2.17it/s]
 45%|████▌     | 237/526 [02:02<02:04,  2.31it/s]
 45%|████▌     | 238/526 [02:03<01:45,  2.74it/s]
 46%|████▌     | 240/526 [02:03<01:06,  4.27it/s]
 46%|████▌     | 241/526 [02:04<02:04,  2.28it/s]
 46%|████▌     | 243/526 [02:04<01:48,  2.62it/s]
 46%|████▋     | 244/526 [02:05<01:50,  2.55it/s]
 47%|████▋     | 245/526 [02:06<02:36,  1.80it/s]
 47%|████▋     | 246/526 [02:06<02:17,  2.03it/s]
 47%|████▋     | 247/526 [02:06<01:53,  2.46it/s]
 47%|████▋     | 248/526 [02:07<02:11,  2.12it/s]
 47%|████▋     | 249/526 [02:08<02:52,  1.61it/s]
 48%|████▊     | 250/526 [02:08<02:15,  2.04it/s]
 48%|████▊     | 251/526 [02:09<02:52,  1.59it/s]
 48%|████▊     | 252/526 [02:09<02:29,  1.83it/s]
 48%|████▊     | 253/526 [02:10<01:59,  2.28it/s]
 48%|████▊     | 255/526 [02:11<02:17,  1.97it/s]
 49%|████▊     | 256/526 [02:11<02:01,  2.22it/s]
 49%|████▉     | 257/526 [02:12<03:03,  1.47it/s]
 49%|████▉     | 258/526 [02:13<03:26,  1.30it/s]
 49%|████▉     | 259/526 [02:14<02:38,  1.68it/s]
 49%|████▉     | 260/526 [02:14<02:04,  2.13it/s]
 50%|████▉     | 261/526 [02:14<02:08,  2.07it/s]
 50%|████▉     | 262/526 [02:14<01:39,  2.66it/s]
 50%|█████     | 263/526 [02:15<02:25,  1.81it/s]
 50%|█████     | 264/526 [02:16<02:48,  1.55it/s]
 50%|█████     | 265/526 [02:16<02:09,  2.01it/s]
 51%|█████     | 266/526 [02:17<02:19,  1.86it/s]
 51%|█████     | 267/526 [02:18<02:33,  1.69it/s]
 51%|█████     | 268/526 [02:18<01:59,  2.17it/s]
 51%|█████     | 269/526 [02:18<01:40,  2.57it/s]
 51%|█████▏    | 270/526 [02:19<01:51,  2.29it/s]
 52%|█████▏    | 271/526 [02:19<01:32,  2.75it/s]
 52%|█████▏    | 272/526 [02:19<01:46,  2.40it/s]
 52%|█████▏    | 273/526 [02:20<02:31,  1.67it/s]
 52%|█████▏    | 274/526 [02:21<02:17,  1.84it/s]
 52%|█████▏    | 275/526 [02:24<05:59,  1.43s/it]
 52%|█████▏    | 276/526 [02:24<04:26,  1.06s/it]
 53%|█████▎    | 277/526 [02:25<03:20,  1.24it/s]
 53%|█████▎    | 278/526 [02:25<03:17,  1.25it/s]
 53%|█████▎    | 279/526 [02:29<06:41,  1.63s/it]
 53%|█████▎    | 280/526 [02:32<08:56,  2.18s/it]
 53%|█████▎    | 281/526 [02:36<10:22,  2.54s/it]
 54%|█████▎    | 282/526 [02:39<11:35,  2.85s/it]
 54%|█████▍    | 283/526 [02:43<12:12,  3.01s/it]
 54%|█████▍    | 284/526 [02:47<12:58,  3.22s/it]
 54%|█████▍    | 285/526 [02:47<09:35,  2.39s/it]
 54%|█████▍    | 286/526 [02:48<07:49,  1.96s/it]
 55%|█████▍    | 287/526 [02:48<05:40,  1.42s/it]
 55%|█████▍    | 288/526 [02:48<04:18,  1.09s/it]
 55%|█████▍    | 289/526 [02:49<03:15,  1.21it/s]
 55%|█████▌    | 291/526 [02:50<02:45,  1.42it/s]
 56%|█████▌    | 292/526 [02:50<02:15,  1.72it/s]
 56%|█████▌    | 293/526 [02:51<02:24,  1.61it/s]
 56%|█████▌    | 294/526 [02:51<02:05,  1.85it/s]
 56%|█████▌    | 295/526 [02:51<01:50,  2.09it/s]
 56%|█████▋    | 296/526 [02:52<01:41,  2.26it/s]
 57%|█████▋    | 298/526 [02:55<03:46,  1.01it/s]
 57%|█████▋    | 299/526 [02:58<05:47,  1.53s/it]
 57%|█████▋    | 300/526 [03:00<05:44,  1.53s/it]
 57%|█████▋    | 301/526 [03:01<05:17,  1.41s/it]
 57%|█████▋    | 302/526 [03:02<05:21,  1.44s/it]
 58%|█████▊    | 303/526 [03:04<05:31,  1.49s/it]
 58%|█████▊    | 304/526 [03:04<04:17,  1.16s/it]
 58%|█████▊    | 305/526 [03:06<04:39,  1.26s/it]
 58%|█████▊    | 306/526 [03:07<04:51,  1.32s/it]
 58%|█████▊    | 307/526 [03:09<05:03,  1.38s/it]
 59%|█████▊    | 308/526 [03:10<05:09,  1.42s/it]
 59%|█████▊    | 309/526 [03:11<03:54,  1.08s/it]
 59%|█████▉    | 310/526 [03:12<03:45,  1.04s/it]
 59%|█████▉    | 311/526 [03:12<02:52,  1.25it/s]
 59%|█████▉    | 312/526 [03:13<03:43,  1.04s/it]
 60%|█████▉    | 313/526 [03:15<04:16,  1.20s/it]
 60%|█████▉    | 314/526 [03:17<04:45,  1.35s/it]
 60%|█████▉    | 315/526 [03:20<06:42,  1.91s/it]
 60%|██████    | 316/526 [03:20<04:47,  1.37s/it]
 60%|██████    | 317/526 [03:21<04:16,  1.23s/it]
 60%|██████    | 318/526 [03:22<03:54,  1.13s/it]
 61%|██████    | 319/526 [03:22<03:07,  1.10it/s]
 61%|██████    | 320/526 [03:22<02:20,  1.47it/s]
 61%|██████    | 321/526 [03:24<03:24,  1.00it/s]
 61%|██████    | 322/526 [03:24<02:46,  1.22it/s]
 61%|██████▏   | 323/526 [03:25<02:12,  1.54it/s]
 62%|██████▏   | 324/526 [03:25<01:47,  1.87it/s]
 62%|██████▏   | 325/526 [03:25<01:31,  2.19it/s]
 62%|██████▏   | 326/526 [03:25<01:11,  2.78it/s]
 62%|██████▏   | 327/526 [03:26<01:10,  2.81it/s]
 62%|██████▏   | 328/526 [03:26<01:00,  3.28it/s]
 63%|██████▎   | 329/526 [03:26<00:48,  4.07it/s]
 63%|██████▎   | 331/526 [03:26<00:40,  4.84it/s]
 63%|██████▎   | 332/526 [03:27<00:57,  3.38it/s]
 63%|██████▎   | 333/526 [03:27<00:52,  3.64it/s]
 63%|██████▎   | 334/526 [03:29<02:09,  1.49it/s]
 64%|██████▎   | 335/526 [03:29<02:03,  1.55it/s]
 64%|██████▍   | 336/526 [03:31<02:43,  1.16it/s]
 64%|██████▍   | 337/526 [03:32<02:40,  1.18it/s]
 64%|██████▍   | 338/526 [03:32<02:28,  1.26it/s]
 64%|██████▍   | 339/526 [03:33<02:08,  1.46it/s]
 65%|██████▍   | 340/526 [03:36<04:50,  1.56s/it]
 65%|██████▍   | 341/526 [03:37<03:31,  1.14s/it]
 65%|██████▌   | 342/526 [03:37<02:54,  1.05it/s]
 65%|██████▌   | 343/526 [03:38<02:53,  1.06it/s]
 66%|██████▌   | 345/526 [03:45<06:31,  2.16s/it]
 66%|██████▌   | 346/526 [03:49<07:28,  2.49s/it]
 66%|██████▌   | 347/526 [03:56<10:57,  3.67s/it]
 66%|██████▌   | 348/526 [03:57<08:46,  2.96s/it]
 66%|██████▋   | 349/526 [03:57<06:40,  2.26s/it]
 67%|██████▋   | 350/526 [04:04<10:42,  3.65s/it]
 67%|██████▋   | 351/526 [04:08<10:28,  3.59s/it]
 67%|██████▋   | 352/526 [04:08<07:35,  2.62s/it]
 67%|██████▋   | 353/526 [04:08<05:30,  1.91s/it]
 67%|██████▋   | 354/526 [04:08<03:56,  1.38s/it]
 67%|██████▋   | 355/526 [04:09<03:09,  1.11s/it]
 68%|██████▊   | 356/526 [04:09<02:18,  1.23it/s]
 68%|██████▊   | 357/526 [04:10<02:06,  1.33it/s]
 68%|██████▊   | 358/526 [04:10<01:58,  1.41it/s]
 68%|██████▊   | 359/526 [04:10<01:36,  1.73it/s]
 68%|██████▊   | 360/526 [04:11<01:13,  2.25it/s]
 69%|██████▊   | 361/526 [04:11<01:03,  2.60it/s]
 69%|██████▉   | 363/526 [04:12<01:01,  2.65it/s]
 69%|██████▉   | 364/526 [04:12<00:54,  2.97it/s]
 69%|██████▉   | 365/526 [04:12<01:06,  2.41it/s]
 70%|██████▉   | 366/526 [04:14<02:03,  1.30it/s]
 70%|██████▉   | 367/526 [04:14<01:34,  1.69it/s]
 70%|██████▉   | 368/526 [04:14<01:14,  2.13it/s]
 70%|███████   | 369/526 [04:15<01:12,  2.17it/s]
 70%|███████   | 370/526 [04:22<06:08,  2.36s/it]
 71%|███████   | 371/526 [04:29<09:37,  3.73s/it]
 71%|███████   | 372/526 [04:36<12:01,  4.68s/it]
 71%|███████   | 374/526 [04:36<06:32,  2.58s/it]
 71%|███████▏  | 375/526 [04:43<09:16,  3.69s/it]
 71%|███████▏  | 376/526 [04:43<06:54,  2.77s/it]
 72%|███████▏  | 377/526 [04:44<05:27,  2.20s/it]
 72%|███████▏  | 378/526 [04:44<03:59,  1.62s/it]
 72%|███████▏  | 379/526 [04:44<03:09,  1.29s/it]
 72%|███████▏  | 380/526 [04:45<02:25,  1.01it/s]
 72%|███████▏  | 381/526 [04:52<06:37,  2.74s/it]
 73%|███████▎  | 382/526 [04:52<05:03,  2.11s/it]
 73%|███████▎  | 383/526 [04:53<03:50,  1.62s/it]
 73%|███████▎  | 384/526 [05:00<07:35,  3.20s/it]
 73%|███████▎  | 385/526 [05:07<10:10,  4.33s/it]
 73%|███████▎  | 386/526 [05:08<07:47,  3.34s/it]
 74%|███████▎  | 387/526 [05:08<05:36,  2.42s/it]
 74%|███████▍  | 388/526 [05:08<04:12,  1.83s/it]
 74%|███████▍  | 389/526 [05:09<03:21,  1.47s/it]
 74%|███████▍  | 390/526 [05:10<02:47,  1.23s/it]
 74%|███████▍  | 391/526 [05:10<02:04,  1.09it/s]
 75%|███████▍  | 392/526 [05:10<01:32,  1.45it/s]
 75%|███████▍  | 393/526 [05:11<01:30,  1.46it/s]
 75%|███████▍  | 394/526 [05:11<01:08,  1.92it/s]
 75%|███████▌  | 396/526 [05:11<00:42,  3.04it/s]
 75%|███████▌  | 397/526 [05:11<00:36,  3.52it/s]
 76%|███████▌  | 398/526 [05:11<00:36,  3.54it/s]
 76%|███████▌  | 399/526 [05:19<04:34,  2.16s/it]
 76%|███████▌  | 400/526 [05:19<03:20,  1.59s/it]
 76%|███████▌  | 401/526 [05:26<06:37,  3.18s/it]
 76%|███████▋  | 402/526 [05:26<04:58,  2.41s/it]
 77%|███████▋  | 403/526 [05:27<03:42,  1.81s/it]
 77%|███████▋  | 404/526 [05:27<02:44,  1.35s/it]
 77%|███████▋  | 405/526 [05:27<02:02,  1.01s/it]
 77%|███████▋  | 406/526 [05:32<04:28,  2.23s/it]
 78%|███████▊  | 408/526 [05:33<02:29,  1.27s/it]
 78%|███████▊  | 409/526 [05:33<02:11,  1.12s/it]
 78%|███████▊  | 410/526 [05:33<01:41,  1.14it/s]
 78%|███████▊  | 411/526 [05:41<04:52,  2.55s/it]
 78%|███████▊  | 412/526 [05:41<03:35,  1.89s/it]
 79%|███████▊  | 414/526 [05:41<02:03,  1.10s/it]
 79%|███████▉  | 415/526 [05:41<01:42,  1.08it/s]
 79%|███████▉  | 417/526 [05:42<01:11,  1.52it/s]
 79%|███████▉  | 418/526 [05:44<01:39,  1.08it/s]
 80%|███████▉  | 419/526 [05:44<01:19,  1.34it/s]
 80%|████████  | 421/526 [05:48<02:17,  1.31s/it]
 80%|████████  | 422/526 [05:48<01:48,  1.04s/it]
 80%|████████  | 423/526 [05:49<01:29,  1.15it/s]
 81%|████████  | 424/526 [05:49<01:10,  1.45it/s]
 81%|████████  | 425/526 [05:49<00:54,  1.86it/s]
 81%|████████  | 426/526 [05:49<00:45,  2.18it/s]
 81%|████████  | 427/526 [05:49<00:36,  2.69it/s]
 81%|████████▏ | 428/526 [05:49<00:29,  3.35it/s]
 82%|████████▏ | 429/526 [05:50<00:24,  3.92it/s]
 82%|████████▏ | 431/526 [05:51<00:37,  2.56it/s]
 82%|████████▏ | 432/526 [05:51<00:30,  3.08it/s]
 82%|████████▏ | 433/526 [05:51<00:27,  3.40it/s]
 83%|████████▎ | 435/526 [05:54<01:08,  1.34it/s]
 83%|████████▎ | 436/526 [05:55<01:11,  1.26it/s]
 83%|████████▎ | 438/526 [05:56<01:00,  1.45it/s]
 83%|████████▎ | 439/526 [05:57<01:06,  1.32it/s]
 84%|████████▎ | 440/526 [05:57<01:04,  1.34it/s]
 84%|████████▍ | 442/526 [05:58<00:45,  1.83it/s]
 84%|████████▍ | 444/526 [06:00<00:55,  1.48it/s]
 85%|████████▍ | 445/526 [06:01<01:12,  1.12it/s]
 85%|████████▍ | 446/526 [06:02<00:59,  1.33it/s]
 85%|████████▍ | 447/526 [06:02<00:52,  1.50it/s]
 85%|████████▌ | 448/526 [06:02<00:42,  1.83it/s]
 85%|████████▌ | 449/526 [06:02<00:32,  2.35it/s]
 86%|████████▌ | 451/526 [06:03<00:21,  3.51it/s]
 86%|████████▌ | 453/526 [06:03<00:15,  4.84it/s]
 86%|████████▋ | 454/526 [06:03<00:21,  3.31it/s]
 87%|████████▋ | 456/526 [06:04<00:16,  4.18it/s]
 87%|████████▋ | 458/526 [06:04<00:13,  4.89it/s]
 87%|████████▋ | 459/526 [06:04<00:14,  4.74it/s]
 87%|████████▋ | 460/526 [06:05<00:19,  3.46it/s]
 88%|████████▊ | 461/526 [06:05<00:16,  4.00it/s]
 88%|████████▊ | 462/526 [06:05<00:15,  4.10it/s]
 88%|████████▊ | 463/526 [06:06<00:17,  3.53it/s]
 88%|████████▊ | 465/526 [06:06<00:14,  4.18it/s]
 89%|████████▊ | 466/526 [06:06<00:16,  3.56it/s]
 89%|████████▉ | 467/526 [06:07<00:19,  3.03it/s]
 89%|████████▉ | 468/526 [06:07<00:16,  3.57it/s]
 89%|████████▉ | 469/526 [06:07<00:13,  4.32it/s]
 89%|████████▉ | 470/526 [06:07<00:11,  4.81it/s]
 90%|████████▉ | 471/526 [06:07<00:09,  5.55it/s]
 90%|████████▉ | 472/526 [06:08<00:14,  3.83it/s]
 90%|█████████ | 474/526 [06:08<00:09,  5.63it/s]
 90%|█████████ | 475/526 [06:09<00:18,  2.83it/s]
 90%|█████████ | 476/526 [06:09<00:18,  2.74it/s]
 91%|█████████ | 478/526 [06:09<00:11,  4.28it/s]
 91%|█████████ | 479/526 [06:10<00:18,  2.61it/s]
 91%|█████████▏| 480/526 [06:11<00:18,  2.53it/s]
 91%|█████████▏| 481/526 [06:12<00:31,  1.42it/s]
 92%|█████████▏| 482/526 [06:13<00:26,  1.68it/s]
 92%|█████████▏| 483/526 [06:13<00:21,  2.00it/s]
 92%|█████████▏| 484/526 [06:13<00:18,  2.27it/s]
 92%|█████████▏| 485/526 [06:13<00:15,  2.56it/s]
 92%|█████████▏| 486/526 [06:14<00:13,  3.07it/s]
 93%|█████████▎| 487/526 [06:14<00:11,  3.43it/s]
 93%|█████████▎| 489/526 [06:14<00:08,  4.26it/s]
 93%|█████████▎| 490/526 [06:14<00:08,  4.25it/s]
 93%|█████████▎| 491/526 [06:15<00:12,  2.85it/s]
 94%|█████████▎| 493/526 [06:19<00:34,  1.06s/it]
 94%|█████████▍| 494/526 [06:19<00:26,  1.19it/s]
 94%|█████████▍| 495/526 [06:19<00:21,  1.43it/s]
 94%|█████████▍| 496/526 [06:20<00:16,  1.78it/s]
 94%|█████████▍| 497/526 [06:21<00:20,  1.39it/s]
 95%|█████████▍| 498/526 [06:22<00:27,  1.01it/s]
 95%|█████████▍| 499/526 [06:24<00:34,  1.26s/it]
 95%|█████████▌| 500/526 [06:25<00:24,  1.06it/s]
 95%|█████████▌| 501/526 [06:25<00:18,  1.34it/s]
 96%|█████████▌| 503/526 [06:25<00:10,  2.12it/s]
 96%|█████████▌| 504/526 [06:25<00:09,  2.35it/s]
 96%|█████████▌| 505/526 [06:26<00:09,  2.22it/s]
 96%|█████████▌| 506/526 [06:26<00:07,  2.51it/s]
 96%|█████████▋| 507/526 [06:26<00:06,  3.03it/s]
 97%|█████████▋| 508/526 [06:27<00:06,  2.71it/s]
 97%|█████████▋| 510/526 [06:28<00:07,  2.20it/s]
 97%|█████████▋| 511/526 [06:28<00:07,  2.07it/s]
 97%|█████████▋| 512/526 [06:29<00:05,  2.44it/s]
 98%|█████████▊| 513/526 [06:30<00:06,  1.87it/s]
 98%|█████████▊| 514/526 [06:30<00:05,  2.06it/s]
 98%|█████████▊| 515/526 [06:30<00:05,  2.14it/s]
 98%|█████████▊| 516/526 [06:30<00:03,  2.65it/s]
 98%|█████████▊| 517/526 [06:31<00:03,  2.53it/s]
 98%|█████████▊| 518/526 [06:31<00:02,  2.74it/s]
 99%|█████████▊| 519/526 [06:31<00:02,  3.30it/s]
 99%|█████████▉| 520/526 [06:32<00:03,  1.82it/s]
 99%|█████████▉| 521/526 [06:33<00:02,  2.38it/s]
 99%|█████████▉| 522/526 [06:36<00:05,  1.35s/it]
 99%|█████████▉| 523/526 [06:40<00:06,  2.03s/it]
100%|█████████▉| 524/526 [06:43<00:05,  2.50s/it]
100%|█████████▉| 525/526 [06:44<00:01,  1.86s/it]
100%|██████████| 526/526 [06:47<00:00,  2.37s/it]
100%|██████████| 526/526 [06:47<00:00,  1.29it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 10:50:54.095205_lp_processed_test.json', '--output_addr', 'data/out/rag/full_profile/lp_rag_full_profile_test_10_limit_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  5.14 examples/s]
Generating train split: 526 examples [00:00, 1262.68 examples/s]
INFO 07-15 10:58:14 config.py:510] This model supports multiple tasks: {'generate', 'classify', 'score', 'reward', 'embed'}. Defaulting to 'generate'.
INFO 07-15 10:58:14 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 10:58:15 selector.py:120] Using Flash Attention backend.
INFO 07-15 10:58:16 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 10:58:16 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.47it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.39it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.44it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.41it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]

INFO 07-15 10:58:19 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 10:58:22 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-15 10:58:22 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 10:58:22 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 10:58:22 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 10:58:22 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 10:58:25 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:13,  2.45it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:12,  2.55it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:12,  2.59it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:11,  2.60it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:11,  2.61it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:11,  2.62it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:10,  2.62it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:03<00:10,  2.63it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:09,  2.62it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:09,  2.63it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:04<00:09,  2.64it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:08,  2.64it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:08,  2.64it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:05<00:07,  2.65it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:07,  2.65it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:06<00:07,  2.65it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:06<00:06,  2.67it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:06,  2.69it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:07<00:05,  2.70it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:07<00:05,  2.72it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:05,  2.73it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:08<00:04,  2.73it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:08<00:04,  2.74it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:09<00:04,  2.74it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:09<00:03,  2.73it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:09<00:03,  2.74it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:10<00:02,  2.75it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:10<00:02,  2.74it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:10<00:02,  2.76it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:11<00:01,  2.76it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:11<00:01,  2.76it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:11<00:01,  2.76it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:12<00:00,  2.72it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:12<00:00,  2.73it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:13<00:00,  2.74it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:13<00:00,  2.69it/s]
INFO 07-15 10:58:38 model_runner.py:1535] Graph capturing finished in 13 secs, took 0.22 GiB
INFO 07-15 10:58:38 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 18.22 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:32<4:43:29, 32.40s/it, est. speed input: 29.41 toks/s, output: 2.56 toks/s]
Processed prompts:   0%|          | 2/526 [00:33<1:59:36, 13.69s/it, est. speed input: 76.27 toks/s, output: 5.27 toks/s]
Processed prompts:   1%|          | 3/526 [00:34<1:08:59,  7.92s/it, est. speed input: 146.24 toks/s, output: 8.14 toks/s]
Processed prompts:   1%|          | 4/526 [00:34<42:49,  4.92s/it, est. speed input: 189.34 toks/s, output: 11.11 toks/s] 
Processed prompts:   1%|          | 5/526 [00:34<29:00,  3.34s/it, est. speed input: 221.47 toks/s, output: 14.07 toks/s]
Processed prompts:   1%|          | 6/526 [00:35<19:25,  2.24s/it, est. speed input: 279.71 toks/s, output: 17.16 toks/s]
Processed prompts:   1%|▏         | 7/526 [00:35<13:40,  1.58s/it, est. speed input: 323.57 toks/s, output: 20.21 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:35<10:01,  1.16s/it, est. speed input: 355.23 toks/s, output: 23.24 toks/s]
Processed prompts:   2%|▏         | 10/526 [00:35<06:02,  1.42it/s, est. speed input: 467.58 toks/s, output: 29.33 toks/s]
Processed prompts:   2%|▏         | 11/526 [00:36<04:51,  1.76it/s, est. speed input: 531.43 toks/s, output: 32.41 toks/s]
Processed prompts:   2%|▏         | 12/526 [00:36<04:09,  2.06it/s, est. speed input: 589.90 toks/s, output: 35.40 toks/s]
Processed prompts:   2%|▏         | 13/526 [00:36<03:15,  2.63it/s, est. speed input: 607.91 toks/s, output: 38.54 toks/s]
Processed prompts:   3%|▎         | 15/526 [00:36<02:42,  3.14it/s, est. speed input: 681.80 toks/s, output: 44.51 toks/s]
Processed prompts:   3%|▎         | 18/526 [00:37<01:52,  4.50it/s, est. speed input: 807.92 toks/s, output: 53.85 toks/s]
Processed prompts:   4%|▎         | 19/526 [00:37<02:03,  4.11it/s, est. speed input: 831.16 toks/s, output: 56.67 toks/s]
Processed prompts:   4%|▍         | 21/526 [00:37<01:42,  4.91it/s, est. speed input: 926.85 toks/s, output: 62.86 toks/s]
Processed prompts:   5%|▍         | 24/526 [00:38<01:34,  5.29it/s, est. speed input: 1036.11 toks/s, output: 71.82 toks/s]
Processed prompts:   5%|▍         | 25/526 [00:38<01:28,  5.63it/s, est. speed input: 1078.01 toks/s, output: 74.89 toks/s]
Processed prompts:   5%|▌         | 27/526 [00:38<01:32,  5.37it/s, est. speed input: 1220.76 toks/s, output: 80.66 toks/s]
Processed prompts:   5%|▌         | 28/526 [00:39<01:39,  5.01it/s, est. speed input: 1238.26 toks/s, output: 83.45 toks/s]
Processed prompts:   6%|▌         | 31/526 [00:39<01:31,  5.41it/s, est. speed input: 1338.81 toks/s, output: 92.26 toks/s]
Processed prompts:   6%|▋         | 34/526 [00:40<01:23,  5.87it/s, est. speed input: 1440.25 toks/s, output: 101.07 toks/s]
Processed prompts:   7%|▋         | 37/526 [00:40<01:24,  5.78it/s, est. speed input: 1572.31 toks/s, output: 109.59 toks/s]
Processed prompts:   8%|▊         | 41/526 [00:41<01:18,  6.21it/s, est. speed input: 1735.53 toks/s, output: 121.09 toks/s]
Processed prompts:   8%|▊         | 44/526 [00:41<01:26,  5.58it/s, est. speed input: 1819.71 toks/s, output: 128.87 toks/s]
Processed prompts:   9%|▊         | 46/526 [00:42<01:18,  6.15it/s, est. speed input: 1898.33 toks/s, output: 134.71 toks/s]
Processed prompts:   9%|▉         | 48/526 [00:42<01:24,  5.64it/s, est. speed input: 1955.22 toks/s, output: 139.77 toks/s]
Processed prompts:   9%|▉         | 49/526 [00:42<01:23,  5.74it/s, est. speed input: 1981.09 toks/s, output: 142.51 toks/s]
Processed prompts:  10%|█         | 53/526 [00:43<01:27,  5.42it/s, est. speed input: 2084.83 toks/s, output: 152.75 toks/s]
Processed prompts:  10%|█         | 55/526 [00:43<01:17,  6.06it/s, est. speed input: 2147.81 toks/s, output: 158.44 toks/s]
Processed prompts:  11%|█         | 59/526 [00:44<01:22,  5.69it/s, est. speed input: 2226.34 toks/s, output: 168.42 toks/s]
Processed prompts:  12%|█▏        | 63/526 [00:44<01:13,  6.30it/s, est. speed input: 2403.76 toks/s, output: 179.14 toks/s]
Processed prompts:  12%|█▏        | 65/526 [00:45<01:15,  6.07it/s, est. speed input: 2478.89 toks/s, output: 183.98 toks/s]
Processed prompts:  13%|█▎        | 71/526 [00:46<01:08,  6.60it/s, est. speed input: 2675.93 toks/s, output: 199.46 toks/s]
Processed prompts:  14%|█▍        | 75/526 [00:46<01:06,  6.78it/s, est. speed input: 2789.74 toks/s, output: 209.53 toks/s]
Processed prompts:  15%|█▍        | 78/526 [00:47<01:00,  7.35it/s, est. speed input: 2870.72 toks/s, output: 217.51 toks/s]
Processed prompts:  16%|█▌        | 82/526 [00:47<01:00,  7.31it/s, est. speed input: 3001.08 toks/s, output: 227.35 toks/s]
Processed prompts:  16%|█▌        | 84/526 [00:47<00:57,  7.63it/s, est. speed input: 3054.59 toks/s, output: 232.56 toks/s]
Processed prompts:  17%|█▋        | 88/526 [00:48<00:55,  7.84it/s, est. speed input: 3150.19 toks/s, output: 242.59 toks/s]
Processed prompts:  17%|█▋        | 91/526 [00:48<00:54,  8.03it/s, est. speed input: 3265.85 toks/s, output: 250.13 toks/s]
Processed prompts:  18%|█▊        | 97/526 [00:49<00:53,  8.02it/s, est. speed input: 3439.81 toks/s, output: 264.70 toks/s]
Processed prompts:  19%|█▉        | 100/526 [00:49<00:50,  8.45it/s, est. speed input: 3578.17 toks/s, output: 272.34 toks/s]
Processed prompts:  19%|█▉        | 101/526 [00:49<00:58,  7.30it/s, est. speed input: 3603.92 toks/s, output: 273.77 toks/s]
Processed prompts:  20%|█▉        | 104/526 [00:50<00:58,  7.25it/s, est. speed input: 3683.04 toks/s, output: 280.68 toks/s]
Processed prompts:  21%|██        | 110/526 [00:51<01:03,  6.57it/s, est. speed input: 3850.97 toks/s, output: 293.27 toks/s]
Processed prompts:  22%|██▏       | 116/526 [00:52<00:57,  7.12it/s, est. speed input: 3985.79 toks/s, output: 307.10 toks/s]
Processed prompts:  23%|██▎       | 119/526 [00:52<00:56,  7.21it/s, est. speed input: 4082.82 toks/s, output: 313.77 toks/s]
Processed prompts:  23%|██▎       | 121/526 [00:52<00:53,  7.53it/s, est. speed input: 4172.93 toks/s, output: 318.53 toks/s]
Processed prompts:  24%|██▍       | 126/526 [00:53<00:58,  6.88it/s, est. speed input: 4248.40 toks/s, output: 328.47 toks/s]
Processed prompts:  25%|██▍       | 131/526 [00:54<00:57,  6.83it/s, est. speed input: 4361.34 toks/s, output: 338.81 toks/s]
Processed prompts:  26%|██▌       | 136/526 [00:54<00:51,  7.59it/s, est. speed input: 4489.75 toks/s, output: 350.44 toks/s]
Processed prompts:  26%|██▌       | 137/526 [00:55<00:54,  7.16it/s, est. speed input: 4502.31 toks/s, output: 352.00 toks/s]
Processed prompts:  27%|██▋       | 142/526 [00:55<00:48,  7.86it/s, est. speed input: 4657.68 toks/s, output: 363.37 toks/s]
Processed prompts:  28%|██▊       | 147/526 [00:56<00:48,  7.79it/s, est. speed input: 4770.72 toks/s, output: 373.84 toks/s]
Processed prompts:  28%|██▊       | 149/526 [00:56<00:48,  7.81it/s, est. speed input: 4815.77 toks/s, output: 378.07 toks/s]
Processed prompts:  30%|██▉       | 156/526 [00:57<00:51,  7.20it/s, est. speed input: 4896.63 toks/s, output: 391.41 toks/s]
Processed prompts:  30%|███       | 158/526 [00:57<00:49,  7.49it/s, est. speed input: 4955.25 toks/s, output: 395.83 toks/s]
Processed prompts:  30%|███       | 160/526 [00:58<00:54,  6.72it/s, est. speed input: 4980.89 toks/s, output: 398.70 toks/s]
Processed prompts:  31%|███       | 162/526 [00:58<00:52,  6.89it/s, est. speed input: 5001.48 toks/s, output: 402.75 toks/s]
Processed prompts:  31%|███▏      | 165/526 [00:58<00:54,  6.58it/s, est. speed input: 5076.04 toks/s, output: 408.03 toks/s]
Processed prompts:  32%|███▏      | 168/526 [00:59<00:54,  6.55it/s, est. speed input: 5141.91 toks/s, output: 413.55 toks/s]
Processed prompts:  33%|███▎      | 171/526 [00:59<00:54,  6.56it/s, est. speed input: 5254.49 toks/s, output: 419.11 toks/s]
Processed prompts:  33%|███▎      | 174/526 [01:00<00:45,  7.67it/s, est. speed input: 5333.52 toks/s, output: 426.20 toks/s]
Processed prompts:  33%|███▎      | 176/526 [01:00<00:50,  6.92it/s, est. speed input: 5349.74 toks/s, output: 429.30 toks/s]
Processed prompts:  34%|███▍      | 178/526 [01:00<00:48,  7.15it/s, est. speed input: 5393.19 toks/s, output: 433.38 toks/s]
Processed prompts:  34%|███▍      | 181/526 [01:01<00:51,  6.70it/s, est. speed input: 5418.59 toks/s, output: 438.56 toks/s]
Processed prompts:  35%|███▍      | 184/526 [01:01<00:47,  7.23it/s, est. speed input: 5516.71 toks/s, output: 444.82 toks/s]
Processed prompts:  36%|███▌      | 190/526 [01:02<00:56,  5.97it/s, est. speed input: 5558.94 toks/s, output: 453.60 toks/s]
Processed prompts:  37%|███▋      | 192/526 [01:03<00:56,  5.90it/s, est. speed input: 5570.27 toks/s, output: 456.78 toks/s]
Processed prompts:  37%|███▋      | 194/526 [01:03<01:02,  5.33it/s, est. speed input: 5581.57 toks/s, output: 458.85 toks/s]
Processed prompts:  37%|███▋      | 196/526 [01:03<00:55,  5.91it/s, est. speed input: 5636.44 toks/s, output: 463.04 toks/s]
Processed prompts:  38%|███▊      | 198/526 [01:04<00:55,  5.93it/s, est. speed input: 5674.17 toks/s, output: 466.38 toks/s]
Processed prompts:  39%|███▉      | 204/526 [01:04<00:45,  7.07it/s, est. speed input: 5767.54 toks/s, output: 478.51 toks/s]
Processed prompts:  39%|███▉      | 206/526 [01:05<00:52,  6.11it/s, est. speed input: 5781.42 toks/s, output: 480.51 toks/s]
Processed prompts:  40%|███▉      | 209/526 [01:05<00:50,  6.24it/s, est. speed input: 5808.68 toks/s, output: 485.75 toks/s]
Processed prompts:  40%|███▉      | 210/526 [01:06<00:55,  5.74it/s, est. speed input: 5811.17 toks/s, output: 486.61 toks/s]
Processed prompts:  41%|████      | 214/526 [01:06<00:49,  6.31it/s, est. speed input: 5844.70 toks/s, output: 494.06 toks/s]
Processed prompts:  41%|████▏     | 217/526 [01:07<00:51,  5.96it/s, est. speed input: 5892.84 toks/s, output: 498.42 toks/s]
Processed prompts:  41%|████▏     | 218/526 [01:07<00:49,  6.28it/s, est. speed input: 5904.82 toks/s, output: 500.54 toks/s]
Processed prompts:  42%|████▏     | 220/526 [01:07<00:51,  5.97it/s, est. speed input: 5925.76 toks/s, output: 503.44 toks/s]
Processed prompts:  42%|████▏     | 221/526 [01:07<00:51,  5.96it/s, est. speed input: 5982.14 toks/s, output: 505.07 toks/s]
Processed prompts:  42%|████▏     | 222/526 [01:08<00:53,  5.68it/s, est. speed input: 5989.41 toks/s, output: 506.37 toks/s]
Processed prompts:  43%|████▎     | 224/526 [01:08<00:46,  6.56it/s, est. speed input: 6064.97 toks/s, output: 510.52 toks/s]
Processed prompts:  44%|████▎     | 229/526 [01:09<00:47,  6.27it/s, est. speed input: 6146.54 toks/s, output: 518.67 toks/s]
Processed prompts:  44%|████▎     | 230/526 [01:09<00:49,  5.97it/s, est. speed input: 6184.50 toks/s, output: 519.91 toks/s]
Processed prompts:  44%|████▍     | 231/526 [01:09<00:58,  5.02it/s, est. speed input: 6170.44 toks/s, output: 520.12 toks/s]
Processed prompts:  44%|████▍     | 232/526 [01:09<00:57,  5.11it/s, est. speed input: 6198.52 toks/s, output: 521.67 toks/s]
Processed prompts:  44%|████▍     | 233/526 [01:10<01:06,  4.40it/s, est. speed input: 6194.73 toks/s, output: 522.02 toks/s]
Processed prompts:  45%|████▍     | 235/526 [01:10<00:50,  5.80it/s, est. speed input: 6235.00 toks/s, output: 526.60 toks/s]
Processed prompts:  45%|████▌     | 238/526 [01:10<00:45,  6.26it/s, est. speed input: 6311.23 toks/s, output: 532.09 toks/s]
Processed prompts:  45%|████▌     | 239/526 [01:11<00:54,  5.23it/s, est. speed input: 6302.30 toks/s, output: 532.50 toks/s]
Processed prompts:  46%|████▌     | 240/526 [01:11<00:51,  5.59it/s, est. speed input: 6308.81 toks/s, output: 534.47 toks/s]
Processed prompts:  46%|████▌     | 241/526 [01:11<01:09,  4.08it/s, est. speed input: 6294.38 toks/s, output: 533.88 toks/s]
Processed prompts:  46%|████▌     | 242/526 [01:11<01:03,  4.46it/s, est. speed input: 6303.68 toks/s, output: 535.67 toks/s]
Processed prompts:  47%|████▋     | 246/526 [01:12<01:05,  4.27it/s, est. speed input: 6306.17 toks/s, output: 540.32 toks/s]
Processed prompts:  47%|████▋     | 247/526 [01:13<01:36,  2.90it/s, est. speed input: 6257.58 toks/s, output: 536.96 toks/s]
Processed prompts:  47%|████▋     | 248/526 [01:14<02:11,  2.11it/s, est. speed input: 6192.37 toks/s, output: 531.58 toks/s]
Processed prompts:  48%|████▊     | 250/526 [01:15<01:51,  2.47it/s, est. speed input: 6188.55 toks/s, output: 531.26 toks/s]
Processed prompts:  48%|████▊     | 251/526 [01:15<01:46,  2.58it/s, est. speed input: 6177.73 toks/s, output: 530.60 toks/s]
Processed prompts:  48%|████▊     | 252/526 [01:16<01:52,  2.43it/s, est. speed input: 6163.80 toks/s, output: 528.90 toks/s]
Processed prompts:  48%|████▊     | 253/526 [01:16<01:38,  2.77it/s, est. speed input: 6154.98 toks/s, output: 530.84 toks/s]
Processed prompts:  48%|████▊     | 255/526 [01:16<01:24,  3.21it/s, est. speed input: 6157.00 toks/s, output: 530.66 toks/s]
Processed prompts:  49%|████▊     | 256/526 [01:16<01:11,  3.78it/s, est. speed input: 6177.74 toks/s, output: 531.68 toks/s]
Processed prompts:  49%|████▉     | 259/526 [01:17<00:58,  4.57it/s, est. speed input: 6218.14 toks/s, output: 532.41 toks/s]
Processed prompts:  49%|████▉     | 260/526 [01:17<00:55,  4.78it/s, est. speed input: 6231.12 toks/s, output: 533.19 toks/s]
Processed prompts:  50%|████▉     | 261/526 [01:17<00:59,  4.44it/s, est. speed input: 6234.84 toks/s, output: 534.61 toks/s]
Processed prompts:  50%|████▉     | 262/526 [01:18<00:55,  4.74it/s, est. speed input: 6249.31 toks/s, output: 535.16 toks/s]
Processed prompts:  50%|█████     | 263/526 [01:18<01:10,  3.75it/s, est. speed input: 6240.72 toks/s, output: 533.92 toks/s]
Processed prompts:  50%|█████     | 264/526 [01:18<00:59,  4.37it/s, est. speed input: 6242.70 toks/s, output: 536.47 toks/s]
Processed prompts:  51%|█████     | 266/526 [01:19<00:58,  4.45it/s, est. speed input: 6260.01 toks/s, output: 537.33 toks/s]
Processed prompts:  51%|█████▏    | 270/526 [01:19<00:52,  4.85it/s, est. speed input: 6312.38 toks/s, output: 538.88 toks/s]
Processed prompts:  52%|█████▏    | 271/526 [01:20<01:02,  4.09it/s, est. speed input: 6301.84 toks/s, output: 537.54 toks/s]
Processed prompts:  52%|█████▏    | 273/526 [01:20<00:50,  5.01it/s, est. speed input: 6352.89 toks/s, output: 539.81 toks/s]
Processed prompts:  52%|█████▏    | 275/526 [01:20<00:53,  4.72it/s, est. speed input: 6360.36 toks/s, output: 539.77 toks/s]
Processed prompts:  52%|█████▏    | 276/526 [01:21<00:49,  5.04it/s, est. speed input: 6368.45 toks/s, output: 540.57 toks/s]
Processed prompts:  53%|█████▎    | 281/526 [01:21<00:24,  9.84it/s, est. speed input: 6480.46 toks/s, output: 548.23 toks/s]
Processed prompts:  54%|█████▍    | 283/526 [01:21<00:22, 10.71it/s, est. speed input: 6510.27 toks/s, output: 550.82 toks/s]
Processed prompts:  54%|█████▍    | 285/526 [01:21<00:20, 11.52it/s, est. speed input: 6546.46 toks/s, output: 553.75 toks/s]
Processed prompts:  55%|█████▍    | 289/526 [01:21<00:15, 15.58it/s, est. speed input: 6616.70 toks/s, output: 559.88 toks/s]
Processed prompts:  56%|█████▌    | 294/526 [01:21<00:11, 20.84it/s, est. speed input: 6710.40 toks/s, output: 567.01 toks/s]
Processed prompts:  56%|█████▋    | 297/526 [01:21<00:10, 21.31it/s, est. speed input: 6820.97 toks/s, output: 571.71 toks/s]
Processed prompts:  57%|█████▋    | 300/526 [01:22<00:10, 21.71it/s, est. speed input: 6880.86 toks/s, output: 575.84 toks/s]
Processed prompts:  58%|█████▊    | 303/526 [01:22<00:10, 22.10it/s, est. speed input: 6964.15 toks/s, output: 580.11 toks/s]
Processed prompts:  59%|█████▊    | 309/526 [01:22<00:07, 28.97it/s, est. speed input: 7111.91 toks/s, output: 589.91 toks/s]
Processed prompts:  60%|█████▉    | 315/526 [01:22<00:06, 34.60it/s, est. speed input: 7259.89 toks/s, output: 600.54 toks/s]
Processed prompts:  61%|██████    | 321/526 [01:22<00:05, 39.01it/s, est. speed input: 7433.69 toks/s, output: 611.21 toks/s]
Processed prompts:  62%|██████▏   | 328/526 [01:22<00:04, 44.95it/s, est. speed input: 7604.68 toks/s, output: 623.35 toks/s]
Processed prompts:  63%|██████▎   | 333/526 [01:22<00:04, 44.70it/s, est. speed input: 7794.38 toks/s, output: 633.45 toks/s]
Processed prompts:  64%|██████▍   | 338/526 [01:22<00:04, 44.88it/s, est. speed input: 7938.72 toks/s, output: 644.48 toks/s]
Processed prompts:  65%|██████▌   | 343/526 [01:23<00:04, 45.21it/s, est. speed input: 8051.42 toks/s, output: 652.40 toks/s]
Processed prompts:  66%|██████▌   | 348/526 [01:23<00:03, 45.70it/s, est. speed input: 8222.02 toks/s, output: 661.32 toks/s]
Processed prompts:  67%|██████▋   | 354/526 [01:23<00:03, 43.09it/s, est. speed input: 8362.84 toks/s, output: 671.29 toks/s]
Processed prompts:  68%|██████▊   | 359/526 [01:23<00:03, 44.63it/s, est. speed input: 8479.79 toks/s, output: 680.19 toks/s]
Processed prompts:  70%|██████▉   | 368/526 [01:23<00:03, 50.13it/s, est. speed input: 8679.66 toks/s, output: 695.31 toks/s]
Processed prompts:  72%|███████▏  | 377/526 [01:23<00:02, 54.05it/s, est. speed input: 8920.49 toks/s, output: 713.09 toks/s]
Processed prompts:  73%|███████▎  | 383/526 [01:23<00:03, 45.80it/s, est. speed input: 9063.33 toks/s, output: 724.47 toks/s]
Processed prompts:  75%|███████▌  | 397/526 [01:24<00:02, 61.92it/s, est. speed input: 9412.69 toks/s, output: 751.42 toks/s]
Processed prompts:  77%|███████▋  | 404/526 [01:24<00:02, 60.72it/s, est. speed input: 9584.87 toks/s, output: 764.06 toks/s]
Processed prompts:  78%|███████▊  | 411/526 [01:24<00:02, 55.54it/s, est. speed input: 9746.05 toks/s, output: 776.39 toks/s]
Processed prompts:  79%|███████▉  | 418/526 [01:24<00:01, 57.17it/s, est. speed input: 9924.87 toks/s, output: 789.20 toks/s]
Processed prompts:  81%|████████  | 425/526 [01:24<00:01, 59.23it/s, est. speed input: 10088.64 toks/s, output: 802.27 toks/s]
Processed prompts:  82%|████████▏ | 433/526 [01:24<00:01, 63.94it/s, est. speed input: 10295.36 toks/s, output: 817.84 toks/s]
Processed prompts:  84%|████████▍ | 442/526 [01:24<00:01, 60.69it/s, est. speed input: 10520.16 toks/s, output: 835.83 toks/s]
Processed prompts:  86%|████████▌ | 452/526 [01:24<00:01, 58.44it/s, est. speed input: 10732.54 toks/s, output: 854.47 toks/s]
Processed prompts:  88%|████████▊ | 461/526 [01:25<00:01, 63.11it/s, est. speed input: 10980.40 toks/s, output: 873.45 toks/s]
Processed prompts:  89%|████████▉ | 468/526 [01:25<00:00, 59.69it/s, est. speed input: 11083.85 toks/s, output: 886.90 toks/s]
Processed prompts:  90%|█████████ | 475/526 [01:25<00:01, 49.27it/s, est. speed input: 11250.71 toks/s, output: 900.63 toks/s]
Processed prompts:  91%|█████████▏| 481/526 [01:25<00:01, 40.92it/s, est. speed input: 11398.86 toks/s, output: 910.67 toks/s]
Processed prompts:  92%|█████████▏| 486/526 [01:25<00:01, 33.81it/s, est. speed input: 11493.61 toks/s, output: 919.07 toks/s]
Processed prompts:  93%|█████████▎| 490/526 [01:26<00:01, 29.88it/s, est. speed input: 11567.17 toks/s, output: 924.25 toks/s]
Processed prompts:  94%|█████████▍| 494/526 [01:26<00:01, 30.37it/s, est. speed input: 11647.31 toks/s, output: 930.18 toks/s]
Processed prompts:  95%|█████████▍| 498/526 [01:26<00:01, 24.25it/s, est. speed input: 11697.77 toks/s, output: 936.21 toks/s]
Processed prompts:  95%|█████████▌| 502/526 [01:26<00:00, 26.51it/s, est. speed input: 11791.40 toks/s, output: 943.40 toks/s]
Processed prompts:  96%|█████████▌| 505/526 [01:26<00:00, 26.86it/s, est. speed input: 11879.59 toks/s, output: 949.72 toks/s]
Processed prompts:  97%|█████████▋| 508/526 [01:26<00:00, 23.74it/s, est. speed input: 11951.47 toks/s, output: 954.40 toks/s]
Processed prompts:  97%|█████████▋| 511/526 [01:27<00:00, 21.82it/s, est. speed input: 11989.05 toks/s, output: 960.39 toks/s]
Processed prompts:  98%|█████████▊| 514/526 [01:27<00:01,  9.49it/s, est. speed input: 11946.90 toks/s, output: 964.38 toks/s]
Processed prompts:  98%|█████████▊| 517/526 [01:27<00:00, 10.91it/s, est. speed input: 12039.92 toks/s, output: 974.01 toks/s]
Processed prompts:  99%|█████████▊| 519/526 [01:28<00:01,  6.51it/s, est. speed input: 11992.44 toks/s, output: 974.05 toks/s]
Processed prompts:  99%|█████████▉| 522/526 [01:29<00:00,  7.07it/s, est. speed input: 12040.17 toks/s, output: 982.64 toks/s]
Processed prompts: 100%|█████████▉| 524/526 [01:29<00:00,  6.61it/s, est. speed input: 12062.02 toks/s, output: 987.26 toks/s]
Processed prompts: 100%|█████████▉| 525/526 [01:29<00:00,  6.77it/s, est. speed input: 12071.87 toks/s, output: 990.16 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:30<00:00,  4.29it/s, est. speed input: 12011.91 toks/s, output: 987.55 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:30<00:00,  5.83it/s, est. speed input: 12011.91 toks/s, output: 987.55 toks/s]
{  "personalized_answer": "It sounds like you're dealing with a challenging situation where teams are deliberately making their negligence hard to document. Given your experience with rogue teams in your company, it seems your company might be facing some systemic issues in how it handles and tracks performance. While it's not uncommon for large companies to have teams that operate in silos or have their own agendas, the deliberate obfuscation of issues is concerning. Here are a few strategies you might consider:\n\n1. **Seek Support from Higher Management:** Since you mentioned that the executive staff has a high approval rating, consider escalating the issue to them. Provide them with detailed documentation and evidence of the issues, and suggest potential solutions.\n\n2. **Implement Clearer Processes:** Work with HR or a process improvement team to establish clearer, more transparent processes for documenting and tracking team performance. This could include regular check-ins, performance reviews, and standardized reporting mechanisms.\n\n3. **Encourage Open Communication:** Foster an environment where team members feel comfortable discussing issues openly. This might involve team-building activities or regular town hall meetings where everyone can voice concerns.\n\n4. **Use Data and Metrics:** Leverage data and metrics to track progress and performance. This can help make it harder for teams to hide their negligence. Ensure that key performance indicators (KPIs) are well-defined and regularly reviewed.\n\n5. **Consider a Cross-Functional Review Team:** Establish a cross-functional review team that can independently assess the performance of these teams. This team can provide an unbiased perspective and help identify areas for improvement.\n\nGiven your experience, it might be worth evaluating whether your company is indeed "healthy" from a systemic perspective. If you find that the issues are widespread, it might be a sign that the company needs to invest more in leadership development and organizational culture."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.94s/it, est. speed input: 668.84 toks/s, output: 79.73 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.94s/it, est. speed input: 668.84 toks/s, output: 79.73 toks/s]
[rank0]:[W715 11:00:16.149076848 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/lp_rag_full_profile_test_10_limit_2_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 11:00:20.283466_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 11:00:20.283466_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 11:00:20.283466_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<02:59,  2.36it/s]
  0%|          | 2/424 [00:01<05:05,  1.38it/s]
  1%|          | 3/424 [00:01<03:06,  2.25it/s]
  1%|          | 4/424 [00:03<06:39,  1.05it/s]
  1%|          | 5/424 [00:03<04:57,  1.41it/s]
  1%|▏         | 6/424 [00:03<03:30,  1.99it/s]
  2%|▏         | 7/424 [00:04<04:32,  1.53it/s]
  2%|▏         | 8/424 [00:05<04:36,  1.50it/s]
  2%|▏         | 9/424 [00:05<03:27,  2.00it/s]
  2%|▏         | 10/424 [00:05<03:00,  2.30it/s]
  3%|▎         | 11/424 [00:05<02:24,  2.86it/s]
  3%|▎         | 12/424 [00:06<02:21,  2.92it/s]
  3%|▎         | 13/424 [00:08<05:31,  1.24it/s]
  3%|▎         | 14/424 [00:08<04:12,  1.62it/s]
  4%|▎         | 15/424 [00:08<03:23,  2.01it/s]
  4%|▍         | 16/424 [00:09<03:35,  1.89it/s]
  4%|▍         | 17/424 [00:09<03:06,  2.18it/s]
  4%|▍         | 18/424 [00:09<02:42,  2.50it/s]
  4%|▍         | 19/424 [00:10<03:08,  2.15it/s]
  5%|▍         | 20/424 [00:10<02:33,  2.64it/s]
  5%|▍         | 21/424 [00:10<02:04,  3.23it/s]
  5%|▌         | 22/424 [00:11<02:46,  2.41it/s]
  5%|▌         | 23/424 [00:12<05:00,  1.34it/s]
  6%|▌         | 24/424 [00:13<04:48,  1.38it/s]
  6%|▌         | 25/424 [00:14<05:21,  1.24it/s]
  6%|▌         | 26/424 [00:14<04:59,  1.33it/s]
  6%|▋         | 27/424 [00:16<06:57,  1.05s/it]
  7%|▋         | 28/424 [00:17<06:08,  1.08it/s]
  7%|▋         | 29/424 [00:17<04:51,  1.36it/s]
  7%|▋         | 30/424 [00:17<03:50,  1.71it/s]
  7%|▋         | 31/424 [00:18<03:55,  1.67it/s]
  8%|▊         | 33/424 [00:18<02:20,  2.77it/s]
  8%|▊         | 34/424 [00:18<02:13,  2.93it/s]
  8%|▊         | 36/424 [00:19<01:28,  4.36it/s]
  9%|▊         | 37/424 [00:19<02:16,  2.83it/s]
  9%|▉         | 38/424 [00:20<02:11,  2.95it/s]
  9%|▉         | 40/424 [00:20<01:38,  3.90it/s]
 10%|▉         | 41/424 [00:20<01:37,  3.91it/s]
 10%|▉         | 42/424 [00:21<02:13,  2.86it/s]
 10%|█         | 43/424 [00:21<01:55,  3.29it/s]
 10%|█         | 44/424 [00:23<04:19,  1.46it/s]
 11%|█         | 45/424 [00:23<04:17,  1.47it/s]
 11%|█         | 46/424 [00:24<03:33,  1.77it/s]
 11%|█         | 47/424 [00:24<03:42,  1.69it/s]
 11%|█▏        | 48/424 [00:25<03:50,  1.63it/s]
 12%|█▏        | 49/424 [00:26<03:51,  1.62it/s]
 12%|█▏        | 51/424 [00:26<03:04,  2.03it/s]
 12%|█▏        | 52/424 [00:27<03:02,  2.04it/s]
 12%|█▎        | 53/424 [00:27<03:14,  1.91it/s]
 13%|█▎        | 54/424 [00:28<03:52,  1.59it/s]
 13%|█▎        | 55/424 [00:29<03:15,  1.89it/s]
 13%|█▎        | 56/424 [00:29<03:29,  1.76it/s]
 14%|█▎        | 58/424 [00:29<02:08,  2.84it/s]
 14%|█▍        | 59/424 [00:31<04:13,  1.44it/s]
 15%|█▍        | 62/424 [00:35<05:43,  1.05it/s]
 15%|█▍        | 63/424 [00:35<05:22,  1.12it/s]
 15%|█▌        | 64/424 [00:36<04:34,  1.31it/s]
 15%|█▌        | 65/424 [00:36<03:37,  1.65it/s]
 16%|█▌        | 66/424 [00:38<05:18,  1.13it/s]
 16%|█▌        | 67/424 [00:38<04:13,  1.41it/s]
 16%|█▌        | 68/424 [00:38<04:01,  1.48it/s]
 16%|█▋        | 69/424 [00:40<05:41,  1.04it/s]
 17%|█▋        | 70/424 [00:40<04:37,  1.27it/s]
 17%|█▋        | 71/424 [00:41<03:53,  1.51it/s]
 17%|█▋        | 72/424 [00:41<03:24,  1.72it/s]
 17%|█▋        | 73/424 [00:42<03:00,  1.94it/s]
 17%|█▋        | 74/424 [00:42<02:42,  2.15it/s]
 18%|█▊        | 75/424 [00:44<05:28,  1.06it/s]
 18%|█▊        | 77/424 [00:44<03:30,  1.65it/s]
 18%|█▊        | 78/424 [00:45<02:50,  2.03it/s]
 19%|█▊        | 79/424 [00:45<02:14,  2.56it/s]
 19%|█▉        | 80/424 [00:45<01:47,  3.20it/s]
 19%|█▉        | 81/424 [00:46<02:44,  2.09it/s]
 19%|█▉        | 82/424 [00:46<03:17,  1.73it/s]
 20%|█▉        | 83/424 [00:47<04:01,  1.41it/s]
 20%|█▉        | 84/424 [00:48<03:01,  1.87it/s]
 20%|██        | 85/424 [00:49<03:51,  1.47it/s]
 20%|██        | 86/424 [00:50<04:18,  1.31it/s]
 21%|██        | 87/424 [00:51<04:50,  1.16it/s]
 21%|██        | 88/424 [00:51<04:06,  1.36it/s]
 21%|██        | 89/424 [00:52<04:34,  1.22it/s]
 21%|██        | 90/424 [00:52<03:38,  1.53it/s]
 21%|██▏       | 91/424 [00:54<04:22,  1.27it/s]
 22%|██▏       | 92/424 [00:55<04:48,  1.15it/s]
 22%|██▏       | 93/424 [00:55<04:27,  1.24it/s]
 22%|██▏       | 94/424 [00:56<05:02,  1.09it/s]
 22%|██▏       | 95/424 [00:57<03:49,  1.43it/s]
 23%|██▎       | 96/424 [00:57<03:17,  1.66it/s]
 23%|██▎       | 98/424 [00:57<02:02,  2.65it/s]
 23%|██▎       | 99/424 [00:57<01:45,  3.08it/s]
 24%|██▎       | 100/424 [00:58<02:11,  2.47it/s]
 24%|██▍       | 101/424 [00:59<03:36,  1.49it/s]
 24%|██▍       | 102/424 [01:00<03:07,  1.72it/s]
 24%|██▍       | 103/424 [01:00<02:35,  2.07it/s]
 25%|██▍       | 104/424 [01:00<02:06,  2.53it/s]
 25%|██▍       | 105/424 [01:01<02:32,  2.09it/s]
 25%|██▌       | 106/424 [01:01<01:58,  2.68it/s]
 25%|██▌       | 107/424 [01:02<02:28,  2.14it/s]
 26%|██▌       | 109/424 [01:06<06:07,  1.17s/it]
 26%|██▌       | 110/424 [01:07<06:52,  1.31s/it]
 26%|██▌       | 111/424 [01:08<05:48,  1.11s/it]
 26%|██▋       | 112/424 [01:08<04:24,  1.18it/s]
 27%|██▋       | 114/424 [01:08<02:37,  1.97it/s]
 27%|██▋       | 116/424 [01:08<01:49,  2.82it/s]
 28%|██▊       | 117/424 [01:09<01:32,  3.32it/s]
 28%|██▊       | 118/424 [01:09<01:23,  3.65it/s]
 28%|██▊       | 119/424 [01:09<01:17,  3.93it/s]
 28%|██▊       | 120/424 [01:09<01:05,  4.67it/s]
 29%|██▊       | 121/424 [01:09<01:01,  4.92it/s]
 29%|██▉       | 122/424 [01:16<10:41,  2.13s/it]
 29%|██▉       | 123/424 [01:23<18:03,  3.60s/it]
 29%|██▉       | 124/424 [01:31<23:00,  4.60s/it]
 29%|██▉       | 125/424 [01:38<26:31,  5.32s/it]
 30%|██▉       | 126/424 [01:45<29:06,  5.86s/it]
 30%|██▉       | 127/424 [01:52<30:57,  6.26s/it]
 30%|███       | 128/424 [01:53<23:13,  4.71s/it]
 30%|███       | 129/424 [01:54<17:38,  3.59s/it]
 31%|███       | 130/424 [01:55<13:42,  2.80s/it]
 31%|███       | 131/424 [01:56<11:03,  2.27s/it]
 31%|███       | 132/424 [01:56<08:33,  1.76s/it]
 31%|███▏      | 133/424 [01:57<06:58,  1.44s/it]
 32%|███▏      | 134/424 [01:57<05:02,  1.04s/it]
 32%|███▏      | 135/424 [01:57<03:46,  1.27it/s]
 32%|███▏      | 136/424 [01:58<02:54,  1.65it/s]
 32%|███▏      | 137/424 [01:58<02:18,  2.07it/s]
 33%|███▎      | 138/424 [01:58<01:52,  2.55it/s]
 33%|███▎      | 139/424 [01:58<01:34,  3.03it/s]
 33%|███▎      | 140/424 [01:58<01:15,  3.75it/s]
 33%|███▎      | 141/424 [01:59<01:07,  4.16it/s]
 33%|███▎      | 142/424 [01:59<01:03,  4.41it/s]
 34%|███▎      | 143/424 [01:59<01:00,  4.64it/s]
 34%|███▍      | 144/424 [01:59<00:58,  4.81it/s]
 34%|███▍      | 145/424 [01:59<00:55,  5.05it/s]
 34%|███▍      | 146/424 [01:59<00:53,  5.18it/s]
 35%|███▍      | 147/424 [02:00<00:52,  5.24it/s]
 35%|███▍      | 148/424 [02:00<00:52,  5.26it/s]
 35%|███▌      | 149/424 [02:00<00:52,  5.28it/s]
 35%|███▌      | 150/424 [02:00<00:52,  5.25it/s]
 36%|███▌      | 151/424 [02:00<00:52,  5.22it/s]
 36%|███▌      | 152/424 [02:01<00:51,  5.26it/s]
 36%|███▌      | 153/424 [02:01<00:51,  5.28it/s]
 36%|███▋      | 154/424 [02:01<00:50,  5.32it/s]
 37%|███▋      | 155/424 [02:01<00:50,  5.34it/s]
 37%|███▋      | 156/424 [02:01<00:50,  5.33it/s]
 37%|███▋      | 157/424 [02:02<00:50,  5.33it/s]
 37%|███▋      | 158/424 [02:02<00:49,  5.32it/s]
 38%|███▊      | 159/424 [02:02<00:50,  5.21it/s]
 38%|███▊      | 160/424 [02:04<03:04,  1.43it/s]
 38%|███▊      | 161/424 [02:04<02:23,  1.83it/s]
 38%|███▊      | 162/424 [02:04<01:55,  2.27it/s]
 38%|███▊      | 163/424 [02:04<01:34,  2.76it/s]
 39%|███▊      | 164/424 [02:05<01:22,  3.17it/s]
 39%|███▉      | 165/424 [02:05<01:11,  3.61it/s]
 39%|███▉      | 166/424 [02:05<00:59,  4.33it/s]
 39%|███▉      | 167/424 [02:05<00:56,  4.55it/s]
 40%|███▉      | 168/424 [02:05<01:03,  4.01it/s]
 40%|███▉      | 169/424 [02:06<01:11,  3.58it/s]
 40%|████      | 170/424 [02:06<01:14,  3.43it/s]
 40%|████      | 171/424 [02:06<01:25,  2.98it/s]
 41%|████      | 172/424 [02:07<01:09,  3.64it/s]
 41%|████      | 174/424 [02:08<01:31,  2.74it/s]
 41%|████▏     | 175/424 [02:08<01:15,  3.30it/s]
 42%|████▏     | 176/424 [02:08<01:06,  3.75it/s]
 42%|████▏     | 177/424 [02:08<00:59,  4.12it/s]
 42%|████▏     | 178/424 [02:08<01:06,  3.69it/s]
 42%|████▏     | 179/424 [02:09<01:05,  3.72it/s]
 42%|████▏     | 180/424 [02:09<01:17,  3.14it/s]
 43%|████▎     | 181/424 [02:09<01:05,  3.68it/s]
 43%|████▎     | 182/424 [02:09<01:02,  3.88it/s]
 43%|████▎     | 183/424 [02:10<01:00,  3.98it/s]
 43%|████▎     | 184/424 [02:10<01:21,  2.94it/s]
 44%|████▎     | 185/424 [02:11<01:42,  2.33it/s]
 44%|████▍     | 186/424 [02:11<01:47,  2.21it/s]
 44%|████▍     | 187/424 [02:12<01:41,  2.33it/s]
 44%|████▍     | 188/424 [02:12<01:39,  2.37it/s]
 45%|████▍     | 189/424 [02:14<03:06,  1.26it/s]
 45%|████▍     | 190/424 [02:18<07:10,  1.84s/it]
 45%|████▌     | 191/424 [02:19<05:29,  1.42s/it]
 45%|████▌     | 192/424 [02:20<05:49,  1.51s/it]
 46%|████▌     | 194/424 [02:21<03:32,  1.08it/s]
 46%|████▌     | 196/424 [02:21<02:35,  1.46it/s]
 46%|████▋     | 197/424 [02:22<02:19,  1.63it/s]
 47%|████▋     | 198/424 [02:22<01:56,  1.93it/s]
 47%|████▋     | 199/424 [02:23<02:12,  1.70it/s]
 47%|████▋     | 200/424 [02:23<01:50,  2.03it/s]
 47%|████▋     | 201/424 [02:25<03:03,  1.21it/s]
 48%|████▊     | 202/424 [02:25<02:23,  1.55it/s]
 48%|████▊     | 203/424 [02:27<03:33,  1.03it/s]
 48%|████▊     | 204/424 [02:30<06:05,  1.66s/it]
 48%|████▊     | 205/424 [02:31<04:52,  1.34s/it]
 49%|████▊     | 206/424 [02:34<06:51,  1.89s/it]
 49%|████▉     | 207/424 [02:34<05:06,  1.41s/it]
 49%|████▉     | 208/424 [02:34<03:55,  1.09s/it]
 49%|████▉     | 209/424 [02:35<02:56,  1.22it/s]
 50%|████▉     | 210/424 [02:35<02:23,  1.49it/s]
 50%|████▉     | 211/424 [02:35<01:48,  1.97it/s]
 50%|█████     | 213/424 [02:36<01:28,  2.39it/s]
 50%|█████     | 214/424 [02:36<01:36,  2.19it/s]
 51%|█████     | 215/424 [02:37<01:59,  1.76it/s]
 51%|█████     | 216/424 [02:37<01:35,  2.18it/s]
 51%|█████     | 217/424 [02:37<01:21,  2.53it/s]
 51%|█████▏    | 218/424 [02:38<01:16,  2.69it/s]
 52%|█████▏    | 219/424 [02:38<01:10,  2.93it/s]
 52%|█████▏    | 220/424 [02:39<01:42,  2.00it/s]
 52%|█████▏    | 221/424 [02:39<01:32,  2.20it/s]
 52%|█████▏    | 222/424 [02:40<01:24,  2.40it/s]
 53%|█████▎    | 223/424 [02:40<01:19,  2.53it/s]
 53%|█████▎    | 224/424 [02:40<01:19,  2.53it/s]
 53%|█████▎    | 225/424 [02:42<02:33,  1.30it/s]
 54%|█████▎    | 227/424 [02:42<01:41,  1.94it/s]
 54%|█████▍    | 229/424 [02:43<01:09,  2.81it/s]
 54%|█████▍    | 230/424 [02:46<03:18,  1.02s/it]
 54%|█████▍    | 231/424 [02:47<02:55,  1.10it/s]
 55%|█████▍    | 232/424 [02:47<02:15,  1.42it/s]
 55%|█████▍    | 233/424 [02:48<03:07,  1.02it/s]
 55%|█████▌    | 234/424 [02:56<08:35,  2.71s/it]
 55%|█████▌    | 235/424 [02:57<07:01,  2.23s/it]
 56%|█████▌    | 236/424 [02:57<05:19,  1.70s/it]
 56%|█████▌    | 238/424 [02:57<03:00,  1.03it/s]
 57%|█████▋    | 240/424 [02:59<02:52,  1.06it/s]
 57%|█████▋    | 241/424 [03:00<02:53,  1.06it/s]
 57%|█████▋    | 242/424 [03:00<02:17,  1.32it/s]
 57%|█████▋    | 243/424 [03:01<02:00,  1.50it/s]
 58%|█████▊    | 244/424 [03:01<02:02,  1.47it/s]
 58%|█████▊    | 245/424 [03:01<01:34,  1.89it/s]
 58%|█████▊    | 246/424 [03:02<01:26,  2.05it/s]
 58%|█████▊    | 247/424 [03:03<02:28,  1.19it/s]
 58%|█████▊    | 248/424 [03:04<01:50,  1.59it/s]
 59%|█████▊    | 249/424 [03:04<01:24,  2.06it/s]
 59%|█████▉    | 250/424 [03:04<01:35,  1.83it/s]
 59%|█████▉    | 251/424 [03:05<01:15,  2.29it/s]
 59%|█████▉    | 252/424 [03:05<00:59,  2.88it/s]
 60%|█████▉    | 253/424 [03:05<00:50,  3.42it/s]
 60%|█████▉    | 254/424 [03:05<00:40,  4.15it/s]
 60%|██████    | 255/424 [03:05<00:34,  4.95it/s]
 60%|██████    | 256/424 [03:05<00:30,  5.46it/s]
 61%|██████    | 257/424 [03:05<00:27,  6.03it/s]
 61%|██████    | 258/424 [03:06<00:25,  6.54it/s]
 61%|██████    | 259/424 [03:06<00:33,  4.96it/s]
 61%|██████▏   | 260/424 [03:07<01:11,  2.29it/s]
 62%|██████▏   | 261/424 [03:07<00:57,  2.86it/s]
 62%|██████▏   | 263/424 [03:08<01:11,  2.25it/s]
 62%|██████▏   | 264/424 [03:08<00:58,  2.72it/s]
 62%|██████▎   | 265/424 [03:08<00:49,  3.24it/s]
 63%|██████▎   | 266/424 [03:09<00:52,  3.02it/s]
 63%|██████▎   | 267/424 [03:09<00:43,  3.62it/s]
 63%|██████▎   | 268/424 [03:09<00:37,  4.15it/s]
 63%|██████▎   | 269/424 [03:10<01:08,  2.27it/s]
 64%|██████▎   | 270/424 [03:10<00:55,  2.79it/s]
 64%|██████▍   | 272/424 [03:10<00:35,  4.31it/s]
 64%|██████▍   | 273/424 [03:10<00:33,  4.44it/s]
 65%|██████▍   | 275/424 [03:11<00:23,  6.30it/s]
 65%|██████▌   | 277/424 [03:11<00:19,  7.59it/s]
 66%|██████▌   | 278/424 [03:11<00:33,  4.30it/s]
 66%|██████▌   | 279/424 [03:12<00:45,  3.19it/s]
 66%|██████▌   | 280/424 [03:12<00:48,  2.96it/s]
 66%|██████▋   | 281/424 [03:13<00:51,  2.76it/s]
 67%|██████▋   | 283/424 [03:16<02:14,  1.05it/s]
 67%|██████▋   | 284/424 [03:16<01:46,  1.31it/s]
 67%|██████▋   | 285/424 [03:17<01:23,  1.67it/s]
 68%|██████▊   | 287/424 [03:17<01:02,  2.19it/s]
 68%|██████▊   | 288/424 [03:17<00:59,  2.29it/s]
 68%|██████▊   | 289/424 [03:18<00:54,  2.48it/s]
 69%|██████▊   | 291/424 [03:18<00:39,  3.39it/s]
 69%|██████▉   | 292/424 [03:18<00:33,  3.98it/s]
 69%|██████▉   | 293/424 [03:22<02:14,  1.03s/it]
 70%|██████▉   | 295/424 [03:22<01:43,  1.25it/s]
 70%|██████▉   | 296/424 [03:23<01:22,  1.54it/s]
 70%|███████   | 297/424 [03:23<01:15,  1.69it/s]
 70%|███████   | 298/424 [03:23<01:03,  1.99it/s]
 71%|███████   | 299/424 [03:23<00:52,  2.40it/s]
 71%|███████   | 301/424 [03:24<00:38,  3.23it/s]
 71%|███████   | 302/424 [03:31<03:53,  1.91s/it]
 71%|███████▏  | 303/424 [03:31<03:05,  1.53s/it]
 72%|███████▏  | 304/424 [03:31<02:20,  1.17s/it]
 72%|███████▏  | 305/424 [03:32<01:53,  1.05it/s]
 72%|███████▏  | 306/424 [03:32<01:34,  1.25it/s]
 72%|███████▏  | 307/424 [03:32<01:10,  1.66it/s]
 73%|███████▎  | 308/424 [03:33<00:58,  1.97it/s]
 73%|███████▎  | 309/424 [03:33<00:59,  1.93it/s]
 73%|███████▎  | 310/424 [03:34<01:17,  1.48it/s]
 73%|███████▎  | 311/424 [03:34<00:57,  1.98it/s]
 74%|███████▎  | 312/424 [03:35<00:45,  2.44it/s]
 74%|███████▍  | 313/424 [03:35<00:39,  2.80it/s]
 74%|███████▍  | 314/424 [03:35<00:41,  2.63it/s]
 74%|███████▍  | 315/424 [03:37<01:14,  1.47it/s]
 75%|███████▍  | 316/424 [03:37<00:56,  1.92it/s]
 75%|███████▍  | 317/424 [03:38<01:23,  1.28it/s]
 75%|███████▌  | 318/424 [03:39<01:40,  1.05it/s]
 75%|███████▌  | 319/424 [03:40<01:20,  1.30it/s]
 75%|███████▌  | 320/424 [03:40<01:02,  1.67it/s]
 76%|███████▌  | 321/424 [03:40<00:46,  2.22it/s]
 76%|███████▌  | 323/424 [03:40<00:30,  3.29it/s]
 76%|███████▋  | 324/424 [03:41<00:27,  3.67it/s]
 77%|███████▋  | 325/424 [03:41<00:24,  4.03it/s]
 77%|███████▋  | 326/424 [03:48<03:24,  2.09s/it]
 77%|███████▋  | 327/424 [03:49<03:04,  1.90s/it]
 77%|███████▋  | 328/424 [03:50<02:32,  1.59s/it]
 78%|███████▊  | 329/424 [03:50<01:58,  1.25s/it]
 78%|███████▊  | 330/424 [03:52<02:00,  1.28s/it]
 78%|███████▊  | 331/424 [03:52<01:27,  1.06it/s]
 79%|███████▊  | 333/424 [03:53<01:19,  1.14it/s]
 79%|███████▉  | 334/424 [03:54<01:08,  1.32it/s]
 79%|███████▉  | 335/424 [03:55<01:05,  1.37it/s]
 79%|███████▉  | 336/424 [03:57<01:35,  1.09s/it]
 79%|███████▉  | 337/424 [04:04<03:58,  2.74s/it]
 80%|███████▉  | 338/424 [04:04<03:03,  2.13s/it]
 80%|███████▉  | 339/424 [04:05<02:32,  1.79s/it]
 80%|████████  | 340/424 [04:12<04:41,  3.35s/it]
 80%|████████  | 341/424 [04:14<03:58,  2.87s/it]
 81%|████████  | 342/424 [04:16<03:27,  2.53s/it]
 81%|████████  | 343/424 [04:16<02:28,  1.83s/it]
 81%|████████  | 344/424 [04:17<02:00,  1.50s/it]
 81%|████████▏ | 345/424 [04:17<01:25,  1.09s/it]
 82%|████████▏ | 346/424 [04:17<01:09,  1.13it/s]
 82%|████████▏ | 347/424 [04:18<01:05,  1.18it/s]
 82%|████████▏ | 349/424 [04:18<00:37,  2.03it/s]
 83%|████████▎ | 350/424 [04:19<00:42,  1.73it/s]
 83%|████████▎ | 351/424 [04:19<00:33,  2.18it/s]
 83%|████████▎ | 352/424 [04:26<02:43,  2.27s/it]
 83%|████████▎ | 353/424 [04:27<02:07,  1.80s/it]
 83%|████████▎ | 354/424 [04:28<01:51,  1.60s/it]
 84%|████████▎ | 355/424 [04:28<01:21,  1.18s/it]
 84%|████████▍ | 356/424 [04:30<01:31,  1.34s/it]
 84%|████████▍ | 357/424 [04:31<01:22,  1.24s/it]
 84%|████████▍ | 358/424 [04:32<01:19,  1.20s/it]
 85%|████████▍ | 359/424 [04:33<01:15,  1.16s/it]
 85%|████████▍ | 360/424 [04:33<00:56,  1.13it/s]
 85%|████████▌ | 361/424 [04:33<00:43,  1.46it/s]
 85%|████████▌ | 362/424 [04:34<00:36,  1.69it/s]
 86%|████████▌ | 363/424 [04:41<02:33,  2.51s/it]
 86%|████████▌ | 364/424 [04:41<01:52,  1.88s/it]
 86%|████████▌ | 365/424 [04:41<01:21,  1.38s/it]
 86%|████████▋ | 366/424 [04:41<00:57,  1.00it/s]
 87%|████████▋ | 367/424 [04:42<00:41,  1.36it/s]
 87%|████████▋ | 368/424 [04:49<02:27,  2.63s/it]
 87%|████████▋ | 369/424 [04:49<01:47,  1.95s/it]
 87%|████████▋ | 370/424 [04:49<01:16,  1.42s/it]
 88%|████████▊ | 372/424 [04:49<00:42,  1.22it/s]
 88%|████████▊ | 373/424 [04:50<00:34,  1.47it/s]
 88%|████████▊ | 374/424 [04:51<00:38,  1.30it/s]
 89%|████████▊ | 376/424 [04:51<00:29,  1.65it/s]
 89%|████████▉ | 377/424 [04:53<00:36,  1.29it/s]
 89%|████████▉ | 378/424 [04:53<00:28,  1.60it/s]
 89%|████████▉ | 379/424 [04:54<00:27,  1.62it/s]
 90%|████████▉ | 380/424 [04:55<00:39,  1.12it/s]
 90%|█████████ | 382/424 [04:57<00:35,  1.20it/s]
 91%|█████████ | 384/424 [04:57<00:22,  1.76it/s]
 91%|█████████ | 385/424 [04:57<00:19,  2.04it/s]
 91%|█████████▏| 387/424 [04:57<00:12,  3.07it/s]
 92%|█████████▏| 388/424 [04:58<00:14,  2.56it/s]
 92%|█████████▏| 389/424 [05:02<00:46,  1.33s/it]
 92%|█████████▏| 390/424 [05:03<00:35,  1.05s/it]
 92%|█████████▏| 391/424 [05:03<00:26,  1.23it/s]
 92%|█████████▏| 392/424 [05:03<00:20,  1.58it/s]
 93%|█████████▎| 393/424 [05:04<00:20,  1.51it/s]
 93%|█████████▎| 394/424 [05:04<00:20,  1.49it/s]
 93%|█████████▎| 395/424 [05:06<00:28,  1.02it/s]
 93%|█████████▎| 396/424 [05:07<00:27,  1.01it/s]
 94%|█████████▎| 397/424 [05:08<00:29,  1.09s/it]
 94%|█████████▍| 398/424 [05:10<00:30,  1.16s/it]
 94%|█████████▍| 399/424 [05:10<00:23,  1.08it/s]
 94%|█████████▍| 400/424 [05:11<00:20,  1.20it/s]
 95%|█████████▍| 401/424 [05:11<00:15,  1.51it/s]
 95%|█████████▍| 402/424 [05:15<00:34,  1.56s/it]
 95%|█████████▌| 403/424 [05:17<00:39,  1.89s/it]
 95%|█████████▌| 404/424 [05:17<00:27,  1.39s/it]
 96%|█████████▌| 405/424 [05:18<00:20,  1.10s/it]
 96%|█████████▌| 406/424 [05:18<00:14,  1.24it/s]
 96%|█████████▌| 407/424 [05:19<00:16,  1.04it/s]
 96%|█████████▌| 408/424 [05:20<00:16,  1.01s/it]
 96%|█████████▋| 409/424 [05:23<00:22,  1.50s/it]
 97%|█████████▋| 410/424 [05:23<00:16,  1.15s/it]
 97%|█████████▋| 411/424 [05:24<00:14,  1.10s/it]
 97%|█████████▋| 412/424 [05:25<00:09,  1.22it/s]
 97%|█████████▋| 413/424 [05:26<00:12,  1.09s/it]
 98%|█████████▊| 415/424 [05:28<00:08,  1.03it/s]
 98%|█████████▊| 416/424 [05:29<00:07,  1.11it/s]
 98%|█████████▊| 417/424 [05:29<00:05,  1.20it/s]
 99%|█████████▊| 418/424 [05:34<00:10,  1.81s/it]
 99%|█████████▉| 419/424 [05:34<00:07,  1.49s/it]
 99%|█████████▉| 420/424 [05:36<00:06,  1.56s/it]
 99%|█████████▉| 421/424 [05:37<00:04,  1.40s/it]
100%|█████████▉| 422/424 [05:37<00:02,  1.04s/it]
100%|█████████▉| 423/424 [05:42<00:01,  1.98s/it]
100%|██████████| 424/424 [05:43<00:00,  1.73s/it]
100%|██████████| 424/424 [05:43<00:00,  1.24it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 11:00:20.283466_sc_processed_test.json', '--output_addr', 'data/out/rag/full_profile/sc_rag_full_profile_test_10_limit_2_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.82 examples/s]
Generating train split: 424 examples [00:00, 1583.96 examples/s]
INFO 07-15 11:06:33 config.py:510] This model supports multiple tasks: {'embed', 'classify', 'reward', 'generate', 'score'}. Defaulting to 'generate'.
INFO 07-15 11:06:33 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 11:06:34 selector.py:120] Using Flash Attention backend.
INFO 07-15 11:06:35 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 11:06:35 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.48it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.40it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.45it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.43it/s]

INFO 07-15 11:06:38 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 11:06:40 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-15 11:06:40 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 11:06:40 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 11:06:41 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 11:06:41 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 11:06:44 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:13,  2.49it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:12,  2.57it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:12,  2.60it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:11,  2.62it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:11,  2.62it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:11,  2.62it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:10,  2.63it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:03<00:10,  2.62it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:09,  2.62it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:09,  2.62it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:04<00:09,  2.63it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:08,  2.63it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:08,  2.64it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:05<00:07,  2.64it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:07,  2.64it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:06<00:07,  2.64it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:06<00:06,  2.66it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:06,  2.67it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:07<00:05,  2.67it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:07<00:05,  2.69it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:05,  2.69it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:08<00:04,  2.71it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:08<00:04,  2.72it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:09<00:04,  2.72it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:09<00:03,  2.73it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:09<00:03,  2.73it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:10<00:02,  2.74it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:10<00:02,  2.73it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:10<00:02,  2.74it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:11<00:01,  2.74it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:11<00:01,  2.74it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:11<00:01,  2.74it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:12<00:00,  2.70it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:12<00:00,  2.72it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:13<00:00,  2.74it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:13<00:00,  2.68it/s]
INFO 07-15 11:06:57 model_runner.py:1535] Graph capturing finished in 13 secs, took 0.22 GiB
INFO 07-15 11:06:57 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 18.25 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:34<4:00:46, 34.15s/it, est. speed input: 50.95 toks/s, output: 1.96 toks/s]
Processed prompts:   0%|          | 2/424 [00:35<1:44:58, 14.93s/it, est. speed input: 99.64 toks/s, output: 4.32 toks/s]
Processed prompts:   1%|          | 3/424 [00:36<59:52,  8.53s/it, est. speed input: 163.74 toks/s, output: 6.92 toks/s] 
Processed prompts:   1%|          | 4/424 [00:36<37:21,  5.34s/it, est. speed input: 206.75 toks/s, output: 9.65 toks/s]
Processed prompts:   1%|          | 5/424 [00:37<24:28,  3.51s/it, est. speed input: 292.53 toks/s, output: 12.43 toks/s]
Processed prompts:   1%|▏         | 6/424 [00:37<17:04,  2.45s/it, est. speed input: 335.33 toks/s, output: 15.25 toks/s]
Processed prompts:   2%|▏         | 8/424 [00:37<09:08,  1.32s/it, est. speed input: 418.31 toks/s, output: 21.03 toks/s]
Processed prompts:   2%|▏         | 9/424 [00:38<06:57,  1.01s/it, est. speed input: 457.53 toks/s, output: 23.96 toks/s]
Processed prompts:   2%|▏         | 10/424 [00:38<05:31,  1.25it/s, est. speed input: 470.79 toks/s, output: 26.80 toks/s]
Processed prompts:   3%|▎         | 11/424 [00:38<04:09,  1.65it/s, est. speed input: 540.80 toks/s, output: 29.75 toks/s]
Processed prompts:   3%|▎         | 12/424 [00:38<03:35,  1.91it/s, est. speed input: 570.49 toks/s, output: 32.56 toks/s]
Processed prompts:   3%|▎         | 13/424 [00:38<02:45,  2.48it/s, est. speed input: 625.19 toks/s, output: 35.53 toks/s]
Processed prompts:   3%|▎         | 14/424 [00:39<02:23,  2.86it/s, est. speed input: 661.20 toks/s, output: 38.40 toks/s]
Processed prompts:   4%|▍         | 16/424 [00:39<01:43,  3.93it/s, est. speed input: 740.44 toks/s, output: 44.30 toks/s]
Processed prompts:   4%|▍         | 17/424 [00:39<01:31,  4.45it/s, est. speed input: 781.60 toks/s, output: 47.27 toks/s]
Processed prompts:   4%|▍         | 18/424 [00:39<01:57,  3.45it/s, est. speed input: 823.52 toks/s, output: 49.83 toks/s]
Processed prompts:   5%|▍         | 20/424 [00:40<01:35,  4.25it/s, est. speed input: 936.26 toks/s, output: 55.69 toks/s]
Processed prompts:   5%|▌         | 23/424 [00:40<01:05,  6.11it/s, est. speed input: 1110.87 toks/s, output: 64.76 toks/s]
Processed prompts:   6%|▌         | 25/424 [00:40<01:13,  5.45it/s, est. speed input: 1192.16 toks/s, output: 70.34 toks/s]
Processed prompts:   6%|▋         | 27/424 [00:41<01:08,  5.82it/s, est. speed input: 1248.75 toks/s, output: 76.19 toks/s]
Processed prompts:   7%|▋         | 31/424 [00:41<00:54,  7.20it/s, est. speed input: 1500.41 toks/s, output: 88.14 toks/s]
Processed prompts:   8%|▊         | 33/424 [00:42<01:05,  6.02it/s, est. speed input: 1612.31 toks/s, output: 93.43 toks/s]
Processed prompts:   8%|▊         | 36/424 [00:42<01:07,  5.79it/s, est. speed input: 1758.14 toks/s, output: 101.65 toks/s]
Processed prompts:  10%|▉         | 41/424 [00:43<01:03,  6.02it/s, est. speed input: 1988.32 toks/s, output: 115.33 toks/s]
Processed prompts:  10%|▉         | 42/424 [00:43<01:00,  6.30it/s, est. speed input: 2050.97 toks/s, output: 118.21 toks/s]
Processed prompts:  11%|█         | 47/424 [00:44<01:00,  6.23it/s, est. speed input: 2193.51 toks/s, output: 131.48 toks/s]
Processed prompts:  12%|█▏        | 50/424 [00:44<01:00,  6.18it/s, est. speed input: 2306.57 toks/s, output: 139.27 toks/s]
Processed prompts:  12%|█▏        | 51/424 [00:45<01:03,  5.87it/s, est. speed input: 2352.20 toks/s, output: 141.64 toks/s]
Processed prompts:  13%|█▎        | 54/424 [00:45<00:54,  6.74it/s, est. speed input: 2486.94 toks/s, output: 149.92 toks/s]
Processed prompts:  13%|█▎        | 56/424 [00:45<00:54,  6.76it/s, est. speed input: 2602.78 toks/s, output: 155.14 toks/s]
Processed prompts:  14%|█▍        | 59/424 [00:46<00:50,  7.16it/s, est. speed input: 2717.81 toks/s, output: 163.15 toks/s]
Processed prompts:  14%|█▍        | 61/424 [00:46<00:51,  7.11it/s, est. speed input: 2801.92 toks/s, output: 168.32 toks/s]
Processed prompts:  16%|█▌        | 68/424 [00:47<00:51,  6.93it/s, est. speed input: 2969.25 toks/s, output: 185.92 toks/s]
Processed prompts:  17%|█▋        | 71/424 [00:47<00:51,  6.79it/s, est. speed input: 3029.37 toks/s, output: 193.20 toks/s]
Processed prompts:  17%|█▋        | 73/424 [00:48<00:49,  7.06it/s, est. speed input: 3173.75 toks/s, output: 198.33 toks/s]
Processed prompts:  18%|█▊        | 75/424 [00:48<00:50,  6.89it/s, est. speed input: 3224.16 toks/s, output: 203.13 toks/s]
Processed prompts:  19%|█▊        | 79/424 [00:48<00:44,  7.68it/s, est. speed input: 3316.53 toks/s, output: 213.49 toks/s]
Processed prompts:  20%|█▉        | 84/424 [00:49<00:46,  7.34it/s, est. speed input: 3480.32 toks/s, output: 225.40 toks/s]
Processed prompts:  20%|██        | 85/424 [00:49<00:46,  7.22it/s, est. speed input: 3510.35 toks/s, output: 227.72 toks/s]
Processed prompts:  21%|██        | 87/424 [00:50<01:03,  5.33it/s, est. speed input: 3523.71 toks/s, output: 230.53 toks/s]
Processed prompts:  21%|██        | 89/424 [00:50<00:57,  5.81it/s, est. speed input: 3570.66 toks/s, output: 235.41 toks/s]
Processed prompts:  21%|██▏       | 91/424 [00:51<00:54,  6.07it/s, est. speed input: 3622.94 toks/s, output: 240.09 toks/s]
Processed prompts:  22%|██▏       | 94/424 [00:51<00:46,  7.04it/s, est. speed input: 3685.20 toks/s, output: 247.69 toks/s]
Processed prompts:  23%|██▎       | 99/424 [00:52<00:47,  6.81it/s, est. speed input: 3826.76 toks/s, output: 258.96 toks/s]
Processed prompts:  24%|██▍       | 102/424 [00:52<00:46,  6.87it/s, est. speed input: 3890.56 toks/s, output: 265.78 toks/s]
Processed prompts:  25%|██▍       | 105/424 [00:53<00:50,  6.31it/s, est. speed input: 3902.66 toks/s, output: 271.82 toks/s]
Processed prompts:  26%|██▌       | 110/424 [00:53<00:46,  6.72it/s, est. speed input: 4049.69 toks/s, output: 283.12 toks/s]
Processed prompts:  27%|██▋       | 114/424 [00:54<00:42,  7.21it/s, est. speed input: 4129.79 toks/s, output: 292.42 toks/s]
Processed prompts:  28%|██▊       | 119/424 [00:54<00:39,  7.70it/s, est. speed input: 4225.32 toks/s, output: 304.07 toks/s]
Processed prompts:  29%|██▉       | 122/424 [00:55<00:37,  8.05it/s, est. speed input: 4302.25 toks/s, output: 311.15 toks/s]
Processed prompts:  29%|██▉       | 124/424 [00:55<00:39,  7.56it/s, est. speed input: 4353.55 toks/s, output: 315.16 toks/s]
Processed prompts:  29%|██▉       | 125/424 [00:55<00:39,  7.49it/s, est. speed input: 4367.44 toks/s, output: 317.32 toks/s]
Processed prompts:  31%|███       | 131/424 [00:56<00:35,  8.27it/s, est. speed input: 4661.25 toks/s, output: 331.27 toks/s]
Processed prompts:  31%|███▏      | 133/424 [00:56<00:35,  8.29it/s, est. speed input: 4695.72 toks/s, output: 335.76 toks/s]
Processed prompts:  32%|███▏      | 137/424 [00:57<00:37,  7.64it/s, est. speed input: 4762.83 toks/s, output: 343.95 toks/s]
Processed prompts:  33%|███▎      | 142/424 [00:58<00:46,  6.08it/s, est. speed input: 4898.89 toks/s, output: 351.97 toks/s]
Processed prompts:  34%|███▍      | 145/424 [00:58<00:45,  6.08it/s, est. speed input: 4970.00 toks/s, output: 357.68 toks/s]
Processed prompts:  35%|███▍      | 147/424 [00:58<00:43,  6.42it/s, est. speed input: 5007.48 toks/s, output: 362.02 toks/s]
Processed prompts:  35%|███▍      | 148/424 [00:59<00:47,  5.85it/s, est. speed input: 5035.17 toks/s, output: 363.20 toks/s]
Processed prompts:  36%|███▌      | 152/424 [00:59<00:41,  6.63it/s, est. speed input: 5132.93 toks/s, output: 371.78 toks/s]
Processed prompts:  36%|███▋      | 154/424 [01:00<00:45,  5.94it/s, est. speed input: 5139.36 toks/s, output: 374.73 toks/s]
Processed prompts:  38%|███▊      | 160/424 [01:01<00:43,  6.08it/s, est. speed input: 5220.05 toks/s, output: 385.92 toks/s]
Processed prompts:  38%|███▊      | 162/424 [01:01<00:45,  5.71it/s, est. speed input: 5246.30 toks/s, output: 388.85 toks/s]
Processed prompts:  39%|███▉      | 165/424 [01:02<00:45,  5.63it/s, est. speed input: 5332.20 toks/s, output: 393.93 toks/s]
Processed prompts:  39%|███▉      | 167/424 [01:02<00:45,  5.62it/s, est. speed input: 5386.86 toks/s, output: 397.35 toks/s]
Processed prompts:  41%|████      | 173/424 [01:02<00:28,  8.69it/s, est. speed input: 5562.75 toks/s, output: 412.60 toks/s]
Processed prompts:  42%|████▏     | 177/424 [01:02<00:22, 11.12it/s, est. speed input: 5667.86 toks/s, output: 423.08 toks/s]
Processed prompts:  43%|████▎     | 181/424 [01:03<00:17, 13.78it/s, est. speed input: 5903.03 toks/s, output: 433.66 toks/s]
Processed prompts:  44%|████▎     | 185/424 [01:03<00:14, 16.51it/s, est. speed input: 6039.87 toks/s, output: 444.32 toks/s]
Processed prompts:  45%|████▍     | 190/424 [01:03<00:11, 20.64it/s, est. speed input: 6201.82 toks/s, output: 457.97 toks/s]
Processed prompts:  46%|████▌     | 194/424 [01:03<00:11, 20.60it/s, est. speed input: 6355.48 toks/s, output: 468.34 toks/s]
Processed prompts:  46%|████▋     | 197/424 [01:03<00:10, 21.15it/s, est. speed input: 6415.62 toks/s, output: 476.38 toks/s]
Processed prompts:  47%|████▋     | 200/424 [01:03<00:10, 21.67it/s, est. speed input: 6463.11 toks/s, output: 484.47 toks/s]
Processed prompts:  48%|████▊     | 203/424 [01:03<00:11, 19.69it/s, est. speed input: 6517.07 toks/s, output: 492.21 toks/s]
Processed prompts:  49%|████▊     | 206/424 [01:04<00:10, 20.63it/s, est. speed input: 6587.25 toks/s, output: 500.48 toks/s]
Processed prompts:  50%|████▉     | 210/424 [01:04<00:10, 21.17it/s, est. speed input: 6727.65 toks/s, output: 511.47 toks/s]
Processed prompts:  50%|█████     | 214/424 [01:04<00:08, 24.10it/s, est. speed input: 6819.44 toks/s, output: 523.08 toks/s]
Processed prompts:  51%|█████     | 217/424 [01:04<00:08, 24.44it/s, est. speed input: 6867.40 toks/s, output: 531.65 toks/s]
Processed prompts:  52%|█████▏    | 220/424 [01:04<00:08, 24.76it/s, est. speed input: 6957.95 toks/s, output: 540.25 toks/s]
Processed prompts:  53%|█████▎    | 223/424 [01:04<00:08, 25.08it/s, est. speed input: 7026.37 toks/s, output: 548.95 toks/s]
Processed prompts:  53%|█████▎    | 226/424 [01:05<00:13, 15.02it/s, est. speed input: 7070.20 toks/s, output: 555.38 toks/s]
Processed prompts:  54%|█████▍    | 229/424 [01:05<00:14, 13.38it/s, est. speed input: 7106.70 toks/s, output: 563.03 toks/s]
Processed prompts:  55%|█████▍    | 232/424 [01:05<00:12, 15.66it/s, est. speed input: 7195.97 toks/s, output: 570.91 toks/s]
Processed prompts:  55%|█████▌    | 235/424 [01:05<00:14, 12.89it/s, est. speed input: 7241.03 toks/s, output: 578.36 toks/s]
Processed prompts:  56%|█████▌    | 237/424 [01:05<00:14, 12.72it/s, est. speed input: 7276.94 toks/s, output: 583.92 toks/s]
Processed prompts:  56%|█████▋    | 239/424 [01:06<00:15, 11.65it/s, est. speed input: 7308.73 toks/s, output: 589.11 toks/s]
Processed prompts:  57%|█████▋    | 241/424 [01:06<00:21,  8.40it/s, est. speed input: 7304.64 toks/s, output: 589.93 toks/s]
Processed prompts:  57%|█████▋    | 243/424 [01:07<00:26,  6.91it/s, est. speed input: 7312.16 toks/s, output: 589.81 toks/s]
Processed prompts:  58%|█████▊    | 245/424 [01:07<00:21,  8.36it/s, est. speed input: 7349.29 toks/s, output: 594.26 toks/s]
Processed prompts:  58%|█████▊    | 247/424 [01:07<00:17,  9.92it/s, est. speed input: 7434.67 toks/s, output: 597.40 toks/s]
Processed prompts:  59%|█████▊    | 249/424 [01:07<00:19,  9.11it/s, est. speed input: 7475.72 toks/s, output: 600.82 toks/s]
Processed prompts:  59%|█████▉    | 251/424 [01:07<00:17,  9.95it/s, est. speed input: 7495.51 toks/s, output: 603.41 toks/s]
Processed prompts:  60%|█████▉    | 253/424 [01:07<00:14, 11.59it/s, est. speed input: 7551.18 toks/s, output: 608.31 toks/s]
Processed prompts:  60%|██████    | 255/424 [01:07<00:12, 13.17it/s, est. speed input: 7581.18 toks/s, output: 611.38 toks/s]
Processed prompts:  61%|██████    | 258/424 [01:08<00:09, 16.75it/s, est. speed input: 7690.83 toks/s, output: 616.93 toks/s]
Processed prompts:  62%|██████▏   | 262/424 [01:08<00:07, 22.22it/s, est. speed input: 7812.81 toks/s, output: 625.99 toks/s]
Processed prompts:  63%|██████▎   | 268/424 [01:08<00:06, 25.49it/s, est. speed input: 7993.81 toks/s, output: 638.10 toks/s]
Processed prompts:  64%|██████▍   | 272/424 [01:08<00:06, 23.74it/s, est. speed input: 8102.02 toks/s, output: 644.70 toks/s]
Processed prompts:  65%|██████▍   | 275/424 [01:08<00:07, 19.35it/s, est. speed input: 8126.70 toks/s, output: 648.75 toks/s]
Processed prompts:  67%|██████▋   | 282/424 [01:08<00:05, 26.71it/s, est. speed input: 8280.63 toks/s, output: 664.90 toks/s]
Processed prompts:  68%|██████▊   | 288/424 [01:09<00:04, 30.90it/s, est. speed input: 8440.47 toks/s, output: 678.07 toks/s]
Processed prompts:  70%|██████▉   | 295/424 [01:09<00:03, 36.34it/s, est. speed input: 8604.49 toks/s, output: 691.59 toks/s]
Processed prompts:  71%|███████   | 299/424 [01:09<00:03, 34.97it/s, est. speed input: 8729.50 toks/s, output: 699.15 toks/s]
Processed prompts:  72%|███████▏  | 305/424 [01:09<00:03, 38.68it/s, est. speed input: 8859.25 toks/s, output: 711.94 toks/s]
Processed prompts:  73%|███████▎  | 311/424 [01:09<00:02, 41.89it/s, est. speed input: 9047.48 toks/s, output: 724.76 toks/s]
Processed prompts:  75%|███████▌  | 318/424 [01:09<00:02, 47.26it/s, est. speed input: 9303.06 toks/s, output: 738.59 toks/s]
Processed prompts:  76%|███████▌  | 323/424 [01:09<00:02, 42.83it/s, est. speed input: 9417.41 toks/s, output: 747.97 toks/s]
Processed prompts:  77%|███████▋  | 328/424 [01:09<00:02, 43.81it/s, est. speed input: 9572.33 toks/s, output: 758.99 toks/s]
Processed prompts:  79%|███████▊  | 333/424 [01:10<00:02, 44.83it/s, est. speed input: 9664.42 toks/s, output: 769.28 toks/s]
Processed prompts:  80%|████████  | 340/424 [01:10<00:01, 51.27it/s, est. speed input: 9820.74 toks/s, output: 785.12 toks/s]
Processed prompts:  82%|████████▏ | 347/424 [01:10<00:01, 52.12it/s, est. speed input: 10097.59 toks/s, output: 799.64 toks/s]
Processed prompts:  83%|████████▎ | 353/424 [01:10<00:01, 47.25it/s, est. speed input: 10211.61 toks/s, output: 811.65 toks/s]
Processed prompts:  85%|████████▍ | 359/424 [01:10<00:01, 44.94it/s, est. speed input: 10405.19 toks/s, output: 829.48 toks/s]
Processed prompts:  87%|████████▋ | 368/424 [01:10<00:01, 51.17it/s, est. speed input: 10698.16 toks/s, output: 850.58 toks/s]
Processed prompts:  88%|████████▊ | 374/424 [01:10<00:00, 52.57it/s, est. speed input: 10851.84 toks/s, output: 868.99 toks/s]
Processed prompts:  90%|█████████ | 382/424 [01:10<00:00, 55.89it/s, est. speed input: 11088.14 toks/s, output: 890.07 toks/s]
Processed prompts:  92%|█████████▏| 388/424 [01:11<00:00, 54.74it/s, est. speed input: 11292.89 toks/s, output: 907.23 toks/s]
Processed prompts:  93%|█████████▎| 394/424 [01:11<00:00, 52.86it/s, est. speed input: 11491.14 toks/s, output: 922.34 toks/s]
Processed prompts:  95%|█████████▌| 403/424 [01:11<00:00, 57.89it/s, est. speed input: 11762.12 toks/s, output: 948.25 toks/s]
Processed prompts:  96%|█████████▋| 409/424 [01:11<00:00, 51.25it/s, est. speed input: 11913.72 toks/s, output: 963.65 toks/s]
Processed prompts:  98%|█████████▊| 415/424 [01:11<00:00, 42.73it/s, est. speed input: 12065.25 toks/s, output: 979.24 toks/s]
Processed prompts:  99%|█████████▉| 420/424 [01:11<00:00, 32.33it/s, est. speed input: 12192.24 toks/s, output: 996.06 toks/s]
Processed prompts: 100%|██████████| 424/424 [01:14<00:00,  6.84it/s, est. speed input: 11993.92 toks/s, output: 988.20 toks/s]
Processed prompts: 100%|██████████| 424/424 [01:14<00:00,  5.72it/s, est. speed input: 11993.92 toks/s, output: 988.20 toks/s]
[rank0]:[W715 11:08:14.537128185 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/sc_rag_full_profile_test_10_limit_2_output.json
Cleaned temporary files.
