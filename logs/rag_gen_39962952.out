Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 10:42:09.122645_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 10:42:09.122645_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 10:42:09.122645_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:01<07:06,  1.07s/it]
  0%|          | 2/401 [00:01<03:55,  1.70it/s]
  1%|          | 3/401 [00:03<09:51,  1.49s/it]
  1%|          | 4/401 [00:05<09:49,  1.49s/it]
  1%|          | 5/401 [00:06<09:46,  1.48s/it]
  1%|▏         | 6/401 [00:08<09:50,  1.50s/it]
  2%|▏         | 7/401 [00:09<09:54,  1.51s/it]
  2%|▏         | 8/401 [00:11<09:45,  1.49s/it]
  2%|▏         | 9/401 [00:12<09:46,  1.50s/it]
  2%|▏         | 10/401 [00:13<07:44,  1.19s/it]
  3%|▎         | 11/401 [00:15<08:48,  1.35s/it]
  3%|▎         | 13/401 [00:16<07:18,  1.13s/it]
  3%|▎         | 14/401 [00:20<11:04,  1.72s/it]
  4%|▎         | 15/401 [00:20<08:22,  1.30s/it]
  4%|▍         | 17/401 [00:20<05:08,  1.25it/s]
  4%|▍         | 18/401 [00:22<06:29,  1.02s/it]
  5%|▍         | 19/401 [00:24<07:34,  1.19s/it]
  5%|▍         | 20/401 [00:28<12:40,  2.00s/it]
  5%|▌         | 21/401 [00:28<09:35,  1.51s/it]
  5%|▌         | 22/401 [00:32<14:20,  2.27s/it]
  6%|▌         | 23/401 [00:34<13:21,  2.12s/it]
  6%|▌         | 24/401 [00:38<17:18,  2.75s/it]
  6%|▌         | 25/401 [00:39<12:26,  1.98s/it]
  6%|▋         | 26/401 [00:39<09:08,  1.46s/it]
  7%|▋         | 27/401 [00:43<14:20,  2.30s/it]
  7%|▋         | 28/401 [00:43<10:35,  1.70s/it]
  7%|▋         | 29/401 [00:43<07:36,  1.23s/it]
  7%|▋         | 30/401 [00:45<07:51,  1.27s/it]
  8%|▊         | 31/401 [00:46<07:37,  1.24s/it]
  8%|▊         | 32/401 [00:46<05:42,  1.08it/s]
  8%|▊         | 33/401 [00:47<06:07,  1.00it/s]
  8%|▊         | 34/401 [00:49<08:00,  1.31s/it]
  9%|▊         | 35/401 [00:49<05:47,  1.05it/s]
  9%|▉         | 37/401 [00:50<03:47,  1.60it/s]
 10%|▉         | 39/401 [00:51<03:48,  1.59it/s]
 10%|▉         | 40/401 [00:51<03:05,  1.95it/s]
 10%|█         | 41/401 [00:53<04:21,  1.38it/s]
 10%|█         | 42/401 [00:53<03:39,  1.64it/s]
 11%|█         | 43/401 [00:53<03:10,  1.88it/s]
 11%|█         | 44/401 [00:54<04:01,  1.48it/s]
 11%|█▏        | 46/401 [00:55<02:54,  2.04it/s]
 12%|█▏        | 47/401 [00:57<05:07,  1.15it/s]
 12%|█▏        | 48/401 [00:57<04:27,  1.32it/s]
 12%|█▏        | 49/401 [00:58<03:51,  1.52it/s]
 12%|█▏        | 50/401 [00:59<04:05,  1.43it/s]
 13%|█▎        | 51/401 [00:59<03:37,  1.61it/s]
 13%|█▎        | 53/401 [01:00<02:42,  2.14it/s]
 13%|█▎        | 54/401 [01:00<02:19,  2.49it/s]
 14%|█▎        | 55/401 [01:03<06:21,  1.10s/it]
 14%|█▍        | 56/401 [01:04<07:02,  1.23s/it]
 14%|█▍        | 57/401 [01:05<06:41,  1.17s/it]
 14%|█▍        | 58/401 [01:06<04:58,  1.15it/s]
 15%|█▍        | 59/401 [01:08<08:18,  1.46s/it]
 15%|█▍        | 60/401 [01:09<07:15,  1.28s/it]
 15%|█▌        | 61/401 [01:10<05:52,  1.04s/it]
 15%|█▌        | 62/401 [01:10<04:42,  1.20it/s]
 16%|█▌        | 63/401 [01:11<04:12,  1.34it/s]
 16%|█▌        | 64/401 [01:11<03:54,  1.44it/s]
 16%|█▌        | 65/401 [01:12<03:43,  1.50it/s]
 16%|█▋        | 66/401 [01:13<04:58,  1.12it/s]
 17%|█▋        | 67/401 [01:14<04:00,  1.39it/s]
 17%|█▋        | 68/401 [01:14<03:09,  1.75it/s]
 17%|█▋        | 69/401 [01:14<02:23,  2.31it/s]
 17%|█▋        | 70/401 [01:15<03:36,  1.53it/s]
 18%|█▊        | 71/401 [01:15<03:06,  1.77it/s]
 18%|█▊        | 72/401 [01:16<03:51,  1.42it/s]
 18%|█▊        | 73/401 [01:17<03:14,  1.68it/s]
 18%|█▊        | 74/401 [01:18<03:54,  1.40it/s]
 19%|█▊        | 75/401 [01:19<04:27,  1.22it/s]
 19%|█▉        | 76/401 [01:20<04:48,  1.13it/s]
 19%|█▉        | 77/401 [01:21<05:00,  1.08it/s]
 19%|█▉        | 78/401 [01:21<03:44,  1.44it/s]
 20%|█▉        | 79/401 [01:22<04:21,  1.23it/s]
 20%|█▉        | 80/401 [01:23<04:38,  1.15it/s]
 20%|██        | 81/401 [01:24<04:31,  1.18it/s]
 20%|██        | 82/401 [01:25<04:47,  1.11it/s]
 21%|██        | 83/401 [01:26<05:08,  1.03it/s]
 21%|██        | 84/401 [01:27<05:23,  1.02s/it]
 21%|██        | 85/401 [01:28<04:22,  1.20it/s]
 21%|██▏       | 86/401 [01:29<04:52,  1.08it/s]
 22%|██▏       | 87/401 [01:32<08:01,  1.53s/it]
 22%|██▏       | 88/401 [01:33<07:13,  1.38s/it]
 22%|██▏       | 89/401 [01:34<07:17,  1.40s/it]
 22%|██▏       | 90/401 [01:34<05:25,  1.05s/it]
 23%|██▎       | 91/401 [01:35<04:01,  1.28it/s]
 23%|██▎       | 92/401 [01:36<04:21,  1.18it/s]
 23%|██▎       | 93/401 [01:36<03:22,  1.52it/s]
 23%|██▎       | 94/401 [01:38<05:30,  1.08s/it]
 24%|██▎       | 95/401 [01:39<05:55,  1.16s/it]
 24%|██▍       | 96/401 [01:40<05:48,  1.14s/it]
 24%|██▍       | 97/401 [01:41<05:34,  1.10s/it]
 24%|██▍       | 98/401 [01:42<04:32,  1.11it/s]
 25%|██▍       | 99/401 [01:42<03:26,  1.46it/s]
 25%|██▍       | 100/401 [01:42<02:53,  1.74it/s]
 25%|██▌       | 101/401 [01:43<03:15,  1.54it/s]
 25%|██▌       | 102/401 [01:43<02:30,  1.99it/s]
 26%|██▌       | 103/401 [01:44<02:24,  2.06it/s]
 26%|██▌       | 104/401 [01:45<03:12,  1.54it/s]
 26%|██▌       | 105/401 [01:46<03:49,  1.29it/s]
 27%|██▋       | 107/401 [01:46<02:41,  1.82it/s]
 27%|██▋       | 108/401 [01:47<02:12,  2.20it/s]
 27%|██▋       | 109/401 [01:48<02:54,  1.67it/s]
 27%|██▋       | 110/401 [01:48<02:15,  2.15it/s]
 28%|██▊       | 111/401 [01:49<03:07,  1.55it/s]
 28%|██▊       | 112/401 [01:50<03:45,  1.28it/s]
 28%|██▊       | 113/401 [01:51<03:37,  1.33it/s]
 28%|██▊       | 114/401 [01:51<03:39,  1.31it/s]
 29%|██▊       | 115/401 [01:52<02:56,  1.62it/s]
 29%|██▉       | 116/401 [01:53<03:27,  1.38it/s]
 29%|██▉       | 117/401 [01:53<03:08,  1.51it/s]
 29%|██▉       | 118/401 [01:53<02:30,  1.88it/s]
 30%|██▉       | 119/401 [01:55<03:28,  1.35it/s]
 30%|██▉       | 120/401 [01:55<02:42,  1.73it/s]
 30%|███       | 121/401 [01:55<02:14,  2.08it/s]
 30%|███       | 122/401 [01:56<02:50,  1.64it/s]
 31%|███       | 123/401 [01:57<03:52,  1.19it/s]
 31%|███       | 124/401 [01:59<04:51,  1.05s/it]
 31%|███       | 125/401 [02:00<05:16,  1.15s/it]
 31%|███▏      | 126/401 [02:00<04:00,  1.14it/s]
 32%|███▏      | 127/401 [02:02<04:43,  1.03s/it]
 32%|███▏      | 128/401 [02:03<05:24,  1.19s/it]
 32%|███▏      | 129/401 [02:05<05:14,  1.16s/it]
 32%|███▏      | 130/401 [02:06<05:36,  1.24s/it]
 33%|███▎      | 131/401 [02:07<05:00,  1.11s/it]
 33%|███▎      | 132/401 [02:07<03:52,  1.16it/s]
 33%|███▎      | 133/401 [02:10<06:29,  1.45s/it]
 33%|███▎      | 134/401 [02:11<06:01,  1.35s/it]
 34%|███▎      | 135/401 [02:12<05:34,  1.26s/it]
 34%|███▍      | 136/401 [02:13<05:15,  1.19s/it]
 34%|███▍      | 137/401 [02:13<03:52,  1.13it/s]
 34%|███▍      | 138/401 [02:14<04:01,  1.09it/s]
 35%|███▍      | 139/401 [02:15<03:51,  1.13it/s]
 35%|███▍      | 140/401 [02:15<03:00,  1.44it/s]
 35%|███▌      | 141/401 [02:17<04:28,  1.03s/it]
 35%|███▌      | 142/401 [02:19<04:56,  1.15s/it]
 36%|███▌      | 143/401 [02:19<04:01,  1.07it/s]
 36%|███▌      | 144/401 [02:20<04:08,  1.03it/s]
 36%|███▌      | 145/401 [02:20<03:16,  1.30it/s]
 36%|███▋      | 146/401 [02:21<03:40,  1.16it/s]
 37%|███▋      | 147/401 [02:22<03:51,  1.10it/s]
 37%|███▋      | 148/401 [02:23<03:13,  1.30it/s]
 37%|███▋      | 149/401 [02:24<03:33,  1.18it/s]
 37%|███▋      | 150/401 [02:25<03:44,  1.12it/s]
 38%|███▊      | 151/401 [02:26<04:21,  1.05s/it]
 38%|███▊      | 152/401 [02:27<04:25,  1.06s/it]
 38%|███▊      | 153/401 [02:28<03:37,  1.14it/s]
 38%|███▊      | 154/401 [02:28<03:08,  1.31it/s]
 39%|███▊      | 155/401 [02:30<04:07,  1.01s/it]
 39%|███▉      | 156/401 [02:31<04:48,  1.18s/it]
 39%|███▉      | 157/401 [02:33<05:01,  1.24s/it]
 40%|███▉      | 159/401 [02:34<03:42,  1.09it/s]
 40%|███▉      | 160/401 [02:34<03:11,  1.26it/s]
 40%|████      | 162/401 [02:36<02:54,  1.37it/s]
 41%|████      | 163/401 [02:37<03:01,  1.31it/s]
 41%|████      | 164/401 [02:37<03:07,  1.26it/s]
 41%|████      | 165/401 [02:38<03:22,  1.17it/s]
 41%|████▏     | 166/401 [02:39<03:32,  1.11it/s]
 42%|████▏     | 167/401 [02:40<02:42,  1.44it/s]
 42%|████▏     | 168/401 [02:41<03:01,  1.28it/s]
 42%|████▏     | 169/401 [02:42<03:19,  1.16it/s]
 42%|████▏     | 170/401 [02:43<03:29,  1.10it/s]
 43%|████▎     | 171/401 [02:44<03:35,  1.07it/s]
 43%|████▎     | 172/401 [02:44<03:02,  1.26it/s]
 43%|████▎     | 173/401 [02:45<03:18,  1.15it/s]
 43%|████▎     | 174/401 [02:46<03:37,  1.04it/s]
 44%|████▎     | 175/401 [02:47<03:44,  1.01it/s]
 44%|████▍     | 176/401 [02:49<03:50,  1.02s/it]
 44%|████▍     | 177/401 [02:50<04:13,  1.13s/it]
 44%|████▍     | 178/401 [02:51<04:04,  1.10s/it]
 45%|████▍     | 179/401 [02:52<03:56,  1.07s/it]
 45%|████▍     | 180/401 [02:53<03:58,  1.08s/it]
 45%|████▌     | 181/401 [02:54<03:58,  1.08s/it]
 45%|████▌     | 182/401 [02:55<03:53,  1.06s/it]
 46%|████▌     | 183/401 [02:59<06:45,  1.86s/it]
 46%|████▌     | 184/401 [03:03<08:39,  2.39s/it]
 46%|████▌     | 185/401 [03:06<10:02,  2.79s/it]
 46%|████▋     | 186/401 [03:10<10:58,  3.06s/it]
 47%|████▋     | 187/401 [03:14<11:35,  3.25s/it]
 47%|████▋     | 188/401 [03:14<08:18,  2.34s/it]
 47%|████▋     | 189/401 [03:18<09:46,  2.77s/it]
 47%|████▋     | 190/401 [03:21<10:43,  3.05s/it]
 48%|████▊     | 191/401 [03:23<09:26,  2.70s/it]
 48%|████▊     | 192/401 [03:25<08:31,  2.45s/it]
 48%|████▊     | 193/401 [03:25<06:08,  1.77s/it]
 48%|████▊     | 194/401 [03:26<04:33,  1.32s/it]
 49%|████▊     | 195/401 [03:29<07:00,  2.04s/it]
 49%|████▉     | 196/401 [03:31<06:46,  1.98s/it]
 49%|████▉     | 197/401 [03:33<06:50,  2.01s/it]
 49%|████▉     | 198/401 [03:37<08:29,  2.51s/it]
 50%|████▉     | 199/401 [03:39<07:47,  2.31s/it]
 50%|████▉     | 200/401 [03:41<07:20,  2.19s/it]
 50%|█████     | 201/401 [03:42<06:59,  2.10s/it]
 50%|█████     | 202/401 [03:44<06:43,  2.03s/it]
 51%|█████     | 203/401 [03:46<06:32,  1.98s/it]
 51%|█████     | 204/401 [03:48<06:22,  1.94s/it]
 51%|█████     | 205/401 [03:48<04:35,  1.40s/it]
 51%|█████▏    | 206/401 [03:50<05:00,  1.54s/it]
 52%|█████▏    | 207/401 [03:52<05:20,  1.65s/it]
 52%|█████▏    | 208/401 [03:54<05:27,  1.70s/it]
 52%|█████▏    | 209/401 [03:54<04:12,  1.31s/it]
 52%|█████▏    | 210/401 [03:56<04:42,  1.48s/it]
 53%|█████▎    | 211/401 [03:57<04:01,  1.27s/it]
 53%|█████▎    | 212/401 [03:57<03:22,  1.07s/it]
 53%|█████▎    | 213/401 [03:58<03:06,  1.01it/s]
 53%|█████▎    | 214/401 [04:00<03:53,  1.25s/it]
 54%|█████▎    | 215/401 [04:01<03:18,  1.07s/it]
 54%|█████▍    | 216/401 [04:02<03:32,  1.15s/it]
 54%|█████▍    | 218/401 [04:03<02:22,  1.28it/s]
 55%|█████▍    | 219/401 [04:03<02:17,  1.33it/s]
 55%|█████▍    | 220/401 [04:04<02:12,  1.37it/s]
 55%|█████▌    | 221/401 [04:07<03:56,  1.32s/it]
 55%|█████▌    | 222/401 [04:08<03:21,  1.13s/it]
 56%|█████▌    | 223/401 [04:08<02:30,  1.19it/s]
 56%|█████▌    | 224/401 [04:08<02:04,  1.42it/s]
 56%|█████▌    | 225/401 [04:08<01:35,  1.85it/s]
 56%|█████▋    | 226/401 [04:08<01:13,  2.38it/s]
 57%|█████▋    | 227/401 [04:09<01:03,  2.73it/s]
 57%|█████▋    | 228/401 [04:09<01:19,  2.17it/s]
 57%|█████▋    | 229/401 [04:10<01:05,  2.63it/s]
 57%|█████▋    | 230/401 [04:11<02:09,  1.32it/s]
 58%|█████▊    | 231/401 [04:11<01:39,  1.71it/s]
 58%|█████▊    | 232/401 [04:12<01:38,  1.71it/s]
 58%|█████▊    | 234/401 [04:16<03:19,  1.20s/it]
 59%|█████▊    | 235/401 [04:16<02:44,  1.01it/s]
 59%|█████▉    | 236/401 [04:16<02:06,  1.30it/s]
 59%|█████▉    | 237/401 [04:17<01:57,  1.39it/s]
 59%|█████▉    | 238/401 [04:17<01:46,  1.53it/s]
 60%|█████▉    | 239/401 [04:18<01:45,  1.53it/s]
 60%|█████▉    | 240/401 [04:18<01:24,  1.90it/s]
 60%|██████    | 242/401 [04:19<00:54,  2.90it/s]
 61%|██████    | 243/401 [04:19<01:11,  2.22it/s]
 61%|██████    | 244/401 [04:20<01:07,  2.31it/s]
 61%|██████    | 245/401 [04:20<00:55,  2.83it/s]
 61%|██████▏   | 246/401 [04:20<01:07,  2.29it/s]
 62%|██████▏   | 247/401 [04:21<01:18,  1.97it/s]
 62%|██████▏   | 248/401 [04:21<01:00,  2.51it/s]
 62%|██████▏   | 249/401 [04:23<01:48,  1.40it/s]
 63%|██████▎   | 251/401 [04:23<01:11,  2.11it/s]
 63%|██████▎   | 252/401 [04:23<00:57,  2.57it/s]
 63%|██████▎   | 254/401 [04:24<00:45,  3.26it/s]
 64%|██████▎   | 255/401 [04:25<01:32,  1.58it/s]
 64%|██████▍   | 256/401 [04:26<01:21,  1.78it/s]
 64%|██████▍   | 257/401 [04:26<01:12,  1.98it/s]
 64%|██████▍   | 258/401 [04:26<01:06,  2.15it/s]
 65%|██████▍   | 259/401 [04:27<01:01,  2.32it/s]
 65%|██████▌   | 261/401 [04:27<00:55,  2.50it/s]
 65%|██████▌   | 262/401 [04:28<00:53,  2.62it/s]
 66%|██████▌   | 263/401 [04:28<00:51,  2.69it/s]
 66%|██████▌   | 264/401 [04:28<00:44,  3.06it/s]
 66%|██████▌   | 265/401 [04:29<00:45,  3.01it/s]
 66%|██████▋   | 266/401 [04:29<00:45,  2.99it/s]
 67%|██████▋   | 267/401 [04:29<00:38,  3.49it/s]
 67%|██████▋   | 268/401 [04:29<00:34,  3.85it/s]
 67%|██████▋   | 269/401 [04:30<00:48,  2.71it/s]
 67%|██████▋   | 270/401 [04:31<00:58,  2.24it/s]
 68%|██████▊   | 272/401 [04:31<00:37,  3.46it/s]
 68%|██████▊   | 273/401 [04:31<00:32,  3.89it/s]
 68%|██████▊   | 274/401 [04:31<00:28,  4.39it/s]
 69%|██████▊   | 275/401 [04:31<00:25,  4.90it/s]
 69%|██████▉   | 276/401 [04:31<00:24,  5.17it/s]
 69%|██████▉   | 277/401 [04:32<00:35,  3.45it/s]
 69%|██████▉   | 278/401 [04:32<00:30,  3.98it/s]
 70%|██████▉   | 279/401 [04:32<00:26,  4.64it/s]
 70%|██████▉   | 280/401 [04:33<00:32,  3.70it/s]
 70%|███████   | 281/401 [04:33<00:27,  4.33it/s]
 70%|███████   | 282/401 [04:33<00:24,  4.96it/s]
 71%|███████   | 283/401 [04:34<00:37,  3.19it/s]
 71%|███████   | 284/401 [04:34<00:37,  3.16it/s]
 71%|███████   | 285/401 [04:34<00:33,  3.51it/s]
 71%|███████▏  | 286/401 [04:34<00:34,  3.36it/s]
 72%|███████▏  | 287/401 [04:35<00:34,  3.28it/s]
 72%|███████▏  | 288/401 [04:35<00:29,  3.86it/s]
 72%|███████▏  | 289/401 [04:35<00:27,  4.04it/s]
 73%|███████▎  | 291/401 [04:36<00:26,  4.08it/s]
 73%|███████▎  | 292/401 [04:37<01:00,  1.81it/s]
 73%|███████▎  | 293/401 [04:38<01:12,  1.49it/s]
 73%|███████▎  | 294/401 [04:41<02:22,  1.34s/it]
 74%|███████▎  | 295/401 [04:41<01:45,  1.00it/s]
 74%|███████▍  | 296/401 [04:42<01:43,  1.01it/s]
 74%|███████▍  | 297/401 [04:42<01:18,  1.33it/s]
 74%|███████▍  | 298/401 [04:43<01:05,  1.56it/s]
 75%|███████▍  | 299/401 [04:44<01:30,  1.13it/s]
 75%|███████▍  | 300/401 [04:45<01:28,  1.14it/s]
 75%|███████▌  | 301/401 [04:45<01:06,  1.51it/s]
 75%|███████▌  | 302/401 [04:45<00:49,  1.98it/s]
 76%|███████▌  | 303/401 [04:46<01:01,  1.60it/s]
 76%|███████▌  | 304/401 [04:47<01:02,  1.56it/s]
 76%|███████▌  | 305/401 [04:48<01:16,  1.26it/s]
 76%|███████▋  | 306/401 [04:49<01:16,  1.24it/s]
 77%|███████▋  | 307/401 [04:50<01:20,  1.16it/s]
 77%|███████▋  | 308/401 [04:50<01:08,  1.36it/s]
 77%|███████▋  | 309/401 [04:51<01:04,  1.42it/s]
 77%|███████▋  | 310/401 [04:52<00:57,  1.59it/s]
 78%|███████▊  | 311/401 [04:52<01:02,  1.45it/s]
 78%|███████▊  | 312/401 [04:53<00:53,  1.65it/s]
 78%|███████▊  | 313/401 [04:53<00:42,  2.08it/s]
 78%|███████▊  | 314/401 [04:53<00:40,  2.17it/s]
 79%|███████▊  | 315/401 [04:54<00:34,  2.52it/s]
 79%|███████▉  | 316/401 [04:54<00:27,  3.05it/s]
 79%|███████▉  | 317/401 [04:55<00:55,  1.50it/s]
 79%|███████▉  | 318/401 [04:56<00:51,  1.61it/s]
 80%|███████▉  | 319/401 [04:56<00:42,  1.93it/s]
 80%|███████▉  | 320/401 [04:57<00:41,  1.97it/s]
 80%|████████  | 321/401 [04:57<00:40,  2.00it/s]
 80%|████████  | 322/401 [04:58<00:40,  1.97it/s]
 81%|████████  | 323/401 [05:01<01:51,  1.43s/it]
 81%|████████  | 324/401 [05:05<02:36,  2.03s/it]
 81%|████████  | 325/401 [05:08<03:07,  2.46s/it]
 81%|████████▏ | 326/401 [05:09<02:31,  2.02s/it]
 82%|████████▏ | 327/401 [05:10<02:03,  1.67s/it]
 82%|████████▏ | 328/401 [05:10<01:37,  1.33s/it]
 82%|████████▏ | 329/401 [05:12<01:43,  1.44s/it]
 82%|████████▏ | 330/401 [05:16<02:25,  2.05s/it]
 83%|████████▎ | 331/401 [05:17<02:01,  1.74s/it]
 83%|████████▎ | 332/401 [05:20<02:36,  2.27s/it]
 83%|████████▎ | 333/401 [05:24<02:58,  2.63s/it]
 83%|████████▎ | 334/401 [05:24<02:10,  1.95s/it]
 84%|████████▎ | 335/401 [05:27<02:40,  2.43s/it]
 84%|████████▍ | 336/401 [05:31<02:59,  2.76s/it]
 84%|████████▍ | 337/401 [05:32<02:25,  2.27s/it]
 84%|████████▍ | 338/401 [05:33<01:50,  1.76s/it]
 85%|████████▍ | 339/401 [05:33<01:26,  1.40s/it]
 85%|████████▍ | 340/401 [05:33<01:02,  1.03s/it]
 85%|████████▌ | 341/401 [05:34<00:45,  1.32it/s]
 85%|████████▌ | 342/401 [05:34<00:36,  1.60it/s]
 86%|████████▌ | 343/401 [05:34<00:34,  1.68it/s]
 86%|████████▌ | 344/401 [05:35<00:29,  1.92it/s]
 86%|████████▌ | 345/401 [05:36<00:45,  1.24it/s]
 86%|████████▋ | 346/401 [05:37<00:38,  1.44it/s]
 87%|████████▋ | 347/401 [05:37<00:32,  1.67it/s]
 87%|████████▋ | 348/401 [05:37<00:28,  1.83it/s]
 87%|████████▋ | 349/401 [05:38<00:23,  2.17it/s]
 87%|████████▋ | 350/401 [05:41<01:04,  1.27s/it]
 88%|████████▊ | 351/401 [05:44<01:36,  1.94s/it]
 88%|████████▊ | 352/401 [05:45<01:09,  1.42s/it]
 88%|████████▊ | 353/401 [05:48<01:39,  2.08s/it]
 89%|████████▊ | 355/401 [05:49<00:57,  1.25s/it]
 89%|████████▉ | 356/401 [05:52<01:17,  1.72s/it]
 89%|████████▉ | 357/401 [05:53<01:04,  1.46s/it]
 89%|████████▉ | 358/401 [05:54<00:59,  1.38s/it]
 90%|████████▉ | 359/401 [05:55<00:53,  1.27s/it]
 90%|████████▉ | 360/401 [05:56<00:48,  1.18s/it]
 90%|█████████ | 361/401 [05:56<00:38,  1.03it/s]
 90%|█████████ | 362/401 [05:56<00:30,  1.29it/s]
 91%|█████████ | 363/401 [05:57<00:24,  1.54it/s]
 91%|█████████ | 364/401 [05:57<00:19,  1.94it/s]
 91%|█████████ | 365/401 [05:59<00:31,  1.13it/s]
 91%|█████████▏| 366/401 [05:59<00:24,  1.44it/s]
 92%|█████████▏| 367/401 [06:00<00:21,  1.56it/s]
 92%|█████████▏| 368/401 [06:00<00:16,  2.06it/s]
 92%|█████████▏| 369/401 [06:00<00:13,  2.34it/s]
 92%|█████████▏| 370/401 [06:02<00:25,  1.21it/s]
 93%|█████████▎| 371/401 [06:03<00:33,  1.11s/it]
 93%|█████████▎| 372/401 [06:04<00:23,  1.22it/s]
 93%|█████████▎| 373/401 [06:05<00:31,  1.12s/it]
 93%|█████████▎| 374/401 [06:07<00:35,  1.31s/it]
 94%|█████████▎| 375/401 [06:09<00:37,  1.44s/it]
 94%|█████████▍| 376/401 [06:12<00:48,  1.94s/it]
 94%|█████████▍| 377/401 [06:13<00:35,  1.49s/it]
 94%|█████████▍| 378/401 [06:16<00:46,  2.01s/it]
 95%|█████████▍| 379/401 [06:19<00:54,  2.47s/it]
 95%|█████████▍| 380/401 [06:21<00:47,  2.26s/it]
 95%|█████████▌| 382/401 [06:24<00:37,  1.95s/it]
 96%|█████████▌| 383/401 [06:27<00:40,  2.25s/it]
 96%|█████████▌| 384/401 [06:30<00:39,  2.31s/it]
 96%|█████████▌| 385/401 [06:33<00:42,  2.64s/it]
 96%|█████████▋| 386/401 [06:34<00:32,  2.15s/it]
 97%|█████████▋| 387/401 [06:36<00:26,  1.92s/it]
 97%|█████████▋| 388/401 [06:37<00:22,  1.70s/it]
 97%|█████████▋| 389/401 [06:37<00:16,  1.35s/it]
 97%|█████████▋| 390/401 [06:38<00:12,  1.12s/it]
 98%|█████████▊| 391/401 [06:38<00:08,  1.17it/s]
 98%|█████████▊| 392/401 [06:39<00:08,  1.06it/s]
 98%|█████████▊| 393/401 [06:39<00:05,  1.38it/s]
 98%|█████████▊| 394/401 [06:40<00:04,  1.70it/s]
 99%|█████████▊| 395/401 [06:40<00:03,  1.92it/s]
 99%|█████████▉| 396/401 [06:44<00:07,  1.47s/it]
 99%|█████████▉| 397/401 [06:44<00:04,  1.12s/it]
 99%|█████████▉| 398/401 [06:48<00:05,  1.89s/it]
100%|█████████▉| 399/401 [06:51<00:04,  2.40s/it]
100%|█████████▉| 400/401 [06:52<00:01,  1.75s/it]
100%|██████████| 401/401 [06:52<00:00,  1.28s/it]
100%|██████████| 401/401 [06:52<00:00,  1.03s/it]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 10:42:09.122645_ae_processed_test.json', '--output_addr', 'data/out/rag/full_profile/ae_rag_full_profile_test_10_limit_3_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  9.82 examples/s]
Generating train split: 401 examples [00:00, 1745.82 examples/s]
INFO 07-15 10:49:48 config.py:510] This model supports multiple tasks: {'classify', 'reward', 'embed', 'generate', 'score'}. Defaulting to 'generate'.
INFO 07-15 10:49:48 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 10:49:50 selector.py:120] Using Flash Attention backend.
INFO 07-15 10:49:51 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 10:49:51 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:05<00:16,  5.61s/it]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:11<00:11,  5.52s/it]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:16<00:05,  5.34s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:21<00:00,  5.41s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:21<00:00,  5.43s/it]

INFO 07-15 10:50:13 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 10:50:15 worker.py:241] Memory profiling takes 2.36 seconds
INFO 07-15 10:50:15 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 10:50:15 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 10:50:16 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 10:50:16 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 10:50:19 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:15,  2.18it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:12,  2.57it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:11,  2.72it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:11,  2.81it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.86it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:10,  2.88it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.91it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.93it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:08,  2.92it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.94it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.95it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.96it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  2.96it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:07,  2.97it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  2.92it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.93it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:06,  2.96it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  2.99it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  3.00it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:04,  3.02it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:04,  3.03it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  3.04it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:03,  3.05it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:03,  2.97it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  2.98it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:03,  2.95it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:09<00:02,  2.94it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  2.93it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:02,  2.93it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:10<00:01,  2.93it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  2.84it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:01,  2.86it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:11<00:00,  2.78it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  2.81it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  2.83it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  2.91it/s]
INFO 07-15 10:50:31 model_runner.py:1535] Graph capturing finished in 12 secs, took 0.22 GiB
INFO 07-15 10:50:31 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 17.50 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:36<4:04:57, 36.74s/it, est. speed input: 69.13 toks/s, output: 2.53 toks/s]
Processed prompts:   0%|          | 2/401 [00:37<1:41:54, 15.32s/it, est. speed input: 128.25 toks/s, output: 5.10 toks/s]
Processed prompts:   1%|          | 3/401 [00:37<56:58,  8.59s/it, est. speed input: 205.63 toks/s, output: 7.76 toks/s]  
Processed prompts:   1%|          | 5/401 [00:37<25:02,  3.80s/it, est. speed input: 310.05 toks/s, output: 13.17 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:38<19:11,  2.92s/it, est. speed input: 405.71 toks/s, output: 15.79 toks/s]
Processed prompts:   2%|▏         | 7/401 [00:38<13:49,  2.11s/it, est. speed input: 446.72 toks/s, output: 18.62 toks/s]
Processed prompts:   2%|▏         | 9/401 [00:39<08:11,  1.25s/it, est. speed input: 610.08 toks/s, output: 24.14 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:39<06:23,  1.02it/s, est. speed input: 658.21 toks/s, output: 26.95 toks/s]
Processed prompts:   3%|▎         | 11/401 [00:39<05:09,  1.26it/s, est. speed input: 691.15 toks/s, output: 29.68 toks/s]
Processed prompts:   3%|▎         | 13/401 [00:40<03:34,  1.81it/s, est. speed input: 753.80 toks/s, output: 35.13 toks/s]
Processed prompts:   4%|▎         | 15/401 [00:40<02:39,  2.41it/s, est. speed input: 820.29 toks/s, output: 40.64 toks/s]
Processed prompts:   4%|▍         | 18/401 [00:40<01:45,  3.64it/s, est. speed input: 937.21 toks/s, output: 49.11 toks/s]
Processed prompts:   5%|▍         | 19/401 [00:40<01:40,  3.79it/s, est. speed input: 970.72 toks/s, output: 51.81 toks/s]
Processed prompts:   5%|▌         | 21/401 [00:41<01:17,  4.92it/s, est. speed input: 1031.84 toks/s, output: 57.51 toks/s]
Processed prompts:   5%|▌         | 22/401 [00:41<01:21,  4.63it/s, est. speed input: 1110.12 toks/s, output: 60.11 toks/s]
Processed prompts:   6%|▌         | 24/401 [00:41<01:20,  4.70it/s, est. speed input: 1186.42 toks/s, output: 65.49 toks/s]
Processed prompts:   6%|▌         | 25/401 [00:41<01:13,  5.09it/s, est. speed input: 1221.20 toks/s, output: 68.31 toks/s]
Processed prompts:   7%|▋         | 27/401 [00:42<01:09,  5.38it/s, est. speed input: 1355.56 toks/s, output: 73.80 toks/s]
Processed prompts:   7%|▋         | 30/401 [00:42<00:54,  6.79it/s, est. speed input: 1442.87 toks/s, output: 82.33 toks/s]
Processed prompts:   8%|▊         | 32/401 [00:42<00:59,  6.16it/s, est. speed input: 1544.23 toks/s, output: 87.60 toks/s]
Processed prompts:   8%|▊         | 34/401 [00:43<00:55,  6.67it/s, est. speed input: 1604.09 toks/s, output: 93.15 toks/s]
Processed prompts:   9%|▉         | 36/401 [00:43<01:00,  6.08it/s, est. speed input: 1664.31 toks/s, output: 98.33 toks/s]
Processed prompts:  10%|▉         | 40/401 [00:44<00:57,  6.32it/s, est. speed input: 1812.97 toks/s, output: 108.95 toks/s]
Processed prompts:  11%|█         | 44/401 [00:45<01:07,  5.28it/s, est. speed input: 1957.82 toks/s, output: 118.46 toks/s]
Processed prompts:  13%|█▎        | 51/401 [00:46<00:54,  6.48it/s, est. speed input: 2200.74 toks/s, output: 136.73 toks/s]
Processed prompts:  13%|█▎        | 53/401 [00:46<01:02,  5.60it/s, est. speed input: 2284.29 toks/s, output: 140.80 toks/s]
Processed prompts:  14%|█▍        | 56/401 [00:47<00:58,  5.94it/s, est. speed input: 2373.17 toks/s, output: 148.24 toks/s]
Processed prompts:  15%|█▍        | 59/401 [00:47<01:01,  5.60it/s, est. speed input: 2492.66 toks/s, output: 154.96 toks/s]
Processed prompts:  16%|█▌        | 64/401 [00:48<00:54,  6.15it/s, est. speed input: 2639.99 toks/s, output: 167.05 toks/s]
Processed prompts:  17%|█▋        | 68/401 [00:48<00:52,  6.32it/s, est. speed input: 2746.90 toks/s, output: 176.41 toks/s]
Processed prompts:  18%|█▊        | 73/401 [00:49<00:54,  5.98it/s, est. speed input: 2923.78 toks/s, output: 187.22 toks/s]
Processed prompts:  19%|█▉        | 76/401 [00:50<01:00,  5.41it/s, est. speed input: 3018.18 toks/s, output: 192.92 toks/s]
Processed prompts:  21%|██        | 84/401 [00:51<00:53,  5.91it/s, est. speed input: 3223.31 toks/s, output: 210.35 toks/s]
Processed prompts:  22%|██▏       | 87/401 [00:52<00:55,  5.65it/s, est. speed input: 3275.07 toks/s, output: 216.05 toks/s]
Processed prompts:  23%|██▎       | 92/401 [00:53<00:57,  5.41it/s, est. speed input: 3368.56 toks/s, output: 225.48 toks/s]
Processed prompts:  24%|██▎       | 95/401 [00:53<00:57,  5.34it/s, est. speed input: 3454.44 toks/s, output: 231.11 toks/s]
Processed prompts:  24%|██▍       | 98/401 [00:54<00:49,  6.13it/s, est. speed input: 3569.51 toks/s, output: 238.10 toks/s]
Processed prompts:  25%|██▌       | 101/401 [00:54<00:50,  5.94it/s, est. speed input: 3615.59 toks/s, output: 243.77 toks/s]
Processed prompts:  26%|██▌       | 104/401 [00:55<00:48,  6.17it/s, est. speed input: 3650.02 toks/s, output: 249.91 toks/s]
Processed prompts:  27%|██▋       | 108/401 [00:55<00:49,  5.86it/s, est. speed input: 3705.67 toks/s, output: 257.23 toks/s]
Processed prompts:  28%|██▊       | 114/401 [00:56<00:48,  5.97it/s, est. speed input: 3838.26 toks/s, output: 268.61 toks/s]
Processed prompts:  30%|██▉       | 119/401 [00:57<00:49,  5.71it/s, est. speed input: 4032.17 toks/s, output: 277.26 toks/s]
Processed prompts:  30%|███       | 122/401 [00:58<00:48,  5.71it/s, est. speed input: 4131.60 toks/s, output: 282.59 toks/s]
Processed prompts:  32%|███▏      | 127/401 [00:59<00:47,  5.81it/s, est. speed input: 4240.43 toks/s, output: 291.53 toks/s]
Processed prompts:  33%|███▎      | 131/401 [00:59<00:43,  6.18it/s, est. speed input: 4401.29 toks/s, output: 299.20 toks/s]
Processed prompts:  34%|███▍      | 136/401 [01:00<00:44,  5.93it/s, est. speed input: 4491.80 toks/s, output: 307.49 toks/s]
Processed prompts:  35%|███▌      | 141/401 [01:01<00:40,  6.46it/s, est. speed input: 4594.39 toks/s, output: 317.07 toks/s]
Processed prompts:  36%|███▌      | 143/401 [01:01<00:40,  6.30it/s, est. speed input: 4617.44 toks/s, output: 320.32 toks/s]
Processed prompts:  36%|███▌      | 145/401 [01:01<00:36,  6.95it/s, est. speed input: 4672.21 toks/s, output: 324.64 toks/s]
Processed prompts:  37%|███▋      | 147/401 [01:02<00:35,  7.17it/s, est. speed input: 4737.16 toks/s, output: 328.50 toks/s]
Processed prompts:  39%|███▉      | 157/401 [01:02<00:15, 15.49it/s, est. speed input: 5109.66 toks/s, output: 353.58 toks/s]
Processed prompts:  42%|████▏     | 169/401 [01:02<00:08, 26.61it/s, est. speed input: 5582.08 toks/s, output: 384.12 toks/s]
Processed prompts:  43%|████▎     | 174/401 [01:02<00:07, 28.57it/s, est. speed input: 5757.84 toks/s, output: 396.53 toks/s]
Processed prompts:  46%|████▌     | 185/401 [01:02<00:05, 39.73it/s, est. speed input: 6102.21 toks/s, output: 424.99 toks/s]
Processed prompts:  48%|████▊     | 191/401 [01:02<00:05, 37.92it/s, est. speed input: 6286.72 toks/s, output: 439.91 toks/s]
Processed prompts:  49%|████▉     | 196/401 [01:03<00:05, 35.09it/s, est. speed input: 6497.63 toks/s, output: 452.42 toks/s]
Processed prompts:  50%|█████     | 201/401 [01:03<00:06, 33.25it/s, est. speed input: 6644.12 toks/s, output: 465.05 toks/s]
Processed prompts:  51%|█████     | 205/401 [01:03<00:05, 33.58it/s, est. speed input: 6752.74 toks/s, output: 475.44 toks/s]
Processed prompts:  52%|█████▏    | 210/401 [01:03<00:05, 36.00it/s, est. speed input: 6881.45 toks/s, output: 488.76 toks/s]
Processed prompts:  53%|█████▎    | 214/401 [01:03<00:08, 20.87it/s, est. speed input: 6969.29 toks/s, output: 497.07 toks/s]
Processed prompts:  54%|█████▍    | 218/401 [01:03<00:07, 23.48it/s, est. speed input: 7067.52 toks/s, output: 508.12 toks/s]
Processed prompts:  55%|█████▌    | 222/401 [01:04<00:07, 23.82it/s, est. speed input: 7149.75 toks/s, output: 518.82 toks/s]
Processed prompts:  56%|█████▋    | 226/401 [01:04<00:06, 26.52it/s, est. speed input: 7326.94 toks/s, output: 530.12 toks/s]
Processed prompts:  57%|█████▋    | 230/401 [01:04<00:05, 29.06it/s, est. speed input: 7438.33 toks/s, output: 541.51 toks/s]
Processed prompts:  58%|█████▊    | 234/401 [01:04<00:05, 31.31it/s, est. speed input: 7545.40 toks/s, output: 553.01 toks/s]
Processed prompts:  59%|█████▉    | 238/401 [01:04<00:04, 33.32it/s, est. speed input: 7625.03 toks/s, output: 564.58 toks/s]
Processed prompts:  60%|██████    | 242/401 [01:04<00:07, 21.26it/s, est. speed input: 7699.48 toks/s, output: 572.18 toks/s]
Processed prompts:  61%|██████    | 245/401 [01:05<00:14, 10.95it/s, est. speed input: 7698.63 toks/s, output: 576.09 toks/s]
Processed prompts:  62%|██████▏   | 248/401 [01:06<00:21,  7.18it/s, est. speed input: 7699.49 toks/s, output: 577.15 toks/s]
Processed prompts:  62%|██████▏   | 250/401 [01:06<00:21,  7.10it/s, est. speed input: 7752.88 toks/s, output: 580.00 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [01:07<00:24,  6.13it/s, est. speed input: 7776.33 toks/s, output: 579.71 toks/s]
Processed prompts:  63%|██████▎   | 254/401 [01:07<00:20,  7.06it/s, est. speed input: 7847.58 toks/s, output: 584.03 toks/s]
Processed prompts:  64%|██████▍   | 256/401 [01:07<00:22,  6.48it/s, est. speed input: 7863.34 toks/s, output: 586.77 toks/s]
Processed prompts:  65%|██████▌   | 261/401 [01:07<00:13, 10.10it/s, est. speed input: 8016.68 toks/s, output: 595.31 toks/s]
Processed prompts:  66%|██████▌   | 265/401 [01:08<00:11, 11.81it/s, est. speed input: 8143.73 toks/s, output: 602.44 toks/s]
Processed prompts:  68%|██████▊   | 271/401 [01:08<00:07, 17.20it/s, est. speed input: 8280.78 toks/s, output: 613.96 toks/s]
Processed prompts:  68%|██████▊   | 274/401 [01:08<00:07, 18.13it/s, est. speed input: 8342.02 toks/s, output: 618.97 toks/s]
Processed prompts:  69%|██████▉   | 277/401 [01:08<00:06, 19.28it/s, est. speed input: 8406.00 toks/s, output: 626.52 toks/s]
Processed prompts:  70%|███████   | 282/401 [01:08<00:06, 19.71it/s, est. speed input: 8545.08 toks/s, output: 634.79 toks/s]
Processed prompts:  72%|███████▏  | 289/401 [01:09<00:04, 24.36it/s, est. speed input: 8760.89 toks/s, output: 648.72 toks/s]
Processed prompts:  73%|███████▎  | 294/401 [01:09<00:03, 28.12it/s, est. speed input: 8911.39 toks/s, output: 658.98 toks/s]
Processed prompts:  75%|███████▍  | 299/401 [01:09<00:03, 31.66it/s, est. speed input: 9086.99 toks/s, output: 669.67 toks/s]
Processed prompts:  76%|███████▌  | 303/401 [01:09<00:03, 28.42it/s, est. speed input: 9243.94 toks/s, output: 678.93 toks/s]
Processed prompts:  77%|███████▋  | 307/401 [01:09<00:03, 28.33it/s, est. speed input: 9352.23 toks/s, output: 687.39 toks/s]
Processed prompts:  78%|███████▊  | 314/401 [01:09<00:02, 36.89it/s, est. speed input: 9553.73 toks/s, output: 704.03 toks/s]
Processed prompts:  80%|███████▉  | 319/401 [01:09<00:02, 39.92it/s, est. speed input: 9742.29 toks/s, output: 715.97 toks/s]
Processed prompts:  82%|████████▏ | 329/401 [01:09<00:01, 51.32it/s, est. speed input: 10139.71 toks/s, output: 740.13 toks/s]
Processed prompts:  84%|████████▍ | 337/401 [01:10<00:01, 55.68it/s, est. speed input: 10391.20 toks/s, output: 758.97 toks/s]
Processed prompts:  88%|████████▊ | 351/401 [01:10<00:00, 75.35it/s, est. speed input: 10928.73 toks/s, output: 796.51 toks/s]
Processed prompts:  90%|████████▉ | 359/401 [01:10<00:00, 67.73it/s, est. speed input: 11171.39 toks/s, output: 818.79 toks/s]
Processed prompts:  92%|█████████▏| 369/401 [01:10<00:00, 61.48it/s, est. speed input: 11475.72 toks/s, output: 843.62 toks/s]
Processed prompts:  94%|█████████▍| 376/401 [01:10<00:00, 41.76it/s, est. speed input: 11706.18 toks/s, output: 860.89 toks/s]
Processed prompts:  95%|█████████▌| 382/401 [01:10<00:00, 38.11it/s, est. speed input: 11897.72 toks/s, output: 877.44 toks/s]
Processed prompts:  97%|█████████▋| 387/401 [01:11<00:00, 29.94it/s, est. speed input: 12016.81 toks/s, output: 892.62 toks/s]
Processed prompts:  98%|█████████▊| 391/401 [01:11<00:00, 18.56it/s, est. speed input: 12064.80 toks/s, output: 901.29 toks/s]
Processed prompts:  98%|█████████▊| 394/401 [01:12<00:00, 12.81it/s, est. speed input: 12059.57 toks/s, output: 909.29 toks/s]
Processed prompts:  99%|█████████▉| 397/401 [01:13<00:00,  8.54it/s, est. speed input: 12079.99 toks/s, output: 914.29 toks/s]
Processed prompts: 100%|█████████▉| 399/401 [01:13<00:00,  6.50it/s, est. speed input: 12073.16 toks/s, output: 919.10 toks/s]
Processed prompts: 100%|██████████| 401/401 [01:15<00:00,  3.54it/s, est. speed input: 11873.60 toks/s, output: 913.00 toks/s]
Processed prompts: 100%|██████████| 401/401 [01:15<00:00,  5.30it/s, est. speed input: 11873.60 toks/s, output: 913.00 toks/s]
{  "personalized_answer": {    "advice": "Given your experience as a new DM and the current makeup of your party, it's important to balance the challenges to keep the game engaging without overwhelming the players. For an ambush with ghosts, consider the following: Since your party consists of a fighter, a rogue, a wizard, and soon a monk, they have a mix of melee, ranged, and spellcasting capabilities. Ghosts can be effective for an ambush, but you might want to limit the number to ensure the encounter is challenging but not too daunting. A group of 2-3 ghosts could work well, especially if they are strategically placed to take advantage of the party's weaknesses. For example, one ghost could target the rogue, another the wizard, and the third could use its haunting whispers to affect the monk's morale. This setup allows for a mix of physical and mental challenges, which can make the encounter more dynamic and less about just "smashing monsters." Remember to provide the players with opportunities to use their skills and strategies, and consider giving them a short rest before the ambush to ensure they are prepared. This approach should help maintain the balance and keep the game enjoyable for everyone."  }}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.37s/it, est. speed input: 474.26 toks/s, output: 81.51 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.37s/it, est. speed input: 474.26 toks/s, output: 81.51 toks/s]
[rank0]:[W715 10:51:52.867159864 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/ae_rag_full_profile_test_10_limit_3_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 10:51:56.948965_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 10:51:56.948965_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 10:51:56.948965_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:42,  3.23it/s]
  1%|          | 3/526 [00:00<01:23,  6.25it/s]
  1%|          | 5/526 [00:00<00:58,  8.90it/s]
  1%|▏         | 7/526 [00:00<00:46, 11.08it/s]
  2%|▏         | 9/526 [00:01<01:52,  4.58it/s]
  2%|▏         | 11/526 [00:01<01:26,  5.96it/s]
  2%|▏         | 13/526 [00:02<01:40,  5.09it/s]
  3%|▎         | 15/526 [00:02<01:23,  6.11it/s]
  3%|▎         | 16/526 [00:02<01:25,  5.97it/s]
  3%|▎         | 18/526 [00:02<01:09,  7.30it/s]
  4%|▎         | 19/526 [00:02<01:10,  7.23it/s]
  4%|▍         | 20/526 [00:03<01:28,  5.72it/s]
  4%|▍         | 21/526 [00:04<03:26,  2.44it/s]
  4%|▍         | 22/526 [00:04<03:27,  2.43it/s]
  4%|▍         | 23/526 [00:05<04:15,  1.97it/s]
  5%|▍         | 24/526 [00:06<04:49,  1.73it/s]
  5%|▍         | 25/526 [00:07<06:02,  1.38it/s]
  5%|▍         | 26/526 [00:07<05:03,  1.65it/s]
  5%|▌         | 27/526 [00:07<03:57,  2.10it/s]
  5%|▌         | 28/526 [00:08<03:48,  2.18it/s]
  6%|▌         | 30/526 [00:10<05:11,  1.59it/s]
  6%|▌         | 31/526 [00:10<05:00,  1.65it/s]
  6%|▌         | 32/526 [00:10<04:27,  1.84it/s]
  6%|▋         | 33/526 [00:12<06:22,  1.29it/s]
  6%|▋         | 34/526 [00:13<06:37,  1.24it/s]
  7%|▋         | 35/526 [00:14<07:13,  1.13it/s]
  7%|▋         | 36/526 [00:14<05:34,  1.47it/s]
  7%|▋         | 37/526 [00:14<04:46,  1.70it/s]
  7%|▋         | 39/526 [00:14<02:48,  2.90it/s]
  8%|▊         | 40/526 [00:15<02:29,  3.25it/s]
  8%|▊         | 42/526 [00:15<01:54,  4.23it/s]
  8%|▊         | 43/526 [00:16<02:33,  3.15it/s]
  9%|▊         | 45/526 [00:16<01:49,  4.41it/s]
  9%|▊         | 46/526 [00:16<01:55,  4.17it/s]
  9%|▉         | 47/526 [00:16<02:13,  3.60it/s]
  9%|▉         | 48/526 [00:17<02:47,  2.85it/s]
  9%|▉         | 49/526 [00:17<02:15,  3.51it/s]
 10%|▉         | 50/526 [00:17<02:13,  3.57it/s]
 10%|▉         | 52/526 [00:18<01:39,  4.75it/s]
 10%|█         | 53/526 [00:19<03:51,  2.04it/s]
 10%|█         | 54/526 [00:22<09:52,  1.26s/it]
 11%|█         | 56/526 [00:23<05:54,  1.33it/s]
 11%|█         | 58/526 [00:23<04:47,  1.63it/s]
 11%|█         | 59/526 [00:24<05:03,  1.54it/s]
 11%|█▏        | 60/526 [00:25<05:34,  1.39it/s]
 12%|█▏        | 61/526 [00:26<05:25,  1.43it/s]
 12%|█▏        | 62/526 [00:27<06:26,  1.20it/s]
 12%|█▏        | 63/526 [00:28<07:49,  1.01s/it]
 12%|█▏        | 64/526 [00:29<06:19,  1.22it/s]
 12%|█▏        | 65/526 [00:29<04:48,  1.60it/s]
 13%|█▎        | 66/526 [00:29<04:02,  1.90it/s]
 13%|█▎        | 67/526 [00:30<03:50,  2.00it/s]
 13%|█▎        | 68/526 [00:31<04:56,  1.54it/s]
 13%|█▎        | 69/526 [00:31<03:49,  1.99it/s]
 13%|█▎        | 70/526 [00:32<06:03,  1.25it/s]
 13%|█▎        | 71/526 [00:33<06:12,  1.22it/s]
 14%|█▎        | 72/526 [00:34<05:44,  1.32it/s]
 14%|█▍        | 73/526 [00:35<06:36,  1.14it/s]
 14%|█▍        | 74/526 [00:36<07:58,  1.06s/it]
 14%|█▍        | 75/526 [00:37<05:56,  1.26it/s]
 14%|█▍        | 76/526 [00:37<04:31,  1.66it/s]
 15%|█▍        | 77/526 [00:38<05:46,  1.30it/s]
 15%|█▍        | 78/526 [00:39<07:24,  1.01it/s]
 15%|█▌        | 79/526 [00:39<05:27,  1.36it/s]
 15%|█▌        | 80/526 [00:40<04:26,  1.67it/s]
 16%|█▌        | 82/526 [00:41<04:36,  1.60it/s]
 16%|█▌        | 84/526 [00:42<04:22,  1.69it/s]
 16%|█▌        | 85/526 [00:44<06:19,  1.16it/s]
 16%|█▋        | 86/526 [00:44<05:22,  1.36it/s]
 17%|█▋        | 87/526 [00:45<05:54,  1.24it/s]
 17%|█▋        | 88/526 [00:46<04:56,  1.48it/s]
 17%|█▋        | 89/526 [00:46<04:15,  1.71it/s]
 17%|█▋        | 90/526 [00:46<03:47,  1.92it/s]
 17%|█▋        | 91/526 [00:47<03:43,  1.94it/s]
 17%|█▋        | 92/526 [00:47<02:55,  2.47it/s]
 18%|█▊        | 93/526 [00:47<02:19,  3.10it/s]
 18%|█▊        | 95/526 [00:47<01:37,  4.42it/s]
 18%|█▊        | 96/526 [00:48<02:06,  3.40it/s]
 18%|█▊        | 97/526 [00:49<02:52,  2.49it/s]
 19%|█▊        | 98/526 [00:52<08:11,  1.15s/it]
 19%|█▉        | 99/526 [00:55<12:29,  1.75s/it]
 19%|█▉        | 101/526 [00:55<07:40,  1.08s/it]
 19%|█▉        | 102/526 [00:56<06:34,  1.08it/s]
 20%|█▉        | 103/526 [00:57<06:04,  1.16it/s]
 20%|█▉        | 104/526 [00:58<07:06,  1.01s/it]
 20%|█▉        | 105/526 [00:58<05:21,  1.31it/s]
 20%|██        | 106/526 [00:59<04:48,  1.46it/s]
 21%|██        | 108/526 [00:59<03:22,  2.06it/s]
 21%|██        | 109/526 [00:59<03:10,  2.19it/s]
 21%|██        | 110/526 [01:01<04:15,  1.63it/s]
 21%|██        | 111/526 [01:01<03:54,  1.77it/s]
 21%|██▏       | 112/526 [01:01<03:45,  1.84it/s]
 21%|██▏       | 113/526 [01:02<02:56,  2.34it/s]
 22%|██▏       | 114/526 [01:02<02:27,  2.79it/s]
 22%|██▏       | 115/526 [01:02<02:01,  3.37it/s]
 22%|██▏       | 116/526 [01:02<01:38,  4.17it/s]
 22%|██▏       | 117/526 [01:03<03:42,  1.84it/s]
 22%|██▏       | 118/526 [01:05<05:12,  1.30it/s]
 23%|██▎       | 119/526 [01:05<04:20,  1.56it/s]
 23%|██▎       | 120/526 [01:06<05:07,  1.32it/s]
 23%|██▎       | 121/526 [01:06<04:03,  1.67it/s]
 23%|██▎       | 122/526 [01:08<05:31,  1.22it/s]
 23%|██▎       | 123/526 [01:09<06:07,  1.10it/s]
 24%|██▎       | 124/526 [01:10<07:03,  1.05s/it]
 24%|██▍       | 125/526 [01:10<05:13,  1.28it/s]
 24%|██▍       | 127/526 [01:10<03:16,  2.03it/s]
 24%|██▍       | 128/526 [01:11<02:44,  2.41it/s]
 25%|██▍       | 129/526 [01:11<02:42,  2.44it/s]
 25%|██▍       | 130/526 [01:11<02:40,  2.47it/s]
 25%|██▍       | 131/526 [01:12<02:21,  2.78it/s]
 25%|██▌       | 132/526 [01:12<01:58,  3.33it/s]
 25%|██▌       | 133/526 [01:12<01:43,  3.81it/s]
 26%|██▌       | 135/526 [01:12<01:32,  4.22it/s]
 26%|██▌       | 136/526 [01:13<01:42,  3.80it/s]
 26%|██▌       | 137/526 [01:13<01:26,  4.48it/s]
 26%|██▌       | 138/526 [01:13<01:24,  4.59it/s]
 26%|██▋       | 139/526 [01:13<01:37,  3.96it/s]
 27%|██▋       | 140/526 [01:14<01:28,  4.38it/s]
 27%|██▋       | 141/526 [01:14<01:27,  4.40it/s]
 27%|██▋       | 142/526 [01:14<01:20,  4.78it/s]
 27%|██▋       | 143/526 [01:15<02:06,  3.04it/s]
 27%|██▋       | 144/526 [01:15<01:45,  3.62it/s]
 28%|██▊       | 145/526 [01:16<03:38,  1.74it/s]
 28%|██▊       | 146/526 [01:16<03:13,  1.97it/s]
 28%|██▊       | 147/526 [01:17<02:59,  2.11it/s]
 28%|██▊       | 149/526 [01:17<02:15,  2.77it/s]
 29%|██▊       | 150/526 [01:17<01:55,  3.27it/s]
 29%|██▊       | 151/526 [01:18<01:39,  3.75it/s]
 29%|██▉       | 152/526 [01:18<01:29,  4.18it/s]
 29%|██▉       | 154/526 [01:19<02:20,  2.64it/s]
 29%|██▉       | 155/526 [01:20<03:09,  1.96it/s]
 30%|██▉       | 156/526 [01:21<03:57,  1.56it/s]
 30%|██▉       | 157/526 [01:21<03:35,  1.71it/s]
 30%|███       | 159/526 [01:21<02:11,  2.80it/s]
 30%|███       | 160/526 [01:23<03:48,  1.60it/s]
 31%|███       | 161/526 [01:23<03:17,  1.85it/s]
 31%|███       | 162/526 [01:25<05:39,  1.07it/s]
 31%|███       | 164/526 [01:26<03:44,  1.61it/s]
 32%|███▏      | 166/526 [01:26<02:34,  2.33it/s]
 32%|███▏      | 167/526 [01:26<02:26,  2.45it/s]
 32%|███▏      | 168/526 [01:27<03:37,  1.65it/s]
 32%|███▏      | 169/526 [01:28<03:11,  1.87it/s]
 33%|███▎      | 171/526 [01:30<04:31,  1.31it/s]
 33%|███▎      | 172/526 [01:30<03:43,  1.58it/s]
 33%|███▎      | 173/526 [01:30<03:16,  1.80it/s]
 33%|███▎      | 174/526 [01:31<03:01,  1.94it/s]
 33%|███▎      | 175/526 [01:31<02:25,  2.41it/s]
 33%|███▎      | 176/526 [01:32<03:17,  1.78it/s]
 34%|███▎      | 177/526 [01:32<02:33,  2.27it/s]
 34%|███▍      | 178/526 [01:32<02:03,  2.82it/s]
 34%|███▍      | 179/526 [01:32<01:42,  3.38it/s]
 34%|███▍      | 180/526 [01:34<03:24,  1.70it/s]
 34%|███▍      | 181/526 [01:34<02:38,  2.17it/s]
 35%|███▍      | 182/526 [01:35<04:26,  1.29it/s]
 35%|███▍      | 183/526 [01:35<03:19,  1.72it/s]
 35%|███▍      | 184/526 [01:36<03:20,  1.71it/s]
 35%|███▌      | 186/526 [01:38<04:14,  1.34it/s]
 36%|███▌      | 187/526 [01:38<03:47,  1.49it/s]
 36%|███▌      | 188/526 [01:39<03:35,  1.57it/s]
 36%|███▌      | 190/526 [01:39<02:18,  2.43it/s]
 36%|███▋      | 191/526 [01:39<01:59,  2.81it/s]
 37%|███▋      | 192/526 [01:39<01:42,  3.25it/s]
 37%|███▋      | 193/526 [01:40<01:25,  3.90it/s]
 37%|███▋      | 194/526 [01:40<01:13,  4.51it/s]
 37%|███▋      | 195/526 [01:41<02:53,  1.91it/s]
 37%|███▋      | 196/526 [01:42<04:00,  1.37it/s]
 37%|███▋      | 197/526 [01:42<03:14,  1.69it/s]
 38%|███▊      | 198/526 [01:43<02:56,  1.86it/s]
 38%|███▊      | 199/526 [01:45<05:18,  1.03it/s]
 38%|███▊      | 200/526 [01:45<04:07,  1.32it/s]
 38%|███▊      | 201/526 [01:46<04:17,  1.26it/s]
 38%|███▊      | 202/526 [01:46<03:23,  1.59it/s]
 39%|███▊      | 203/526 [01:47<03:42,  1.45it/s]
 39%|███▉      | 205/526 [01:47<02:10,  2.47it/s]
 39%|███▉      | 206/526 [01:47<01:50,  2.90it/s]
 39%|███▉      | 207/526 [01:48<01:41,  3.13it/s]
 40%|███▉      | 209/526 [01:48<01:05,  4.87it/s]
 40%|████      | 211/526 [01:49<01:48,  2.90it/s]
 40%|████      | 212/526 [01:49<01:42,  3.05it/s]
 41%|████      | 214/526 [01:49<01:18,  3.97it/s]
 41%|████      | 215/526 [01:50<01:45,  2.94it/s]
 41%|████      | 216/526 [01:50<01:45,  2.93it/s]
 41%|████▏     | 217/526 [01:51<02:37,  1.96it/s]
 41%|████▏     | 218/526 [01:52<03:19,  1.54it/s]
 42%|████▏     | 219/526 [01:53<03:30,  1.46it/s]
 42%|████▏     | 220/526 [01:53<02:40,  1.90it/s]
 42%|████▏     | 222/526 [01:53<01:39,  3.06it/s]
 42%|████▏     | 223/526 [01:55<02:30,  2.01it/s]
 43%|████▎     | 224/526 [01:55<02:05,  2.41it/s]
 43%|████▎     | 225/526 [01:55<02:03,  2.44it/s]
 43%|████▎     | 227/526 [01:56<01:41,  2.96it/s]
 43%|████▎     | 228/526 [01:56<01:26,  3.46it/s]
 44%|████▎     | 229/526 [01:56<01:36,  3.09it/s]
 44%|████▎     | 230/526 [01:56<01:26,  3.44it/s]
 44%|████▍     | 231/526 [01:57<02:23,  2.06it/s]
 44%|████▍     | 232/526 [01:57<01:52,  2.62it/s]
 44%|████▍     | 233/526 [01:58<01:36,  3.05it/s]
 44%|████▍     | 234/526 [01:59<02:58,  1.63it/s]
 45%|████▍     | 235/526 [01:59<02:48,  1.73it/s]
 45%|████▍     | 236/526 [02:00<02:11,  2.20it/s]
 45%|████▌     | 237/526 [02:00<02:04,  2.33it/s]
 45%|████▌     | 238/526 [02:00<01:45,  2.74it/s]
 46%|████▌     | 240/526 [02:00<01:06,  4.28it/s]
 46%|████▌     | 241/526 [02:01<02:03,  2.30it/s]
 46%|████▌     | 243/526 [02:02<01:45,  2.68it/s]
 46%|████▋     | 244/526 [02:02<01:49,  2.58it/s]
 47%|████▋     | 245/526 [02:03<02:35,  1.81it/s]
 47%|████▋     | 246/526 [02:04<02:16,  2.05it/s]
 47%|████▋     | 247/526 [02:04<01:53,  2.47it/s]
 47%|████▋     | 248/526 [02:05<02:10,  2.12it/s]
 47%|████▋     | 249/526 [02:06<02:53,  1.60it/s]
 48%|████▊     | 250/526 [02:06<02:16,  2.02it/s]
 48%|████▊     | 251/526 [02:07<02:53,  1.59it/s]
 48%|████▊     | 252/526 [02:07<02:29,  1.83it/s]
 48%|████▊     | 253/526 [02:07<01:59,  2.28it/s]
 48%|████▊     | 255/526 [02:08<02:11,  2.05it/s]
 49%|████▊     | 256/526 [02:09<01:56,  2.32it/s]
 49%|████▉     | 257/526 [02:10<02:55,  1.53it/s]
 49%|████▉     | 258/526 [02:11<03:18,  1.35it/s]
 49%|████▉     | 259/526 [02:11<02:32,  1.75it/s]
 49%|████▉     | 260/526 [02:11<02:00,  2.21it/s]
 50%|████▉     | 261/526 [02:12<02:04,  2.13it/s]
 50%|████▉     | 262/526 [02:12<01:36,  2.72it/s]
 50%|█████     | 263/526 [02:13<02:23,  1.83it/s]
 50%|█████     | 264/526 [02:14<02:46,  1.57it/s]
 50%|█████     | 265/526 [02:14<02:08,  2.04it/s]
 51%|█████     | 266/526 [02:14<02:18,  1.87it/s]
 51%|█████     | 267/526 [02:15<02:26,  1.77it/s]
 51%|█████     | 268/526 [02:15<01:53,  2.28it/s]
 51%|█████     | 269/526 [02:15<01:35,  2.68it/s]
 51%|█████▏    | 270/526 [02:16<01:48,  2.35it/s]
 52%|█████▏    | 271/526 [02:16<01:30,  2.81it/s]
 52%|█████▏    | 272/526 [02:17<01:44,  2.43it/s]
 52%|█████▏    | 273/526 [02:18<02:31,  1.67it/s]
 52%|█████▏    | 274/526 [02:18<02:17,  1.84it/s]
 52%|█████▏    | 275/526 [02:21<05:42,  1.37s/it]
 52%|█████▏    | 276/526 [02:22<04:14,  1.02s/it]
 53%|█████▎    | 277/526 [02:22<03:12,  1.29it/s]
 53%|█████▎    | 278/526 [02:23<03:09,  1.31it/s]
 53%|█████▎    | 279/526 [02:26<06:24,  1.56s/it]
 53%|█████▎    | 280/526 [02:30<08:50,  2.16s/it]
 53%|█████▎    | 281/526 [02:33<10:12,  2.50s/it]
 54%|█████▎    | 282/526 [02:36<11:15,  2.77s/it]
 54%|█████▍    | 283/526 [02:40<11:49,  2.92s/it]
 54%|█████▍    | 284/526 [02:43<12:15,  3.04s/it]
 54%|█████▍    | 285/526 [02:43<09:05,  2.26s/it]
 54%|█████▍    | 286/526 [02:44<07:22,  1.84s/it]
 55%|█████▍    | 287/526 [02:44<05:21,  1.35s/it]
 55%|█████▍    | 288/526 [02:45<04:02,  1.02s/it]
 55%|█████▍    | 289/526 [02:45<03:01,  1.30it/s]
 55%|█████▌    | 291/526 [02:46<02:36,  1.50it/s]
 56%|█████▌    | 292/526 [02:46<02:09,  1.81it/s]
 56%|█████▌    | 293/526 [02:47<02:20,  1.66it/s]
 56%|█████▌    | 294/526 [02:47<02:02,  1.89it/s]
 56%|█████▌    | 295/526 [02:47<01:48,  2.13it/s]
 56%|█████▋    | 296/526 [02:48<01:39,  2.32it/s]
 57%|█████▋    | 298/526 [02:51<03:43,  1.02it/s]
 57%|█████▋    | 299/526 [02:54<05:45,  1.52s/it]
 57%|█████▋    | 300/526 [02:56<05:42,  1.52s/it]
 57%|█████▋    | 301/526 [02:57<05:13,  1.39s/it]
 57%|█████▋    | 302/526 [02:58<05:16,  1.41s/it]
 58%|█████▊    | 303/526 [03:00<05:20,  1.44s/it]
 58%|█████▊    | 304/526 [03:00<04:07,  1.12s/it]
 58%|█████▊    | 305/526 [03:02<04:31,  1.23s/it]
 58%|█████▊    | 306/526 [03:03<04:42,  1.29s/it]
 58%|█████▊    | 307/526 [03:05<04:56,  1.35s/it]
 59%|█████▊    | 308/526 [03:06<05:04,  1.40s/it]
 59%|█████▊    | 309/526 [03:06<03:50,  1.06s/it]
 59%|█████▉    | 310/526 [03:07<03:41,  1.02s/it]
 59%|█████▉    | 311/526 [03:08<02:49,  1.27it/s]
 59%|█████▉    | 312/526 [03:09<03:38,  1.02s/it]
 60%|█████▉    | 313/526 [03:11<04:10,  1.18s/it]
 60%|█████▉    | 314/526 [03:12<04:41,  1.33s/it]
 60%|█████▉    | 315/526 [03:16<06:38,  1.89s/it]
 60%|██████    | 316/526 [03:16<04:45,  1.36s/it]
 60%|██████    | 317/526 [03:17<04:15,  1.22s/it]
 60%|██████    | 318/526 [03:17<03:51,  1.11s/it]
 61%|██████    | 319/526 [03:18<03:04,  1.12it/s]
 61%|██████    | 320/526 [03:18<02:18,  1.49it/s]
 61%|██████    | 321/526 [03:20<03:22,  1.01it/s]
 61%|██████    | 322/526 [03:20<02:43,  1.25it/s]
 61%|██████▏   | 323/526 [03:20<02:07,  1.59it/s]
 62%|██████▏   | 324/526 [03:21<01:44,  1.93it/s]
 62%|██████▏   | 325/526 [03:21<01:29,  2.24it/s]
 62%|██████▏   | 326/526 [03:21<01:10,  2.84it/s]
 62%|██████▏   | 327/526 [03:21<01:09,  2.86it/s]
 62%|██████▏   | 328/526 [03:21<00:58,  3.37it/s]
 63%|██████▎   | 329/526 [03:22<00:47,  4.19it/s]
 63%|██████▎   | 331/526 [03:22<00:39,  4.94it/s]
 63%|██████▎   | 332/526 [03:22<00:56,  3.42it/s]
 63%|██████▎   | 333/526 [03:23<00:52,  3.68it/s]
 63%|██████▎   | 334/526 [03:24<01:48,  1.76it/s]
 64%|██████▎   | 335/526 [03:25<01:48,  1.76it/s]
 64%|██████▍   | 336/526 [03:26<02:32,  1.25it/s]
 64%|██████▍   | 337/526 [03:27<02:30,  1.26it/s]
 64%|██████▍   | 338/526 [03:27<02:22,  1.32it/s]
 64%|██████▍   | 339/526 [03:28<02:03,  1.52it/s]
 65%|██████▍   | 340/526 [03:31<04:28,  1.44s/it]
 65%|██████▍   | 341/526 [03:31<03:14,  1.05s/it]
 65%|██████▌   | 342/526 [03:32<02:43,  1.13it/s]
 65%|██████▌   | 343/526 [03:33<02:51,  1.07it/s]
 66%|██████▌   | 345/526 [03:40<06:28,  2.15s/it]
 66%|██████▌   | 346/526 [03:43<07:18,  2.44s/it]
 66%|██████▌   | 347/526 [03:50<10:43,  3.60s/it]
 66%|██████▌   | 348/526 [03:51<08:37,  2.91s/it]
 66%|██████▋   | 349/526 [03:52<06:35,  2.23s/it]
 67%|██████▋   | 350/526 [03:59<10:34,  3.61s/it]
 67%|██████▋   | 351/526 [04:02<10:25,  3.57s/it]
 67%|██████▋   | 352/526 [04:02<07:32,  2.60s/it]
 67%|██████▋   | 353/526 [04:03<05:26,  1.89s/it]
 67%|██████▋   | 355/526 [04:03<03:17,  1.15s/it]
 68%|██████▊   | 356/526 [04:03<02:33,  1.11it/s]
 68%|██████▊   | 357/526 [04:04<02:19,  1.21it/s]
 68%|██████▊   | 358/526 [04:05<02:10,  1.28it/s]
 68%|██████▊   | 359/526 [04:05<01:46,  1.56it/s]
 68%|██████▊   | 360/526 [04:05<01:21,  2.03it/s]
 69%|██████▊   | 361/526 [04:05<01:09,  2.37it/s]
 69%|██████▉   | 363/526 [04:06<01:04,  2.51it/s]
 69%|██████▉   | 364/526 [04:06<00:57,  2.84it/s]
 69%|██████▉   | 365/526 [04:07<01:08,  2.35it/s]
 70%|██████▉   | 366/526 [04:09<02:04,  1.29it/s]
 70%|██████▉   | 367/526 [04:09<01:35,  1.67it/s]
 70%|██████▉   | 368/526 [04:09<01:14,  2.11it/s]
 70%|███████   | 369/526 [04:09<01:12,  2.16it/s]
 70%|███████   | 370/526 [04:16<06:06,  2.35s/it]
 71%|███████   | 371/526 [04:23<09:36,  3.72s/it]
 71%|███████   | 372/526 [04:30<11:54,  4.64s/it]
 71%|███████   | 374/526 [04:30<06:28,  2.55s/it]
 71%|███████▏  | 375/526 [04:37<09:07,  3.63s/it]
 71%|███████▏  | 376/526 [04:37<06:47,  2.71s/it]
 72%|███████▏  | 377/526 [04:38<05:19,  2.15s/it]
 72%|███████▏  | 378/526 [04:38<03:53,  1.58s/it]
 72%|███████▏  | 379/526 [04:38<03:03,  1.25s/it]
 72%|███████▏  | 380/526 [04:39<02:20,  1.04it/s]
 72%|███████▏  | 381/526 [04:46<06:31,  2.70s/it]
 73%|███████▎  | 382/526 [04:46<04:55,  2.05s/it]
 73%|███████▎  | 383/526 [04:47<03:45,  1.57s/it]
 73%|███████▎  | 384/526 [04:53<07:28,  3.16s/it]
 73%|███████▎  | 385/526 [05:00<10:04,  4.29s/it]
 73%|███████▎  | 386/526 [05:01<07:43,  3.31s/it]
 74%|███████▎  | 387/526 [05:02<05:33,  2.40s/it]
 74%|███████▍  | 388/526 [05:02<04:08,  1.80s/it]
 74%|███████▍  | 389/526 [05:03<03:18,  1.45s/it]
 74%|███████▍  | 390/526 [05:03<02:44,  1.21s/it]
 74%|███████▍  | 391/526 [05:03<02:00,  1.12it/s]
 75%|███████▍  | 392/526 [05:04<01:29,  1.50it/s]
 75%|███████▍  | 393/526 [05:04<01:27,  1.53it/s]
 75%|███████▍  | 394/526 [05:04<01:05,  2.02it/s]
 75%|███████▌  | 396/526 [05:05<00:40,  3.17it/s]
 75%|███████▌  | 397/526 [05:05<00:36,  3.58it/s]
 76%|███████▌  | 398/526 [05:05<00:35,  3.58it/s]
 76%|███████▌  | 399/526 [05:12<04:29,  2.12s/it]
 76%|███████▌  | 400/526 [05:12<03:16,  1.56s/it]
 76%|███████▌  | 401/526 [05:19<06:31,  3.13s/it]
 76%|███████▋  | 402/526 [05:20<04:54,  2.37s/it]
 77%|███████▋  | 403/526 [05:20<03:39,  1.79s/it]
 77%|███████▋  | 404/526 [05:20<02:40,  1.32s/it]
 77%|███████▋  | 405/526 [05:21<01:59,  1.01it/s]
 77%|███████▋  | 406/526 [05:26<04:25,  2.21s/it]
 78%|███████▊  | 408/526 [05:26<02:27,  1.25s/it]
 78%|███████▊  | 409/526 [05:27<02:10,  1.11s/it]
 78%|███████▊  | 410/526 [05:27<01:40,  1.15it/s]
 78%|███████▊  | 411/526 [05:34<04:50,  2.52s/it]
 78%|███████▊  | 412/526 [05:34<03:34,  1.88s/it]
 79%|███████▊  | 414/526 [05:34<02:02,  1.10s/it]
 79%|███████▉  | 415/526 [05:35<01:42,  1.09it/s]
 79%|███████▉  | 417/526 [05:35<01:10,  1.55it/s]
 79%|███████▉  | 418/526 [05:37<01:37,  1.11it/s]
 80%|███████▉  | 419/526 [05:37<01:17,  1.38it/s]
 80%|████████  | 421/526 [05:41<02:06,  1.21s/it]
 80%|████████  | 422/526 [05:41<01:39,  1.04it/s]
 80%|████████  | 423/526 [05:41<01:22,  1.24it/s]
 81%|████████  | 424/526 [05:41<01:04,  1.57it/s]
 81%|████████  | 425/526 [05:42<00:50,  2.01it/s]
 81%|████████  | 426/526 [05:42<00:42,  2.33it/s]
 81%|████████  | 427/526 [05:42<00:34,  2.86it/s]
 81%|████████▏ | 428/526 [05:42<00:27,  3.53it/s]
 82%|████████▏ | 429/526 [05:42<00:23,  4.09it/s]
 82%|████████▏ | 431/526 [05:43<00:36,  2.59it/s]
 82%|████████▏ | 433/526 [05:44<00:26,  3.47it/s]
 83%|████████▎ | 435/526 [05:46<01:01,  1.48it/s]
 83%|████████▎ | 436/526 [05:47<01:05,  1.36it/s]
 83%|████████▎ | 438/526 [05:48<00:57,  1.52it/s]
 83%|████████▎ | 439/526 [05:49<01:03,  1.37it/s]
 84%|████████▎ | 440/526 [05:50<01:01,  1.39it/s]
 84%|████████▍ | 442/526 [05:51<00:45,  1.86it/s]
 84%|████████▍ | 444/526 [05:52<00:54,  1.50it/s]
 85%|████████▍ | 445/526 [05:54<01:11,  1.13it/s]
 85%|████████▍ | 446/526 [05:54<00:59,  1.35it/s]
 85%|████████▍ | 447/526 [05:55<00:51,  1.53it/s]
 85%|████████▌ | 448/526 [05:55<00:41,  1.87it/s]
 85%|████████▌ | 449/526 [05:55<00:32,  2.39it/s]
 86%|████████▌ | 451/526 [05:55<00:21,  3.56it/s]
 86%|████████▌ | 453/526 [05:55<00:14,  4.90it/s]
 86%|████████▋ | 454/526 [05:56<00:20,  3.53it/s]
 87%|████████▋ | 456/526 [05:56<00:15,  4.39it/s]
 87%|████████▋ | 458/526 [05:56<00:13,  5.07it/s]
 87%|████████▋ | 459/526 [05:57<00:13,  4.87it/s]
 87%|████████▋ | 460/526 [05:57<00:18,  3.51it/s]
 88%|████████▊ | 461/526 [05:57<00:16,  4.06it/s]
 88%|████████▊ | 462/526 [05:58<00:15,  4.20it/s]
 88%|████████▊ | 463/526 [05:58<00:17,  3.54it/s]
 88%|████████▊ | 464/526 [05:58<00:14,  4.31it/s]
 88%|████████▊ | 465/526 [05:58<00:14,  4.20it/s]
 89%|████████▊ | 466/526 [05:59<00:16,  3.57it/s]
 89%|████████▉ | 467/526 [05:59<00:19,  3.05it/s]
 89%|████████▉ | 468/526 [05:59<00:15,  3.67it/s]
 89%|████████▉ | 470/526 [06:00<00:10,  5.26it/s]
 90%|████████▉ | 471/526 [06:00<00:10,  5.45it/s]
 90%|████████▉ | 472/526 [06:00<00:13,  3.90it/s]
 90%|█████████ | 474/526 [06:00<00:09,  5.56it/s]
 90%|█████████ | 475/526 [06:01<00:17,  2.95it/s]
 90%|█████████ | 476/526 [06:02<00:17,  2.80it/s]
 91%|█████████ | 478/526 [06:02<00:11,  4.31it/s]
 91%|█████████ | 479/526 [06:03<00:17,  2.63it/s]
 91%|█████████▏| 480/526 [06:03<00:17,  2.56it/s]
 91%|█████████▏| 481/526 [06:05<00:30,  1.45it/s]
 92%|█████████▏| 482/526 [06:05<00:25,  1.70it/s]
 92%|█████████▏| 483/526 [06:05<00:21,  2.04it/s]
 92%|█████████▏| 484/526 [06:05<00:17,  2.37it/s]
 92%|█████████▏| 485/526 [06:06<00:15,  2.69it/s]
 92%|█████████▏| 486/526 [06:06<00:12,  3.24it/s]
 93%|█████████▎| 487/526 [06:06<00:10,  3.61it/s]
 93%|█████████▎| 489/526 [06:06<00:07,  4.66it/s]
 93%|█████████▎| 490/526 [06:06<00:07,  4.71it/s]
 93%|█████████▎| 491/526 [06:07<00:11,  3.01it/s]
 94%|█████████▎| 493/526 [06:11<00:33,  1.02s/it]
 94%|█████████▍| 494/526 [06:11<00:25,  1.23it/s]
 94%|█████████▍| 495/526 [06:12<00:22,  1.40it/s]
 94%|█████████▍| 496/526 [06:12<00:17,  1.75it/s]
 94%|█████████▍| 497/526 [06:13<00:21,  1.38it/s]
 95%|█████████▍| 498/526 [06:15<00:28,  1.00s/it]
 95%|█████████▍| 499/526 [06:16<00:33,  1.25s/it]
 95%|█████████▌| 500/526 [06:17<00:24,  1.07it/s]
 95%|█████████▌| 501/526 [06:17<00:18,  1.35it/s]
 96%|█████████▌| 503/526 [06:17<00:10,  2.18it/s]
 96%|█████████▌| 504/526 [06:17<00:09,  2.41it/s]
 96%|█████████▌| 505/526 [06:18<00:09,  2.30it/s]
 96%|█████████▌| 506/526 [06:18<00:07,  2.58it/s]
 96%|█████████▋| 507/526 [06:18<00:06,  3.11it/s]
 97%|█████████▋| 508/526 [06:19<00:06,  2.77it/s]
 97%|█████████▋| 510/526 [06:20<00:07,  2.23it/s]
 97%|█████████▋| 511/526 [06:20<00:07,  2.09it/s]
 97%|█████████▋| 512/526 [06:21<00:05,  2.49it/s]
 98%|█████████▊| 513/526 [06:22<00:06,  1.88it/s]
 98%|█████████▊| 514/526 [06:22<00:05,  2.05it/s]
 98%|█████████▊| 515/526 [06:22<00:05,  2.13it/s]
 98%|█████████▊| 516/526 [06:22<00:03,  2.65it/s]
 98%|█████████▊| 517/526 [06:23<00:03,  2.57it/s]
 98%|█████████▊| 518/526 [06:23<00:02,  2.79it/s]
 99%|█████████▊| 519/526 [06:23<00:02,  3.35it/s]
 99%|█████████▉| 520/526 [06:24<00:03,  1.97it/s]
 99%|█████████▉| 521/526 [06:24<00:01,  2.56it/s]
 99%|█████████▉| 522/526 [06:28<00:05,  1.34s/it]
 99%|█████████▉| 523/526 [06:31<00:05,  1.97s/it]
100%|█████████▉| 524/526 [06:35<00:04,  2.43s/it]
100%|█████████▉| 525/526 [06:35<00:01,  1.81s/it]
100%|██████████| 526/526 [06:39<00:00,  2.32s/it]
100%|██████████| 526/526 [06:39<00:00,  1.32it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 10:51:56.948965_lp_processed_test.json', '--output_addr', 'data/out/rag/full_profile/lp_rag_full_profile_test_10_limit_3_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  4.79 examples/s]
Generating train split: 526 examples [00:00, 1212.97 examples/s]
INFO 07-15 10:59:09 config.py:510] This model supports multiple tasks: {'classify', 'generate', 'embed', 'reward', 'score'}. Defaulting to 'generate'.
INFO 07-15 10:59:09 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 10:59:11 selector.py:120] Using Flash Attention backend.
INFO 07-15 10:59:12 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 10:59:12 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.63it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.51it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.56it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.53it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.54it/s]

INFO 07-15 10:59:15 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 10:59:17 worker.py:241] Memory profiling takes 2.10 seconds
INFO 07-15 10:59:17 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 10:59:17 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 10:59:17 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 10:59:17 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 10:59:20 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.64it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.75it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:11,  2.82it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:10,  2.86it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.88it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:10,  2.89it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.90it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.91it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:08,  2.91it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.91it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.92it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:07,  2.94it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  2.94it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.95it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:06,  2.97it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  2.99it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  3.00it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:04,  3.00it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:04,  3.02it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  3.02it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:03,  3.01it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:03,  2.96it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  2.93it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:03,  2.90it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:09<00:02,  2.88it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  2.87it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:02,  2.88it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:10<00:01,  2.91it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  2.92it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:01,  2.90it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:11<00:00,  2.84it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  2.84it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  2.85it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  2.91it/s]
INFO 07-15 10:59:32 model_runner.py:1535] Graph capturing finished in 12 secs, took 0.22 GiB
INFO 07-15 10:59:32 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 17.23 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:34<5:06:14, 35.00s/it, est. speed input: 26.80 toks/s, output: 3.00 toks/s]
Processed prompts:   1%|          | 3/526 [00:35<1:21:22,  9.34s/it, est. speed input: 114.74 toks/s, output: 8.99 toks/s]
Processed prompts:   1%|          | 4/526 [00:36<54:05,  6.22s/it, est. speed input: 167.28 toks/s, output: 12.05 toks/s] 
Processed prompts:   1%|          | 5/526 [00:36<36:52,  4.25s/it, est. speed input: 209.87 toks/s, output: 15.10 toks/s]
Processed prompts:   1%|▏         | 7/526 [00:36<19:37,  2.27s/it, est. speed input: 303.70 toks/s, output: 21.21 toks/s]
Processed prompts:   2%|▏         | 8/526 [00:36<14:50,  1.72s/it, est. speed input: 367.34 toks/s, output: 24.28 toks/s]
Processed prompts:   2%|▏         | 9/526 [00:37<11:30,  1.34s/it, est. speed input: 404.82 toks/s, output: 27.25 toks/s]
Processed prompts:   2%|▏         | 10/526 [00:37<08:32,  1.01it/s, est. speed input: 444.34 toks/s, output: 30.34 toks/s]
Processed prompts:   2%|▏         | 11/526 [00:37<06:50,  1.26it/s, est. speed input: 484.00 toks/s, output: 33.28 toks/s]
Processed prompts:   3%|▎         | 16/526 [00:38<02:59,  2.83it/s, est. speed input: 693.92 toks/s, output: 48.34 toks/s]
Processed prompts:   3%|▎         | 17/526 [00:38<02:43,  3.12it/s, est. speed input: 739.13 toks/s, output: 51.33 toks/s]
Processed prompts:   4%|▎         | 19/526 [00:38<02:19,  3.63it/s, est. speed input: 820.42 toks/s, output: 57.21 toks/s]
Processed prompts:   4%|▍         | 21/526 [00:38<01:54,  4.40it/s, est. speed input: 903.41 toks/s, output: 63.20 toks/s]
Processed prompts:   4%|▍         | 23/526 [00:39<01:49,  4.58it/s, est. speed input: 1008.12 toks/s, output: 68.91 toks/s]
Processed prompts:   5%|▍         | 25/526 [00:39<01:34,  5.31it/s, est. speed input: 1122.43 toks/s, output: 74.84 toks/s]
Processed prompts:   5%|▍         | 26/526 [00:39<01:41,  4.93it/s, est. speed input: 1143.60 toks/s, output: 77.52 toks/s]
Processed prompts:   6%|▌         | 29/526 [00:40<01:20,  6.16it/s, est. speed input: 1347.04 toks/s, output: 86.41 toks/s]
Processed prompts:   6%|▌         | 30/526 [00:40<01:41,  4.89it/s, est. speed input: 1372.83 toks/s, output: 88.72 toks/s]
Processed prompts:   6%|▌         | 32/526 [00:40<01:30,  5.48it/s, est. speed input: 1428.37 toks/s, output: 94.47 toks/s]
Processed prompts:   7%|▋         | 39/526 [00:41<01:14,  6.58it/s, est. speed input: 1673.85 toks/s, output: 114.18 toks/s]
Processed prompts:   8%|▊         | 42/526 [00:42<01:15,  6.40it/s, est. speed input: 1766.21 toks/s, output: 122.15 toks/s]
Processed prompts:   8%|▊         | 44/526 [00:42<01:25,  5.64it/s, est. speed input: 1865.42 toks/s, output: 126.88 toks/s]
Processed prompts:   9%|▊         | 45/526 [00:42<01:20,  5.97it/s, est. speed input: 1908.90 toks/s, output: 129.70 toks/s]
Processed prompts:   9%|▊         | 46/526 [00:43<01:27,  5.48it/s, est. speed input: 1934.10 toks/s, output: 132.04 toks/s]
Processed prompts:   9%|▉         | 48/526 [00:43<01:22,  5.81it/s, est. speed input: 2037.99 toks/s, output: 137.38 toks/s]
Processed prompts:  10%|█         | 53/526 [00:44<01:25,  5.52it/s, est. speed input: 2306.86 toks/s, output: 149.79 toks/s]
Processed prompts:  11%|█         | 57/526 [00:44<01:20,  5.86it/s, est. speed input: 2436.44 toks/s, output: 160.05 toks/s]
Processed prompts:  11%|█▏        | 60/526 [00:45<01:21,  5.73it/s, est. speed input: 2527.93 toks/s, output: 167.28 toks/s]
Processed prompts:  13%|█▎        | 66/526 [00:46<01:16,  5.99it/s, est. speed input: 2770.18 toks/s, output: 181.97 toks/s]
Processed prompts:  13%|█▎        | 70/526 [00:46<01:11,  6.42it/s, est. speed input: 2888.64 toks/s, output: 191.99 toks/s]
Processed prompts:  14%|█▍        | 73/526 [00:47<01:09,  6.54it/s, est. speed input: 2958.33 toks/s, output: 199.24 toks/s]
Processed prompts:  14%|█▍        | 74/526 [00:47<01:09,  6.49it/s, est. speed input: 2968.30 toks/s, output: 201.58 toks/s]
Processed prompts:  15%|█▍        | 77/526 [00:48<01:08,  6.53it/s, est. speed input: 3152.15 toks/s, output: 208.69 toks/s]
Processed prompts:  16%|█▌        | 82/526 [00:48<00:57,  7.73it/s, est. speed input: 3319.40 toks/s, output: 221.57 toks/s]
Processed prompts:  16%|█▌        | 85/526 [00:48<00:59,  7.45it/s, est. speed input: 3406.22 toks/s, output: 228.53 toks/s]
Processed prompts:  17%|█▋        | 92/526 [00:49<00:52,  8.34it/s, est. speed input: 3519.59 toks/s, output: 245.91 toks/s]
Processed prompts:  18%|█▊        | 96/526 [00:50<00:52,  8.18it/s, est. speed input: 3588.39 toks/s, output: 255.21 toks/s]
Processed prompts:  19%|█▉        | 102/526 [00:50<00:52,  8.15it/s, est. speed input: 3747.76 toks/s, output: 269.06 toks/s]
Processed prompts:  20%|██        | 106/526 [00:51<00:57,  7.33it/s, est. speed input: 3803.47 toks/s, output: 277.04 toks/s]
Processed prompts:  21%|██        | 109/526 [00:52<00:55,  7.46it/s, est. speed input: 3883.05 toks/s, output: 283.76 toks/s]
Processed prompts:  21%|██▏       | 113/526 [00:52<01:02,  6.64it/s, est. speed input: 3992.00 toks/s, output: 291.21 toks/s]
Processed prompts:  22%|██▏       | 117/526 [00:53<00:57,  7.17it/s, est. speed input: 4063.73 toks/s, output: 300.24 toks/s]
Processed prompts:  22%|██▏       | 118/526 [00:53<01:00,  6.79it/s, est. speed input: 4084.91 toks/s, output: 301.90 toks/s]
Processed prompts:  23%|██▎       | 120/526 [00:53<00:55,  7.32it/s, est. speed input: 4120.96 toks/s, output: 306.60 toks/s]
Processed prompts:  23%|██▎       | 121/526 [00:53<01:01,  6.62it/s, est. speed input: 4196.00 toks/s, output: 308.11 toks/s]
Processed prompts:  24%|██▍       | 125/526 [00:54<00:56,  7.10it/s, est. speed input: 4316.50 toks/s, output: 316.78 toks/s]
Processed prompts:  25%|██▍       | 130/526 [00:55<01:06,  5.99it/s, est. speed input: 4413.02 toks/s, output: 325.32 toks/s]
Processed prompts:  25%|██▍       | 131/526 [00:55<01:03,  6.22it/s, est. speed input: 4436.88 toks/s, output: 327.55 toks/s]
Processed prompts:  26%|██▌       | 135/526 [00:56<00:58,  6.73it/s, est. speed input: 4529.41 toks/s, output: 335.96 toks/s]
Processed prompts:  26%|██▋       | 139/526 [00:56<00:52,  7.31it/s, est. speed input: 4628.51 toks/s, output: 344.62 toks/s]
Processed prompts:  28%|██▊       | 146/526 [00:57<00:54,  6.97it/s, est. speed input: 4733.36 toks/s, output: 358.01 toks/s]
Processed prompts:  29%|██▉       | 154/526 [00:58<00:49,  7.44it/s, est. speed input: 4891.53 toks/s, output: 374.31 toks/s]
Processed prompts:  30%|███       | 158/526 [00:59<00:51,  7.20it/s, est. speed input: 4976.14 toks/s, output: 381.54 toks/s]
Processed prompts:  31%|███       | 162/526 [00:59<00:51,  7.13it/s, est. speed input: 5046.66 toks/s, output: 388.91 toks/s]
Processed prompts:  32%|███▏      | 167/526 [01:00<00:52,  6.83it/s, est. speed input: 5142.30 toks/s, output: 397.50 toks/s]
Processed prompts:  32%|███▏      | 168/526 [01:00<00:53,  6.70it/s, est. speed input: 5150.86 toks/s, output: 399.07 toks/s]
Processed prompts:  33%|███▎      | 172/526 [01:01<00:48,  7.24it/s, est. speed input: 5219.89 toks/s, output: 407.09 toks/s]
Processed prompts:  33%|███▎      | 175/526 [01:01<00:44,  7.93it/s, est. speed input: 5291.18 toks/s, output: 413.56 toks/s]
Processed prompts:  34%|███▍      | 178/526 [01:01<00:48,  7.19it/s, est. speed input: 5334.61 toks/s, output: 418.31 toks/s]
Processed prompts:  34%|███▍      | 179/526 [01:02<00:51,  6.72it/s, est. speed input: 5337.87 toks/s, output: 419.57 toks/s]
Processed prompts:  35%|███▍      | 183/526 [01:02<00:49,  7.00it/s, est. speed input: 5414.28 toks/s, output: 427.04 toks/s]
Processed prompts:  35%|███▌      | 185/526 [01:03<00:59,  5.74it/s, est. speed input: 5424.48 toks/s, output: 428.69 toks/s]
Processed prompts:  36%|███▌      | 187/526 [01:03<01:03,  5.33it/s, est. speed input: 5447.95 toks/s, output: 431.11 toks/s]
Processed prompts:  36%|███▌      | 190/526 [01:04<00:59,  5.66it/s, est. speed input: 5528.09 toks/s, output: 436.26 toks/s]
Processed prompts:  37%|███▋      | 192/526 [01:04<01:05,  5.11it/s, est. speed input: 5583.12 toks/s, output: 438.33 toks/s]
Processed prompts:  37%|███▋      | 196/526 [01:05<00:58,  5.67it/s, est. speed input: 5681.69 toks/s, output: 445.33 toks/s]
Processed prompts:  37%|███▋      | 197/526 [01:05<00:59,  5.51it/s, est. speed input: 5679.92 toks/s, output: 446.61 toks/s]
Processed prompts:  39%|███▉      | 204/526 [01:06<00:50,  6.43it/s, est. speed input: 5827.68 toks/s, output: 459.32 toks/s]
Processed prompts:  39%|███▉      | 205/526 [01:06<00:56,  5.72it/s, est. speed input: 5813.52 toks/s, output: 459.70 toks/s]
Processed prompts:  40%|███▉      | 208/526 [01:07<01:01,  5.19it/s, est. speed input: 5831.02 toks/s, output: 463.12 toks/s]
Processed prompts:  41%|████      | 214/526 [01:08<00:56,  5.51it/s, est. speed input: 5938.40 toks/s, output: 472.68 toks/s]
Processed prompts:  41%|████▏     | 217/526 [01:08<00:51,  5.95it/s, est. speed input: 5999.33 toks/s, output: 478.30 toks/s]
Processed prompts:  41%|████▏     | 218/526 [01:09<00:56,  5.47it/s, est. speed input: 5995.60 toks/s, output: 478.95 toks/s]
Processed prompts:  42%|████▏     | 219/526 [01:09<00:54,  5.63it/s, est. speed input: 6024.50 toks/s, output: 480.74 toks/s]
Processed prompts:  42%|████▏     | 221/526 [01:09<00:58,  5.21it/s, est. speed input: 6023.22 toks/s, output: 483.11 toks/s]
Processed prompts:  43%|████▎     | 224/526 [01:10<00:57,  5.25it/s, est. speed input: 6059.05 toks/s, output: 487.59 toks/s]
Processed prompts:  43%|████▎     | 225/526 [01:10<01:00,  4.94it/s, est. speed input: 6067.65 toks/s, output: 488.55 toks/s]
Processed prompts:  43%|████▎     | 228/526 [01:11<01:00,  4.90it/s, est. speed input: 6096.76 toks/s, output: 492.75 toks/s]
Processed prompts:  44%|████▎     | 229/526 [01:11<01:08,  4.31it/s, est. speed input: 6079.56 toks/s, output: 493.00 toks/s]
Processed prompts:  44%|████▎     | 230/526 [01:12<01:24,  3.52it/s, est. speed input: 6065.09 toks/s, output: 492.36 toks/s]
Processed prompts:  44%|████▍     | 232/526 [01:12<01:29,  3.30it/s, est. speed input: 6058.29 toks/s, output: 493.64 toks/s]
Processed prompts:  44%|████▍     | 234/526 [01:13<01:23,  3.49it/s, est. speed input: 6066.24 toks/s, output: 494.58 toks/s]
Processed prompts:  45%|████▍     | 236/526 [01:13<01:15,  3.84it/s, est. speed input: 6076.39 toks/s, output: 497.84 toks/s]
Processed prompts:  45%|████▌     | 238/526 [01:14<01:09,  4.13it/s, est. speed input: 6091.75 toks/s, output: 501.16 toks/s]
Processed prompts:  45%|████▌     | 239/526 [01:14<01:20,  3.56it/s, est. speed input: 6092.98 toks/s, output: 501.18 toks/s]
Processed prompts:  46%|████▌     | 240/526 [01:14<01:11,  4.00it/s, est. speed input: 6099.28 toks/s, output: 503.40 toks/s]
Processed prompts:  46%|████▌     | 241/526 [01:15<01:26,  3.31it/s, est. speed input: 6094.39 toks/s, output: 503.30 toks/s]
Processed prompts:  46%|████▌     | 242/526 [01:15<01:24,  3.36it/s, est. speed input: 6087.30 toks/s, output: 502.82 toks/s]
Processed prompts:  46%|████▌     | 243/526 [01:15<01:16,  3.71it/s, est. speed input: 6091.87 toks/s, output: 503.18 toks/s]
Processed prompts:  46%|████▋     | 244/526 [01:16<01:28,  3.20it/s, est. speed input: 6084.58 toks/s, output: 503.48 toks/s]
Processed prompts:  47%|████▋     | 245/526 [01:16<01:33,  3.00it/s, est. speed input: 6076.20 toks/s, output: 502.29 toks/s]
Processed prompts:  47%|████▋     | 246/526 [01:17<01:56,  2.40it/s, est. speed input: 6070.10 toks/s, output: 501.45 toks/s]
Processed prompts:  47%|████▋     | 247/526 [01:17<01:31,  3.06it/s, est. speed input: 6082.31 toks/s, output: 502.36 toks/s]
Processed prompts:  47%|████▋     | 248/526 [01:18<02:43,  1.70it/s, est. speed input: 6020.01 toks/s, output: 496.35 toks/s]
Processed prompts:  48%|████▊     | 251/526 [01:19<01:38,  2.79it/s, est. speed input: 6061.60 toks/s, output: 498.43 toks/s]
Processed prompts:  48%|████▊     | 253/526 [01:19<01:19,  3.42it/s, est. speed input: 6092.41 toks/s, output: 499.60 toks/s]
Processed prompts:  48%|████▊     | 255/526 [01:19<01:13,  3.70it/s, est. speed input: 6109.83 toks/s, output: 500.34 toks/s]
Processed prompts:  49%|████▊     | 256/526 [01:19<01:04,  4.18it/s, est. speed input: 6116.97 toks/s, output: 501.39 toks/s]
Processed prompts:  49%|████▉     | 257/526 [01:20<01:04,  4.20it/s, est. speed input: 6122.31 toks/s, output: 501.66 toks/s]
Processed prompts:  49%|████▉     | 259/526 [01:20<00:54,  4.88it/s, est. speed input: 6143.76 toks/s, output: 503.17 toks/s]
Processed prompts:  50%|████▉     | 261/526 [01:20<00:56,  4.71it/s, est. speed input: 6151.22 toks/s, output: 503.69 toks/s]
Processed prompts:  50%|████▉     | 262/526 [01:21<00:53,  4.93it/s, est. speed input: 6157.09 toks/s, output: 504.23 toks/s]
Processed prompts:  50%|█████     | 263/526 [01:21<01:05,  4.04it/s, est. speed input: 6149.69 toks/s, output: 503.56 toks/s]
Processed prompts:  50%|█████     | 264/526 [01:21<00:56,  4.60it/s, est. speed input: 6158.81 toks/s, output: 504.43 toks/s]
Processed prompts:  50%|█████     | 265/526 [01:21<00:58,  4.43it/s, est. speed input: 6161.61 toks/s, output: 504.50 toks/s]
Processed prompts:  51%|█████     | 266/526 [01:22<01:07,  3.82it/s, est. speed input: 6156.77 toks/s, output: 503.83 toks/s]
Processed prompts:  51%|█████     | 268/526 [01:22<00:56,  4.60it/s, est. speed input: 6185.95 toks/s, output: 505.13 toks/s]
Processed prompts:  51%|█████▏    | 270/526 [01:23<00:57,  4.47it/s, est. speed input: 6198.31 toks/s, output: 505.22 toks/s]
Processed prompts:  52%|█████▏    | 272/526 [01:23<00:43,  5.79it/s, est. speed input: 6241.19 toks/s, output: 507.56 toks/s]
Processed prompts:  52%|█████▏    | 274/526 [01:23<00:37,  6.65it/s, est. speed input: 6294.06 toks/s, output: 509.46 toks/s]
Processed prompts:  53%|█████▎    | 277/526 [01:23<00:29,  8.58it/s, est. speed input: 6361.33 toks/s, output: 513.50 toks/s]
Processed prompts:  53%|█████▎    | 278/526 [01:23<00:29,  8.33it/s, est. speed input: 6376.50 toks/s, output: 514.59 toks/s]
Processed prompts:  54%|█████▍    | 284/526 [01:23<00:15, 15.88it/s, est. speed input: 6511.38 toks/s, output: 523.45 toks/s]
Processed prompts:  55%|█████▍    | 287/526 [01:23<00:13, 17.32it/s, est. speed input: 6585.46 toks/s, output: 527.92 toks/s]
Processed prompts:  56%|█████▌    | 292/526 [01:24<00:10, 22.26it/s, est. speed input: 6687.86 toks/s, output: 536.25 toks/s]
Processed prompts:  57%|█████▋    | 299/526 [01:24<00:07, 30.17it/s, est. speed input: 6865.71 toks/s, output: 547.23 toks/s]
Processed prompts:  58%|█████▊    | 307/526 [01:24<00:05, 38.59it/s, est. speed input: 7066.10 toks/s, output: 560.36 toks/s]
Processed prompts:  59%|█████▉    | 312/526 [01:24<00:05, 38.99it/s, est. speed input: 7164.51 toks/s, output: 568.65 toks/s]
Processed prompts:  60%|██████    | 318/526 [01:24<00:04, 41.97it/s, est. speed input: 7288.97 toks/s, output: 578.38 toks/s]
Processed prompts:  61%|██████▏   | 323/526 [01:24<00:05, 37.07it/s, est. speed input: 7431.15 toks/s, output: 586.21 toks/s]
Processed prompts:  63%|██████▎   | 329/526 [01:24<00:04, 40.90it/s, est. speed input: 7632.53 toks/s, output: 595.51 toks/s]
Processed prompts:  64%|██████▍   | 336/526 [01:25<00:04, 46.45it/s, est. speed input: 7785.00 toks/s, output: 609.02 toks/s]
Processed prompts:  66%|██████▌   | 346/526 [01:25<00:03, 58.61it/s, est. speed input: 8065.30 toks/s, output: 627.18 toks/s]
Processed prompts:  67%|██████▋   | 353/526 [01:25<00:03, 47.89it/s, est. speed input: 8222.41 toks/s, output: 640.20 toks/s]
Processed prompts:  68%|██████▊   | 359/526 [01:25<00:04, 41.03it/s, est. speed input: 8360.30 toks/s, output: 650.38 toks/s]
Processed prompts:  70%|███████   | 370/526 [01:25<00:03, 50.15it/s, est. speed input: 8624.97 toks/s, output: 669.52 toks/s]
Processed prompts:  71%|███████▏  | 376/526 [01:25<00:03, 40.28it/s, est. speed input: 8743.45 toks/s, output: 680.57 toks/s]
Processed prompts:  73%|███████▎  | 385/526 [01:26<00:03, 46.06it/s, est. speed input: 8958.18 toks/s, output: 696.47 toks/s]
Processed prompts:  75%|███████▍  | 393/526 [01:26<00:02, 49.22it/s, est. speed input: 9195.22 toks/s, output: 710.45 toks/s]
Processed prompts:  76%|███████▋  | 402/526 [01:26<00:02, 54.73it/s, est. speed input: 9460.75 toks/s, output: 728.57 toks/s]
Processed prompts:  78%|███████▊  | 408/526 [01:26<00:02, 53.57it/s, est. speed input: 9590.37 toks/s, output: 740.98 toks/s]
Processed prompts:  79%|███████▉  | 418/526 [01:26<00:01, 62.33it/s, est. speed input: 9827.11 toks/s, output: 762.01 toks/s]
Processed prompts:  81%|████████  | 425/526 [01:26<00:01, 57.98it/s, est. speed input: 10023.23 toks/s, output: 774.04 toks/s]
Processed prompts:  82%|████████▏ | 432/526 [01:26<00:01, 60.21it/s, est. speed input: 10186.70 toks/s, output: 787.27 toks/s]
Processed prompts:  83%|████████▎ | 439/526 [01:27<00:01, 49.99it/s, est. speed input: 10310.80 toks/s, output: 800.50 toks/s]
Processed prompts:  85%|████████▍ | 445/526 [01:27<00:01, 46.02it/s, est. speed input: 10469.67 toks/s, output: 813.27 toks/s]
Processed prompts:  86%|████████▌ | 451/526 [01:27<00:01, 46.63it/s, est. speed input: 10605.68 toks/s, output: 826.41 toks/s]
Processed prompts:  87%|████████▋ | 456/526 [01:27<00:01, 40.04it/s, est. speed input: 10697.29 toks/s, output: 836.05 toks/s]
Processed prompts:  88%|████████▊ | 461/526 [01:27<00:02, 29.98it/s, est. speed input: 10814.61 toks/s, output: 842.88 toks/s]
Processed prompts:  89%|████████▉ | 470/526 [01:27<00:01, 38.36it/s, est. speed input: 11030.55 toks/s, output: 860.11 toks/s]
Processed prompts:  90%|█████████ | 475/526 [01:28<00:01, 31.02it/s, est. speed input: 11135.28 toks/s, output: 871.00 toks/s]
Processed prompts:  91%|█████████ | 479/526 [01:28<00:01, 27.74it/s, est. speed input: 11251.33 toks/s, output: 881.38 toks/s]
Processed prompts:  92%|█████████▏| 484/526 [01:28<00:01, 29.49it/s, est. speed input: 11346.50 toks/s, output: 891.77 toks/s]
Processed prompts:  93%|█████████▎| 489/526 [01:28<00:01, 31.43it/s, est. speed input: 11459.38 toks/s, output: 902.53 toks/s]
Processed prompts:  94%|█████████▍| 494/526 [01:28<00:00, 32.21it/s, est. speed input: 11561.59 toks/s, output: 912.84 toks/s]
Processed prompts:  95%|█████████▍| 498/526 [01:28<00:00, 30.34it/s, est. speed input: 11672.91 toks/s, output: 920.16 toks/s]
Processed prompts:  95%|█████████▌| 502/526 [01:29<00:00, 28.37it/s, est. speed input: 11756.23 toks/s, output: 925.83 toks/s]
Processed prompts:  96%|█████████▌| 505/526 [01:29<00:00, 23.80it/s, est. speed input: 11825.76 toks/s, output: 929.57 toks/s]
Processed prompts:  97%|█████████▋| 509/526 [01:29<00:00, 22.23it/s, est. speed input: 11923.07 toks/s, output: 938.65 toks/s]
Processed prompts:  97%|█████████▋| 512/526 [01:29<00:00, 20.14it/s, est. speed input: 11996.12 toks/s, output: 943.24 toks/s]
Processed prompts:  98%|█████████▊| 515/526 [01:30<00:01, 10.47it/s, est. speed input: 12002.06 toks/s, output: 949.50 toks/s]
Processed prompts:  98%|█████████▊| 517/526 [01:30<00:00,  9.53it/s, est. speed input: 12018.15 toks/s, output: 954.40 toks/s]
Processed prompts:  99%|█████████▉| 520/526 [01:30<00:00, 10.54it/s, est. speed input: 12081.48 toks/s, output: 964.99 toks/s]
Processed prompts:  99%|█████████▉| 523/526 [01:31<00:00, 10.36it/s, est. speed input: 12146.34 toks/s, output: 974.06 toks/s]
Processed prompts: 100%|█████████▉| 525/526 [01:31<00:00, 11.57it/s, est. speed input: 12184.65 toks/s, output: 979.88 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:32<00:00,  5.71it/s, est. speed input: 12114.01 toks/s, output: 975.12 toks/s]
[rank0]:[W715 11:01:09.131610938 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/lp_rag_full_profile_test_10_limit_3_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 11:01:13.145021_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 11:01:13.145021_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 11:01:13.145021_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<03:02,  2.32it/s]
  0%|          | 2/424 [00:01<05:13,  1.35it/s]
  1%|          | 3/424 [00:01<03:11,  2.20it/s]
  1%|          | 4/424 [00:03<06:44,  1.04it/s]
  1%|          | 5/424 [00:03<04:59,  1.40it/s]
  2%|▏         | 7/424 [00:04<04:14,  1.64it/s]
  2%|▏         | 8/424 [00:05<04:19,  1.60it/s]
  2%|▏         | 9/424 [00:05<03:23,  2.04it/s]
  2%|▏         | 10/424 [00:05<03:00,  2.30it/s]
  3%|▎         | 11/424 [00:05<02:26,  2.82it/s]
  3%|▎         | 12/424 [00:06<02:20,  2.92it/s]
  3%|▎         | 13/424 [00:07<05:19,  1.29it/s]
  3%|▎         | 14/424 [00:08<04:05,  1.67it/s]
  4%|▎         | 15/424 [00:08<03:19,  2.05it/s]
  4%|▍         | 16/424 [00:08<03:33,  1.91it/s]
  4%|▍         | 17/424 [00:09<03:07,  2.17it/s]
  4%|▍         | 18/424 [00:09<02:41,  2.52it/s]
  4%|▍         | 19/424 [00:10<03:07,  2.16it/s]
  5%|▍         | 20/424 [00:10<02:32,  2.65it/s]
  5%|▍         | 21/424 [00:10<02:04,  3.25it/s]
  5%|▌         | 22/424 [00:11<02:45,  2.42it/s]
  5%|▌         | 23/424 [00:12<04:58,  1.34it/s]
  6%|▌         | 24/424 [00:13<04:47,  1.39it/s]
  6%|▌         | 25/424 [00:14<05:16,  1.26it/s]
  6%|▌         | 26/424 [00:14<04:59,  1.33it/s]
  6%|▋         | 27/424 [00:16<06:57,  1.05s/it]
  7%|▋         | 28/424 [00:17<06:06,  1.08it/s]
  7%|▋         | 29/424 [00:17<04:49,  1.37it/s]
  7%|▋         | 30/424 [00:17<03:44,  1.75it/s]
  7%|▋         | 31/424 [00:18<03:50,  1.70it/s]
  8%|▊         | 33/424 [00:18<02:16,  2.86it/s]
  8%|▊         | 34/424 [00:18<02:09,  3.01it/s]
  8%|▊         | 36/424 [00:18<01:26,  4.48it/s]
  9%|▊         | 37/424 [00:19<02:14,  2.88it/s]
  9%|▉         | 38/424 [00:20<02:09,  2.97it/s]
  9%|▉         | 40/424 [00:20<01:40,  3.82it/s]
 10%|▉         | 41/424 [00:20<01:39,  3.83it/s]
 10%|▉         | 42/424 [00:21<02:19,  2.74it/s]
 10%|█         | 43/424 [00:21<01:58,  3.22it/s]
 10%|█         | 44/424 [00:23<04:18,  1.47it/s]
 11%|█         | 45/424 [00:23<04:17,  1.47it/s]
 11%|█         | 46/424 [00:24<03:33,  1.77it/s]
 11%|█         | 47/424 [00:24<03:39,  1.72it/s]
 11%|█▏        | 48/424 [00:25<03:46,  1.66it/s]
 12%|█▏        | 49/424 [00:25<03:48,  1.64it/s]
 12%|█▏        | 51/424 [00:26<03:00,  2.07it/s]
 12%|█▏        | 52/424 [00:27<02:59,  2.08it/s]
 12%|█▎        | 53/424 [00:27<03:15,  1.90it/s]
 13%|█▎        | 54/424 [00:28<03:56,  1.57it/s]
 13%|█▎        | 55/424 [00:28<03:17,  1.87it/s]
 13%|█▎        | 56/424 [00:29<03:30,  1.75it/s]
 14%|█▎        | 58/424 [00:29<02:06,  2.88it/s]
 14%|█▍        | 59/424 [00:31<04:05,  1.49it/s]
 15%|█▍        | 62/424 [00:34<05:35,  1.08it/s]
 15%|█▍        | 63/424 [00:35<05:14,  1.15it/s]
 15%|█▌        | 64/424 [00:35<04:27,  1.35it/s]
 15%|█▌        | 65/424 [00:35<03:32,  1.69it/s]
 16%|█▌        | 66/424 [00:37<05:14,  1.14it/s]
 16%|█▌        | 67/424 [00:37<04:10,  1.42it/s]
 16%|█▌        | 68/424 [00:38<03:57,  1.50it/s]
 16%|█▋        | 69/424 [00:40<05:38,  1.05it/s]
 17%|█▋        | 70/424 [00:40<04:40,  1.26it/s]
 17%|█▋        | 71/424 [00:41<04:01,  1.46it/s]
 17%|█▋        | 72/424 [00:41<03:26,  1.70it/s]
 17%|█▋        | 73/424 [00:41<03:02,  1.93it/s]
 17%|█▋        | 74/424 [00:42<02:44,  2.13it/s]
 18%|█▊        | 75/424 [00:44<05:28,  1.06it/s]
 18%|█▊        | 77/424 [00:44<03:29,  1.66it/s]
 18%|█▊        | 78/424 [00:44<02:48,  2.05it/s]
 19%|█▊        | 79/424 [00:44<02:14,  2.57it/s]
 19%|█▉        | 80/424 [00:44<01:48,  3.16it/s]
 19%|█▉        | 81/424 [00:45<02:46,  2.07it/s]
 19%|█▉        | 82/424 [00:46<03:18,  1.72it/s]
 20%|█▉        | 83/424 [00:47<04:00,  1.42it/s]
 20%|█▉        | 84/424 [00:47<03:00,  1.88it/s]
 20%|██        | 85/424 [00:48<03:51,  1.47it/s]
 20%|██        | 86/424 [00:49<04:12,  1.34it/s]
 21%|██        | 87/424 [00:50<04:40,  1.20it/s]
 21%|██        | 88/424 [00:51<03:54,  1.44it/s]
 21%|██        | 89/424 [00:52<04:25,  1.26it/s]
 21%|██        | 90/424 [00:52<03:24,  1.63it/s]
 21%|██▏       | 91/424 [00:53<04:09,  1.34it/s]
 22%|██▏       | 92/424 [00:54<04:36,  1.20it/s]
 22%|██▏       | 93/424 [00:55<04:15,  1.29it/s]
 22%|██▏       | 94/424 [00:56<04:38,  1.18it/s]
 22%|██▏       | 95/424 [00:56<03:27,  1.58it/s]
 23%|██▎       | 96/424 [00:56<03:00,  1.82it/s]
 23%|██▎       | 98/424 [00:56<01:52,  2.90it/s]
 23%|██▎       | 99/424 [00:56<01:37,  3.33it/s]
 24%|██▎       | 100/424 [00:57<02:01,  2.67it/s]
 24%|██▍       | 101/424 [00:58<03:26,  1.56it/s]
 24%|██▍       | 102/424 [00:59<02:55,  1.83it/s]
 24%|██▍       | 103/424 [00:59<02:26,  2.19it/s]
 25%|██▍       | 104/424 [00:59<02:00,  2.66it/s]
 25%|██▍       | 105/424 [01:00<02:27,  2.16it/s]
 25%|██▌       | 106/424 [01:00<01:55,  2.76it/s]
 25%|██▌       | 107/424 [01:01<02:23,  2.21it/s]
 26%|██▌       | 109/424 [01:04<05:39,  1.08s/it]
 26%|██▌       | 110/424 [01:06<06:28,  1.24s/it]
 26%|██▌       | 111/424 [01:06<05:30,  1.06s/it]
 26%|██▋       | 112/424 [01:07<04:10,  1.24it/s]
 27%|██▋       | 114/424 [01:07<02:29,  2.07it/s]
 27%|██▋       | 116/424 [01:07<01:44,  2.94it/s]
 28%|██▊       | 117/424 [01:07<01:28,  3.46it/s]
 28%|██▊       | 118/424 [01:07<01:20,  3.78it/s]
 28%|██▊       | 119/424 [01:07<01:15,  4.05it/s]
 29%|██▊       | 121/424 [01:08<01:00,  5.02it/s]
 29%|██▉       | 122/424 [01:15<08:43,  1.73s/it]
 29%|██▉       | 123/424 [01:22<15:26,  3.08s/it]
 29%|██▉       | 124/424 [01:29<20:35,  4.12s/it]
 29%|██▉       | 125/424 [01:36<24:20,  4.89s/it]
 30%|██▉       | 126/424 [01:43<27:16,  5.49s/it]
 30%|██▉       | 127/424 [01:50<29:22,  5.93s/it]
 30%|███       | 128/424 [01:51<22:15,  4.51s/it]
 30%|███       | 129/424 [01:52<17:06,  3.48s/it]
 31%|███       | 130/424 [01:53<13:23,  2.73s/it]
 31%|███       | 131/424 [01:54<10:49,  2.22s/it]
 31%|███       | 132/424 [01:54<08:16,  1.70s/it]
 31%|███▏      | 133/424 [01:55<06:46,  1.40s/it]
 32%|███▏      | 134/424 [01:55<04:54,  1.01s/it]
 32%|███▏      | 135/424 [01:55<03:41,  1.31it/s]
 32%|███▏      | 136/424 [01:55<02:50,  1.69it/s]
 32%|███▏      | 137/424 [01:56<02:15,  2.11it/s]
 33%|███▎      | 138/424 [01:56<01:50,  2.59it/s]
 33%|███▎      | 139/424 [01:56<01:32,  3.08it/s]
 33%|███▎      | 140/424 [01:56<01:14,  3.81it/s]
 33%|███▎      | 141/424 [01:56<01:07,  4.21it/s]
 33%|███▎      | 142/424 [01:56<01:03,  4.46it/s]
 34%|███▎      | 143/424 [01:57<01:00,  4.68it/s]
 34%|███▍      | 144/424 [01:57<00:57,  4.85it/s]
 34%|███▍      | 145/424 [01:57<00:54,  5.09it/s]
 34%|███▍      | 146/424 [01:57<00:53,  5.22it/s]
 35%|███▍      | 147/424 [01:57<00:52,  5.27it/s]
 35%|███▍      | 148/424 [01:58<00:52,  5.30it/s]
 35%|███▌      | 149/424 [01:58<00:51,  5.32it/s]
 35%|███▌      | 150/424 [01:58<00:51,  5.29it/s]
 36%|███▌      | 151/424 [01:58<00:51,  5.26it/s]
 36%|███▌      | 152/424 [01:58<00:51,  5.30it/s]
 36%|███▌      | 153/424 [01:59<00:50,  5.33it/s]
 36%|███▋      | 154/424 [01:59<00:51,  5.25it/s]
 37%|███▋      | 155/424 [01:59<00:50,  5.30it/s]
 37%|███▋      | 156/424 [01:59<00:50,  5.32it/s]
 37%|███▋      | 157/424 [01:59<00:50,  5.33it/s]
 37%|███▋      | 158/424 [01:59<00:49,  5.33it/s]
 38%|███▊      | 159/424 [02:00<00:49,  5.32it/s]
 38%|███▊      | 160/424 [02:02<03:02,  1.44it/s]
 38%|███▊      | 161/424 [02:02<02:22,  1.85it/s]
 38%|███▊      | 162/424 [02:02<01:54,  2.29it/s]
 38%|███▊      | 163/424 [02:02<01:33,  2.78it/s]
 39%|███▊      | 164/424 [02:02<01:20,  3.22it/s]
 39%|███▉      | 165/424 [02:02<01:10,  3.66it/s]
 39%|███▉      | 166/424 [02:03<00:58,  4.38it/s]
 39%|███▉      | 167/424 [02:03<00:55,  4.60it/s]
 40%|███▉      | 168/424 [02:03<01:03,  4.03it/s]
 40%|███▉      | 169/424 [02:03<01:10,  3.61it/s]
 40%|████      | 170/424 [02:04<01:13,  3.44it/s]
 40%|████      | 171/424 [02:04<01:24,  2.99it/s]
 41%|████      | 172/424 [02:04<01:08,  3.66it/s]
 41%|████      | 174/424 [02:05<01:30,  2.77it/s]
 41%|████▏     | 175/424 [02:05<01:14,  3.34it/s]
 42%|████▏     | 176/424 [02:06<01:05,  3.80it/s]
 42%|████▏     | 177/424 [02:06<00:58,  4.24it/s]
 42%|████▏     | 178/424 [02:06<01:02,  3.92it/s]
 42%|████▏     | 179/424 [02:06<01:02,  3.94it/s]
 42%|████▏     | 180/424 [02:07<01:13,  3.33it/s]
 43%|████▎     | 181/424 [02:07<01:03,  3.85it/s]
 43%|████▎     | 182/424 [02:07<01:00,  4.01it/s]
 43%|████▎     | 183/424 [02:07<00:59,  4.08it/s]
 43%|████▎     | 184/424 [02:08<01:21,  2.95it/s]
 44%|████▎     | 185/424 [02:09<01:49,  2.18it/s]
 44%|████▍     | 186/424 [02:09<01:52,  2.11it/s]
 44%|████▍     | 187/424 [02:09<01:44,  2.27it/s]
 44%|████▍     | 188/424 [02:10<01:41,  2.33it/s]
 45%|████▍     | 189/424 [02:11<03:06,  1.26it/s]
 45%|████▍     | 190/424 [02:16<07:04,  1.81s/it]
 45%|████▌     | 191/424 [02:16<05:22,  1.38s/it]
 45%|████▌     | 192/424 [02:18<05:44,  1.49s/it]
 46%|████▌     | 194/424 [02:18<03:30,  1.09it/s]
 46%|████▌     | 196/424 [02:19<02:33,  1.48it/s]
 46%|████▋     | 197/424 [02:19<02:13,  1.70it/s]
 47%|████▋     | 198/424 [02:19<01:52,  2.01it/s]
 47%|████▋     | 199/424 [02:20<02:08,  1.75it/s]
 47%|████▋     | 200/424 [02:20<01:46,  2.11it/s]
 47%|████▋     | 201/424 [02:22<02:59,  1.24it/s]
 48%|████▊     | 202/424 [02:22<02:20,  1.58it/s]
 48%|████▊     | 203/424 [02:24<03:32,  1.04it/s]
 48%|████▊     | 204/424 [02:27<06:02,  1.65s/it]
 48%|████▊     | 205/424 [02:28<04:50,  1.33s/it]
 49%|████▊     | 206/424 [02:31<06:46,  1.86s/it]
 49%|████▉     | 207/424 [02:31<05:03,  1.40s/it]
 49%|████▉     | 208/424 [02:32<03:53,  1.08s/it]
 49%|████▉     | 209/424 [02:32<02:54,  1.23it/s]
 50%|████▉     | 210/424 [02:32<02:21,  1.51it/s]
 50%|█████     | 212/424 [02:32<01:24,  2.52it/s]
 50%|█████     | 213/424 [02:33<01:31,  2.31it/s]
 50%|█████     | 214/424 [02:33<01:38,  2.13it/s]
 51%|█████     | 215/424 [02:34<02:01,  1.72it/s]
 51%|█████     | 216/424 [02:35<01:36,  2.15it/s]
 51%|█████     | 217/424 [02:35<01:21,  2.53it/s]
 51%|█████▏    | 218/424 [02:35<01:15,  2.74it/s]
 52%|█████▏    | 219/424 [02:35<01:09,  2.96it/s]
 52%|█████▏    | 220/424 [02:36<01:41,  2.01it/s]
 52%|█████▏    | 221/424 [02:37<01:34,  2.16it/s]
 52%|█████▏    | 222/424 [02:37<01:26,  2.34it/s]
 53%|█████▎    | 223/424 [02:37<01:17,  2.60it/s]
 53%|█████▎    | 224/424 [02:38<01:13,  2.74it/s]
 53%|█████▎    | 225/424 [02:39<02:27,  1.35it/s]
 54%|█████▎    | 227/424 [02:40<01:36,  2.05it/s]
 54%|█████▍    | 229/424 [02:40<01:07,  2.91it/s]
 54%|█████▍    | 230/424 [02:43<03:14,  1.01s/it]
 54%|█████▍    | 231/424 [02:44<02:53,  1.11it/s]
 55%|█████▍    | 232/424 [02:44<02:13,  1.44it/s]
 55%|█████▍    | 233/424 [02:45<03:03,  1.04it/s]
 55%|█████▌    | 234/424 [02:53<08:25,  2.66s/it]
 55%|█████▌    | 235/424 [02:54<06:51,  2.18s/it]
 56%|█████▌    | 236/424 [02:54<05:11,  1.66s/it]
 56%|█████▌    | 238/424 [02:54<02:55,  1.06it/s]
 57%|█████▋    | 240/424 [02:56<02:49,  1.08it/s]
 57%|█████▋    | 241/424 [02:57<02:47,  1.09it/s]
 57%|█████▋    | 242/424 [02:57<02:13,  1.36it/s]
 57%|█████▋    | 243/424 [02:57<01:57,  1.54it/s]
 58%|█████▊    | 244/424 [02:58<01:59,  1.51it/s]
 58%|█████▊    | 245/424 [02:58<01:32,  1.94it/s]
 58%|█████▊    | 246/424 [02:58<01:23,  2.14it/s]
 58%|█████▊    | 247/424 [03:00<02:24,  1.22it/s]
 58%|█████▊    | 248/424 [03:00<01:48,  1.63it/s]
 59%|█████▊    | 249/424 [03:00<01:22,  2.13it/s]
 59%|█████▉    | 250/424 [03:01<01:32,  1.88it/s]
 59%|█████▉    | 251/424 [03:01<01:13,  2.34it/s]
 59%|█████▉    | 252/424 [03:01<00:57,  2.98it/s]
 60%|█████▉    | 253/424 [03:01<00:46,  3.68it/s]
 60%|█████▉    | 254/424 [03:02<00:38,  4.45it/s]
 60%|██████    | 255/424 [03:02<00:32,  5.24it/s]
 60%|██████    | 256/424 [03:02<00:28,  5.88it/s]
 61%|██████    | 257/424 [03:02<00:25,  6.45it/s]
 61%|██████    | 258/424 [03:02<00:24,  6.89it/s]
 61%|██████    | 259/424 [03:02<00:31,  5.22it/s]
 61%|██████▏   | 260/424 [03:03<01:09,  2.35it/s]
 62%|██████▏   | 261/424 [03:03<00:53,  3.03it/s]
 62%|██████▏   | 263/424 [03:04<01:07,  2.38it/s]
 62%|██████▏   | 264/424 [03:05<00:55,  2.90it/s]
 62%|██████▎   | 265/424 [03:05<00:44,  3.54it/s]
 63%|██████▎   | 266/424 [03:05<00:49,  3.21it/s]
 63%|██████▎   | 267/424 [03:05<00:40,  3.88it/s]
 63%|██████▎   | 268/424 [03:05<00:34,  4.57it/s]
 63%|██████▎   | 269/424 [03:06<01:02,  2.47it/s]
 64%|██████▎   | 270/424 [03:06<00:49,  3.12it/s]
 64%|██████▍   | 272/424 [03:06<00:31,  4.77it/s]
 64%|██████▍   | 273/424 [03:07<00:31,  4.80it/s]
 65%|██████▍   | 275/424 [03:07<00:22,  6.73it/s]
 65%|██████▌   | 277/424 [03:07<00:18,  7.99it/s]
 66%|██████▌   | 279/424 [03:08<00:41,  3.48it/s]
 66%|██████▌   | 280/424 [03:09<00:45,  3.19it/s]
 66%|██████▋   | 281/424 [03:09<00:48,  2.95it/s]
 67%|██████▋   | 283/424 [03:12<02:00,  1.17it/s]
 67%|██████▋   | 284/424 [03:12<01:37,  1.43it/s]
 67%|██████▋   | 285/424 [03:13<01:17,  1.78it/s]
 68%|██████▊   | 287/424 [03:13<00:59,  2.30it/s]
 68%|██████▊   | 288/424 [03:13<00:56,  2.39it/s]
 68%|██████▊   | 289/424 [03:14<00:52,  2.56it/s]
 69%|██████▊   | 291/424 [03:14<00:38,  3.46it/s]
 69%|██████▉   | 292/424 [03:14<00:32,  4.04it/s]
 69%|██████▉   | 293/424 [03:17<02:10,  1.00it/s]
 70%|██████▉   | 295/424 [03:18<01:39,  1.30it/s]
 70%|██████▉   | 296/424 [03:18<01:19,  1.60it/s]
 70%|███████   | 297/424 [03:19<01:12,  1.76it/s]
 70%|███████   | 298/424 [03:19<01:01,  2.06it/s]
 71%|███████   | 299/424 [03:19<00:50,  2.48it/s]
 71%|███████   | 301/424 [03:20<00:36,  3.34it/s]
 71%|███████   | 302/424 [03:27<03:50,  1.89s/it]
 71%|███████▏  | 303/424 [03:27<03:02,  1.51s/it]
 72%|███████▏  | 304/424 [03:27<02:18,  1.16s/it]
 72%|███████▏  | 305/424 [03:28<01:51,  1.07it/s]
 72%|███████▏  | 306/424 [03:28<01:33,  1.26it/s]
 72%|███████▏  | 307/424 [03:28<01:09,  1.68it/s]
 73%|███████▎  | 308/424 [03:28<00:57,  2.01it/s]
 73%|███████▎  | 309/424 [03:29<01:00,  1.90it/s]
 73%|███████▎  | 310/424 [03:30<01:17,  1.46it/s]
 73%|███████▎  | 311/424 [03:30<00:57,  1.95it/s]
 74%|███████▎  | 312/424 [03:30<00:46,  2.42it/s]
 74%|███████▍  | 313/424 [03:31<00:40,  2.76it/s]
 74%|███████▍  | 314/424 [03:31<00:41,  2.62it/s]
 74%|███████▍  | 315/424 [03:32<01:12,  1.51it/s]
 75%|███████▍  | 316/424 [03:32<00:53,  2.01it/s]
 75%|███████▍  | 317/424 [03:34<01:22,  1.30it/s]
 75%|███████▌  | 318/424 [03:35<01:39,  1.06it/s]
 75%|███████▌  | 319/424 [03:35<01:19,  1.31it/s]
 75%|███████▌  | 320/424 [03:36<01:03,  1.65it/s]
 76%|███████▌  | 321/424 [03:36<00:46,  2.20it/s]
 76%|███████▌  | 323/424 [03:36<00:30,  3.27it/s]
 76%|███████▋  | 324/424 [03:36<00:27,  3.67it/s]
 77%|███████▋  | 325/424 [03:36<00:24,  4.02it/s]
 77%|███████▋  | 326/424 [03:43<03:22,  2.07s/it]
 77%|███████▋  | 327/424 [03:45<03:01,  1.88s/it]
 77%|███████▋  | 328/424 [03:46<02:30,  1.57s/it]
 78%|███████▊  | 329/424 [03:46<01:57,  1.23s/it]
 78%|███████▊  | 330/424 [03:47<01:59,  1.27s/it]
 78%|███████▊  | 331/424 [03:47<01:27,  1.07it/s]
 79%|███████▊  | 333/424 [03:49<01:18,  1.15it/s]
 79%|███████▉  | 334/424 [03:49<01:07,  1.33it/s]
 79%|███████▉  | 335/424 [03:50<01:04,  1.38it/s]
 79%|███████▉  | 336/424 [03:52<01:34,  1.07s/it]
 79%|███████▉  | 337/424 [03:59<03:58,  2.74s/it]
 80%|███████▉  | 338/424 [04:00<03:00,  2.10s/it]
 80%|███████▉  | 339/424 [04:01<02:30,  1.77s/it]
 80%|████████  | 340/424 [04:08<04:38,  3.32s/it]
 80%|████████  | 341/424 [04:09<03:56,  2.85s/it]
 81%|████████  | 342/424 [04:11<03:25,  2.51s/it]
 81%|████████  | 343/424 [04:11<02:26,  1.81s/it]
 81%|████████  | 344/424 [04:12<01:59,  1.49s/it]
 81%|████████▏ | 345/424 [04:12<01:25,  1.08s/it]
 82%|████████▏ | 346/424 [04:13<01:08,  1.13it/s]
 82%|████████▏ | 347/424 [04:13<01:04,  1.19it/s]
 82%|████████▏ | 349/424 [04:13<00:35,  2.09it/s]
 83%|████████▎ | 350/424 [04:14<00:41,  1.78it/s]
 83%|████████▎ | 351/424 [04:14<00:32,  2.26it/s]
 83%|████████▎ | 352/424 [04:21<02:38,  2.20s/it]
 83%|████████▎ | 353/424 [04:22<02:03,  1.75s/it]
 83%|████████▎ | 354/424 [04:23<01:47,  1.54s/it]
 84%|████████▎ | 355/424 [04:23<01:18,  1.14s/it]
 84%|████████▍ | 356/424 [04:25<01:28,  1.30s/it]
 84%|████████▍ | 357/424 [04:26<01:19,  1.19s/it]
 84%|████████▍ | 358/424 [04:27<01:16,  1.16s/it]
 85%|████████▍ | 359/424 [04:28<01:13,  1.12s/it]
 85%|████████▍ | 360/424 [04:28<00:55,  1.16it/s]
 85%|████████▌ | 361/424 [04:28<00:41,  1.50it/s]
 85%|████████▌ | 362/424 [04:29<00:35,  1.73it/s]
 86%|████████▌ | 363/424 [04:35<02:31,  2.48s/it]
 86%|████████▌ | 364/424 [04:36<01:51,  1.87s/it]
 86%|████████▌ | 365/424 [04:36<01:20,  1.37s/it]
 86%|████████▋ | 366/424 [04:36<00:57,  1.00it/s]
 87%|████████▋ | 367/424 [04:36<00:42,  1.36it/s]
 87%|████████▋ | 368/424 [04:43<02:27,  2.64s/it]
 87%|████████▋ | 369/424 [04:44<01:47,  1.95s/it]
 87%|████████▋ | 370/424 [04:44<01:15,  1.41s/it]
 88%|████████▊ | 372/424 [04:44<00:42,  1.22it/s]
 88%|████████▊ | 373/424 [04:44<00:34,  1.47it/s]
 88%|████████▊ | 374/424 [04:45<00:38,  1.31it/s]
 89%|████████▊ | 376/424 [04:46<00:28,  1.66it/s]
 89%|████████▉ | 377/424 [04:48<00:36,  1.29it/s]
 89%|████████▉ | 378/424 [04:48<00:28,  1.62it/s]
 89%|████████▉ | 379/424 [04:48<00:27,  1.65it/s]
 90%|████████▉ | 380/424 [04:50<00:38,  1.14it/s]
 90%|████████▉ | 381/424 [04:50<00:28,  1.52it/s]
 90%|█████████ | 382/424 [04:51<00:36,  1.14it/s]
 91%|█████████ | 384/424 [04:52<00:21,  1.83it/s]
 91%|█████████ | 385/424 [04:52<00:18,  2.15it/s]
 91%|█████████▏| 387/424 [04:52<00:11,  3.29it/s]
 92%|█████████▏| 388/424 [04:53<00:13,  2.61it/s]
 92%|█████████▏| 389/424 [04:57<00:47,  1.36s/it]
 92%|█████████▏| 390/424 [04:57<00:36,  1.06s/it]
 92%|█████████▏| 391/424 [04:57<00:27,  1.22it/s]
 92%|█████████▏| 392/424 [04:58<00:20,  1.58it/s]
 93%|█████████▎| 393/424 [04:58<00:20,  1.51it/s]
 93%|█████████▎| 394/424 [04:59<00:20,  1.50it/s]
 93%|█████████▎| 395/424 [05:01<00:28,  1.03it/s]
 93%|█████████▎| 396/424 [05:02<00:27,  1.02it/s]
 94%|█████████▎| 397/424 [05:03<00:29,  1.08s/it]
 94%|█████████▍| 398/424 [05:04<00:29,  1.15s/it]
 94%|█████████▍| 399/424 [05:05<00:23,  1.08it/s]
 94%|█████████▍| 400/424 [05:05<00:19,  1.20it/s]
 95%|█████████▍| 401/424 [05:06<00:15,  1.52it/s]
 95%|█████████▍| 402/424 [05:09<00:32,  1.47s/it]
 95%|█████████▌| 403/424 [05:12<00:38,  1.82s/it]
 95%|█████████▌| 404/424 [05:12<00:26,  1.34s/it]
 96%|█████████▌| 405/424 [05:12<00:20,  1.06s/it]
 96%|█████████▌| 406/424 [05:12<00:14,  1.28it/s]
 96%|█████████▌| 407/424 [05:14<00:16,  1.06it/s]
 96%|█████████▌| 408/424 [05:15<00:15,  1.02it/s]
 96%|█████████▋| 409/424 [05:17<00:22,  1.48s/it]
 97%|█████████▋| 410/424 [05:18<00:15,  1.14s/it]
 97%|█████████▋| 411/424 [05:19<00:14,  1.08s/it]
 97%|█████████▋| 412/424 [05:19<00:09,  1.24it/s]
 97%|█████████▋| 413/424 [05:21<00:11,  1.07s/it]
 98%|█████████▊| 415/424 [05:22<00:08,  1.05it/s]
 98%|█████████▊| 416/424 [05:23<00:07,  1.13it/s]
 98%|█████████▊| 417/424 [05:24<00:05,  1.20it/s]
 99%|█████████▊| 418/424 [05:28<00:10,  1.80s/it]
 99%|█████████▉| 419/424 [05:29<00:07,  1.47s/it]
 99%|█████████▉| 420/424 [05:30<00:06,  1.53s/it]
 99%|█████████▉| 421/424 [05:31<00:04,  1.38s/it]
100%|█████████▉| 422/424 [05:31<00:02,  1.02s/it]
100%|█████████▉| 423/424 [05:36<00:01,  1.96s/it]
100%|██████████| 424/424 [05:37<00:00,  1.71s/it]
100%|██████████| 424/424 [05:37<00:00,  1.26it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 11:01:13.145021_sc_processed_test.json', '--output_addr', 'data/out/rag/full_profile/sc_rag_full_profile_test_10_limit_3_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  6.77 examples/s]
Generating train split: 424 examples [00:00, 1476.55 examples/s]
INFO 07-15 11:07:24 config.py:510] This model supports multiple tasks: {'embed', 'reward', 'classify', 'generate', 'score'}. Defaulting to 'generate'.
INFO 07-15 11:07:24 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 11:07:25 selector.py:120] Using Flash Attention backend.
INFO 07-15 11:07:26 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 11:07:27 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.58it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.48it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.52it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.50it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.50it/s]

INFO 07-15 11:07:30 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 11:07:32 worker.py:241] Memory profiling takes 2.08 seconds
INFO 07-15 11:07:32 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 11:07:32 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 11:07:32 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 11:07:32 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 11:07:35 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:12,  2.62it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:11,  2.77it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:11,  2.83it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:10,  2.86it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:10,  2.88it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:10,  2.90it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:09,  2.91it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:09,  2.92it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:08,  2.91it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:08,  2.92it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:08,  2.93it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:07,  2.93it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:07,  2.94it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:04<00:07,  2.94it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:06,  2.95it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.89it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:05<00:06,  2.87it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  2.86it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:05,  2.84it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:05,  2.83it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:04,  2.83it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:04,  2.86it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:04,  2.88it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:03,  2.87it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:03,  2.86it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:09<00:03,  2.85it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:09<00:02,  2.80it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:02,  2.79it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:10<00:02,  2.81it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:10<00:01,  2.83it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:10<00:01,  2.83it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:11<00:01,  2.84it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:11<00:00,  2.81it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:11<00:00,  2.82it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  2.83it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:12<00:00,  2.86it/s]
INFO 07-15 11:07:47 model_runner.py:1535] Graph capturing finished in 12 secs, took 0.22 GiB
INFO 07-15 11:07:47 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 17.42 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:35<4:07:54, 35.16s/it, est. speed input: 49.71 toks/s, output: 1.91 toks/s]
Processed prompts:   0%|          | 2/424 [00:36<1:48:42, 15.46s/it, est. speed input: 99.17 toks/s, output: 4.26 toks/s]
Processed prompts:   1%|          | 3/424 [00:37<59:56,  8.54s/it, est. speed input: 131.50 toks/s, output: 6.73 toks/s] 
Processed prompts:   1%|          | 4/424 [00:37<37:45,  5.39s/it, est. speed input: 231.36 toks/s, output: 9.28 toks/s]
Processed prompts:   1%|          | 5/424 [00:37<24:20,  3.49s/it, est. speed input: 284.25 toks/s, output: 11.93 toks/s]
Processed prompts:   1%|▏         | 6/424 [00:38<17:27,  2.51s/it, est. speed input: 349.87 toks/s, output: 14.55 toks/s]
Processed prompts:   2%|▏         | 7/424 [00:38<12:11,  1.76s/it, est. speed input: 387.36 toks/s, output: 17.32 toks/s]
Processed prompts:   2%|▏         | 8/424 [00:38<09:00,  1.30s/it, est. speed input: 403.00 toks/s, output: 20.08 toks/s]
Processed prompts:   2%|▏         | 10/424 [00:39<05:29,  1.26it/s, est. speed input: 501.05 toks/s, output: 25.66 toks/s]
Processed prompts:   3%|▎         | 11/424 [00:39<04:15,  1.61it/s, est. speed input: 554.61 toks/s, output: 28.58 toks/s]
Processed prompts:   3%|▎         | 12/424 [00:39<03:49,  1.80it/s, est. speed input: 591.31 toks/s, output: 31.34 toks/s]
Processed prompts:   3%|▎         | 14/424 [00:40<02:25,  2.82it/s, est. speed input: 685.60 toks/s, output: 37.26 toks/s]
Processed prompts:   4%|▍         | 16/424 [00:40<01:50,  3.68it/s, est. speed input: 816.07 toks/s, output: 43.08 toks/s]
Processed prompts:   4%|▍         | 19/424 [00:40<01:29,  4.54it/s, est. speed input: 923.83 toks/s, output: 51.64 toks/s]
Processed prompts:   5%|▍         | 21/424 [00:41<01:29,  4.49it/s, est. speed input: 1033.35 toks/s, output: 57.12 toks/s]
Processed prompts:   5%|▌         | 23/424 [00:41<01:21,  4.94it/s, est. speed input: 1110.76 toks/s, output: 62.83 toks/s]
Processed prompts:   6%|▌         | 25/424 [00:41<01:11,  5.58it/s, est. speed input: 1187.74 toks/s, output: 68.59 toks/s]
Processed prompts:   6%|▌         | 26/424 [00:42<01:16,  5.23it/s, est. speed input: 1200.61 toks/s, output: 71.28 toks/s]
Processed prompts:   7%|▋         | 29/424 [00:42<01:01,  6.41it/s, est. speed input: 1348.44 toks/s, output: 79.94 toks/s]
Processed prompts:   8%|▊         | 32/424 [00:42<00:57,  6.85it/s, est. speed input: 1484.48 toks/s, output: 88.41 toks/s]
Processed prompts:   8%|▊         | 33/424 [00:43<01:13,  5.30it/s, est. speed input: 1498.17 toks/s, output: 90.65 toks/s]
Processed prompts:   8%|▊         | 34/424 [00:43<01:17,  5.01it/s, est. speed input: 1550.62 toks/s, output: 93.23 toks/s]
Processed prompts:   9%|▊         | 37/424 [00:44<01:12,  5.31it/s, est. speed input: 1746.00 toks/s, output: 101.35 toks/s]
Processed prompts:   9%|▉         | 39/424 [00:44<01:01,  6.23it/s, est. speed input: 1837.73 toks/s, output: 107.10 toks/s]
Processed prompts:  10%|▉         | 42/424 [00:44<01:06,  5.75it/s, est. speed input: 1983.87 toks/s, output: 114.89 toks/s]
Processed prompts:  10%|█         | 44/424 [00:45<01:06,  5.72it/s, est. speed input: 2022.01 toks/s, output: 120.13 toks/s]
Processed prompts:  11%|█         | 45/424 [00:45<01:08,  5.53it/s, est. speed input: 2065.10 toks/s, output: 122.65 toks/s]
Processed prompts:  11%|█         | 47/424 [00:45<01:05,  5.80it/s, est. speed input: 2165.13 toks/s, output: 127.98 toks/s]
Processed prompts:  12%|█▏        | 49/424 [00:46<01:16,  4.90it/s, est. speed input: 2217.95 toks/s, output: 132.63 toks/s]
Processed prompts:  12%|█▏        | 51/424 [00:46<01:21,  4.58it/s, est. speed input: 2262.51 toks/s, output: 137.41 toks/s]
Processed prompts:  13%|█▎        | 57/424 [00:47<00:55,  6.65it/s, est. speed input: 2642.92 toks/s, output: 154.23 toks/s]
Processed prompts:  14%|█▍        | 60/424 [00:47<00:54,  6.62it/s, est. speed input: 2783.29 toks/s, output: 162.00 toks/s]
Processed prompts:  15%|█▍        | 63/424 [00:48<00:48,  7.38it/s, est. speed input: 2916.29 toks/s, output: 170.28 toks/s]
Processed prompts:  16%|█▌        | 68/424 [00:49<00:57,  6.19it/s, est. speed input: 3025.00 toks/s, output: 182.03 toks/s]
Processed prompts:  17%|█▋        | 72/424 [00:49<00:50,  6.94it/s, est. speed input: 3161.06 toks/s, output: 192.60 toks/s]
Processed prompts:  18%|█▊        | 77/424 [00:50<00:48,  7.19it/s, est. speed input: 3274.72 toks/s, output: 205.18 toks/s]
Processed prompts:  19%|█▉        | 82/424 [00:50<00:45,  7.55it/s, est. speed input: 3442.50 toks/s, output: 217.77 toks/s]
Processed prompts:  20%|██        | 85/424 [00:51<00:49,  6.91it/s, est. speed input: 3525.57 toks/s, output: 224.36 toks/s]
Processed prompts:  21%|██        | 88/424 [00:51<00:54,  6.17it/s, est. speed input: 3577.73 toks/s, output: 230.47 toks/s]
Processed prompts:  21%|██▏       | 91/424 [00:52<00:53,  6.23it/s, est. speed input: 3655.43 toks/s, output: 237.30 toks/s]
Processed prompts:  22%|██▏       | 93/424 [00:52<00:50,  6.56it/s, est. speed input: 3736.96 toks/s, output: 242.17 toks/s]
Processed prompts:  23%|██▎       | 99/424 [00:53<00:47,  6.78it/s, est. speed input: 3889.41 toks/s, output: 255.95 toks/s]
Processed prompts:  24%|██▍       | 103/424 [00:54<00:47,  6.82it/s, est. speed input: 4004.58 toks/s, output: 264.93 toks/s]
Processed prompts:  25%|██▍       | 105/424 [00:54<00:50,  6.35it/s, est. speed input: 4047.86 toks/s, output: 268.76 toks/s]
Processed prompts:  25%|██▌       | 108/424 [00:54<00:50,  6.24it/s, est. speed input: 4133.76 toks/s, output: 275.05 toks/s]
Processed prompts:  26%|██▌       | 109/424 [00:55<00:53,  5.88it/s, est. speed input: 4158.54 toks/s, output: 276.76 toks/s]
Processed prompts:  27%|██▋       | 113/424 [00:55<00:41,  7.43it/s, est. speed input: 4292.54 toks/s, output: 286.82 toks/s]
Processed prompts:  27%|██▋       | 116/424 [00:55<00:39,  7.72it/s, est. speed input: 4367.01 toks/s, output: 293.78 toks/s]
Processed prompts:  28%|██▊       | 119/424 [00:56<00:37,  8.10it/s, est. speed input: 4502.61 toks/s, output: 300.83 toks/s]
Processed prompts:  29%|██▉       | 124/424 [00:56<00:38,  7.84it/s, est. speed input: 4630.93 toks/s, output: 311.83 toks/s]
Processed prompts:  31%|███       | 130/424 [00:57<00:34,  8.49it/s, est. speed input: 4734.55 toks/s, output: 325.77 toks/s]
Processed prompts:  32%|███▏      | 134/424 [00:58<00:38,  7.51it/s, est. speed input: 4811.21 toks/s, output: 333.42 toks/s]
Processed prompts:  33%|███▎      | 140/424 [00:59<00:43,  6.56it/s, est. speed input: 4893.77 toks/s, output: 344.34 toks/s]
Processed prompts:  34%|███▎      | 143/424 [00:59<00:44,  6.36it/s, est. speed input: 4985.11 toks/s, output: 349.84 toks/s]
Processed prompts:  34%|███▍      | 146/424 [01:00<00:41,  6.65it/s, est. speed input: 5074.25 toks/s, output: 356.15 toks/s]
Processed prompts:  35%|███▍      | 147/424 [01:00<00:44,  6.29it/s, est. speed input: 5104.22 toks/s, output: 357.63 toks/s]
Processed prompts:  36%|███▌      | 153/424 [01:01<00:38,  7.04it/s, est. speed input: 5253.68 toks/s, output: 370.32 toks/s]
Processed prompts:  37%|███▋      | 157/424 [01:01<00:41,  6.43it/s, est. speed input: 5326.10 toks/s, output: 377.12 toks/s]
Processed prompts:  38%|███▊      | 160/424 [01:02<00:43,  6.06it/s, est. speed input: 5397.12 toks/s, output: 382.02 toks/s]
Processed prompts:  39%|███▉      | 166/424 [01:03<00:44,  5.86it/s, est. speed input: 5528.09 toks/s, output: 392.19 toks/s]
Processed prompts:  41%|████      | 173/424 [01:04<00:31,  7.94it/s, est. speed input: 5689.30 toks/s, output: 408.95 toks/s]
Processed prompts:  41%|████▏     | 175/424 [01:04<00:29,  8.49it/s, est. speed input: 5741.76 toks/s, output: 413.63 toks/s]
Processed prompts:  43%|████▎     | 181/424 [01:04<00:19, 12.24it/s, est. speed input: 5923.49 toks/s, output: 429.54 toks/s]
Processed prompts:  43%|████▎     | 184/424 [01:04<00:17, 13.55it/s, est. speed input: 5986.14 toks/s, output: 437.13 toks/s]
Processed prompts:  45%|████▌     | 191/424 [01:04<00:12, 18.25it/s, est. speed input: 6233.51 toks/s, output: 455.70 toks/s]
Processed prompts:  46%|████▌     | 196/424 [01:04<00:10, 21.65it/s, est. speed input: 6356.51 toks/s, output: 469.20 toks/s]
Processed prompts:  47%|████▋     | 200/424 [01:04<00:09, 23.50it/s, est. speed input: 6481.28 toks/s, output: 479.92 toks/s]
Processed prompts:  48%|████▊     | 204/424 [01:05<00:09, 22.85it/s, est. speed input: 6609.77 toks/s, output: 490.34 toks/s]
Processed prompts:  49%|████▉     | 207/424 [01:05<00:09, 23.09it/s, est. speed input: 6657.69 toks/s, output: 498.35 toks/s]
Processed prompts:  50%|████▉     | 210/424 [01:05<00:09, 23.47it/s, est. speed input: 6758.55 toks/s, output: 506.44 toks/s]
Processed prompts:  50%|█████     | 214/424 [01:05<00:08, 26.00it/s, est. speed input: 6865.88 toks/s, output: 517.62 toks/s]
Processed prompts:  51%|█████     | 217/424 [01:05<00:07, 25.93it/s, est. speed input: 6930.96 toks/s, output: 525.85 toks/s]
Processed prompts:  52%|█████▏    | 221/424 [01:05<00:07, 28.24it/s, est. speed input: 7029.56 toks/s, output: 537.23 toks/s]
Processed prompts:  53%|█████▎    | 224/424 [01:05<00:10, 19.71it/s, est. speed input: 7075.74 toks/s, output: 544.27 toks/s]
Processed prompts:  54%|█████▎    | 227/424 [01:06<00:09, 21.19it/s, est. speed input: 7160.91 toks/s, output: 551.45 toks/s]
Processed prompts:  54%|█████▍    | 230/424 [01:06<00:08, 22.53it/s, est. speed input: 7302.86 toks/s, output: 560.09 toks/s]
Processed prompts:  55%|█████▌    | 234/424 [01:06<00:07, 25.93it/s, est. speed input: 7382.97 toks/s, output: 572.01 toks/s]
Processed prompts:  56%|█████▌    | 237/424 [01:06<00:17, 10.95it/s, est. speed input: 7384.85 toks/s, output: 575.92 toks/s]
Processed prompts:  57%|█████▋    | 240/424 [01:07<00:17, 10.45it/s, est. speed input: 7466.59 toks/s, output: 583.44 toks/s]
Processed prompts:  57%|█████▋    | 243/424 [01:07<00:18,  9.66it/s, est. speed input: 7497.54 toks/s, output: 587.45 toks/s]
Processed prompts:  58%|█████▊    | 245/424 [01:07<00:17, 10.17it/s, est. speed input: 7530.39 toks/s, output: 589.57 toks/s]
Processed prompts:  58%|█████▊    | 247/424 [01:08<00:20,  8.46it/s, est. speed input: 7533.18 toks/s, output: 592.24 toks/s]
Processed prompts:  59%|█████▊    | 249/424 [01:08<00:18,  9.24it/s, est. speed input: 7609.08 toks/s, output: 594.77 toks/s]
Processed prompts:  59%|█████▉    | 251/424 [01:08<00:17,  9.99it/s, est. speed input: 7694.93 toks/s, output: 596.79 toks/s]
Processed prompts:  60%|█████▉    | 253/424 [01:08<00:18,  9.30it/s, est. speed input: 7718.37 toks/s, output: 598.11 toks/s]
Processed prompts:  60%|██████    | 256/424 [01:08<00:13, 12.47it/s, est. speed input: 7822.53 toks/s, output: 603.78 toks/s]
Processed prompts:  61%|██████    | 258/424 [01:08<00:12, 13.80it/s, est. speed input: 7872.52 toks/s, output: 606.23 toks/s]
Processed prompts:  62%|██████▏   | 263/424 [01:09<00:08, 19.29it/s, est. speed input: 7996.46 toks/s, output: 614.12 toks/s]
Processed prompts:  63%|██████▎   | 266/424 [01:09<00:08, 19.58it/s, est. speed input: 8071.61 toks/s, output: 620.82 toks/s]
Processed prompts:  63%|██████▎   | 269/424 [01:09<00:08, 18.16it/s, est. speed input: 8117.49 toks/s, output: 627.11 toks/s]
Processed prompts:  64%|██████▍   | 272/424 [01:09<00:08, 18.87it/s, est. speed input: 8213.98 toks/s, output: 632.48 toks/s]
Processed prompts:  65%|██████▌   | 277/424 [01:09<00:07, 19.76it/s, est. speed input: 8341.64 toks/s, output: 639.86 toks/s]
Processed prompts:  67%|██████▋   | 283/424 [01:09<00:05, 25.45it/s, est. speed input: 8472.58 toks/s, output: 650.75 toks/s]
Processed prompts:  68%|██████▊   | 288/424 [01:10<00:04, 28.28it/s, est. speed input: 8624.01 toks/s, output: 660.04 toks/s]
Processed prompts:  69%|██████▉   | 292/424 [01:10<00:05, 26.33it/s, est. speed input: 8719.25 toks/s, output: 666.34 toks/s]
Processed prompts:  70%|███████   | 297/424 [01:10<00:04, 29.37it/s, est. speed input: 8826.70 toks/s, output: 680.05 toks/s]
Processed prompts:  72%|███████▏  | 305/424 [01:10<00:03, 35.64it/s, est. speed input: 8989.58 toks/s, output: 695.19 toks/s]
Processed prompts:  73%|███████▎  | 309/424 [01:10<00:03, 35.22it/s, est. speed input: 9068.49 toks/s, output: 705.50 toks/s]
Processed prompts:  74%|███████▍  | 315/424 [01:10<00:02, 39.48it/s, est. speed input: 9216.68 toks/s, output: 720.13 toks/s]
Processed prompts:  75%|███████▌  | 320/424 [01:10<00:02, 37.49it/s, est. speed input: 9327.05 toks/s, output: 729.71 toks/s]
Processed prompts:  77%|███████▋  | 325/424 [01:11<00:02, 39.58it/s, est. speed input: 9424.27 toks/s, output: 740.36 toks/s]
Processed prompts:  78%|███████▊  | 330/424 [01:11<00:02, 35.46it/s, est. speed input: 9549.59 toks/s, output: 749.28 toks/s]
Processed prompts:  79%|███████▉  | 335/424 [01:11<00:02, 38.50it/s, est. speed input: 9750.63 toks/s, output: 764.34 toks/s]
Processed prompts:  80%|████████  | 340/424 [01:11<00:02, 41.23it/s, est. speed input: 9845.72 toks/s, output: 775.85 toks/s]
Processed prompts:  82%|████████▏ | 348/424 [01:11<00:01, 47.77it/s, est. speed input: 10104.40 toks/s, output: 792.45 toks/s]
Processed prompts:  84%|████████▎ | 355/424 [01:11<00:01, 50.35it/s, est. speed input: 10410.22 toks/s, output: 806.87 toks/s]
Processed prompts:  85%|████████▌ | 361/424 [01:11<00:01, 50.39it/s, est. speed input: 10636.09 toks/s, output: 822.86 toks/s]
Processed prompts:  87%|████████▋ | 368/424 [01:11<00:01, 50.45it/s, est. speed input: 10804.35 toks/s, output: 838.17 toks/s]
Processed prompts:  88%|████████▊ | 374/424 [01:12<00:00, 52.01it/s, est. speed input: 11001.74 toks/s, output: 854.25 toks/s]
Processed prompts:  90%|█████████ | 383/424 [01:12<00:00, 58.75it/s, est. speed input: 11326.32 toks/s, output: 876.21 toks/s]
Processed prompts:  92%|█████████▏| 391/424 [01:12<00:00, 63.58it/s, est. speed input: 11632.20 toks/s, output: 896.31 toks/s]
Processed prompts:  94%|█████████▍| 398/424 [01:12<00:00, 60.26it/s, est. speed input: 11844.33 toks/s, output: 913.84 toks/s]
Processed prompts:  96%|█████████▌| 405/424 [01:12<00:00, 50.63it/s, est. speed input: 11994.79 toks/s, output: 933.10 toks/s]
Processed prompts:  97%|█████████▋| 411/424 [01:12<00:00, 44.69it/s, est. speed input: 12130.23 toks/s, output: 950.85 toks/s]
Processed prompts:  98%|█████████▊| 416/424 [01:13<00:00, 31.97it/s, est. speed input: 12260.14 toks/s, output: 967.41 toks/s]
Processed prompts:  99%|█████████▉| 420/424 [01:13<00:00, 32.92it/s, est. speed input: 12340.31 toks/s, output: 979.47 toks/s]
Processed prompts: 100%|██████████| 424/424 [01:14<00:00,  8.33it/s, est. speed input: 12169.29 toks/s, output: 977.15 toks/s]
Processed prompts: 100%|██████████| 424/424 [01:14<00:00,  5.66it/s, est. speed input: 12169.29 toks/s, output: 977.15 toks/s]
{  "personalized_answer": "Given your interest in historical storytelling and vivid narration, you might find that 'Making my Day' in the office can be approached with a touch of historical flair. Consider using the 'Historical Present' technique to bring your workday to life. For example, you could write: 'As I sit down at my desk, the morning light filters through the blinds, casting a warm glow on my computer screen. The sound of the printer in the next room is a familiar rhythm, and the smell of fresh coffee wafts from the break room. Suddenly, a colleague bursts in, "Hey, do you have a minute? I need some help with this report." And so, the day begins with a burst of energy and collaboration.' This approach not only makes your descriptions more engaging but also adds a layer of authenticity to your workday narrative."}
Invalid JSON
{  "personalized_answer": "When you are hospitalized on December 31st and released a few days into the following year, the deductible for your hospital stay is generally applied based on the date of service, not the date of discharge. This means that the entire stay, including the days in December and the days in the new year, would be considered one continuous period for deductible purposes. It's important to check with your specific health insurance plan to confirm their policy, as some plans might have different rules. However, based on typical insurance practices, you should be able to use the full deductible for the entire hospital stay, regardless of the跨语言回复
Invalid JSON
None

Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  50%|█████     | 1/2 [00:01<00:01,  1.97s/it, est. speed input: 1083.70 toks/s, output: 64.34 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:02<00:00,  1.18s/it, est. speed input: 2536.35 toks/s, output: 117.42 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:02<00:00,  1.30s/it, est. speed input: 2536.35 toks/s, output: 117.42 toks/s]
[rank0]:[W715 11:09:08.916677070 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/sc_rag_full_profile_test_10_limit_3_output.json
Cleaned temporary files.
