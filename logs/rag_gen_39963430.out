Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 12:05:16.088655_ae_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 12:05:16.088655_ae_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 12:05:16.088655_ae_processed_test.json', '--batch_size', '4']

  0%|          | 0/401 [00:00<?, ?it/s]
  0%|          | 1/401 [00:00<02:02,  3.27it/s]
  0%|          | 2/401 [00:00<01:47,  3.71it/s]
  1%|          | 3/401 [00:02<08:15,  1.25s/it]
  1%|          | 4/401 [00:04<08:45,  1.32s/it]
  1%|          | 5/401 [00:05<09:00,  1.37s/it]
  1%|▏         | 6/401 [00:07<09:13,  1.40s/it]
  2%|▏         | 7/401 [00:08<09:24,  1.43s/it]
  2%|▏         | 8/401 [00:10<09:21,  1.43s/it]
  2%|▏         | 9/401 [00:11<09:22,  1.44s/it]
  2%|▏         | 10/401 [00:12<07:27,  1.14s/it]
  3%|▎         | 11/401 [00:13<08:31,  1.31s/it]
  3%|▎         | 13/401 [00:15<07:03,  1.09s/it]
  3%|▎         | 14/401 [00:18<10:44,  1.67s/it]
  4%|▎         | 15/401 [00:19<08:07,  1.26s/it]
  4%|▍         | 17/401 [00:19<04:58,  1.28it/s]
  4%|▍         | 18/401 [00:21<06:18,  1.01it/s]
  5%|▍         | 19/401 [00:22<07:22,  1.16s/it]
  5%|▍         | 20/401 [00:26<12:23,  1.95s/it]
  5%|▌         | 21/401 [00:27<09:22,  1.48s/it]
  5%|▌         | 22/401 [00:31<14:01,  2.22s/it]
  6%|▌         | 23/401 [00:32<12:59,  2.06s/it]
  6%|▌         | 24/401 [00:37<16:52,  2.69s/it]
  6%|▌         | 25/401 [00:37<12:07,  1.93s/it]
  6%|▋         | 26/401 [00:37<08:54,  1.42s/it]
  7%|▋         | 27/401 [00:41<13:57,  2.24s/it]
  7%|▋         | 28/401 [00:41<10:18,  1.66s/it]
  7%|▋         | 29/401 [00:41<07:24,  1.20s/it]
  7%|▋         | 30/401 [00:43<07:37,  1.23s/it]
  8%|▊         | 31/401 [00:44<07:25,  1.20s/it]
  8%|▊         | 32/401 [00:44<05:31,  1.11it/s]
  8%|▊         | 33/401 [00:45<05:57,  1.03it/s]
  8%|▊         | 34/401 [00:47<07:48,  1.28s/it]
  9%|▊         | 35/401 [00:47<05:38,  1.08it/s]
  9%|▉         | 37/401 [00:48<03:37,  1.68it/s]
 10%|▉         | 39/401 [00:49<03:39,  1.65it/s]
 10%|█         | 41/401 [00:50<03:51,  1.55it/s]
 10%|█         | 42/401 [00:51<03:22,  1.77it/s]
 11%|█         | 43/401 [00:51<02:59,  2.00it/s]
 11%|█         | 44/401 [00:52<03:40,  1.62it/s]
 11%|█▏        | 46/401 [00:52<02:45,  2.15it/s]
 12%|█▏        | 47/401 [00:54<04:50,  1.22it/s]
 12%|█▏        | 48/401 [00:55<04:15,  1.38it/s]
 12%|█▏        | 49/401 [00:55<03:43,  1.58it/s]
 12%|█▏        | 50/401 [00:56<03:56,  1.48it/s]
 13%|█▎        | 51/401 [00:56<03:30,  1.66it/s]
 13%|█▎        | 53/401 [00:57<02:37,  2.20it/s]
 13%|█▎        | 54/401 [00:57<02:15,  2.57it/s]
 14%|█▎        | 55/401 [01:00<05:44,  1.00it/s]
 14%|█▍        | 56/401 [01:01<06:14,  1.08s/it]
 14%|█▍        | 57/401 [01:02<06:01,  1.05s/it]
 14%|█▍        | 58/401 [01:02<04:29,  1.27it/s]
 15%|█▍        | 59/401 [01:05<07:41,  1.35s/it]
 15%|█▍        | 60/401 [01:06<06:32,  1.15s/it]
 15%|█▌        | 61/401 [01:06<05:19,  1.06it/s]
 15%|█▌        | 62/401 [01:07<04:15,  1.33it/s]
 16%|█▌        | 63/401 [01:07<03:48,  1.48it/s]
 16%|█▌        | 64/401 [01:07<03:27,  1.62it/s]
 16%|█▌        | 65/401 [01:08<03:15,  1.72it/s]
 16%|█▋        | 66/401 [01:09<04:25,  1.26it/s]
 17%|█▋        | 67/401 [01:10<03:32,  1.57it/s]
 17%|█▋        | 68/401 [01:10<02:49,  1.96it/s]
 17%|█▋        | 69/401 [01:10<02:08,  2.58it/s]
 17%|█▋        | 70/401 [01:11<03:16,  1.68it/s]
 18%|█▊        | 71/401 [01:11<02:51,  1.92it/s]
 18%|█▊        | 72/401 [01:12<03:37,  1.51it/s]
 18%|█▊        | 73/401 [01:13<03:03,  1.78it/s]
 18%|█▊        | 74/401 [01:14<03:43,  1.47it/s]
 19%|█▊        | 75/401 [01:15<04:12,  1.29it/s]
 19%|█▉        | 76/401 [01:16<04:30,  1.20it/s]
 19%|█▉        | 77/401 [01:17<04:44,  1.14it/s]
 19%|█▉        | 78/401 [01:17<03:33,  1.52it/s]
 20%|█▉        | 79/401 [01:18<04:02,  1.33it/s]
 20%|█▉        | 80/401 [01:19<04:22,  1.22it/s]
 20%|██        | 81/401 [01:19<04:17,  1.24it/s]
 20%|██        | 82/401 [01:20<04:32,  1.17it/s]
 21%|██        | 83/401 [01:21<04:44,  1.12it/s]
 21%|██        | 84/401 [01:22<04:51,  1.09it/s]
 21%|██        | 85/401 [01:23<03:59,  1.32it/s]
 21%|██▏       | 86/401 [01:24<04:18,  1.22it/s]
 22%|██▏       | 87/401 [01:26<07:19,  1.40s/it]
 22%|██▏       | 88/401 [01:27<06:38,  1.27s/it]
 22%|██▏       | 89/401 [01:29<06:41,  1.29s/it]
 22%|██▏       | 90/401 [01:29<04:59,  1.04it/s]
 23%|██▎       | 91/401 [01:29<03:42,  1.39it/s]
 23%|██▎       | 92/401 [01:30<04:05,  1.26it/s]
 23%|██▎       | 93/401 [01:30<03:10,  1.62it/s]
 23%|██▎       | 94/401 [01:32<05:16,  1.03s/it]
 24%|██▎       | 95/401 [01:34<05:40,  1.11s/it]
 24%|██▍       | 96/401 [01:35<05:26,  1.07s/it]
 24%|██▍       | 97/401 [01:35<05:16,  1.04s/it]
 24%|██▍       | 98/401 [01:36<04:17,  1.17it/s]
 25%|██▍       | 99/401 [01:36<03:15,  1.54it/s]
 25%|██▍       | 100/401 [01:36<02:42,  1.85it/s]
 25%|██▌       | 101/401 [01:37<03:03,  1.64it/s]
 25%|██▌       | 102/401 [01:37<02:19,  2.15it/s]
 26%|██▌       | 103/401 [01:38<02:14,  2.21it/s]
 26%|██▌       | 104/401 [01:39<03:00,  1.64it/s]
 26%|██▌       | 105/401 [01:40<03:31,  1.40it/s]
 27%|██▋       | 107/401 [01:40<02:30,  1.95it/s]
 27%|██▋       | 108/401 [01:40<02:03,  2.36it/s]
 27%|██▋       | 109/401 [01:41<02:45,  1.76it/s]
 27%|██▋       | 110/401 [01:41<02:08,  2.27it/s]
 28%|██▊       | 111/401 [01:42<02:49,  1.71it/s]
 28%|██▊       | 112/401 [01:43<03:20,  1.44it/s]
 28%|██▊       | 113/401 [01:44<03:17,  1.46it/s]
 28%|██▊       | 114/401 [01:45<03:10,  1.51it/s]
 29%|██▊       | 115/401 [01:45<02:33,  1.86it/s]
 29%|██▉       | 116/401 [01:46<03:08,  1.51it/s]
 29%|██▉       | 117/401 [01:46<02:53,  1.64it/s]
 29%|██▉       | 118/401 [01:46<02:17,  2.06it/s]
 30%|██▉       | 119/401 [01:48<03:16,  1.43it/s]
 30%|██▉       | 120/401 [01:48<02:33,  1.83it/s]
 30%|███       | 121/401 [01:48<02:04,  2.24it/s]
 30%|███       | 122/401 [01:49<02:18,  2.02it/s]
 31%|███       | 123/401 [01:50<03:25,  1.35it/s]
 31%|███       | 124/401 [01:51<04:12,  1.10it/s]
 31%|███       | 125/401 [01:53<04:44,  1.03s/it]
 31%|███▏      | 126/401 [01:53<03:37,  1.26it/s]
 32%|███▏      | 127/401 [01:54<04:19,  1.06it/s]
 32%|███▏      | 128/401 [01:55<04:48,  1.06s/it]
 32%|███▏      | 129/401 [01:56<04:39,  1.03s/it]
 32%|███▏      | 130/401 [01:58<05:02,  1.11s/it]
 33%|███▎      | 131/401 [01:59<04:33,  1.01s/it]
 33%|███▎      | 132/401 [01:59<03:32,  1.27it/s]
 33%|███▎      | 133/401 [02:02<06:09,  1.38s/it]
 33%|███▎      | 134/401 [02:03<05:36,  1.26s/it]
 34%|███▎      | 135/401 [02:04<05:14,  1.18s/it]
 34%|███▍      | 136/401 [02:04<04:56,  1.12s/it]
 34%|███▍      | 137/401 [02:05<03:38,  1.21it/s]
 34%|███▍      | 138/401 [02:06<03:48,  1.15it/s]
 35%|███▍      | 139/401 [02:06<03:40,  1.19it/s]
 35%|███▍      | 140/401 [02:07<02:51,  1.52it/s]
 35%|███▌      | 141/401 [02:08<04:15,  1.02it/s]
 35%|███▌      | 142/401 [02:10<04:41,  1.09s/it]
 36%|███▌      | 143/401 [02:10<03:49,  1.12it/s]
 36%|███▌      | 144/401 [02:11<03:54,  1.10it/s]
 36%|███▌      | 145/401 [02:11<03:04,  1.39it/s]
 36%|███▋      | 146/401 [02:12<03:24,  1.25it/s]
 37%|███▋      | 147/401 [02:13<03:35,  1.18it/s]
 37%|███▋      | 148/401 [02:14<03:01,  1.39it/s]
 37%|███▋      | 149/401 [02:15<03:18,  1.27it/s]
 37%|███▋      | 150/401 [02:16<03:32,  1.18it/s]
 38%|███▊      | 151/401 [02:17<04:06,  1.01it/s]
 38%|███▊      | 152/401 [02:18<04:04,  1.02it/s]
 38%|███▊      | 153/401 [02:18<03:22,  1.22it/s]
 38%|███▊      | 154/401 [02:19<02:56,  1.40it/s]
 39%|███▊      | 155/401 [02:20<03:39,  1.12it/s]
 39%|███▉      | 156/401 [02:21<04:09,  1.02s/it]
 39%|███▉      | 157/401 [02:23<04:29,  1.10s/it]
 40%|███▉      | 159/401 [02:24<03:19,  1.21it/s]
 40%|███▉      | 160/401 [02:24<02:54,  1.38it/s]
 40%|████      | 162/401 [02:25<02:42,  1.47it/s]
 41%|████      | 163/401 [02:26<02:49,  1.40it/s]
 41%|████      | 164/401 [02:27<02:52,  1.37it/s]
 41%|████      | 165/401 [02:28<03:07,  1.26it/s]
 41%|████▏     | 166/401 [02:29<03:18,  1.18it/s]
 42%|████▏     | 167/401 [02:29<02:32,  1.54it/s]
 42%|████▏     | 168/401 [02:30<02:52,  1.35it/s]
 42%|████▏     | 169/401 [02:31<03:06,  1.24it/s]
 42%|████▏     | 170/401 [02:32<03:17,  1.17it/s]
 43%|████▎     | 171/401 [02:33<03:24,  1.12it/s]
 43%|████▎     | 172/401 [02:33<02:52,  1.33it/s]
 43%|████▎     | 173/401 [02:34<03:07,  1.21it/s]
 43%|████▎     | 174/401 [02:35<03:18,  1.14it/s]
 44%|████▎     | 175/401 [02:36<03:23,  1.11it/s]
 44%|████▍     | 176/401 [02:37<03:27,  1.08it/s]
 44%|████▍     | 177/401 [02:39<03:53,  1.04s/it]
 44%|████▍     | 178/401 [02:40<03:46,  1.02s/it]
 45%|████▍     | 179/401 [02:41<03:42,  1.00s/it]
 45%|████▍     | 180/401 [02:42<03:39,  1.01it/s]
 45%|████▌     | 181/401 [02:43<03:37,  1.01it/s]
 45%|████▌     | 182/401 [02:44<03:36,  1.01it/s]
 46%|████▌     | 183/401 [02:47<06:27,  1.78s/it]
 46%|████▌     | 184/401 [02:51<08:22,  2.31s/it]
 46%|████▌     | 185/401 [02:54<09:46,  2.72s/it]
 46%|████▋     | 186/401 [02:58<10:42,  2.99s/it]
 47%|████▋     | 187/401 [03:02<11:20,  3.18s/it]
 47%|████▋     | 188/401 [03:02<08:08,  2.29s/it]
 47%|████▋     | 189/401 [03:06<09:33,  2.71s/it]
 47%|████▋     | 190/401 [03:09<10:28,  2.98s/it]
 48%|████▊     | 191/401 [03:11<09:12,  2.63s/it]
 48%|████▊     | 192/401 [03:13<08:18,  2.38s/it]
 48%|████▊     | 193/401 [03:13<05:58,  1.73s/it]
 48%|████▊     | 194/401 [03:13<04:26,  1.29s/it]
 49%|████▊     | 195/401 [03:17<06:50,  1.99s/it]
 49%|████▉     | 196/401 [03:19<06:35,  1.93s/it]
 49%|████▉     | 197/401 [03:21<06:38,  1.95s/it]
 49%|████▉     | 198/401 [03:24<08:15,  2.44s/it]
 50%|████▉     | 199/401 [03:26<07:34,  2.25s/it]
 50%|████▉     | 200/401 [03:28<07:06,  2.12s/it]
 50%|█████     | 201/401 [03:30<06:46,  2.03s/it]
 50%|█████     | 202/401 [03:31<06:30,  1.96s/it]
 51%|█████     | 203/401 [03:33<06:20,  1.92s/it]
 51%|█████     | 204/401 [03:35<06:12,  1.89s/it]
 51%|█████     | 205/401 [03:35<04:26,  1.36s/it]
 51%|█████▏    | 206/401 [03:37<04:52,  1.50s/it]
 52%|█████▏    | 207/401 [03:39<05:11,  1.61s/it]
 52%|█████▏    | 208/401 [03:41<05:19,  1.65s/it]
 52%|█████▏    | 209/401 [03:41<04:05,  1.28s/it]
 52%|█████▏    | 210/401 [03:43<04:35,  1.44s/it]
 53%|█████▎    | 211/401 [03:44<03:56,  1.24s/it]
 53%|█████▎    | 212/401 [03:44<03:17,  1.04s/it]
 53%|█████▎    | 213/401 [03:45<03:01,  1.04it/s]
 53%|█████▎    | 214/401 [03:47<03:47,  1.22s/it]
 54%|█████▎    | 215/401 [03:47<03:13,  1.04s/it]
 54%|█████▍    | 216/401 [03:49<03:27,  1.12s/it]
 54%|█████▍    | 218/401 [03:49<02:18,  1.32it/s]
 55%|█████▍    | 219/401 [03:50<02:12,  1.38it/s]
 55%|█████▍    | 220/401 [03:51<02:06,  1.44it/s]
 55%|█████▌    | 221/401 [03:53<03:46,  1.26s/it]
 55%|█████▌    | 222/401 [03:54<03:12,  1.08s/it]
 56%|█████▌    | 223/401 [03:54<02:23,  1.24it/s]
 56%|█████▌    | 224/401 [03:55<01:59,  1.48it/s]
 56%|█████▌    | 225/401 [03:55<01:31,  1.93it/s]
 56%|█████▋    | 226/401 [03:55<01:10,  2.48it/s]
 57%|█████▋    | 227/401 [03:55<01:00,  2.88it/s]
 57%|█████▋    | 228/401 [03:56<01:16,  2.26it/s]
 57%|█████▋    | 229/401 [03:56<01:02,  2.75it/s]
 57%|█████▋    | 230/401 [03:57<02:05,  1.37it/s]
 58%|█████▊    | 231/401 [03:58<01:35,  1.77it/s]
 58%|█████▊    | 232/401 [03:58<01:35,  1.77it/s]
 58%|█████▊    | 234/401 [04:02<03:13,  1.16s/it]
 59%|█████▊    | 235/401 [04:02<02:38,  1.05it/s]
 59%|█████▉    | 236/401 [04:02<02:01,  1.35it/s]
 59%|█████▉    | 237/401 [04:03<01:53,  1.44it/s]
 59%|█████▉    | 238/401 [04:03<01:42,  1.59it/s]
 60%|█████▉    | 239/401 [04:04<01:41,  1.60it/s]
 60%|█████▉    | 240/401 [04:04<01:20,  2.00it/s]
 60%|██████    | 242/401 [04:04<00:52,  3.04it/s]
 61%|██████    | 243/401 [04:05<01:08,  2.30it/s]
 61%|██████    | 244/401 [04:06<01:05,  2.38it/s]
 61%|██████    | 245/401 [04:06<00:53,  2.93it/s]
 61%|██████▏   | 246/401 [04:06<01:04,  2.39it/s]
 62%|██████▏   | 247/401 [04:07<01:13,  2.10it/s]
 62%|██████▏   | 248/401 [04:07<00:56,  2.70it/s]
 62%|██████▏   | 249/401 [04:09<01:43,  1.46it/s]
 63%|██████▎   | 251/401 [04:09<01:07,  2.21it/s]
 63%|██████▎   | 252/401 [04:09<00:55,  2.71it/s]
 63%|██████▎   | 254/401 [04:09<00:43,  3.41it/s]
 64%|██████▎   | 255/401 [04:11<01:28,  1.66it/s]
 64%|██████▍   | 256/401 [04:11<01:17,  1.88it/s]
 64%|██████▍   | 257/401 [04:12<01:09,  2.08it/s]
 64%|██████▍   | 258/401 [04:12<01:03,  2.25it/s]
 65%|██████▍   | 259/401 [04:12<00:58,  2.45it/s]
 65%|██████▌   | 261/401 [04:13<00:53,  2.60it/s]
 65%|██████▌   | 262/401 [04:13<00:51,  2.71it/s]
 66%|██████▌   | 263/401 [04:14<00:49,  2.78it/s]
 66%|██████▌   | 264/401 [04:14<00:43,  3.16it/s]
 66%|██████▌   | 265/401 [04:14<00:43,  3.11it/s]
 66%|██████▋   | 266/401 [04:15<00:43,  3.09it/s]
 67%|██████▋   | 267/401 [04:15<00:36,  3.63it/s]
 67%|██████▋   | 268/401 [04:15<00:33,  4.01it/s]
 67%|██████▋   | 269/401 [04:15<00:45,  2.89it/s]
 67%|██████▋   | 270/401 [04:16<00:55,  2.38it/s]
 68%|██████▊   | 272/401 [04:16<00:35,  3.68it/s]
 68%|██████▊   | 273/401 [04:16<00:30,  4.15it/s]
 68%|██████▊   | 274/401 [04:17<00:26,  4.77it/s]
 69%|██████▊   | 275/401 [04:17<00:23,  5.33it/s]
 69%|██████▉   | 276/401 [04:17<00:22,  5.58it/s]
 69%|██████▉   | 277/401 [04:17<00:34,  3.62it/s]
 69%|██████▉   | 278/401 [04:17<00:29,  4.19it/s]
 70%|██████▉   | 279/401 [04:18<00:24,  4.88it/s]
 70%|██████▉   | 280/401 [04:18<00:31,  3.85it/s]
 70%|███████   | 281/401 [04:18<00:26,  4.53it/s]
 70%|███████   | 282/401 [04:18<00:22,  5.30it/s]
 71%|███████   | 283/401 [04:19<00:35,  3.35it/s]
 71%|███████   | 284/401 [04:19<00:35,  3.30it/s]
 71%|███████   | 285/401 [04:19<00:31,  3.66it/s]
 71%|███████▏  | 286/401 [04:20<00:33,  3.48it/s]
 72%|███████▏  | 287/401 [04:20<00:33,  3.40it/s]
 72%|███████▏  | 288/401 [04:20<00:28,  4.01it/s]
 72%|███████▏  | 289/401 [04:20<00:26,  4.20it/s]
 73%|███████▎  | 291/401 [04:21<00:26,  4.23it/s]
 73%|███████▎  | 292/401 [04:22<00:58,  1.87it/s]
 73%|███████▎  | 293/401 [04:23<01:09,  1.55it/s]
 73%|███████▎  | 294/401 [04:26<02:18,  1.30s/it]
 74%|███████▎  | 295/401 [04:26<01:42,  1.03it/s]
 74%|███████▍  | 296/401 [04:27<01:40,  1.04it/s]
 74%|███████▍  | 297/401 [04:27<01:15,  1.37it/s]
 74%|███████▍  | 298/401 [04:28<01:04,  1.61it/s]
 75%|███████▍  | 299/401 [04:29<01:28,  1.15it/s]
 75%|███████▍  | 300/401 [04:30<01:26,  1.17it/s]
 75%|███████▌  | 301/401 [04:30<01:04,  1.54it/s]
 75%|███████▌  | 302/401 [04:30<00:48,  2.04it/s]
 76%|███████▌  | 303/401 [04:31<00:58,  1.68it/s]
 76%|███████▌  | 304/401 [04:32<00:59,  1.62it/s]
 76%|███████▌  | 305/401 [04:33<01:13,  1.31it/s]
 76%|███████▋  | 306/401 [04:34<01:14,  1.28it/s]
 77%|███████▋  | 307/401 [04:35<01:18,  1.19it/s]
 77%|███████▋  | 308/401 [04:35<01:06,  1.39it/s]
 77%|███████▋  | 309/401 [04:36<01:03,  1.45it/s]
 77%|███████▋  | 310/401 [04:36<00:55,  1.65it/s]
 78%|███████▊  | 311/401 [04:37<01:00,  1.49it/s]
 78%|███████▊  | 312/401 [04:37<00:52,  1.71it/s]
 78%|███████▊  | 313/401 [04:38<00:40,  2.15it/s]
 78%|███████▊  | 314/401 [04:38<00:39,  2.22it/s]
 79%|███████▊  | 315/401 [04:38<00:33,  2.59it/s]
 79%|███████▉  | 316/401 [04:38<00:27,  3.13it/s]
 79%|███████▉  | 317/401 [04:40<00:54,  1.53it/s]
 79%|███████▉  | 318/401 [04:40<00:50,  1.64it/s]
 80%|███████▉  | 319/401 [04:41<00:41,  1.97it/s]
 80%|███████▉  | 320/401 [04:41<00:40,  2.00it/s]
 80%|████████  | 321/401 [04:42<00:39,  2.04it/s]
 80%|████████  | 322/401 [04:42<00:38,  2.05it/s]
 81%|████████  | 323/401 [04:45<01:46,  1.36s/it]
 81%|████████  | 324/401 [04:49<02:30,  1.96s/it]
 81%|████████  | 325/401 [04:52<03:01,  2.39s/it]
 81%|████████▏ | 326/401 [04:53<02:26,  1.96s/it]
 82%|████████▏ | 327/401 [04:54<02:00,  1.63s/it]
 82%|████████▏ | 328/401 [04:55<01:34,  1.29s/it]
 82%|████████▏ | 329/401 [04:56<01:40,  1.40s/it]
 82%|████████▏ | 330/401 [05:00<02:22,  2.00s/it]
 83%|████████▎ | 331/401 [05:01<01:58,  1.69s/it]
 83%|████████▎ | 332/401 [05:04<02:33,  2.22s/it]
 83%|████████▎ | 333/401 [05:07<02:54,  2.57s/it]
 83%|████████▎ | 334/401 [05:08<02:07,  1.90s/it]
 84%|████████▎ | 335/401 [05:11<02:35,  2.35s/it]
 84%|████████▍ | 336/401 [05:15<02:53,  2.67s/it]
 84%|████████▍ | 337/401 [05:16<02:21,  2.21s/it]
 84%|████████▍ | 338/401 [05:16<01:47,  1.71s/it]
 85%|████████▍ | 339/401 [05:17<01:24,  1.36s/it]
 85%|████████▍ | 340/401 [05:17<01:00,  1.00it/s]
 85%|████████▌ | 341/401 [05:17<00:43,  1.37it/s]
 85%|████████▌ | 342/401 [05:17<00:35,  1.65it/s]
 86%|████████▌ | 343/401 [05:18<00:33,  1.73it/s]
 86%|████████▌ | 344/401 [05:18<00:28,  2.00it/s]
 86%|████████▌ | 345/401 [05:20<00:44,  1.27it/s]
 86%|████████▋ | 346/401 [05:20<00:37,  1.49it/s]
 87%|████████▋ | 347/401 [05:20<00:31,  1.73it/s]
 87%|████████▋ | 348/401 [05:21<00:28,  1.89it/s]
 87%|████████▋ | 349/401 [05:21<00:23,  2.24it/s]
 87%|████████▋ | 350/401 [05:24<01:03,  1.24s/it]
 88%|████████▊ | 351/401 [05:28<01:34,  1.89s/it]
 88%|████████▊ | 352/401 [05:28<01:08,  1.39s/it]
 88%|████████▊ | 353/401 [05:31<01:37,  2.03s/it]
 89%|████████▊ | 355/401 [05:32<00:54,  1.19s/it]
 89%|████████▉ | 356/401 [05:35<01:14,  1.66s/it]
 89%|████████▉ | 357/401 [05:36<01:02,  1.41s/it]
 89%|████████▉ | 358/401 [05:37<00:57,  1.34s/it]
 90%|████████▉ | 359/401 [05:38<00:51,  1.23s/it]
 90%|████████▉ | 360/401 [05:39<00:47,  1.15s/it]
 90%|█████████ | 361/401 [05:39<00:38,  1.05it/s]
 90%|█████████ | 362/401 [05:39<00:29,  1.32it/s]
 91%|█████████ | 363/401 [05:40<00:23,  1.62it/s]
 91%|█████████ | 364/401 [05:40<00:18,  2.05it/s]
 91%|█████████ | 365/401 [05:42<00:30,  1.16it/s]
 91%|█████████▏| 366/401 [05:42<00:23,  1.49it/s]
 92%|█████████▏| 367/401 [05:42<00:21,  1.61it/s]
 92%|█████████▏| 368/401 [05:42<00:15,  2.13it/s]
 92%|█████████▏| 369/401 [05:43<00:13,  2.43it/s]
 92%|█████████▏| 370/401 [05:44<00:24,  1.24it/s]
 93%|█████████▎| 371/401 [05:46<00:32,  1.08s/it]
 93%|█████████▎| 372/401 [05:46<00:23,  1.25it/s]
 93%|█████████▎| 373/401 [05:48<00:30,  1.08s/it]
 93%|█████████▎| 374/401 [05:50<00:34,  1.28s/it]
 94%|█████████▎| 375/401 [05:51<00:36,  1.41s/it]
 94%|█████████▍| 376/401 [05:55<00:47,  1.90s/it]
 94%|█████████▍| 377/401 [05:55<00:35,  1.46s/it]
 94%|█████████▍| 378/401 [05:58<00:45,  1.96s/it]
 95%|█████████▍| 379/401 [06:01<00:52,  2.40s/it]
 95%|█████████▍| 380/401 [06:03<00:46,  2.20s/it]
 95%|█████████▌| 382/401 [06:06<00:36,  1.90s/it]
 96%|█████████▌| 383/401 [06:09<00:39,  2.21s/it]
 96%|█████████▌| 384/401 [06:12<00:38,  2.25s/it]
 96%|█████████▌| 385/401 [06:15<00:40,  2.56s/it]
 96%|█████████▋| 386/401 [06:16<00:31,  2.08s/it]
 97%|█████████▋| 387/401 [06:17<00:26,  1.86s/it]
 97%|█████████▋| 388/401 [06:19<00:21,  1.65s/it]
 97%|█████████▋| 389/401 [06:19<00:15,  1.31s/it]
 97%|█████████▋| 390/401 [06:20<00:11,  1.09s/it]
 98%|█████████▊| 391/401 [06:20<00:08,  1.20it/s]
 98%|█████████▊| 392/401 [06:21<00:08,  1.09it/s]
 98%|█████████▊| 393/401 [06:21<00:05,  1.42it/s]
 98%|█████████▊| 394/401 [06:21<00:04,  1.74it/s]
 99%|█████████▊| 395/401 [06:22<00:03,  1.98it/s]
 99%|█████████▉| 396/401 [06:25<00:07,  1.41s/it]
 99%|█████████▉| 397/401 [06:26<00:04,  1.07s/it]
 99%|█████████▉| 398/401 [06:29<00:05,  1.82s/it]
100%|█████████▉| 399/401 [06:33<00:04,  2.30s/it]
100%|█████████▉| 400/401 [06:33<00:01,  1.67s/it]
100%|██████████| 401/401 [06:33<00:00,  1.21s/it]
100%|██████████| 401/401 [06:33<00:00,  1.02it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 12:05:16.088655_ae_processed_test.json', '--output_addr', 'data/out/rag/full_profile/ae_rag_full_profile_test_10_limit_6_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.43 examples/s]
Generating train split: 401 examples [00:00, 1593.12 examples/s]
INFO 07-15 12:12:23 config.py:510] This model supports multiple tasks: {'score', 'embed', 'classify', 'generate', 'reward'}. Defaulting to 'generate'.
INFO 07-15 12:12:23 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 12:12:24 selector.py:120] Using Flash Attention backend.
INFO 07-15 12:12:26 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 12:12:26 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:15<00:45, 15.17s/it]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:29<00:28, 14.50s/it]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:42<00:13, 13.89s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:54<00:00, 13.38s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:54<00:00, 13.74s/it]

INFO 07-15 12:13:21 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 12:13:23 worker.py:241] Memory profiling takes 2.11 seconds
INFO 07-15 12:13:23 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 12:13:23 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 12:13:23 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 12:13:23 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 12:13:26 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:10,  3.13it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.44it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:08,  3.56it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.62it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.66it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.68it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.70it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.69it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.69it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.72it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.71it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.66it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.69it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.72it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.74it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.75it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.80it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.84it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.87it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.88it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.86it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.87it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.89it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.92it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.81it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:06<00:02,  3.86it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.90it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.92it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.95it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:07<00:01,  3.98it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.99it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  4.01it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.93it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:08<00:00,  3.95it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.96it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.81it/s]
INFO 07-15 12:13:35 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-15 12:13:35 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.19 seconds
None

Processed prompts:   0%|          | 0/401 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/401 [00:35<3:58:27, 35.77s/it, est. speed input: 33.61 toks/s, output: 2.60 toks/s]
Processed prompts:   0%|          | 2/401 [00:36<1:39:35, 14.97s/it, est. speed input: 92.74 toks/s, output: 5.25 toks/s]
Processed prompts:   1%|          | 3/401 [00:36<54:49,  8.26s/it, est. speed input: 123.54 toks/s, output: 7.93 toks/s] 
Processed prompts:   1%|          | 4/401 [00:36<34:12,  5.17s/it, est. speed input: 165.73 toks/s, output: 10.63 toks/s]
Processed prompts:   1%|▏         | 6/401 [00:37<16:31,  2.51s/it, est. speed input: 261.11 toks/s, output: 16.10 toks/s]
Processed prompts:   2%|▏         | 7/401 [00:37<12:32,  1.91s/it, est. speed input: 294.79 toks/s, output: 18.76 toks/s]
Processed prompts:   2%|▏         | 8/401 [00:37<09:17,  1.42s/it, est. speed input: 324.01 toks/s, output: 21.49 toks/s]
Processed prompts:   2%|▏         | 9/401 [00:38<07:33,  1.16s/it, est. speed input: 357.52 toks/s, output: 24.06 toks/s]
Processed prompts:   2%|▏         | 10/401 [00:38<05:53,  1.11it/s, est. speed input: 390.50 toks/s, output: 26.77 toks/s]
Processed prompts:   3%|▎         | 11/401 [00:38<04:31,  1.44it/s, est. speed input: 440.46 toks/s, output: 29.53 toks/s]
Processed prompts:   3%|▎         | 12/401 [00:38<03:40,  1.76it/s, est. speed input: 520.83 toks/s, output: 32.23 toks/s]
Processed prompts:   3%|▎         | 14/401 [00:39<02:28,  2.61it/s, est. speed input: 626.38 toks/s, output: 37.74 toks/s]
Processed prompts:   4%|▎         | 15/401 [00:39<02:18,  2.79it/s, est. speed input: 709.72 toks/s, output: 40.38 toks/s]
Processed prompts:   5%|▍         | 19/401 [00:40<01:26,  4.41it/s, est. speed input: 844.30 toks/s, output: 51.37 toks/s]
Processed prompts:   5%|▌         | 21/401 [00:40<01:19,  4.77it/s, est. speed input: 901.50 toks/s, output: 56.80 toks/s]
Processed prompts:   5%|▌         | 22/401 [00:40<01:32,  4.09it/s, est. speed input: 922.93 toks/s, output: 59.24 toks/s]
Processed prompts:   6%|▌         | 24/401 [00:41<01:23,  4.53it/s, est. speed input: 1000.98 toks/s, output: 64.79 toks/s]
Processed prompts:   6%|▋         | 26/401 [00:41<01:10,  5.32it/s, est. speed input: 1080.47 toks/s, output: 70.48 toks/s]
Processed prompts:   7%|▋         | 28/401 [00:41<01:07,  5.55it/s, est. speed input: 1152.33 toks/s, output: 75.99 toks/s]
Processed prompts:   7%|▋         | 30/401 [00:42<01:05,  5.68it/s, est. speed input: 1248.18 toks/s, output: 81.50 toks/s]
Processed prompts:   8%|▊         | 31/401 [00:42<01:06,  5.56it/s, est. speed input: 1341.81 toks/s, output: 84.19 toks/s]
Processed prompts:   9%|▉         | 36/401 [00:43<01:00,  6.08it/s, est. speed input: 1514.85 toks/s, output: 97.83 toks/s]
Processed prompts:  10%|▉         | 40/401 [00:43<00:59,  6.02it/s, est. speed input: 1661.77 toks/s, output: 108.33 toks/s]
Processed prompts:  11%|█         | 43/401 [00:44<01:13,  4.85it/s, est. speed input: 1720.39 toks/s, output: 115.03 toks/s]
Processed prompts:  12%|█▏        | 49/401 [00:45<01:03,  5.57it/s, est. speed input: 2060.23 toks/s, output: 130.34 toks/s]
Processed prompts:  13%|█▎        | 52/401 [00:46<01:07,  5.20it/s, est. speed input: 2145.31 toks/s, output: 137.11 toks/s]
Processed prompts:  14%|█▍        | 58/401 [00:47<00:59,  5.76it/s, est. speed input: 2343.21 toks/s, output: 151.77 toks/s]
Processed prompts:  15%|█▌        | 61/401 [00:47<01:01,  5.57it/s, est. speed input: 2427.57 toks/s, output: 158.44 toks/s]
Processed prompts:  16%|█▌        | 64/401 [00:48<00:59,  5.71it/s, est. speed input: 2489.36 toks/s, output: 165.40 toks/s]
Processed prompts:  17%|█▋        | 67/401 [00:48<00:56,  5.91it/s, est. speed input: 2597.61 toks/s, output: 172.38 toks/s]
Processed prompts:  18%|█▊        | 71/401 [00:49<00:54,  6.06it/s, est. speed input: 2742.05 toks/s, output: 181.50 toks/s]
Processed prompts:  19%|█▉        | 78/401 [00:50<00:56,  5.67it/s, est. speed input: 2920.34 toks/s, output: 196.13 toks/s]
Processed prompts:  20%|██        | 82/401 [00:51<00:54,  5.81it/s, est. speed input: 3133.14 toks/s, output: 204.70 toks/s]
Processed prompts:  21%|██▏       | 86/401 [00:52<00:59,  5.33it/s, est. speed input: 3220.93 toks/s, output: 212.04 toks/s]
Processed prompts:  23%|██▎       | 91/401 [00:52<00:56,  5.50it/s, est. speed input: 3305.03 toks/s, output: 222.14 toks/s]
Processed prompts:  24%|██▍       | 97/401 [00:54<00:58,  5.23it/s, est. speed input: 3436.71 toks/s, output: 233.00 toks/s]
Processed prompts:  25%|██▍       | 100/401 [00:54<00:51,  5.80it/s, est. speed input: 3631.47 toks/s, output: 239.70 toks/s]
Processed prompts:  26%|██▌       | 104/401 [00:55<00:54,  5.46it/s, est. speed input: 3706.39 toks/s, output: 246.63 toks/s]
Processed prompts:  27%|██▋       | 107/401 [00:55<00:54,  5.39it/s, est. speed input: 3753.65 toks/s, output: 251.97 toks/s]
Processed prompts:  27%|██▋       | 109/401 [00:56<00:58,  5.01it/s, est. speed input: 3805.60 toks/s, output: 254.87 toks/s]
Processed prompts:  28%|██▊       | 114/401 [00:57<00:50,  5.66it/s, est. speed input: 3929.54 toks/s, output: 264.77 toks/s]
Processed prompts:  29%|██▉       | 117/401 [00:57<00:52,  5.45it/s, est. speed input: 4000.05 toks/s, output: 269.79 toks/s]
Processed prompts:  30%|███       | 121/401 [00:58<00:50,  5.50it/s, est. speed input: 4070.91 toks/s, output: 276.84 toks/s]
Processed prompts:  31%|███       | 123/401 [00:59<00:54,  5.13it/s, est. speed input: 4107.65 toks/s, output: 279.64 toks/s]
Processed prompts:  32%|███▏      | 128/401 [00:59<00:46,  5.84it/s, est. speed input: 4201.68 toks/s, output: 289.30 toks/s]
Processed prompts:  33%|███▎      | 133/401 [01:00<00:46,  5.78it/s, est. speed input: 4297.30 toks/s, output: 297.82 toks/s]
Processed prompts:  35%|███▍      | 139/401 [01:01<00:40,  6.45it/s, est. speed input: 4498.78 toks/s, output: 309.31 toks/s]
Processed prompts:  35%|███▌      | 141/401 [01:01<00:43,  5.99it/s, est. speed input: 4555.20 toks/s, output: 312.06 toks/s]
Processed prompts:  36%|███▌      | 143/401 [01:02<00:44,  5.84it/s, est. speed input: 4570.04 toks/s, output: 315.23 toks/s]
Processed prompts:  37%|███▋      | 148/401 [01:02<00:30,  8.17it/s, est. speed input: 4719.79 toks/s, output: 326.80 toks/s]
Processed prompts:  38%|███▊      | 154/401 [01:02<00:20, 12.03it/s, est. speed input: 4884.99 toks/s, output: 341.39 toks/s]
Processed prompts:  39%|███▉      | 157/401 [01:02<00:18, 13.43it/s, est. speed input: 4980.51 toks/s, output: 348.40 toks/s]
Processed prompts:  41%|████      | 163/401 [01:02<00:12, 18.51it/s, est. speed input: 5202.86 toks/s, output: 363.30 toks/s]
Processed prompts:  42%|████▏     | 168/401 [01:02<00:10, 22.16it/s, est. speed input: 5349.05 toks/s, output: 375.69 toks/s]
Processed prompts:  44%|████▍     | 178/401 [01:03<00:06, 33.64it/s, est. speed input: 5675.70 toks/s, output: 401.52 toks/s]
Processed prompts:  46%|████▌     | 185/401 [01:03<00:05, 38.60it/s, est. speed input: 5866.49 toks/s, output: 419.54 toks/s]
Processed prompts:  47%|████▋     | 190/401 [01:03<00:05, 39.44it/s, est. speed input: 6033.40 toks/s, output: 432.35 toks/s]
Processed prompts:  49%|████▊     | 195/401 [01:03<00:05, 40.25it/s, est. speed input: 6208.86 toks/s, output: 445.28 toks/s]
Processed prompts:  50%|████▉     | 200/401 [01:03<00:06, 29.64it/s, est. speed input: 6336.04 toks/s, output: 457.27 toks/s]
Processed prompts:  51%|█████     | 204/401 [01:03<00:07, 27.91it/s, est. speed input: 6518.26 toks/s, output: 467.45 toks/s]
Processed prompts:  52%|█████▏    | 209/401 [01:04<00:06, 31.45it/s, est. speed input: 6647.28 toks/s, output: 480.99 toks/s]
Processed prompts:  53%|█████▎    | 213/401 [01:04<00:05, 32.57it/s, est. speed input: 6743.39 toks/s, output: 491.79 toks/s]
Processed prompts:  55%|█████▍    | 219/401 [01:04<00:04, 38.10it/s, est. speed input: 6920.02 toks/s, output: 508.54 toks/s]
Processed prompts:  56%|█████▌    | 224/401 [01:04<00:06, 26.87it/s, est. speed input: 7028.12 toks/s, output: 520.96 toks/s]
Processed prompts:  57%|█████▋    | 228/401 [01:04<00:05, 29.06it/s, est. speed input: 7115.29 toks/s, output: 532.28 toks/s]
Processed prompts:  58%|█████▊    | 232/401 [01:04<00:07, 23.66it/s, est. speed input: 7228.51 toks/s, output: 542.56 toks/s]
Processed prompts:  59%|█████▊    | 235/401 [01:05<00:08, 19.39it/s, est. speed input: 7344.65 toks/s, output: 549.91 toks/s]
Processed prompts:  59%|█████▉    | 238/401 [01:05<00:08, 19.53it/s, est. speed input: 7415.82 toks/s, output: 558.26 toks/s]
Processed prompts:  60%|██████    | 241/401 [01:05<00:09, 16.89it/s, est. speed input: 7536.99 toks/s, output: 565.92 toks/s]
Processed prompts:  61%|██████    | 243/401 [01:05<00:09, 16.12it/s, est. speed input: 7588.28 toks/s, output: 571.24 toks/s]
Processed prompts:  61%|██████    | 245/401 [01:05<00:12, 12.45it/s, est. speed input: 7648.72 toks/s, output: 573.50 toks/s]
Processed prompts:  62%|██████▏   | 247/401 [01:06<00:17,  8.85it/s, est. speed input: 7685.49 toks/s, output: 576.73 toks/s]
Processed prompts:  62%|██████▏   | 249/401 [01:06<00:18,  8.28it/s, est. speed input: 7750.97 toks/s, output: 579.76 toks/s]
Processed prompts:  63%|██████▎   | 251/401 [01:07<00:27,  5.44it/s, est. speed input: 7719.34 toks/s, output: 576.86 toks/s]
Processed prompts:  63%|██████▎   | 252/401 [01:07<00:26,  5.64it/s, est. speed input: 7731.54 toks/s, output: 577.48 toks/s]
Processed prompts:  63%|██████▎   | 254/401 [01:07<00:23,  6.29it/s, est. speed input: 7790.03 toks/s, output: 578.91 toks/s]
Processed prompts:  64%|██████▎   | 255/401 [01:07<00:22,  6.42it/s, est. speed input: 7811.82 toks/s, output: 581.61 toks/s]
Processed prompts:  64%|██████▍   | 258/401 [01:08<00:15,  9.28it/s, est. speed input: 7912.43 toks/s, output: 586.73 toks/s]
Processed prompts:  65%|██████▍   | 260/401 [01:08<00:15,  9.07it/s, est. speed input: 7930.58 toks/s, output: 588.99 toks/s]
Processed prompts:  66%|██████▌   | 265/401 [01:08<00:09, 14.75it/s, est. speed input: 8100.82 toks/s, output: 599.76 toks/s]
Processed prompts:  67%|██████▋   | 269/401 [01:08<00:07, 16.82it/s, est. speed input: 8208.98 toks/s, output: 605.84 toks/s]
Processed prompts:  68%|██████▊   | 272/401 [01:08<00:07, 16.82it/s, est. speed input: 8272.00 toks/s, output: 613.03 toks/s]
Processed prompts:  69%|██████▉   | 277/401 [01:08<00:05, 21.99it/s, est. speed input: 8380.59 toks/s, output: 623.33 toks/s]
Processed prompts:  70%|███████   | 281/401 [01:09<00:05, 22.80it/s, est. speed input: 8465.68 toks/s, output: 630.88 toks/s]
Processed prompts:  72%|███████▏  | 287/401 [01:09<00:04, 25.41it/s, est. speed input: 8709.51 toks/s, output: 642.84 toks/s]
Processed prompts:  73%|███████▎  | 291/401 [01:09<00:04, 27.41it/s, est. speed input: 8883.19 toks/s, output: 650.60 toks/s]
Processed prompts:  74%|███████▍  | 297/401 [01:09<00:03, 33.52it/s, est. speed input: 9085.95 toks/s, output: 664.57 toks/s]
Processed prompts:  76%|███████▌  | 304/401 [01:09<00:02, 41.18it/s, est. speed input: 9353.98 toks/s, output: 680.26 toks/s]
Processed prompts:  78%|███████▊  | 311/401 [01:09<00:01, 47.70it/s, est. speed input: 9558.87 toks/s, output: 697.44 toks/s]
Processed prompts:  79%|███████▉  | 317/401 [01:09<00:01, 50.76it/s, est. speed input: 9768.49 toks/s, output: 711.13 toks/s]
Processed prompts:  81%|████████  | 325/401 [01:09<00:01, 54.34it/s, est. speed input: 10091.72 toks/s, output: 731.06 toks/s]
Processed prompts:  84%|████████▍ | 337/401 [01:10<00:00, 67.90it/s, est. speed input: 10498.85 toks/s, output: 760.23 toks/s]
Processed prompts:  86%|████████▌ | 344/401 [01:10<00:00, 66.46it/s, est. speed input: 10728.89 toks/s, output: 779.48 toks/s]
Processed prompts:  88%|████████▊ | 351/401 [01:10<00:00, 55.60it/s, est. speed input: 10971.74 toks/s, output: 795.69 toks/s]
Processed prompts:  90%|█████████ | 361/401 [01:10<00:00, 66.14it/s, est. speed input: 11379.66 toks/s, output: 821.89 toks/s]
Processed prompts:  92%|█████████▏| 369/401 [01:10<00:00, 48.15it/s, est. speed input: 11633.81 toks/s, output: 840.56 toks/s]
Processed prompts:  94%|█████████▎| 375/401 [01:10<00:00, 47.14it/s, est. speed input: 11824.09 toks/s, output: 856.61 toks/s]
Processed prompts:  95%|█████████▌| 381/401 [01:11<00:00, 27.89it/s, est. speed input: 12040.31 toks/s, output: 872.20 toks/s]
Processed prompts:  96%|█████████▋| 386/401 [01:12<00:01, 11.30it/s, est. speed input: 11993.29 toks/s, output: 878.79 toks/s]
Processed prompts:  97%|█████████▋| 390/401 [01:13<00:01,  8.19it/s, est. speed input: 11997.44 toks/s, output: 886.55 toks/s]
Processed prompts:  98%|█████████▊| 393/401 [01:14<00:01,  7.81it/s, est. speed input: 12099.87 toks/s, output: 898.99 toks/s]
Processed prompts:  99%|█████████▉| 396/401 [01:14<00:00,  9.08it/s, est. speed input: 12235.33 toks/s, output: 914.24 toks/s]
Processed prompts:  99%|█████████▉| 398/401 [01:14<00:00,  7.15it/s, est. speed input: 12248.96 toks/s, output: 920.85 toks/s]
Processed prompts: 100%|█████████▉| 400/401 [01:15<00:00,  6.58it/s, est. speed input: 12272.18 toks/s, output: 928.54 toks/s]
Processed prompts: 100%|██████████| 401/401 [01:18<00:00,  5.14it/s, est. speed input: 11872.32 toks/s, output: 904.98 toks/s]
{  "personalized_answer": "The formatting styles you're seeing in Hebrew/Aramaic texts from Sefaria are part of the traditional text formatting used in Jewish texts. These styles serve various purposes, such as indicating different levels of emphasis, quotations, and historical references. Here's a breakdown of what you're seeing:\n\n1. **Bold and Italic Text**: These are often used to highlight names, titles, or important phrases. For example, <big><strong>ר' אהרן</strong></big> is a name, and <b>י</b> is a part of a name or title.\n\n2. **Parentheses and Brackets**: These are used to include additional information, such as references to other texts or historical notes. For example, <small>(תהלים ק\"ד, כ\"ד)</small> and [כָּל חָכְמָה מֵיהֹוָה, וִעמּוֹ הִיא לְעוֹלָמִים.] are references to other texts.\n\n3. **Small Parentheses**: These are used to include additional information or notes, such as <small>(משלי ג', י\"ט)</small> and <small>(שם קי\"א, י')</small>.\n\n4. **Quotes**: These are used to indicate direct speech or quotations from other texts. For example, ' and " are used to denote quotes.\n\n5. **Hyphens**: These are used to separate words or to indicate a break in a sentence. For example, - are used to separate words in some texts.\n\n6. **Font Styles**: The styles you're seeing are part of the traditional formatting used in Jewish texts. The font styles are not part of the original text but are added for clarity and emphasis. They do not represent any specific script from ancient times but are modern additions to enhance readability.\n\n7. **Aramaic Script**: The texts you're seeing are in Hebrew, not Aramaic. The Samaritan script and Paleo-Hebrew are older scripts, but the texts on Sefaria are in the modern Hebrew script. The earliest Hebrew texts were written in a script similar to the Phoenician alphabet, which evolved into the modern Hebrew script.\n\nTo remove these modern additions and get a cleaner version of the text, you can use text processing tools or scripts to strip out these formatting elements. This will give you a more traditional, uncluttered version of the text."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.67s/it, est. speed input: 948.95 toks/s, output: 78.96 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.67s/it, est. speed input: 948.95 toks/s, output: 78.96 toks/s]
{  "personalized_answer": "The formatting styles you see in Hebrew/Aramaic texts from Sefaria are designed to enhance readability and provide important linguistic and cultural context. Here's what each element means:\n\n1. **Bold and Italic Text**: These are often used to highlight specific names, titles, or important phrases. For example, in the text you provided, <big><strong>ר' אהרן</strong></big> is a name that is being emphasized.\n\n2. **Parentheses and Brackets**: These are used to include additional information, such as references to other texts or explanations. For example, <small>(תהלים ק\"ד, כ\"ד)</small> is a reference to a specific verse in the Psalms.\n\n3. **Small Parentheses**: These are used to include brief notes or references. For instance, <small>(משלי ג', י\"ט)</small> is a reference to a specific verse in Proverbs.\n\n4. **Hyphens**: These are used to connect words that are part of a compound term. For example, in the phrase 'י-שמחו', the hyphen indicates that these are two parts of a single term.\n\n5. **Quotes**: These are used to denote direct speech or quotations from other texts. For example, 'וכן כתב הרמב"ם בפרק ט' מהלכות תשובה הלכה ב'\" is a quote from Maimonides.\n\n6. **Font Styles**: The use of different font styles (bold, italics, etc.) is to draw attention to specific elements and to maintain consistency with traditional text formatting. The font styles are not part of the original text but are used to enhance readability and clarity.\n\nTo remove or change these elements, you can use text processing tools or scripts to strip out these formatting styles. However, it's important to note that removing these elements might alter the intended meaning and structure of the text. If you want to clean up the text for personal use, you can use tools like regular expressions to remove these elements while preserving the core text."}
Invalid JSON
None

Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.33s/it, est. speed input: 1618.70 toks/s, output: 75.46 toks/s]
Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.33s/it, est. speed input: 1618.70 toks/s, output: 75.46 toks/s]
[rank0]:[W715 12:15:06.279878024 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/ae_rag_full_profile_test_10_limit_6_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 12:15:09.285165_lp_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 12:15:09.285165_lp_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 12:15:09.285165_lp_processed_test.json', '--batch_size', '4']

  0%|          | 0/526 [00:00<?, ?it/s]
  0%|          | 1/526 [00:00<02:32,  3.44it/s]
  1%|          | 3/526 [00:00<01:20,  6.47it/s]
  1%|          | 5/526 [00:00<00:55,  9.30it/s]
  1%|▏         | 7/526 [00:00<00:44, 11.67it/s]
  2%|▏         | 9/526 [00:01<01:44,  4.92it/s]
  2%|▏         | 11/526 [00:01<01:19,  6.47it/s]
  2%|▏         | 13/526 [00:02<01:32,  5.53it/s]
  3%|▎         | 15/526 [00:02<01:17,  6.59it/s]
  3%|▎         | 16/526 [00:02<01:19,  6.38it/s]
  3%|▎         | 18/526 [00:02<01:03,  7.99it/s]
  4%|▍         | 20/526 [00:03<01:18,  6.45it/s]
  4%|▍         | 21/526 [00:04<02:53,  2.91it/s]
  4%|▍         | 22/526 [00:04<03:00,  2.80it/s]
  4%|▍         | 23/526 [00:05<03:43,  2.25it/s]
  5%|▍         | 24/526 [00:06<04:19,  1.93it/s]
  5%|▍         | 25/526 [00:07<05:29,  1.52it/s]
  5%|▍         | 26/526 [00:07<04:40,  1.78it/s]
  5%|▌         | 27/526 [00:07<03:42,  2.24it/s]
  5%|▌         | 28/526 [00:07<03:36,  2.30it/s]
  6%|▌         | 30/526 [00:09<04:48,  1.72it/s]
  6%|▌         | 31/526 [00:10<04:41,  1.76it/s]
  6%|▌         | 32/526 [00:10<03:59,  2.06it/s]
  6%|▋         | 33/526 [00:11<05:47,  1.42it/s]
  6%|▋         | 34/526 [00:12<06:01,  1.36it/s]
  7%|▋         | 35/526 [00:13<06:37,  1.23it/s]
  7%|▋         | 36/526 [00:13<05:08,  1.59it/s]
  7%|▋         | 37/526 [00:13<04:27,  1.83it/s]
  7%|▋         | 39/526 [00:14<02:36,  3.11it/s]
  8%|▊         | 40/526 [00:14<02:20,  3.47it/s]
  8%|▊         | 42/526 [00:14<01:47,  4.51it/s]
  8%|▊         | 43/526 [00:15<02:25,  3.31it/s]
  9%|▊         | 45/526 [00:15<01:43,  4.63it/s]
  9%|▊         | 46/526 [00:15<01:51,  4.32it/s]
  9%|▉         | 47/526 [00:15<02:07,  3.75it/s]
  9%|▉         | 48/526 [00:16<02:42,  2.93it/s]
 10%|▉         | 50/526 [00:16<02:06,  3.75it/s]
 10%|▉         | 52/526 [00:16<01:37,  4.87it/s]
 10%|█         | 53/526 [00:18<03:29,  2.26it/s]
 10%|█         | 54/526 [00:21<08:55,  1.13s/it]
 11%|█         | 56/526 [00:21<05:32,  1.42it/s]
 11%|█         | 58/526 [00:22<04:30,  1.73it/s]
 11%|█         | 59/526 [00:23<04:47,  1.62it/s]
 11%|█▏        | 60/526 [00:24<05:09,  1.51it/s]
 12%|█▏        | 61/526 [00:24<05:05,  1.52it/s]
 12%|█▏        | 62/526 [00:25<06:07,  1.26it/s]
 12%|█▏        | 63/526 [00:27<07:31,  1.03it/s]
 12%|█▏        | 64/526 [00:27<06:05,  1.26it/s]
 12%|█▏        | 65/526 [00:27<04:38,  1.66it/s]
 13%|█▎        | 66/526 [00:28<03:55,  1.95it/s]
 13%|█▎        | 67/526 [00:28<03:44,  2.05it/s]
 13%|█▎        | 68/526 [00:29<04:46,  1.60it/s]
 13%|█▎        | 69/526 [00:29<03:39,  2.09it/s]
 13%|█▎        | 70/526 [00:31<05:51,  1.30it/s]
 13%|█▎        | 71/526 [00:31<06:02,  1.25it/s]
 14%|█▎        | 72/526 [00:32<05:35,  1.35it/s]
 14%|█▍        | 73/526 [00:33<06:23,  1.18it/s]
 14%|█▍        | 74/526 [00:35<07:44,  1.03s/it]
 14%|█▍        | 75/526 [00:35<05:46,  1.30it/s]
 14%|█▍        | 76/526 [00:35<04:18,  1.74it/s]
 15%|█▍        | 77/526 [00:36<05:24,  1.38it/s]
 15%|█▍        | 78/526 [00:37<07:00,  1.06it/s]
 15%|█▌        | 79/526 [00:38<05:09,  1.44it/s]
 15%|█▌        | 80/526 [00:38<04:12,  1.76it/s]
 16%|█▌        | 82/526 [00:39<04:26,  1.67it/s]
 16%|█▌        | 84/526 [00:40<04:14,  1.74it/s]
 16%|█▌        | 85/526 [00:42<06:09,  1.19it/s]
 16%|█▋        | 86/526 [00:42<05:14,  1.40it/s]
 17%|█▋        | 87/526 [00:43<05:45,  1.27it/s]
 17%|█▋        | 88/526 [00:44<04:49,  1.51it/s]
 17%|█▋        | 89/526 [00:44<04:08,  1.76it/s]
 17%|█▋        | 90/526 [00:44<03:41,  1.97it/s]
 17%|█▋        | 91/526 [00:45<03:29,  2.08it/s]
 17%|█▋        | 92/526 [00:45<02:44,  2.63it/s]
 18%|█▊        | 93/526 [00:45<02:08,  3.36it/s]
 18%|█▊        | 95/526 [00:45<01:27,  4.93it/s]
 18%|█▊        | 96/526 [00:46<01:57,  3.67it/s]
 18%|█▊        | 97/526 [00:46<02:42,  2.64it/s]
 19%|█▊        | 98/526 [00:49<07:55,  1.11s/it]
 19%|█▉        | 99/526 [00:53<12:08,  1.71s/it]
 19%|█▉        | 101/526 [00:53<07:27,  1.05s/it]
 19%|█▉        | 102/526 [00:53<06:23,  1.11it/s]
 20%|█▉        | 103/526 [00:54<05:54,  1.19it/s]
 20%|█▉        | 104/526 [00:55<06:49,  1.03it/s]
 20%|██        | 106/526 [00:56<04:41,  1.49it/s]
 21%|██        | 108/526 [00:56<03:29,  2.00it/s]
 21%|██        | 109/526 [00:57<03:13,  2.16it/s]
 21%|██        | 110/526 [00:58<04:09,  1.67it/s]
 21%|██        | 111/526 [00:58<03:50,  1.80it/s]
 21%|██▏       | 112/526 [00:59<03:38,  1.90it/s]
 21%|██▏       | 113/526 [00:59<02:49,  2.43it/s]
 22%|██▏       | 114/526 [00:59<02:19,  2.95it/s]
 22%|██▏       | 115/526 [00:59<01:55,  3.56it/s]
 22%|██▏       | 116/526 [00:59<01:33,  4.37it/s]
 22%|██▏       | 117/526 [01:00<03:34,  1.91it/s]
 22%|██▏       | 118/526 [01:02<05:03,  1.34it/s]
 23%|██▎       | 119/526 [01:02<04:12,  1.61it/s]
 23%|██▎       | 120/526 [01:03<04:59,  1.36it/s]
 23%|██▎       | 121/526 [01:03<03:56,  1.71it/s]
 23%|██▎       | 122/526 [01:05<05:19,  1.26it/s]
 23%|██▎       | 123/526 [01:06<05:56,  1.13it/s]
 24%|██▎       | 124/526 [01:07<06:46,  1.01s/it]
 24%|██▍       | 125/526 [01:07<05:00,  1.33it/s]
 24%|██▍       | 127/526 [01:07<03:08,  2.12it/s]
 24%|██▍       | 128/526 [01:08<02:38,  2.52it/s]
 25%|██▍       | 129/526 [01:08<02:36,  2.53it/s]
 25%|██▍       | 130/526 [01:08<02:35,  2.54it/s]
 25%|██▍       | 131/526 [01:09<02:17,  2.88it/s]
 25%|██▌       | 132/526 [01:09<01:54,  3.45it/s]
 25%|██▌       | 133/526 [01:09<01:39,  3.95it/s]
 26%|██▌       | 135/526 [01:09<01:29,  4.36it/s]
 26%|██▌       | 136/526 [01:10<01:38,  3.95it/s]
 26%|██▌       | 138/526 [01:10<01:20,  4.83it/s]
 26%|██▋       | 139/526 [01:10<01:30,  4.26it/s]
 27%|██▋       | 140/526 [01:10<01:23,  4.63it/s]
 27%|██▋       | 141/526 [01:11<01:21,  4.70it/s]
 27%|██▋       | 142/526 [01:11<01:15,  5.06it/s]
 27%|██▋       | 143/526 [01:11<01:57,  3.25it/s]
 27%|██▋       | 144/526 [01:11<01:40,  3.82it/s]
 28%|██▊       | 145/526 [01:13<03:28,  1.83it/s]
 28%|██▊       | 146/526 [01:13<03:02,  2.08it/s]
 28%|██▊       | 147/526 [01:13<02:51,  2.21it/s]
 28%|██▊       | 149/526 [01:14<02:09,  2.91it/s]
 29%|██▊       | 150/526 [01:14<01:49,  3.43it/s]
 29%|██▊       | 151/526 [01:14<01:35,  3.92it/s]
 29%|██▉       | 152/526 [01:14<01:25,  4.35it/s]
 29%|██▉       | 154/526 [01:15<02:17,  2.71it/s]
 29%|██▉       | 155/526 [01:16<03:05,  2.00it/s]
 30%|██▉       | 156/526 [01:17<03:52,  1.59it/s]
 30%|██▉       | 157/526 [01:18<03:29,  1.76it/s]
 30%|███       | 159/526 [01:18<02:07,  2.87it/s]
 30%|███       | 160/526 [01:19<03:38,  1.67it/s]
 31%|███       | 161/526 [01:20<03:09,  1.93it/s]
 31%|███       | 162/526 [01:22<05:31,  1.10it/s]
 31%|███       | 164/526 [01:22<03:38,  1.66it/s]
 32%|███▏      | 166/526 [01:22<02:29,  2.41it/s]
 32%|███▏      | 167/526 [01:22<02:21,  2.53it/s]
 32%|███▏      | 168/526 [01:24<03:31,  1.69it/s]
 32%|███▏      | 169/526 [01:24<03:06,  1.92it/s]
 33%|███▎      | 171/526 [01:26<04:19,  1.37it/s]
 33%|███▎      | 172/526 [01:26<03:33,  1.66it/s]
 33%|███▎      | 173/526 [01:27<03:07,  1.89it/s]
 33%|███▎      | 174/526 [01:27<02:52,  2.04it/s]
 33%|███▎      | 175/526 [01:27<02:18,  2.53it/s]
 33%|███▎      | 176/526 [01:28<03:09,  1.85it/s]
 34%|███▎      | 177/526 [01:28<02:28,  2.36it/s]
 34%|███▍      | 178/526 [01:28<01:58,  2.94it/s]
 34%|███▍      | 179/526 [01:28<01:38,  3.52it/s]
 34%|███▍      | 180/526 [01:30<03:17,  1.75it/s]
 34%|███▍      | 181/526 [01:30<02:33,  2.24it/s]
 35%|███▍      | 182/526 [01:31<04:16,  1.34it/s]
 35%|███▍      | 183/526 [01:31<03:12,  1.78it/s]
 35%|███▍      | 184/526 [01:32<03:11,  1.78it/s]
 35%|███▌      | 186/526 [01:34<04:07,  1.37it/s]
 36%|███▌      | 187/526 [01:34<03:40,  1.54it/s]
 36%|███▌      | 188/526 [01:35<03:24,  1.66it/s]
 36%|███▌      | 190/526 [01:35<02:10,  2.58it/s]
 36%|███▋      | 191/526 [01:35<01:53,  2.96it/s]
 37%|███▋      | 192/526 [01:35<01:37,  3.42it/s]
 37%|███▋      | 193/526 [01:35<01:21,  4.11it/s]
 37%|███▋      | 194/526 [01:35<01:09,  4.75it/s]
 37%|███▋      | 195/526 [01:37<02:47,  1.97it/s]
 37%|███▋      | 196/526 [01:38<03:53,  1.41it/s]
 37%|███▋      | 197/526 [01:38<03:09,  1.73it/s]
 38%|███▊      | 198/526 [01:39<02:51,  1.91it/s]
 38%|███▊      | 199/526 [01:41<05:10,  1.05it/s]
 38%|███▊      | 200/526 [01:41<04:01,  1.35it/s]
 38%|███▊      | 201/526 [01:42<04:10,  1.30it/s]
 38%|███▊      | 202/526 [01:42<03:18,  1.64it/s]
 39%|███▊      | 203/526 [01:43<03:36,  1.49it/s]
 39%|███▉      | 205/526 [01:43<02:06,  2.54it/s]
 39%|███▉      | 206/526 [01:43<01:46,  3.00it/s]
 39%|███▉      | 207/526 [01:43<01:36,  3.30it/s]
 40%|███▉      | 210/526 [01:43<00:53,  5.95it/s]
 40%|████      | 212/526 [01:45<01:39,  3.15it/s]
 41%|████      | 214/526 [01:45<01:19,  3.92it/s]
 41%|████      | 215/526 [01:45<01:42,  3.04it/s]
 41%|████      | 216/526 [01:46<01:42,  3.02it/s]
 41%|████▏     | 217/526 [01:47<02:29,  2.07it/s]
 41%|████▏     | 218/526 [01:48<03:08,  1.64it/s]
 42%|████▏     | 219/526 [01:49<03:20,  1.53it/s]
 42%|████▏     | 220/526 [01:49<02:34,  1.98it/s]
 42%|████▏     | 222/526 [01:49<01:36,  3.16it/s]
 42%|████▏     | 223/526 [01:50<02:26,  2.07it/s]
 43%|████▎     | 224/526 [01:50<02:02,  2.48it/s]
 43%|████▎     | 225/526 [01:50<01:59,  2.51it/s]
 43%|████▎     | 227/526 [01:51<01:38,  3.03it/s]
 43%|████▎     | 228/526 [01:51<01:24,  3.54it/s]
 44%|████▎     | 229/526 [01:51<01:33,  3.19it/s]
 44%|████▎     | 230/526 [01:52<01:23,  3.54it/s]
 44%|████▍     | 231/526 [01:53<02:20,  2.10it/s]
 44%|████▍     | 232/526 [01:53<01:49,  2.68it/s]
 44%|████▍     | 233/526 [01:53<01:32,  3.15it/s]
 44%|████▍     | 234/526 [01:54<02:52,  1.70it/s]
 45%|████▍     | 235/526 [01:55<02:42,  1.79it/s]
 45%|████▍     | 236/526 [01:55<02:07,  2.28it/s]
 45%|████▌     | 237/526 [01:55<01:59,  2.41it/s]
 45%|████▌     | 238/526 [01:55<01:40,  2.86it/s]
 46%|████▌     | 240/526 [01:55<01:04,  4.46it/s]
 46%|████▌     | 241/526 [01:56<02:00,  2.37it/s]
 46%|████▌     | 243/526 [01:57<01:41,  2.78it/s]
 46%|████▋     | 244/526 [01:57<01:44,  2.69it/s]
 47%|████▋     | 245/526 [01:58<02:27,  1.91it/s]
 47%|████▋     | 246/526 [01:59<02:10,  2.15it/s]
 47%|████▋     | 247/526 [01:59<01:47,  2.59it/s]
 47%|████▋     | 248/526 [02:00<02:06,  2.19it/s]
 47%|████▋     | 249/526 [02:00<02:47,  1.65it/s]
 48%|████▊     | 250/526 [02:01<02:10,  2.11it/s]
 48%|████▊     | 251/526 [02:02<02:46,  1.65it/s]
 48%|████▊     | 252/526 [02:02<02:23,  1.91it/s]
 48%|████▊     | 253/526 [02:02<01:55,  2.37it/s]
 48%|████▊     | 255/526 [02:03<02:06,  2.13it/s]
 49%|████▊     | 256/526 [02:03<01:51,  2.41it/s]
 49%|████▉     | 257/526 [02:05<02:50,  1.57it/s]
 49%|████▉     | 258/526 [02:06<03:13,  1.39it/s]
 49%|████▉     | 259/526 [02:06<02:28,  1.80it/s]
 49%|████▉     | 260/526 [02:06<01:56,  2.28it/s]
 50%|████▉     | 261/526 [02:06<02:01,  2.18it/s]
 50%|████▉     | 262/526 [02:06<01:34,  2.80it/s]
 50%|█████     | 263/526 [02:07<02:20,  1.87it/s]
 50%|█████     | 264/526 [02:08<02:42,  1.61it/s]
 50%|█████     | 265/526 [02:08<02:04,  2.09it/s]
 51%|█████     | 266/526 [02:09<02:15,  1.92it/s]
 51%|█████     | 267/526 [02:10<02:22,  1.81it/s]
 51%|█████     | 268/526 [02:10<01:50,  2.33it/s]
 51%|█████     | 269/526 [02:10<01:33,  2.74it/s]
 51%|█████▏    | 270/526 [02:11<01:46,  2.41it/s]
 52%|█████▏    | 271/526 [02:11<01:28,  2.88it/s]
 52%|█████▏    | 272/526 [02:11<01:42,  2.49it/s]
 52%|█████▏    | 273/526 [02:12<02:25,  1.74it/s]
 52%|█████▏    | 274/526 [02:13<02:12,  1.91it/s]
 52%|█████▏    | 275/526 [02:16<05:33,  1.33s/it]
 52%|█████▏    | 276/526 [02:16<04:07,  1.01it/s]
 53%|█████▎    | 277/526 [02:16<03:06,  1.33it/s]
 53%|█████▎    | 278/526 [02:17<03:04,  1.35it/s]
 53%|█████▎    | 279/526 [02:20<06:04,  1.47s/it]
 53%|█████▎    | 280/526 [02:23<08:06,  1.98s/it]
 53%|█████▎    | 281/526 [02:26<09:32,  2.34s/it]
 54%|█████▎    | 282/526 [02:30<10:31,  2.59s/it]
 54%|█████▍    | 283/526 [02:33<11:12,  2.77s/it]
 54%|█████▍    | 284/526 [02:36<11:39,  2.89s/it]
 54%|█████▍    | 285/526 [02:36<08:38,  2.15s/it]
 54%|█████▍    | 286/526 [02:37<07:02,  1.76s/it]
 55%|█████▍    | 287/526 [02:37<05:06,  1.28s/it]
 55%|█████▍    | 288/526 [02:38<03:51,  1.03it/s]
 55%|█████▍    | 289/526 [02:38<02:53,  1.36it/s]
 55%|█████▌    | 291/526 [02:39<02:31,  1.55it/s]
 56%|█████▌    | 292/526 [02:39<02:05,  1.87it/s]
 56%|█████▌    | 293/526 [02:40<02:15,  1.72it/s]
 56%|█████▌    | 294/526 [02:40<01:57,  1.97it/s]
 56%|█████▌    | 295/526 [02:40<01:44,  2.22it/s]
 56%|█████▋    | 296/526 [02:41<01:35,  2.41it/s]
 57%|█████▋    | 298/526 [02:44<03:37,  1.05it/s]
 57%|█████▋    | 299/526 [02:47<05:34,  1.47s/it]
 57%|█████▋    | 300/526 [02:49<05:32,  1.47s/it]
 57%|█████▋    | 301/526 [02:50<05:04,  1.35s/it]
 57%|█████▋    | 302/526 [02:51<05:07,  1.37s/it]
 58%|█████▊    | 303/526 [02:53<05:13,  1.40s/it]
 58%|█████▊    | 304/526 [02:53<04:01,  1.09s/it]
 58%|█████▊    | 305/526 [02:54<04:25,  1.20s/it]
 58%|█████▊    | 306/526 [02:56<04:37,  1.26s/it]
 58%|█████▊    | 307/526 [02:57<04:49,  1.32s/it]
 59%|█████▊    | 308/526 [02:59<04:58,  1.37s/it]
 59%|█████▊    | 309/526 [02:59<03:45,  1.04s/it]
 59%|█████▉    | 310/526 [03:00<03:36,  1.00s/it]
 59%|█████▉    | 311/526 [03:00<02:45,  1.30it/s]
 59%|█████▉    | 312/526 [03:02<03:32,  1.01it/s]
 60%|█████▉    | 313/526 [03:03<04:03,  1.14s/it]
 60%|█████▉    | 314/526 [03:05<04:34,  1.30s/it]
 60%|█████▉    | 315/526 [03:08<06:30,  1.85s/it]
 60%|██████    | 316/526 [03:08<04:39,  1.33s/it]
 60%|██████    | 317/526 [03:09<04:08,  1.19s/it]
 60%|██████    | 318/526 [03:10<03:45,  1.08s/it]
 61%|██████    | 319/526 [03:10<02:59,  1.15it/s]
 61%|██████    | 320/526 [03:10<02:14,  1.53it/s]
 61%|██████    | 321/526 [03:12<03:16,  1.04it/s]
 61%|██████    | 322/526 [03:12<02:38,  1.29it/s]
 61%|██████▏   | 323/526 [03:12<02:04,  1.63it/s]
 62%|██████▏   | 324/526 [03:13<01:41,  1.99it/s]
 62%|██████▏   | 325/526 [03:13<01:27,  2.31it/s]
 62%|██████▏   | 326/526 [03:13<01:08,  2.92it/s]
 62%|██████▏   | 327/526 [03:13<01:07,  2.94it/s]
 62%|██████▏   | 328/526 [03:14<00:56,  3.49it/s]
 63%|██████▎   | 330/526 [03:14<00:36,  5.31it/s]
 63%|██████▎   | 331/526 [03:14<00:40,  4.86it/s]
 63%|██████▎   | 332/526 [03:15<00:57,  3.39it/s]
 63%|██████▎   | 333/526 [03:15<00:52,  3.69it/s]
 63%|██████▎   | 334/526 [03:16<01:47,  1.78it/s]
 64%|██████▎   | 335/526 [03:17<01:46,  1.79it/s]
 64%|██████▍   | 336/526 [03:18<02:27,  1.29it/s]
 64%|██████▍   | 337/526 [03:19<02:24,  1.30it/s]
 64%|██████▍   | 338/526 [03:19<02:16,  1.38it/s]
 64%|██████▍   | 339/526 [03:20<01:58,  1.57it/s]
 65%|██████▍   | 340/526 [03:23<04:20,  1.40s/it]
 65%|██████▍   | 341/526 [03:23<03:09,  1.02s/it]
 65%|██████▌   | 342/526 [03:24<02:38,  1.16it/s]
 65%|██████▌   | 343/526 [03:24<02:35,  1.17it/s]
 66%|██████▌   | 345/526 [03:31<06:10,  2.04s/it]
 66%|██████▌   | 346/526 [03:34<06:59,  2.33s/it]
 66%|██████▌   | 347/526 [03:41<10:22,  3.48s/it]
 66%|██████▌   | 348/526 [03:42<08:19,  2.81s/it]
 66%|██████▋   | 349/526 [03:43<06:20,  2.15s/it]
 67%|██████▋   | 350/526 [03:50<10:16,  3.50s/it]
 67%|██████▋   | 351/526 [03:53<09:57,  3.42s/it]
 67%|██████▋   | 352/526 [03:53<07:12,  2.49s/it]
 67%|██████▋   | 353/526 [03:53<05:12,  1.81s/it]
 67%|██████▋   | 355/526 [03:54<03:09,  1.11s/it]
 68%|██████▊   | 356/526 [03:54<02:27,  1.16it/s]
 68%|██████▊   | 357/526 [03:54<02:14,  1.26it/s]
 68%|██████▊   | 358/526 [03:55<02:03,  1.36it/s]
 68%|██████▊   | 359/526 [03:55<01:40,  1.65it/s]
 68%|██████▊   | 360/526 [03:55<01:17,  2.14it/s]
 69%|██████▊   | 361/526 [03:56<01:06,  2.48it/s]
 69%|██████▉   | 363/526 [03:56<01:02,  2.61it/s]
 69%|██████▉   | 364/526 [03:57<00:54,  2.95it/s]
 69%|██████▉   | 365/526 [03:57<01:05,  2.44it/s]
 70%|██████▉   | 366/526 [03:59<02:00,  1.32it/s]
 70%|██████▉   | 367/526 [03:59<01:32,  1.72it/s]
 70%|██████▉   | 368/526 [03:59<01:12,  2.17it/s]
 70%|███████   | 369/526 [04:00<01:10,  2.22it/s]
 70%|███████   | 370/526 [04:06<05:56,  2.29s/it]
 71%|███████   | 371/526 [04:13<09:21,  3.62s/it]
 71%|███████   | 372/526 [04:20<11:37,  4.53s/it]
 71%|███████   | 374/526 [04:20<06:18,  2.49s/it]
 71%|███████▏  | 375/526 [04:27<08:56,  3.55s/it]
 71%|███████▏  | 376/526 [04:27<06:38,  2.66s/it]
 72%|███████▏  | 377/526 [04:28<05:13,  2.10s/it]
 72%|███████▏  | 379/526 [04:28<03:10,  1.29s/it]
 72%|███████▏  | 380/526 [04:28<02:32,  1.04s/it]
 72%|███████▏  | 381/526 [04:35<05:56,  2.46s/it]
 73%|███████▎  | 382/526 [04:35<04:38,  1.93s/it]
 73%|███████▎  | 383/526 [04:36<03:37,  1.52s/it]
 73%|███████▎  | 384/526 [04:42<07:01,  2.97s/it]
 73%|███████▎  | 385/526 [04:49<09:31,  4.06s/it]
 73%|███████▎  | 386/526 [04:50<07:23,  3.17s/it]
 74%|███████▎  | 387/526 [04:50<05:21,  2.31s/it]
 74%|███████▍  | 388/526 [04:51<04:00,  1.74s/it]
 74%|███████▍  | 389/526 [04:51<03:13,  1.41s/it]
 74%|███████▍  | 390/526 [04:52<02:39,  1.17s/it]
 74%|███████▍  | 391/526 [04:52<01:57,  1.15it/s]
 75%|███████▍  | 392/526 [04:52<01:26,  1.55it/s]
 75%|███████▍  | 393/526 [04:53<01:24,  1.58it/s]
 75%|███████▍  | 394/526 [04:53<01:03,  2.08it/s]
 75%|███████▌  | 396/526 [04:53<00:39,  3.29it/s]
 75%|███████▌  | 397/526 [04:53<00:33,  3.80it/s]
 76%|███████▌  | 398/526 [04:54<00:33,  3.77it/s]
 76%|███████▌  | 399/526 [05:01<04:19,  2.05s/it]
 76%|███████▌  | 400/526 [05:01<03:09,  1.50s/it]
 76%|███████▌  | 401/526 [05:07<06:18,  3.03s/it]
 76%|███████▋  | 402/526 [05:08<04:44,  2.30s/it]
 77%|███████▋  | 403/526 [05:08<03:32,  1.73s/it]
 77%|███████▋  | 404/526 [05:09<02:35,  1.27s/it]
 77%|███████▋  | 405/526 [05:09<01:55,  1.04it/s]
 77%|███████▋  | 406/526 [05:14<04:19,  2.16s/it]
 78%|███████▊  | 408/526 [05:14<02:24,  1.22s/it]
 78%|███████▊  | 409/526 [05:15<02:04,  1.07s/it]
 78%|███████▊  | 410/526 [05:15<01:36,  1.21it/s]
 78%|███████▊  | 411/526 [05:21<04:41,  2.45s/it]
 78%|███████▊  | 412/526 [05:22<03:27,  1.82s/it]
 79%|███████▊  | 414/526 [05:22<01:58,  1.06s/it]
 79%|███████▉  | 415/526 [05:22<01:38,  1.12it/s]
 79%|███████▉  | 417/526 [05:23<01:08,  1.60it/s]
 79%|███████▉  | 418/526 [05:25<01:35,  1.13it/s]
 80%|███████▉  | 419/526 [05:25<01:15,  1.42it/s]
 80%|████████  | 421/526 [05:28<02:04,  1.18s/it]
 80%|████████  | 422/526 [05:29<01:37,  1.07it/s]
 80%|████████  | 423/526 [05:29<01:21,  1.27it/s]
 81%|████████  | 424/526 [05:29<01:03,  1.61it/s]
 81%|████████  | 425/526 [05:29<00:48,  2.07it/s]
 81%|████████  | 426/526 [05:29<00:41,  2.40it/s]
 81%|████████  | 427/526 [05:29<00:33,  2.94it/s]
 81%|████████▏ | 428/526 [05:30<00:26,  3.64it/s]
 82%|████████▏ | 429/526 [05:30<00:22,  4.22it/s]
 82%|████████▏ | 431/526 [05:31<00:35,  2.70it/s]
 82%|████████▏ | 433/526 [05:31<00:25,  3.62it/s]
 83%|████████▎ | 435/526 [05:34<00:59,  1.54it/s]
 83%|████████▎ | 436/526 [05:35<01:03,  1.41it/s]
 83%|████████▎ | 438/526 [05:36<00:56,  1.57it/s]
 83%|████████▎ | 439/526 [05:36<00:58,  1.47it/s]
 84%|████████▎ | 440/526 [05:37<00:58,  1.48it/s]
 84%|████████▍ | 442/526 [05:38<00:42,  1.97it/s]
 84%|████████▍ | 444/526 [05:39<00:52,  1.56it/s]
 85%|████████▍ | 445/526 [05:41<01:09,  1.17it/s]
 85%|████████▍ | 446/526 [05:41<00:57,  1.40it/s]
 85%|████████▍ | 447/526 [05:42<00:49,  1.58it/s]
 85%|████████▌ | 448/526 [05:42<00:40,  1.93it/s]
 86%|████████▌ | 450/526 [05:42<00:25,  3.00it/s]
 86%|████████▌ | 451/526 [05:42<00:21,  3.51it/s]
 86%|████████▌ | 453/526 [05:42<00:14,  4.97it/s]
 86%|████████▋ | 454/526 [05:43<00:20,  3.55it/s]
 87%|████████▋ | 456/526 [05:43<00:15,  4.48it/s]
 87%|████████▋ | 458/526 [05:43<00:13,  5.22it/s]
 87%|████████▋ | 459/526 [05:44<00:13,  5.03it/s]
 87%|████████▋ | 460/526 [05:44<00:18,  3.61it/s]
 88%|████████▊ | 461/526 [05:44<00:15,  4.18it/s]
 88%|████████▊ | 462/526 [05:45<00:14,  4.31it/s]
 88%|████████▊ | 463/526 [05:45<00:16,  3.71it/s]
 88%|████████▊ | 465/526 [05:45<00:13,  4.44it/s]
 89%|████████▊ | 466/526 [05:46<00:15,  3.84it/s]
 89%|████████▉ | 467/526 [05:46<00:18,  3.27it/s]
 89%|████████▉ | 468/526 [05:46<00:15,  3.85it/s]
 89%|████████▉ | 470/526 [05:46<00:10,  5.41it/s]
 90%|████████▉ | 471/526 [05:46<00:09,  6.01it/s]
 90%|████████▉ | 472/526 [05:47<00:12,  4.27it/s]
 90%|█████████ | 474/526 [05:47<00:08,  6.02it/s]
 90%|█████████ | 475/526 [05:48<00:16,  3.13it/s]
 90%|█████████ | 476/526 [05:48<00:16,  2.98it/s]
 91%|█████████ | 478/526 [05:48<00:10,  4.57it/s]
 91%|█████████ | 479/526 [05:49<00:17,  2.74it/s]
 91%|█████████▏| 480/526 [05:50<00:17,  2.66it/s]
 91%|█████████▏| 481/526 [05:51<00:29,  1.51it/s]
 92%|█████████▏| 482/526 [05:51<00:24,  1.76it/s]
 92%|█████████▏| 483/526 [05:52<00:20,  2.11it/s]
 92%|█████████▏| 484/526 [05:52<00:17,  2.45it/s]
 92%|█████████▏| 485/526 [05:52<00:14,  2.78it/s]
 92%|█████████▏| 486/526 [05:52<00:11,  3.35it/s]
 93%|█████████▎| 487/526 [05:52<00:10,  3.72it/s]
 93%|█████████▎| 489/526 [05:53<00:07,  4.82it/s]
 93%|█████████▎| 490/526 [05:53<00:07,  4.86it/s]
 93%|█████████▎| 491/526 [05:54<00:11,  3.09it/s]
 94%|█████████▎| 493/526 [05:57<00:32,  1.02it/s]
 94%|█████████▍| 495/526 [05:58<00:20,  1.49it/s]
 94%|█████████▍| 496/526 [05:58<00:16,  1.78it/s]
 94%|█████████▍| 497/526 [05:59<00:19,  1.45it/s]
 95%|█████████▍| 498/526 [06:01<00:26,  1.07it/s]
 95%|█████████▍| 499/526 [06:02<00:31,  1.17s/it]
 95%|█████████▌| 500/526 [06:03<00:23,  1.11it/s]
 95%|█████████▌| 501/526 [06:03<00:17,  1.41it/s]
 96%|█████████▌| 503/526 [06:03<00:10,  2.25it/s]
 96%|█████████▌| 504/526 [06:03<00:08,  2.48it/s]
 96%|█████████▌| 505/526 [06:04<00:08,  2.36it/s]
 96%|█████████▌| 506/526 [06:04<00:07,  2.71it/s]
 96%|█████████▋| 507/526 [06:04<00:05,  3.27it/s]
 97%|█████████▋| 508/526 [06:05<00:06,  2.90it/s]
 97%|█████████▋| 510/526 [06:06<00:06,  2.30it/s]
 97%|█████████▋| 511/526 [06:06<00:06,  2.16it/s]
 97%|█████████▋| 512/526 [06:06<00:05,  2.56it/s]
 98%|█████████▊| 513/526 [06:07<00:06,  1.97it/s]
 98%|█████████▊| 514/526 [06:08<00:05,  2.16it/s]
 98%|█████████▊| 515/526 [06:08<00:04,  2.24it/s]
 98%|█████████▊| 516/526 [06:08<00:03,  2.77it/s]
 98%|█████████▊| 517/526 [06:09<00:03,  2.68it/s]
 98%|█████████▊| 518/526 [06:09<00:02,  2.89it/s]
 99%|█████████▊| 519/526 [06:09<00:02,  3.48it/s]
 99%|█████████▉| 520/526 [06:10<00:02,  2.02it/s]
 99%|█████████▉| 521/526 [06:10<00:01,  2.64it/s]
 99%|█████████▉| 522/526 [06:13<00:05,  1.27s/it]
 99%|█████████▉| 523/526 [06:17<00:05,  1.90s/it]
100%|█████████▉| 524/526 [06:20<00:04,  2.36s/it]
100%|█████████▉| 525/526 [06:21<00:01,  1.76s/it]
100%|██████████| 526/526 [06:24<00:00,  2.24s/it]
100%|██████████| 526/526 [06:24<00:00,  1.37it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 12:15:09.285165_lp_processed_test.json', '--output_addr', 'data/out/rag/full_profile/lp_rag_full_profile_test_10_limit_6_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  4.82 examples/s]
Generating train split: 526 examples [00:00, 1240.80 examples/s]
INFO 07-15 12:22:00 config.py:510] This model supports multiple tasks: {'embed', 'classify', 'reward', 'score', 'generate'}. Defaulting to 'generate'.
INFO 07-15 12:22:00 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 12:22:01 selector.py:120] Using Flash Attention backend.
INFO 07-15 12:22:02 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 12:22:02 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.54it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.39it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.40it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.36it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.38it/s]

INFO 07-15 12:22:06 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 12:22:08 worker.py:241] Memory profiling takes 2.09 seconds
INFO 07-15 12:22:08 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 12:22:08 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 12:22:08 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 12:22:08 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 12:22:11 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:13,  2.48it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:12,  2.69it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:12,  2.66it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:11,  2.66it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:11,  2.66it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:10,  2.65it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:02<00:10,  2.65it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:03<00:10,  2.63it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:03<00:09,  2.62it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:03<00:09,  2.63it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:04<00:09,  2.63it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:04<00:08,  2.64it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:04<00:08,  2.64it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:05<00:07,  2.65it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:05<00:07,  2.67it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:05<00:06,  2.88it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:06<00:05,  3.12it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:06<00:05,  3.32it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:06<00:04,  3.47it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:06<00:04,  3.59it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:07<00:03,  3.68it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:07<00:03,  3.75it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:07<00:03,  3.80it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:08<00:02,  3.83it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:08<00:02,  3.80it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:08<00:02,  3.77it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:08<00:02,  3.78it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:09<00:01,  3.66it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:09<00:01,  3.71it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:09<00:01,  3.76it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:09<00:01,  3.76it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:10<00:00,  3.80it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:10<00:00,  3.76it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:10<00:00,  3.80it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:10<00:00,  3.81it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:10<00:00,  3.20it/s]
INFO 07-15 12:22:22 model_runner.py:1535] Graph capturing finished in 11 secs, took 0.22 GiB
INFO 07-15 12:22:22 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 15.96 seconds
None

Processed prompts:   0%|          | 0/526 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/526 [00:35<5:10:45, 35.52s/it, est. speed input: 64.39 toks/s, output: 2.76 toks/s]
Processed prompts:   0%|          | 2/526 [00:36<2:10:40, 14.96s/it, est. speed input: 105.76 toks/s, output: 5.62 toks/s]
Processed prompts:   1%|          | 3/526 [00:36<1:11:42,  8.23s/it, est. speed input: 130.99 toks/s, output: 8.51 toks/s]
Processed prompts:   1%|          | 4/526 [00:36<44:25,  5.11s/it, est. speed input: 155.00 toks/s, output: 11.36 toks/s] 
Processed prompts:   1%|          | 5/526 [00:37<29:33,  3.40s/it, est. speed input: 212.98 toks/s, output: 14.19 toks/s]
Processed prompts:   1%|          | 6/526 [00:37<19:51,  2.29s/it, est. speed input: 267.80 toks/s, output: 17.10 toks/s]
Processed prompts:   2%|▏         | 9/526 [00:37<08:50,  1.03s/it, est. speed input: 373.66 toks/s, output: 25.68 toks/s]
Processed prompts:   2%|▏         | 10/526 [00:37<07:19,  1.18it/s, est. speed input: 410.87 toks/s, output: 28.51 toks/s]
Processed prompts:   2%|▏         | 11/526 [00:37<05:49,  1.47it/s, est. speed input: 469.04 toks/s, output: 31.42 toks/s]
Processed prompts:   2%|▏         | 12/526 [00:38<04:49,  1.77it/s, est. speed input: 528.57 toks/s, output: 34.24 toks/s]
Processed prompts:   2%|▏         | 13/526 [00:38<03:46,  2.27it/s, est. speed input: 573.53 toks/s, output: 37.17 toks/s]
Processed prompts:   3%|▎         | 16/526 [00:38<02:29,  3.42it/s, est. speed input: 695.11 toks/s, output: 45.70 toks/s]
Processed prompts:   3%|▎         | 17/526 [00:38<02:13,  3.82it/s, est. speed input: 739.83 toks/s, output: 48.57 toks/s]
Processed prompts:   4%|▎         | 19/526 [00:39<02:01,  4.17it/s, est. speed input: 813.01 toks/s, output: 54.12 toks/s]
Processed prompts:   4%|▍         | 21/526 [00:39<01:39,  5.07it/s, est. speed input: 899.10 toks/s, output: 59.89 toks/s]
Processed prompts:   4%|▍         | 22/526 [00:39<01:45,  4.79it/s, est. speed input: 933.79 toks/s, output: 62.57 toks/s]
Processed prompts:   4%|▍         | 23/526 [00:39<01:39,  5.08it/s, est. speed input: 968.32 toks/s, output: 65.40 toks/s]
Processed prompts:   5%|▍         | 26/526 [00:40<01:32,  5.41it/s, est. speed input: 1097.91 toks/s, output: 73.73 toks/s]
Processed prompts:   5%|▌         | 27/526 [00:40<01:25,  5.86it/s, est. speed input: 1147.49 toks/s, output: 76.64 toks/s]
Processed prompts:   5%|▌         | 28/526 [00:40<01:37,  5.09it/s, est. speed input: 1201.09 toks/s, output: 79.22 toks/s]
Processed prompts:   6%|▌         | 31/526 [00:41<01:32,  5.38it/s, est. speed input: 1303.25 toks/s, output: 87.51 toks/s]
Processed prompts:   6%|▋         | 34/526 [00:41<01:20,  6.08it/s, est. speed input: 1417.56 toks/s, output: 95.96 toks/s]
Processed prompts:   7%|▋         | 36/526 [00:42<01:25,  5.72it/s, est. speed input: 1474.99 toks/s, output: 101.27 toks/s]
Processed prompts:   7%|▋         | 37/526 [00:42<01:20,  6.10it/s, est. speed input: 1537.42 toks/s, output: 104.15 toks/s]
Processed prompts:   8%|▊         | 43/526 [00:43<01:29,  5.41it/s, est. speed input: 1838.64 toks/s, output: 119.66 toks/s]
Processed prompts:   9%|▊         | 45/526 [00:43<01:25,  5.63it/s, est. speed input: 1922.85 toks/s, output: 125.02 toks/s]
Processed prompts:   9%|▊         | 46/526 [00:44<01:30,  5.31it/s, est. speed input: 1948.29 toks/s, output: 127.40 toks/s]
Processed prompts:   9%|▉         | 47/526 [00:44<01:28,  5.43it/s, est. speed input: 1969.60 toks/s, output: 130.05 toks/s]
Processed prompts:  10%|▉         | 50/526 [00:44<01:31,  5.18it/s, est. speed input: 2118.50 toks/s, output: 137.51 toks/s]
Processed prompts:  10%|▉         | 52/526 [00:45<01:21,  5.81it/s, est. speed input: 2205.90 toks/s, output: 142.97 toks/s]
Processed prompts:  11%|█         | 58/526 [00:46<01:19,  5.90it/s, est. speed input: 2415.79 toks/s, output: 158.12 toks/s]
Processed prompts:  11%|█▏        | 60/526 [00:46<01:27,  5.30it/s, est. speed input: 2487.61 toks/s, output: 162.45 toks/s]
Processed prompts:  12%|█▏        | 63/526 [00:47<01:27,  5.30it/s, est. speed input: 2578.48 toks/s, output: 169.61 toks/s]
Processed prompts:  12%|█▏        | 65/526 [00:47<01:19,  5.80it/s, est. speed input: 2634.41 toks/s, output: 174.87 toks/s]
Processed prompts:  13%|█▎        | 68/526 [00:48<01:25,  5.34it/s, est. speed input: 2739.75 toks/s, output: 181.55 toks/s]
Processed prompts:  14%|█▎        | 72/526 [00:48<01:10,  6.40it/s, est. speed input: 2823.35 toks/s, output: 192.03 toks/s]
Processed prompts:  14%|█▍        | 73/526 [00:48<01:14,  6.09it/s, est. speed input: 2868.15 toks/s, output: 194.18 toks/s]
Processed prompts:  15%|█▍        | 78/526 [00:49<01:04,  6.90it/s, est. speed input: 3049.73 toks/s, output: 206.79 toks/s]
Processed prompts:  15%|█▌        | 81/526 [00:49<01:03,  7.05it/s, est. speed input: 3116.17 toks/s, output: 214.12 toks/s]
Processed prompts:  16%|█▌        | 84/526 [00:50<00:59,  7.46it/s, est. speed input: 3216.91 toks/s, output: 221.65 toks/s]
Processed prompts:  17%|█▋        | 88/526 [00:50<00:56,  7.71it/s, est. speed input: 3311.94 toks/s, output: 231.48 toks/s]
Processed prompts:  17%|█▋        | 92/526 [00:51<01:02,  6.90it/s, est. speed input: 3436.59 toks/s, output: 240.21 toks/s]
Processed prompts:  18%|█▊        | 96/526 [00:51<00:56,  7.66it/s, est. speed input: 3567.96 toks/s, output: 250.28 toks/s]
Processed prompts:  19%|█▉        | 100/526 [00:52<00:56,  7.51it/s, est. speed input: 3670.12 toks/s, output: 259.51 toks/s]
Processed prompts:  20%|█▉        | 103/526 [00:52<00:58,  7.18it/s, est. speed input: 3730.42 toks/s, output: 266.08 toks/s]
Processed prompts:  20%|██        | 106/526 [00:53<01:01,  6.77it/s, est. speed input: 3805.77 toks/s, output: 272.39 toks/s]
Processed prompts:  21%|██▏       | 113/526 [00:54<00:58,  7.01it/s, est. speed input: 3979.01 toks/s, output: 287.99 toks/s]
Processed prompts:  22%|██▏       | 118/526 [00:54<00:56,  7.21it/s, est. speed input: 4113.08 toks/s, output: 299.08 toks/s]
Processed prompts:  23%|██▎       | 122/526 [00:55<00:50,  7.93it/s, est. speed input: 4220.62 toks/s, output: 308.70 toks/s]
Processed prompts:  24%|██▍       | 126/526 [00:56<01:01,  6.50it/s, est. speed input: 4272.85 toks/s, output: 315.23 toks/s]
Processed prompts:  25%|██▍       | 129/526 [00:56<00:56,  6.97it/s, est. speed input: 4347.12 toks/s, output: 322.04 toks/s]
Processed prompts:  25%|██▌       | 133/526 [00:57<00:57,  6.83it/s, est. speed input: 4469.70 toks/s, output: 330.03 toks/s]
Processed prompts:  25%|██▌       | 134/526 [00:57<01:01,  6.40it/s, est. speed input: 4490.88 toks/s, output: 331.51 toks/s]
Processed prompts:  26%|██▌       | 136/526 [00:57<00:57,  6.77it/s, est. speed input: 4547.05 toks/s, output: 335.95 toks/s]
Processed prompts:  27%|██▋       | 141/526 [00:58<00:54,  7.07it/s, est. speed input: 4722.81 toks/s, output: 346.46 toks/s]
Processed prompts:  28%|██▊       | 145/526 [00:58<00:49,  7.73it/s, est. speed input: 4823.00 toks/s, output: 355.45 toks/s]
Processed prompts:  29%|██▊       | 151/526 [00:59<00:56,  6.65it/s, est. speed input: 4974.05 toks/s, output: 366.04 toks/s]
Processed prompts:  30%|██▉       | 156/526 [01:00<00:52,  7.06it/s, est. speed input: 5121.45 toks/s, output: 376.37 toks/s]
Processed prompts:  31%|███       | 163/526 [01:01<00:53,  6.81it/s, est. speed input: 5265.03 toks/s, output: 389.24 toks/s]
Processed prompts:  32%|███▏      | 169/526 [01:02<00:48,  7.40it/s, est. speed input: 5365.81 toks/s, output: 401.71 toks/s]
Processed prompts:  33%|███▎      | 174/526 [01:02<00:45,  7.68it/s, est. speed input: 5490.32 toks/s, output: 411.77 toks/s]
Processed prompts:  34%|███▍      | 178/526 [01:03<00:45,  7.72it/s, est. speed input: 5550.76 toks/s, output: 419.47 toks/s]
Processed prompts:  35%|███▍      | 183/526 [01:04<00:48,  7.02it/s, est. speed input: 5635.73 toks/s, output: 427.52 toks/s]
Processed prompts:  36%|███▌      | 190/526 [01:05<00:52,  6.44it/s, est. speed input: 5716.25 toks/s, output: 438.33 toks/s]
Processed prompts:  37%|███▋      | 192/526 [01:05<00:56,  5.96it/s, est. speed input: 5742.41 toks/s, output: 440.39 toks/s]
Processed prompts:  37%|███▋      | 194/526 [01:06<00:56,  5.87it/s, est. speed input: 5779.82 toks/s, output: 443.34 toks/s]
Processed prompts:  37%|███▋      | 197/526 [01:06<00:56,  5.87it/s, est. speed input: 5816.56 toks/s, output: 448.01 toks/s]
Processed prompts:  38%|███▊      | 201/526 [01:07<00:50,  6.45it/s, est. speed input: 5877.55 toks/s, output: 455.47 toks/s]
Processed prompts:  39%|███▉      | 204/526 [01:07<00:56,  5.72it/s, est. speed input: 5927.03 toks/s, output: 458.83 toks/s]
Processed prompts:  39%|███▉      | 206/526 [01:08<00:57,  5.60it/s, est. speed input: 5957.61 toks/s, output: 461.57 toks/s]
Processed prompts:  40%|███▉      | 210/526 [01:09<00:59,  5.29it/s, est. speed input: 6021.96 toks/s, output: 466.66 toks/s]
Processed prompts:  40%|████      | 212/526 [01:09<00:59,  5.27it/s, est. speed input: 6082.61 toks/s, output: 469.40 toks/s]
Processed prompts:  41%|████      | 214/526 [01:09<00:57,  5.38it/s, est. speed input: 6119.80 toks/s, output: 472.44 toks/s]
Processed prompts:  41%|████      | 216/526 [01:10<00:53,  5.76it/s, est. speed input: 6177.18 toks/s, output: 475.98 toks/s]
Processed prompts:  41%|████▏     | 217/526 [01:10<00:57,  5.39it/s, est. speed input: 6190.37 toks/s, output: 476.96 toks/s]
Processed prompts:  42%|████▏     | 219/526 [01:10<00:57,  5.35it/s, est. speed input: 6212.43 toks/s, output: 479.78 toks/s]
Processed prompts:  42%|████▏     | 222/526 [01:11<00:56,  5.40it/s, est. speed input: 6245.36 toks/s, output: 484.16 toks/s]
Processed prompts:  43%|████▎     | 224/526 [01:11<00:49,  6.09it/s, est. speed input: 6269.42 toks/s, output: 488.12 toks/s]
Processed prompts:  43%|████▎     | 226/526 [01:11<00:54,  5.47it/s, est. speed input: 6276.56 toks/s, output: 490.40 toks/s]
Processed prompts:  43%|████▎     | 227/526 [01:12<00:50,  5.88it/s, est. speed input: 6281.43 toks/s, output: 492.40 toks/s]
Processed prompts:  44%|████▎     | 229/526 [01:12<00:54,  5.43it/s, est. speed input: 6280.80 toks/s, output: 494.92 toks/s]
Processed prompts:  44%|████▎     | 230/526 [01:12<01:04,  4.56it/s, est. speed input: 6276.53 toks/s, output: 495.12 toks/s]
Processed prompts:  44%|████▍     | 231/526 [01:13<01:12,  4.06it/s, est. speed input: 6316.88 toks/s, output: 495.55 toks/s]
Processed prompts:  44%|████▍     | 234/526 [01:13<01:02,  4.69it/s, est. speed input: 6349.34 toks/s, output: 500.26 toks/s]
Processed prompts:  45%|████▍     | 235/526 [01:13<01:03,  4.61it/s, est. speed input: 6355.84 toks/s, output: 501.45 toks/s]
Processed prompts:  45%|████▍     | 236/526 [01:14<01:04,  4.53it/s, est. speed input: 6399.68 toks/s, output: 502.65 toks/s]
Processed prompts:  45%|████▌     | 238/526 [01:14<00:57,  5.02it/s, est. speed input: 6421.07 toks/s, output: 506.04 toks/s]
Processed prompts:  45%|████▌     | 239/526 [01:14<01:00,  4.75it/s, est. speed input: 6441.33 toks/s, output: 507.16 toks/s]
Processed prompts:  46%|████▌     | 240/526 [01:15<01:07,  4.23it/s, est. speed input: 6454.25 toks/s, output: 507.83 toks/s]
Processed prompts:  46%|████▌     | 242/526 [01:15<01:16,  3.73it/s, est. speed input: 6457.78 toks/s, output: 509.29 toks/s]
Processed prompts:  46%|████▌     | 243/526 [01:15<01:10,  4.00it/s, est. speed input: 6487.18 toks/s, output: 510.92 toks/s]
Processed prompts:  46%|████▋     | 244/526 [01:16<01:43,  2.71it/s, est. speed input: 6453.70 toks/s, output: 508.94 toks/s]
Processed prompts:  47%|████▋     | 245/526 [01:16<01:26,  3.26it/s, est. speed input: 6462.82 toks/s, output: 511.06 toks/s]
Processed prompts:  47%|████▋     | 246/526 [01:17<01:33,  3.00it/s, est. speed input: 6451.33 toks/s, output: 511.37 toks/s]
Processed prompts:  47%|████▋     | 247/526 [01:17<01:15,  3.70it/s, est. speed input: 6463.23 toks/s, output: 512.11 toks/s]
Processed prompts:  47%|████▋     | 248/526 [01:17<01:30,  3.09it/s, est. speed input: 6445.54 toks/s, output: 510.70 toks/s]
Processed prompts:  47%|████▋     | 249/526 [01:18<01:36,  2.86it/s, est. speed input: 6441.04 toks/s, output: 511.09 toks/s]
Processed prompts:  48%|████▊     | 250/526 [01:18<01:46,  2.58it/s, est. speed input: 6445.43 toks/s, output: 511.11 toks/s]
Processed prompts:  48%|████▊     | 251/526 [01:18<01:32,  2.98it/s, est. speed input: 6443.99 toks/s, output: 511.25 toks/s]
Processed prompts:  48%|████▊     | 252/526 [01:19<01:37,  2.81it/s, est. speed input: 6432.47 toks/s, output: 510.42 toks/s]
Processed prompts:  48%|████▊     | 253/526 [01:19<01:35,  2.87it/s, est. speed input: 6430.91 toks/s, output: 510.12 toks/s]
Processed prompts:  48%|████▊     | 254/526 [01:19<01:39,  2.74it/s, est. speed input: 6425.85 toks/s, output: 509.30 toks/s]
Processed prompts:  48%|████▊     | 255/526 [01:20<01:39,  2.74it/s, est. speed input: 6426.01 toks/s, output: 508.59 toks/s]
Processed prompts:  49%|████▊     | 256/526 [01:20<01:17,  3.48it/s, est. speed input: 6437.94 toks/s, output: 509.59 toks/s]
Processed prompts:  49%|████▉     | 257/526 [01:20<01:12,  3.72it/s, est. speed input: 6438.38 toks/s, output: 509.98 toks/s]
Processed prompts:  49%|████▉     | 259/526 [01:21<01:08,  3.89it/s, est. speed input: 6442.80 toks/s, output: 511.47 toks/s]
Processed prompts:  49%|████▉     | 260/526 [01:21<01:19,  3.33it/s, est. speed input: 6432.26 toks/s, output: 510.65 toks/s]
Processed prompts:  50%|█████     | 265/526 [01:22<01:00,  4.34it/s, est. speed input: 6480.22 toks/s, output: 513.12 toks/s]
Processed prompts:  51%|█████     | 267/526 [01:22<00:57,  4.53it/s, est. speed input: 6534.44 toks/s, output: 514.34 toks/s]
Processed prompts:  51%|█████     | 268/526 [01:23<01:17,  3.35it/s, est. speed input: 6507.43 toks/s, output: 511.97 toks/s]
Processed prompts:  51%|█████     | 269/526 [01:23<01:12,  3.56it/s, est. speed input: 6518.70 toks/s, output: 512.85 toks/s]
Processed prompts:  52%|█████▏    | 272/526 [01:24<00:54,  4.64it/s, est. speed input: 6552.54 toks/s, output: 515.73 toks/s]
Processed prompts:  52%|█████▏    | 275/526 [01:24<00:37,  6.71it/s, est. speed input: 6640.50 toks/s, output: 520.09 toks/s]
Processed prompts:  53%|█████▎    | 277/526 [01:24<00:35,  6.94it/s, est. speed input: 6684.13 toks/s, output: 521.49 toks/s]
Processed prompts:  53%|█████▎    | 281/526 [01:24<00:25,  9.74it/s, est. speed input: 6755.71 toks/s, output: 526.92 toks/s]
Processed prompts:  54%|█████▍    | 283/526 [01:24<00:22, 10.68it/s, est. speed input: 6792.68 toks/s, output: 529.27 toks/s]
Processed prompts:  55%|█████▍    | 289/526 [01:25<00:13, 17.47it/s, est. speed input: 6924.01 toks/s, output: 539.27 toks/s]
Processed prompts:  56%|█████▌    | 292/526 [01:25<00:12, 18.75it/s, est. speed input: 7001.77 toks/s, output: 543.56 toks/s]
Processed prompts:  56%|█████▌    | 295/526 [01:25<00:11, 19.89it/s, est. speed input: 7049.80 toks/s, output: 547.35 toks/s]
Processed prompts:  57%|█████▋    | 298/526 [01:25<00:10, 20.87it/s, est. speed input: 7106.91 toks/s, output: 551.89 toks/s]
Processed prompts:  57%|█████▋    | 301/526 [01:25<00:10, 21.70it/s, est. speed input: 7171.35 toks/s, output: 557.95 toks/s]
Processed prompts:  58%|█████▊    | 306/526 [01:25<00:08, 26.78it/s, est. speed input: 7294.41 toks/s, output: 566.63 toks/s]
Processed prompts:  59%|█████▉    | 312/526 [01:25<00:06, 33.24it/s, est. speed input: 7512.35 toks/s, output: 576.62 toks/s]
Processed prompts:  60%|██████    | 316/526 [01:25<00:07, 29.72it/s, est. speed input: 7606.91 toks/s, output: 582.13 toks/s]
Processed prompts:  61%|██████    | 321/526 [01:26<00:06, 33.39it/s, est. speed input: 7698.74 toks/s, output: 590.26 toks/s]
Processed prompts:  62%|██████▏   | 325/526 [01:26<00:05, 34.07it/s, est. speed input: 7808.90 toks/s, output: 596.34 toks/s]
Processed prompts:  63%|██████▎   | 331/526 [01:26<00:04, 39.65it/s, est. speed input: 7937.18 toks/s, output: 605.91 toks/s]
Processed prompts:  65%|██████▍   | 340/526 [01:26<00:03, 51.66it/s, est. speed input: 8126.75 toks/s, output: 621.51 toks/s]
Processed prompts:  66%|██████▌   | 346/526 [01:26<00:03, 46.83it/s, est. speed input: 8276.95 toks/s, output: 632.15 toks/s]
Processed prompts:  67%|██████▋   | 353/526 [01:26<00:03, 52.41it/s, est. speed input: 8513.50 toks/s, output: 645.69 toks/s]
Processed prompts:  69%|██████▉   | 363/526 [01:26<00:02, 57.82it/s, est. speed input: 8721.79 toks/s, output: 666.19 toks/s]
Processed prompts:  70%|███████   | 369/526 [01:26<00:02, 52.68it/s, est. speed input: 8846.31 toks/s, output: 675.95 toks/s]
Processed prompts:  72%|███████▏  | 378/526 [01:27<00:02, 56.33it/s, est. speed input: 9096.68 toks/s, output: 691.52 toks/s]
Processed prompts:  73%|███████▎  | 385/526 [01:27<00:02, 54.88it/s, est. speed input: 9267.98 toks/s, output: 703.05 toks/s]
Processed prompts:  75%|███████▍  | 392/526 [01:27<00:02, 54.26it/s, est. speed input: 9424.31 toks/s, output: 715.62 toks/s]
Processed prompts:  76%|███████▌  | 398/526 [01:27<00:02, 47.35it/s, est. speed input: 9539.55 toks/s, output: 725.62 toks/s]
Processed prompts:  78%|███████▊  | 411/526 [01:27<00:01, 63.89it/s, est. speed input: 9898.66 toks/s, output: 750.15 toks/s]
Processed prompts:  80%|███████▉  | 419/526 [01:27<00:01, 61.09it/s, est. speed input: 10052.72 toks/s, output: 765.15 toks/s]
Processed prompts:  81%|████████▏ | 428/526 [01:27<00:01, 67.09it/s, est. speed input: 10264.69 toks/s, output: 782.20 toks/s]
Processed prompts:  83%|████████▎ | 436/526 [01:28<00:01, 64.80it/s, est. speed input: 10547.84 toks/s, output: 797.47 toks/s]
Processed prompts:  84%|████████▍ | 443/526 [01:28<00:01, 61.45it/s, est. speed input: 10739.23 toks/s, output: 812.49 toks/s]
Processed prompts:  86%|████████▌ | 450/526 [01:28<00:01, 60.26it/s, est. speed input: 10947.44 toks/s, output: 825.67 toks/s]
Processed prompts:  87%|████████▋ | 457/526 [01:28<00:01, 47.02it/s, est. speed input: 11086.46 toks/s, output: 839.66 toks/s]
Processed prompts:  88%|████████▊ | 465/526 [01:28<00:01, 52.75it/s, est. speed input: 11256.39 toks/s, output: 854.18 toks/s]
Processed prompts:  90%|████████▉ | 471/526 [01:28<00:01, 47.93it/s, est. speed input: 11398.67 toks/s, output: 864.79 toks/s]
Processed prompts:  91%|█████████ | 477/526 [01:29<00:01, 34.79it/s, est. speed input: 11554.52 toks/s, output: 874.86 toks/s]
Processed prompts:  92%|█████████▏| 482/526 [01:29<00:01, 24.78it/s, est. speed input: 11645.88 toks/s, output: 881.45 toks/s]
Processed prompts:  92%|█████████▏| 486/526 [01:29<00:01, 25.46it/s, est. speed input: 11708.95 toks/s, output: 886.76 toks/s]
Processed prompts:  93%|█████████▎| 490/526 [01:30<00:02, 17.71it/s, est. speed input: 11745.88 toks/s, output: 891.55 toks/s]
Processed prompts:  94%|█████████▍| 494/526 [01:30<00:01, 19.97it/s, est. speed input: 11830.54 toks/s, output: 902.08 toks/s]
Processed prompts:  94%|█████████▍| 497/526 [01:30<00:01, 18.36it/s, est. speed input: 11891.55 toks/s, output: 907.06 toks/s]
Processed prompts:  95%|█████████▌| 500/526 [01:30<00:01, 19.81it/s, est. speed input: 11930.21 toks/s, output: 912.12 toks/s]
Processed prompts:  96%|█████████▌| 503/526 [01:30<00:01, 16.10it/s, est. speed input: 12001.51 toks/s, output: 917.41 toks/s]
Processed prompts:  96%|█████████▌| 506/526 [01:31<00:01, 14.13it/s, est. speed input: 12075.82 toks/s, output: 923.68 toks/s]
Processed prompts:  97%|█████████▋| 508/526 [01:31<00:01, 11.12it/s, est. speed input: 12097.55 toks/s, output: 927.75 toks/s]
Processed prompts:  97%|█████████▋| 510/526 [01:31<00:01, 12.01it/s, est. speed input: 12160.61 toks/s, output: 933.76 toks/s]
Processed prompts:  98%|█████████▊| 513/526 [01:31<00:01, 12.68it/s, est. speed input: 12212.22 toks/s, output: 942.87 toks/s]
Processed prompts:  98%|█████████▊| 515/526 [01:32<00:01, 10.47it/s, est. speed input: 12251.56 toks/s, output: 947.56 toks/s]
Processed prompts:  98%|█████████▊| 517/526 [01:32<00:00, 10.18it/s, est. speed input: 12326.65 toks/s, output: 953.91 toks/s]
Processed prompts:  99%|█████████▊| 519/526 [01:32<00:00, 10.30it/s, est. speed input: 12339.47 toks/s, output: 960.99 toks/s]
Processed prompts:  99%|█████████▉| 521/526 [01:32<00:00, 11.41it/s, est. speed input: 12379.27 toks/s, output: 966.74 toks/s]
Processed prompts:  99%|█████████▉| 523/526 [01:33<00:00,  6.84it/s, est. speed input: 12391.34 toks/s, output: 969.00 toks/s]
Processed prompts: 100%|█████████▉| 524/526 [01:33<00:00,  7.01it/s, est. speed input: 12409.64 toks/s, output: 971.79 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:33<00:00,  5.46it/s, est. speed input: 12415.32 toks/s, output: 974.58 toks/s]
Processed prompts: 100%|██████████| 526/526 [01:33<00:00,  5.60it/s, est. speed input: 12415.32 toks/s, output: 974.58 toks/s]
[rank0]:[W715 12:23:59.041123481 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/lp_rag_full_profile_test_10_limit_6_output.json
Cleaned temporary files.
Keeping ['ae', 'lp', 'sc'] in profile
Temp data file saved at data/processed/TEMP_2025-07-15 12:24:03.103426_sc_processed_test.json.
	Running Ranking: ['python', 'retrieval/rank_dataset.py', '--model_name', 'facebook/contriever-msmarco', '--input_dataset_addr', 'data/processed/TEMP_2025-07-15 12:24:03.103426_sc_processed_test.json', '--output_dataset_addr', 'data/processed/TEMP_2025-07-15 12:24:03.103426_sc_processed_test.json', '--batch_size', '4']

  0%|          | 0/424 [00:00<?, ?it/s]
  0%|          | 1/424 [00:00<03:03,  2.31it/s]
  0%|          | 2/424 [00:01<05:03,  1.39it/s]
  1%|          | 3/424 [00:01<03:04,  2.28it/s]
  1%|          | 4/424 [00:03<06:33,  1.07it/s]
  1%|          | 5/424 [00:03<04:50,  1.44it/s]
  2%|▏         | 7/424 [00:04<04:07,  1.69it/s]
  2%|▏         | 8/424 [00:05<04:10,  1.66it/s]
  2%|▏         | 9/424 [00:05<03:15,  2.13it/s]
  2%|▏         | 10/424 [00:05<02:52,  2.40it/s]
  3%|▎         | 11/424 [00:05<02:20,  2.94it/s]
  3%|▎         | 12/424 [00:05<02:15,  3.04it/s]
  3%|▎         | 13/424 [00:07<05:12,  1.32it/s]
  3%|▎         | 14/424 [00:07<04:00,  1.71it/s]
  4%|▎         | 15/424 [00:08<03:14,  2.10it/s]
  4%|▍         | 16/424 [00:08<03:26,  1.97it/s]
  4%|▍         | 17/424 [00:08<02:57,  2.29it/s]
  4%|▍         | 18/424 [00:09<02:33,  2.65it/s]
  4%|▍         | 19/424 [00:09<03:00,  2.24it/s]
  5%|▍         | 20/424 [00:09<02:27,  2.74it/s]
  5%|▍         | 21/424 [00:10<01:59,  3.37it/s]
  5%|▌         | 22/424 [00:10<02:40,  2.50it/s]
  5%|▌         | 23/424 [00:12<04:49,  1.38it/s]
  6%|▌         | 24/424 [00:12<04:36,  1.44it/s]
  6%|▌         | 25/424 [00:13<05:04,  1.31it/s]
  6%|▌         | 26/424 [00:14<04:45,  1.39it/s]
  6%|▋         | 27/424 [00:16<06:39,  1.01s/it]
  7%|▋         | 28/424 [00:16<05:52,  1.12it/s]
  7%|▋         | 29/424 [00:16<04:37,  1.42it/s]
  7%|▋         | 30/424 [00:17<03:35,  1.83it/s]
  7%|▋         | 31/424 [00:17<03:42,  1.77it/s]
  8%|▊         | 33/424 [00:17<02:11,  2.97it/s]
  8%|▊         | 34/424 [00:18<02:04,  3.14it/s]
  8%|▊         | 36/424 [00:18<01:22,  4.69it/s]
  9%|▊         | 37/424 [00:19<02:09,  2.98it/s]
  9%|▉         | 38/424 [00:19<02:03,  3.12it/s]
  9%|▉         | 40/424 [00:19<01:33,  4.11it/s]
 10%|▉         | 41/424 [00:19<01:33,  4.09it/s]
 10%|▉         | 42/424 [00:20<02:08,  2.97it/s]
 10%|█         | 43/424 [00:20<01:48,  3.50it/s]
 10%|█         | 44/424 [00:22<04:08,  1.53it/s]
 11%|█         | 45/424 [00:22<04:03,  1.56it/s]
 11%|█         | 46/424 [00:23<03:22,  1.87it/s]
 11%|█         | 47/424 [00:23<03:29,  1.80it/s]
 11%|█▏        | 48/424 [00:24<03:37,  1.73it/s]
 12%|█▏        | 49/424 [00:24<03:40,  1.70it/s]
 12%|█▏        | 51/424 [00:25<02:54,  2.14it/s]
 12%|█▏        | 52/424 [00:26<02:54,  2.13it/s]
 12%|█▎        | 53/424 [00:26<03:06,  1.99it/s]
 13%|█▎        | 54/424 [00:27<03:44,  1.65it/s]
 13%|█▎        | 55/424 [00:27<03:09,  1.95it/s]
 13%|█▎        | 56/424 [00:28<03:18,  1.85it/s]
 14%|█▎        | 58/424 [00:28<01:59,  3.06it/s]
 14%|█▍        | 59/424 [00:30<03:58,  1.53it/s]
 15%|█▍        | 62/424 [00:33<05:16,  1.14it/s]
 15%|█▍        | 63/424 [00:34<04:57,  1.21it/s]
 15%|█▌        | 64/424 [00:34<04:13,  1.42it/s]
 15%|█▌        | 65/424 [00:34<03:21,  1.78it/s]
 16%|█▌        | 66/424 [00:36<05:02,  1.19it/s]
 16%|█▌        | 67/424 [00:36<04:00,  1.48it/s]
 16%|█▌        | 68/424 [00:36<03:49,  1.55it/s]
 16%|█▋        | 69/424 [00:38<05:29,  1.08it/s]
 17%|█▋        | 70/424 [00:38<04:28,  1.32it/s]
 17%|█▋        | 71/424 [00:39<03:45,  1.56it/s]
 17%|█▋        | 72/424 [00:39<03:14,  1.81it/s]
 17%|█▋        | 73/424 [00:39<02:52,  2.03it/s]
 17%|█▋        | 74/424 [00:40<02:35,  2.25it/s]
 18%|█▊        | 75/424 [00:42<05:16,  1.10it/s]
 18%|█▊        | 77/424 [00:42<03:21,  1.72it/s]
 18%|█▊        | 78/424 [00:42<02:42,  2.13it/s]
 19%|█▉        | 80/424 [00:43<01:48,  3.16it/s]
 19%|█▉        | 81/424 [00:43<02:28,  2.31it/s]
 19%|█▉        | 82/424 [00:44<02:58,  1.92it/s]
 20%|█▉        | 83/424 [00:45<03:38,  1.56it/s]
 20%|█▉        | 84/424 [00:45<02:48,  2.01it/s]
 20%|██        | 85/424 [00:46<03:36,  1.57it/s]
 20%|██        | 86/424 [00:47<03:56,  1.43it/s]
 21%|██        | 87/424 [00:48<04:23,  1.28it/s]
 21%|██        | 88/424 [00:48<03:41,  1.52it/s]
 21%|██        | 89/424 [00:49<04:12,  1.33it/s]
 21%|██        | 90/424 [00:50<03:15,  1.70it/s]
 21%|██▏       | 91/424 [00:51<03:57,  1.40it/s]
 22%|██▏       | 92/424 [00:52<04:24,  1.25it/s]
 22%|██▏       | 93/424 [00:52<04:05,  1.35it/s]
 22%|██▏       | 94/424 [00:53<04:27,  1.23it/s]
 22%|██▏       | 95/424 [00:53<03:18,  1.65it/s]
 23%|██▎       | 96/424 [00:54<02:51,  1.91it/s]
 23%|██▎       | 98/424 [00:54<01:45,  3.10it/s]
 23%|██▎       | 99/424 [00:54<01:31,  3.56it/s]
 24%|██▎       | 100/424 [00:55<01:55,  2.80it/s]
 24%|██▍       | 101/424 [00:56<03:21,  1.60it/s]
 24%|██▍       | 102/424 [00:56<02:50,  1.89it/s]
 24%|██▍       | 103/424 [00:56<02:22,  2.26it/s]
 25%|██▍       | 104/424 [00:57<01:56,  2.74it/s]
 25%|██▍       | 105/424 [00:57<02:23,  2.22it/s]
 25%|██▌       | 106/424 [00:57<01:51,  2.84it/s]
 25%|██▌       | 107/424 [00:58<02:19,  2.27it/s]
 26%|██▌       | 109/424 [01:01<05:24,  1.03s/it]
 26%|██▌       | 110/424 [01:03<06:13,  1.19s/it]
 26%|██▌       | 111/424 [01:04<05:17,  1.01s/it]
 26%|██▋       | 112/424 [01:04<04:01,  1.29it/s]
 27%|██▋       | 114/424 [01:04<02:23,  2.16it/s]
 27%|██▋       | 116/424 [01:04<01:40,  3.07it/s]
 28%|██▊       | 118/424 [01:04<01:18,  3.88it/s]
 28%|██▊       | 119/424 [01:05<01:14,  4.10it/s]
 29%|██▊       | 121/424 [01:05<01:01,  4.96it/s]
 29%|██▉       | 122/424 [01:11<07:44,  1.54s/it]
 29%|██▉       | 123/424 [01:18<13:46,  2.74s/it]
 29%|██▉       | 124/424 [01:25<18:46,  3.75s/it]
 29%|██▉       | 125/424 [01:32<22:40,  4.55s/it]
 30%|██▉       | 126/424 [01:39<25:44,  5.18s/it]
 30%|██▉       | 127/424 [01:46<27:57,  5.65s/it]
 30%|███       | 128/424 [01:47<21:17,  4.32s/it]
 30%|███       | 129/424 [01:48<16:22,  3.33s/it]
 31%|███       | 130/424 [01:48<12:51,  2.62s/it]
 31%|███       | 131/424 [01:49<10:24,  2.13s/it]
 31%|███       | 132/424 [01:50<07:58,  1.64s/it]
 31%|███▏      | 133/424 [01:51<06:32,  1.35s/it]
 32%|███▏      | 134/424 [01:51<04:44,  1.02it/s]
 32%|███▏      | 135/424 [01:51<03:34,  1.35it/s]
 32%|███▏      | 136/424 [01:51<02:45,  1.74it/s]
 32%|███▏      | 137/424 [01:51<02:11,  2.18it/s]
 33%|███▎      | 138/424 [01:51<01:46,  2.68it/s]
 33%|███▎      | 139/424 [01:52<01:29,  3.18it/s]
 33%|███▎      | 140/424 [01:52<01:12,  3.93it/s]
 33%|███▎      | 141/424 [01:52<01:05,  4.34it/s]
 33%|███▎      | 142/424 [01:52<01:01,  4.60it/s]
 34%|███▎      | 143/424 [01:52<00:58,  4.82it/s]
 34%|███▍      | 144/424 [01:52<00:56,  4.98it/s]
 34%|███▍      | 145/424 [01:53<00:53,  5.23it/s]
 34%|███▍      | 146/424 [01:53<00:51,  5.37it/s]
 35%|███▍      | 147/424 [01:53<00:51,  5.42it/s]
 35%|███▍      | 148/424 [01:53<00:50,  5.45it/s]
 35%|███▌      | 149/424 [01:53<00:50,  5.48it/s]
 35%|███▌      | 150/424 [01:53<00:50,  5.47it/s]
 36%|███▌      | 151/424 [01:54<00:50,  5.44it/s]
 36%|███▌      | 152/424 [01:54<00:49,  5.49it/s]
 36%|███▌      | 153/424 [01:54<00:49,  5.49it/s]
 36%|███▋      | 154/424 [01:54<00:48,  5.52it/s]
 37%|███▋      | 155/424 [01:54<00:48,  5.53it/s]
 37%|███▋      | 156/424 [01:55<00:48,  5.53it/s]
 37%|███▋      | 157/424 [01:55<00:48,  5.51it/s]
 37%|███▋      | 158/424 [01:55<00:48,  5.50it/s]
 38%|███▊      | 159/424 [01:55<00:48,  5.48it/s]
 38%|███▊      | 160/424 [01:57<02:58,  1.48it/s]
 38%|███▊      | 161/424 [01:57<02:18,  1.89it/s]
 38%|███▊      | 162/424 [01:57<01:51,  2.35it/s]
 38%|███▊      | 163/424 [01:58<01:31,  2.85it/s]
 39%|███▊      | 164/424 [01:58<01:18,  3.31it/s]
 39%|███▉      | 165/424 [01:58<01:08,  3.78it/s]
 39%|███▉      | 166/424 [01:58<00:56,  4.53it/s]
 39%|███▉      | 167/424 [01:58<00:54,  4.74it/s]
 40%|███▉      | 168/424 [01:58<01:01,  4.16it/s]
 40%|███▉      | 169/424 [01:59<01:08,  3.71it/s]
 40%|████      | 170/424 [01:59<01:11,  3.54it/s]
 40%|████      | 171/424 [02:00<01:22,  3.08it/s]
 41%|████      | 172/424 [02:00<01:06,  3.78it/s]
 41%|████      | 174/424 [02:01<01:27,  2.85it/s]
 41%|████▏     | 175/424 [02:01<01:12,  3.43it/s]
 42%|████▏     | 176/424 [02:01<01:03,  3.91it/s]
 42%|████▏     | 177/424 [02:01<00:56,  4.37it/s]
 42%|████▏     | 178/424 [02:01<01:00,  4.05it/s]
 42%|████▏     | 179/424 [02:02<00:59,  4.11it/s]
 42%|████▏     | 180/424 [02:02<01:09,  3.51it/s]
 43%|████▎     | 181/424 [02:02<00:59,  4.08it/s]
 43%|████▎     | 182/424 [02:02<00:57,  4.22it/s]
 43%|████▎     | 183/424 [02:03<00:56,  4.28it/s]
 43%|████▎     | 184/424 [02:03<01:17,  3.09it/s]
 44%|████▎     | 185/424 [02:04<01:38,  2.43it/s]
 44%|████▍     | 186/424 [02:04<01:42,  2.33it/s]
 44%|████▍     | 187/424 [02:04<01:36,  2.45it/s]
 44%|████▍     | 188/424 [02:05<01:35,  2.48it/s]
 45%|████▍     | 189/424 [02:06<02:58,  1.32it/s]
 45%|████▍     | 190/424 [02:11<06:54,  1.77s/it]
 45%|████▌     | 191/424 [02:11<05:14,  1.35s/it]
 45%|████▌     | 192/424 [02:13<05:35,  1.45s/it]
 46%|████▌     | 194/424 [02:13<03:23,  1.13it/s]
 46%|████▌     | 196/424 [02:14<02:29,  1.53it/s]
 46%|████▋     | 197/424 [02:14<02:09,  1.76it/s]
 47%|████▋     | 198/424 [02:14<01:48,  2.08it/s]
 47%|████▋     | 199/424 [02:15<02:04,  1.81it/s]
 47%|████▋     | 200/424 [02:15<01:42,  2.19it/s]
 47%|████▋     | 201/424 [02:17<02:54,  1.28it/s]
 48%|████▊     | 202/424 [02:17<02:15,  1.63it/s]
 48%|████▊     | 203/424 [02:19<03:22,  1.09it/s]
 48%|████▊     | 204/424 [02:22<05:44,  1.57s/it]
 48%|████▊     | 205/424 [02:22<04:36,  1.26s/it]
 49%|████▊     | 206/424 [02:25<06:31,  1.80s/it]
 49%|████▉     | 207/424 [02:26<04:51,  1.35s/it]
 49%|████▉     | 208/424 [02:26<03:44,  1.04s/it]
 49%|████▉     | 209/424 [02:26<02:48,  1.27it/s]
 50%|████▉     | 210/424 [02:26<02:17,  1.56it/s]
 50%|█████     | 212/424 [02:27<01:21,  2.60it/s]
 50%|█████     | 213/424 [02:27<01:28,  2.37it/s]
 50%|█████     | 214/424 [02:28<01:35,  2.19it/s]
 51%|█████     | 215/424 [02:29<01:56,  1.79it/s]
 51%|█████     | 216/424 [02:29<01:33,  2.23it/s]
 51%|█████     | 217/424 [02:29<01:18,  2.64it/s]
 51%|█████▏    | 218/424 [02:29<01:12,  2.86it/s]
 52%|█████▏    | 219/424 [02:29<01:06,  3.08it/s]
 52%|█████▏    | 220/424 [02:30<01:37,  2.10it/s]
 52%|█████▏    | 221/424 [02:31<01:26,  2.34it/s]
 52%|█████▏    | 222/424 [02:31<01:19,  2.55it/s]
 53%|█████▎    | 223/424 [02:31<01:11,  2.80it/s]
 53%|█████▎    | 224/424 [02:32<01:08,  2.93it/s]
 53%|█████▎    | 225/424 [02:33<02:21,  1.40it/s]
 54%|█████▎    | 227/424 [02:33<01:32,  2.14it/s]
 54%|█████▍    | 229/424 [02:34<01:02,  3.11it/s]
 54%|█████▍    | 230/424 [02:37<03:05,  1.05it/s]
 54%|█████▍    | 231/424 [02:37<02:44,  1.17it/s]
 55%|█████▍    | 232/424 [02:37<02:06,  1.51it/s]
 55%|█████▍    | 233/424 [02:39<02:57,  1.08it/s]
 55%|█████▌    | 234/424 [02:46<08:12,  2.59s/it]
 55%|█████▌    | 235/424 [02:47<06:35,  2.09s/it]
 56%|█████▌    | 236/424 [02:47<04:59,  1.59s/it]
 56%|█████▌    | 238/424 [02:47<02:48,  1.10it/s]
 57%|█████▋    | 240/424 [02:49<02:44,  1.12it/s]
 57%|█████▋    | 241/424 [02:50<02:40,  1.14it/s]
 57%|█████▋    | 242/424 [02:50<02:07,  1.43it/s]
 57%|█████▋    | 243/424 [02:50<01:52,  1.61it/s]
 58%|█████▊    | 244/424 [02:51<01:53,  1.58it/s]
 58%|█████▊    | 245/424 [02:51<01:27,  2.04it/s]
 58%|█████▊    | 246/424 [02:52<01:18,  2.27it/s]
 58%|█████▊    | 247/424 [02:53<02:19,  1.27it/s]
 58%|█████▊    | 248/424 [02:53<01:44,  1.69it/s]
 59%|█████▊    | 249/424 [02:53<01:18,  2.22it/s]
 59%|█████▉    | 250/424 [02:54<01:28,  1.96it/s]
 59%|█████▉    | 251/424 [02:54<01:10,  2.44it/s]
 59%|█████▉    | 252/424 [02:54<00:55,  3.11it/s]
 60%|█████▉    | 253/424 [02:55<00:44,  3.88it/s]
 60%|█████▉    | 254/424 [02:55<00:36,  4.67it/s]
 60%|██████    | 255/424 [02:55<00:30,  5.49it/s]
 60%|██████    | 256/424 [02:55<00:27,  6.18it/s]
 61%|██████    | 257/424 [02:55<00:24,  6.89it/s]
 61%|██████    | 258/424 [02:55<00:22,  7.37it/s]
 61%|██████    | 259/424 [02:55<00:29,  5.54it/s]
 61%|██████▏   | 260/424 [02:56<01:07,  2.42it/s]
 62%|██████▏   | 261/424 [02:56<00:52,  3.12it/s]
 62%|██████▏   | 263/424 [02:57<01:05,  2.45it/s]
 62%|██████▏   | 264/424 [02:58<00:53,  2.99it/s]
 63%|██████▎   | 266/424 [02:58<00:46,  3.40it/s]
 63%|██████▎   | 267/424 [02:58<00:39,  3.96it/s]
 63%|██████▎   | 268/424 [02:58<00:33,  4.61it/s]
 63%|██████▎   | 269/424 [02:59<00:58,  2.67it/s]
 64%|██████▎   | 270/424 [02:59<00:46,  3.31it/s]
 64%|██████▍   | 272/424 [02:59<00:30,  4.94it/s]
 64%|██████▍   | 273/424 [03:00<00:30,  4.98it/s]
 65%|██████▍   | 275/424 [03:00<00:21,  6.96it/s]
 65%|██████▌   | 277/424 [03:00<00:17,  8.27it/s]
 66%|██████▌   | 279/424 [03:01<00:40,  3.60it/s]
 66%|██████▌   | 280/424 [03:01<00:43,  3.30it/s]
 66%|██████▋   | 281/424 [03:02<00:46,  3.09it/s]
 67%|██████▋   | 283/424 [03:05<01:55,  1.22it/s]
 67%|██████▋   | 284/424 [03:05<01:33,  1.49it/s]
 67%|██████▋   | 285/424 [03:05<01:14,  1.86it/s]
 68%|██████▊   | 287/424 [03:06<00:56,  2.44it/s]
 68%|██████▊   | 288/424 [03:06<00:53,  2.53it/s]
 68%|██████▊   | 289/424 [03:06<00:49,  2.71it/s]
 69%|██████▊   | 291/424 [03:07<00:36,  3.67it/s]
 69%|██████▉   | 292/424 [03:07<00:30,  4.27it/s]
 69%|██████▉   | 293/424 [03:10<02:05,  1.04it/s]
 70%|██████▉   | 295/424 [03:11<01:36,  1.34it/s]
 70%|██████▉   | 296/424 [03:11<01:17,  1.66it/s]
 70%|███████   | 297/424 [03:11<01:09,  1.82it/s]
 70%|███████   | 298/424 [03:11<00:59,  2.13it/s]
 71%|███████   | 299/424 [03:12<00:48,  2.56it/s]
 71%|███████   | 301/424 [03:12<00:35,  3.45it/s]
 71%|███████   | 302/424 [03:19<03:45,  1.85s/it]
 71%|███████▏  | 303/424 [03:19<02:58,  1.48s/it]
 72%|███████▏  | 304/424 [03:19<02:15,  1.13s/it]
 72%|███████▏  | 305/424 [03:20<01:48,  1.10it/s]
 72%|███████▏  | 306/424 [03:20<01:30,  1.30it/s]
 72%|███████▏  | 307/424 [03:20<01:07,  1.73it/s]
 73%|███████▎  | 308/424 [03:20<00:55,  2.07it/s]
 73%|███████▎  | 309/424 [03:21<00:57,  2.01it/s]
 73%|███████▎  | 310/424 [03:22<01:13,  1.55it/s]
 74%|███████▎  | 312/424 [03:22<00:45,  2.46it/s]
 74%|███████▍  | 313/424 [03:22<00:40,  2.77it/s]
 74%|███████▍  | 314/424 [03:23<00:41,  2.68it/s]
 74%|███████▍  | 315/424 [03:24<01:07,  1.62it/s]
 75%|███████▍  | 316/424 [03:24<00:51,  2.10it/s]
 75%|███████▍  | 317/424 [03:26<01:17,  1.38it/s]
 75%|███████▌  | 318/424 [03:27<01:35,  1.11it/s]
 75%|███████▌  | 319/424 [03:27<01:17,  1.36it/s]
 75%|███████▌  | 320/424 [03:27<00:59,  1.74it/s]
 76%|███████▌  | 322/424 [03:28<00:35,  2.86it/s]
 76%|███████▌  | 323/424 [03:28<00:31,  3.23it/s]
 76%|███████▋  | 324/424 [03:28<00:27,  3.67it/s]
 77%|███████▋  | 325/424 [03:28<00:24,  4.05it/s]
 77%|███████▋  | 326/424 [03:35<03:23,  2.08s/it]
 77%|███████▋  | 327/424 [03:36<03:00,  1.87s/it]
 77%|███████▋  | 328/424 [03:37<02:29,  1.55s/it]
 78%|███████▊  | 329/424 [03:38<01:55,  1.22s/it]
 78%|███████▊  | 330/424 [03:39<01:57,  1.25s/it]
 78%|███████▊  | 331/424 [03:39<01:25,  1.09it/s]
 79%|███████▊  | 333/424 [03:40<01:17,  1.18it/s]
 79%|███████▉  | 334/424 [03:41<01:06,  1.36it/s]
 79%|███████▉  | 335/424 [03:42<01:02,  1.41it/s]
 79%|███████▉  | 336/424 [03:43<01:32,  1.05s/it]
 79%|███████▉  | 337/424 [03:50<03:50,  2.65s/it]
 80%|███████▉  | 338/424 [03:51<02:54,  2.02s/it]
 80%|███████▉  | 339/424 [03:52<02:24,  1.71s/it]
 80%|████████  | 340/424 [03:58<04:29,  3.20s/it]
 80%|████████  | 341/424 [04:00<03:48,  2.75s/it]
 81%|████████  | 342/424 [04:02<03:18,  2.43s/it]
 81%|████████  | 343/424 [04:02<02:21,  1.75s/it]
 81%|████████  | 344/424 [04:03<01:55,  1.44s/it]
 81%|████████▏ | 345/424 [04:03<01:22,  1.05s/it]
 82%|████████▏ | 346/424 [04:03<01:06,  1.17it/s]
 82%|████████▏ | 347/424 [04:04<01:02,  1.22it/s]
 83%|████████▎ | 350/424 [04:05<00:38,  1.91it/s]
 83%|████████▎ | 352/424 [04:12<01:49,  1.53s/it]
 83%|████████▎ | 353/424 [04:12<01:34,  1.33s/it]
 83%|████████▎ | 354/424 [04:13<01:27,  1.25s/it]
 84%|████████▎ | 355/424 [04:13<01:08,  1.01it/s]
 84%|████████▍ | 356/424 [04:15<01:18,  1.16s/it]
 84%|████████▍ | 357/424 [04:16<01:13,  1.10s/it]
 84%|████████▍ | 358/424 [04:17<01:11,  1.08s/it]
 85%|████████▍ | 359/424 [04:18<01:09,  1.07s/it]
 85%|████████▍ | 360/424 [04:18<00:52,  1.21it/s]
 85%|████████▌ | 361/424 [04:18<00:40,  1.55it/s]
 85%|████████▌ | 362/424 [04:19<00:34,  1.78it/s]
 86%|████████▌ | 363/424 [04:25<02:25,  2.38s/it]
 86%|████████▌ | 364/424 [04:26<01:47,  1.79s/it]
 86%|████████▌ | 365/424 [04:26<01:17,  1.32s/it]
 86%|████████▋ | 366/424 [04:26<00:55,  1.05it/s]
 87%|████████▋ | 367/424 [04:26<00:39,  1.43it/s]
 87%|████████▋ | 368/424 [04:33<02:22,  2.55s/it]
 87%|████████▋ | 369/424 [04:33<01:43,  1.88s/it]
 87%|████████▋ | 370/424 [04:34<01:13,  1.35s/it]
 88%|████████▊ | 372/424 [04:34<00:40,  1.29it/s]
 88%|████████▊ | 373/424 [04:34<00:32,  1.57it/s]
 88%|████████▊ | 374/424 [04:35<00:36,  1.38it/s]
 89%|████████▊ | 376/424 [04:36<00:27,  1.73it/s]
 89%|████████▉ | 377/424 [04:37<00:34,  1.34it/s]
 89%|████████▉ | 378/424 [04:37<00:27,  1.68it/s]
 89%|████████▉ | 379/424 [04:38<00:26,  1.70it/s]
 90%|████████▉ | 380/424 [04:39<00:37,  1.17it/s]
 90%|█████████ | 382/424 [04:41<00:33,  1.26it/s]
 91%|█████████ | 384/424 [04:41<00:21,  1.84it/s]
 91%|█████████ | 385/424 [04:41<00:18,  2.13it/s]
 91%|█████████▏| 387/424 [04:41<00:11,  3.21it/s]
 92%|█████████▏| 388/424 [04:42<00:13,  2.68it/s]
 92%|█████████▏| 389/424 [04:46<00:44,  1.28s/it]
 92%|█████████▏| 390/424 [04:46<00:34,  1.01s/it]
 92%|█████████▏| 391/424 [04:46<00:25,  1.28it/s]
 92%|█████████▏| 392/424 [04:47<00:19,  1.67it/s]
 93%|█████████▎| 393/424 [04:47<00:19,  1.59it/s]
 93%|█████████▎| 394/424 [04:48<00:19,  1.56it/s]
 93%|█████████▎| 395/424 [04:50<00:27,  1.06it/s]
 93%|█████████▎| 396/424 [04:51<00:26,  1.04it/s]
 94%|█████████▎| 397/424 [04:52<00:28,  1.06s/it]
 94%|█████████▍| 398/424 [04:53<00:29,  1.12s/it]
 94%|█████████▍| 399/424 [04:54<00:22,  1.11it/s]
 94%|█████████▍| 400/424 [04:54<00:19,  1.23it/s]
 95%|█████████▍| 401/424 [04:54<00:14,  1.56it/s]
 95%|█████████▍| 402/424 [04:58<00:30,  1.41s/it]
 95%|█████████▌| 403/424 [05:00<00:36,  1.76s/it]
 95%|█████████▌| 404/424 [05:00<00:25,  1.29s/it]
 96%|█████████▌| 405/424 [05:01<00:19,  1.03s/it]
 96%|█████████▌| 406/424 [05:01<00:13,  1.32it/s]
 96%|█████████▌| 407/424 [05:02<00:15,  1.09it/s]
 96%|█████████▌| 408/424 [05:03<00:15,  1.06it/s]
 96%|█████████▋| 409/424 [05:06<00:21,  1.44s/it]
 97%|█████████▋| 410/424 [05:06<00:15,  1.11s/it]
 97%|█████████▋| 411/424 [05:07<00:13,  1.05s/it]
 97%|█████████▋| 412/424 [05:07<00:09,  1.28it/s]
 97%|█████████▋| 413/424 [05:09<00:11,  1.04s/it]
 98%|█████████▊| 415/424 [05:10<00:08,  1.09it/s]
 98%|█████████▊| 416/424 [05:11<00:06,  1.17it/s]
 98%|█████████▊| 417/424 [05:12<00:05,  1.26it/s]
 99%|█████████▊| 418/424 [05:16<00:10,  1.72s/it]
 99%|█████████▉| 419/424 [05:17<00:07,  1.42s/it]
 99%|█████████▉| 420/424 [05:18<00:05,  1.48s/it]
 99%|█████████▉| 421/424 [05:19<00:04,  1.33s/it]
100%|█████████▉| 422/424 [05:19<00:01,  1.01it/s]
100%|█████████▉| 423/424 [05:23<00:01,  1.91s/it]
100%|██████████| 424/424 [05:24<00:00,  1.64s/it]
100%|██████████| 424/424 [05:24<00:00,  1.30it/s]
	Running baseline: ['python', 'baselines.py', '--model_addr', 'Qwen/Qwen2.5-7B-Instruct', '--inputs_addr', 'data/processed/TEMP_2025-07-15 12:24:03.103426_sc_processed_test.json', '--output_addr', 'data/out/rag/full_profile/sc_rag_full_profile_test_10_limit_6_output.json', '--temperature', '0.1', '--top_p', '0.95', '--max_tokens', '8192', '--num_generated_outputs', '1', '--num_contexts', '10', '--max_retries', '10', '--cache_dir', '/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', '--rag']

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 1 examples [00:00,  7.69 examples/s]
Generating train split: 424 examples [00:00, 1534.40 examples/s]
INFO 07-15 12:29:53 config.py:510] This model supports multiple tasks: {'generate', 'score', 'classify', 'reward', 'embed'}. Defaulting to 'generate'.
INFO 07-15 12:29:53 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-7B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-7B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scratch3/workspace/oyilmazel_umass_edu-lampqa_cache/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-7B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 07-15 12:29:54 selector.py:120] Using Flash Attention backend.
INFO 07-15 12:29:55 model_runner.py:1094] Starting to load model Qwen/Qwen2.5-7B-Instruct...
INFO 07-15 12:29:55 weight_utils.py:251] Using model weights format ['*.safetensors']

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.52it/s]

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.42it/s]

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.46it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.44it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]

INFO 07-15 12:29:58 model_runner.py:1099] Loading model weights took 14.2487 GB
INFO 07-15 12:30:01 worker.py:241] Memory profiling takes 2.07 seconds
INFO 07-15 12:30:01 worker.py:241] the current vLLM instance can use total_gpu_memory (79.25GiB) x gpu_memory_utilization (0.90) = 71.33GiB
INFO 07-15 12:30:01 worker.py:241] model weights take 14.25GiB; non_torch_memory takes 0.14GiB; PyTorch activation peak memory takes 4.35GiB; the rest of the memory reserved for KV Cache is 52.59GiB.
INFO 07-15 12:30:01 gpu_executor.py:76] # GPU blocks: 61542, # CPU blocks: 4681
INFO 07-15 12:30:01 gpu_executor.py:80] Maximum concurrency for 32768 tokens per request: 30.05x
INFO 07-15 12:30:04 model_runner.py:1415] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:10,  3.15it/s]
Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:00<00:09,  3.47it/s]
Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:00<00:08,  3.58it/s]
Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:08,  3.60it/s]
Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:01<00:08,  3.62it/s]
Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:01<00:07,  3.64it/s]
Capturing CUDA graph shapes:  20%|██        | 7/35 [00:01<00:07,  3.68it/s]
Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:02<00:07,  3.70it/s]
Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:02<00:07,  3.70it/s]
Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:02<00:06,  3.72it/s]
Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:03<00:06,  3.73it/s]
Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:03<00:06,  3.75it/s]
Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:03<00:05,  3.76it/s]
Capturing CUDA graph shapes:  40%|████      | 14/35 [00:03<00:05,  3.77it/s]
Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:04<00:05,  3.77it/s]
Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:04<00:05,  3.77it/s]
Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:04<00:04,  3.82it/s]
Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:04<00:04,  3.86it/s]
Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:05<00:04,  3.88it/s]
Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:05<00:03,  3.90it/s]
Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:05<00:03,  3.93it/s]
Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:05<00:03,  3.94it/s]
Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:06<00:03,  3.95it/s]
Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:06<00:02,  3.96it/s]
Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:06<00:02,  3.97it/s]
Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:06<00:02,  3.98it/s]
Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:07<00:02,  3.95it/s]
Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:07<00:01,  3.90it/s]
Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:07<00:01,  3.95it/s]
Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:07<00:01,  3.98it/s]
Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:08<00:01,  3.98it/s]
Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:08<00:00,  4.00it/s]
Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:08<00:00,  3.94it/s]
Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:08<00:00,  3.98it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.99it/s]
Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:09<00:00,  3.84it/s]
INFO 07-15 12:30:13 model_runner.py:1535] Graph capturing finished in 9 secs, took 0.22 GiB
INFO 07-15 12:30:13 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 14.19 seconds
None

Processed prompts:   0%|          | 0/424 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 1/424 [00:36<4:18:11, 36.62s/it, est. speed input: 47.73 toks/s, output: 1.83 toks/s]
Processed prompts:   0%|          | 2/424 [00:38<1:55:20, 16.40s/it, est. speed input: 148.07 toks/s, output: 4.30 toks/s]
Processed prompts:   1%|          | 3/424 [00:39<1:03:17,  9.02s/it, est. speed input: 208.50 toks/s, output: 6.88 toks/s]
Processed prompts:   1%|          | 5/424 [00:39<28:11,  4.04s/it, est. speed input: 288.87 toks/s, output: 12.06 toks/s] 
Processed prompts:   2%|▏         | 7/424 [00:40<16:15,  2.34s/it, est. speed input: 373.11 toks/s, output: 17.31 toks/s]
Processed prompts:   2%|▏         | 8/424 [00:40<12:44,  1.84s/it, est. speed input: 430.04 toks/s, output: 19.98 toks/s]
Processed prompts:   2%|▏         | 9/424 [00:40<09:52,  1.43s/it, est. speed input: 469.69 toks/s, output: 22.68 toks/s]
Processed prompts:   2%|▏         | 10/424 [00:40<07:45,  1.12s/it, est. speed input: 534.23 toks/s, output: 25.38 toks/s]
Processed prompts:   3%|▎         | 13/424 [00:41<04:15,  1.61it/s, est. speed input: 677.74 toks/s, output: 33.61 toks/s]
Processed prompts:   4%|▎         | 15/424 [00:41<03:08,  2.17it/s, est. speed input: 824.99 toks/s, output: 39.23 toks/s]
Processed prompts:   4%|▍         | 19/424 [00:42<02:09,  3.13it/s, est. speed input: 964.60 toks/s, output: 50.25 toks/s]
Processed prompts:   5%|▍         | 21/424 [00:42<01:49,  3.68it/s, est. speed input: 1016.37 toks/s, output: 55.82 toks/s]
Processed prompts:   5%|▌         | 22/424 [00:42<01:47,  3.72it/s, est. speed input: 1082.88 toks/s, output: 58.45 toks/s]
Processed prompts:   6%|▌         | 24/424 [00:43<01:35,  4.19it/s, est. speed input: 1310.13 toks/s, output: 63.91 toks/s]
Processed prompts:   6%|▌         | 26/424 [00:43<01:28,  4.47it/s, est. speed input: 1394.49 toks/s, output: 69.32 toks/s]
Processed prompts:   7%|▋         | 30/424 [00:44<01:07,  5.88it/s, est. speed input: 1531.20 toks/s, output: 80.55 toks/s]
Processed prompts:   7%|▋         | 31/424 [00:44<01:08,  5.73it/s, est. speed input: 1555.06 toks/s, output: 83.19 toks/s]
Processed prompts:   8%|▊         | 33/424 [00:44<01:07,  5.80it/s, est. speed input: 1622.34 toks/s, output: 88.55 toks/s]
Processed prompts:   9%|▊         | 37/424 [00:45<01:08,  5.66it/s, est. speed input: 1797.63 toks/s, output: 98.98 toks/s]
Processed prompts:   9%|▉         | 39/424 [00:45<01:00,  6.37it/s, est. speed input: 1859.97 toks/s, output: 104.52 toks/s]
Processed prompts:   9%|▉         | 40/424 [00:45<01:07,  5.65it/s, est. speed input: 1904.35 toks/s, output: 106.85 toks/s]
Processed prompts:  10%|█         | 44/424 [00:46<01:01,  6.16it/s, est. speed input: 2025.36 toks/s, output: 117.35 toks/s]
Processed prompts:  11%|█         | 45/424 [00:46<01:03,  5.93it/s, est. speed input: 2054.80 toks/s, output: 119.81 toks/s]
Processed prompts:  11%|█▏        | 48/424 [00:47<01:01,  6.09it/s, est. speed input: 2229.83 toks/s, output: 127.49 toks/s]
Processed prompts:  12%|█▏        | 49/424 [00:47<01:09,  5.43it/s, est. speed input: 2275.12 toks/s, output: 129.68 toks/s]
Processed prompts:  12%|█▏        | 52/424 [00:47<01:00,  6.18it/s, est. speed input: 2374.94 toks/s, output: 137.52 toks/s]
Processed prompts:  13%|█▎        | 54/424 [00:48<01:02,  5.91it/s, est. speed input: 2418.03 toks/s, output: 142.36 toks/s]
Processed prompts:  13%|█▎        | 56/424 [00:48<00:54,  6.70it/s, est. speed input: 2475.38 toks/s, output: 147.73 toks/s]
Processed prompts:  14%|█▍        | 60/424 [00:48<00:54,  6.69it/s, est. speed input: 2587.59 toks/s, output: 157.72 toks/s]
Processed prompts:  15%|█▌        | 64/424 [00:49<00:53,  6.74it/s, est. speed input: 2698.03 toks/s, output: 167.59 toks/s]
Processed prompts:  15%|█▌        | 65/424 [00:49<00:56,  6.31it/s, est. speed input: 2720.68 toks/s, output: 169.76 toks/s]
Processed prompts:  16%|█▌        | 68/424 [00:50<00:57,  6.16it/s, est. speed input: 2859.35 toks/s, output: 176.84 toks/s]
Processed prompts:  17%|█▋        | 70/424 [00:50<00:59,  5.97it/s, est. speed input: 3011.33 toks/s, output: 181.43 toks/s]
Processed prompts:  17%|█▋        | 71/424 [00:50<00:57,  6.11it/s, est. speed input: 3044.45 toks/s, output: 183.88 toks/s]
Processed prompts:  17%|█▋        | 73/424 [00:51<01:04,  5.48it/s, est. speed input: 3080.03 toks/s, output: 188.15 toks/s]
Processed prompts:  18%|█▊        | 76/424 [00:51<00:57,  6.02it/s, est. speed input: 3183.43 toks/s, output: 195.53 toks/s]
Processed prompts:  18%|█▊        | 77/424 [00:51<00:54,  6.39it/s, est. speed input: 3227.47 toks/s, output: 198.13 toks/s]
Processed prompts:  20%|█▉        | 84/424 [00:52<00:51,  6.61it/s, est. speed input: 3501.67 toks/s, output: 214.83 toks/s]
Processed prompts:  21%|██▏       | 91/424 [00:53<00:49,  6.78it/s, est. speed input: 3742.33 toks/s, output: 231.15 toks/s]
Processed prompts:  22%|██▏       | 95/424 [00:54<00:49,  6.60it/s, est. speed input: 3898.85 toks/s, output: 239.96 toks/s]
Processed prompts:  23%|██▎       | 99/424 [00:54<00:43,  7.39it/s, est. speed input: 4078.79 toks/s, output: 249.87 toks/s]
Processed prompts:  24%|██▍       | 102/424 [00:55<00:48,  6.65it/s, est. speed input: 4184.34 toks/s, output: 255.78 toks/s]
Processed prompts:  26%|██▌       | 109/424 [00:56<00:46,  6.82it/s, est. speed input: 4368.35 toks/s, output: 271.17 toks/s]
Processed prompts:  26%|██▋       | 112/424 [00:56<00:43,  7.15it/s, est. speed input: 4435.63 toks/s, output: 278.06 toks/s]
Processed prompts:  28%|██▊       | 117/424 [00:57<00:37,  8.21it/s, est. speed input: 4608.87 toks/s, output: 290.16 toks/s]
Processed prompts:  28%|██▊       | 119/424 [00:57<00:40,  7.58it/s, est. speed input: 4642.89 toks/s, output: 293.99 toks/s]
Processed prompts:  29%|██▊       | 121/424 [00:57<00:39,  7.62it/s, est. speed input: 4692.49 toks/s, output: 298.37 toks/s]
Processed prompts:  29%|██▉       | 123/424 [00:58<00:43,  6.98it/s, est. speed input: 4760.98 toks/s, output: 302.13 toks/s]
Processed prompts:  29%|██▉       | 125/424 [00:58<00:41,  7.15it/s, est. speed input: 4808.68 toks/s, output: 306.50 toks/s]
Processed prompts:  30%|███       | 129/424 [00:58<00:39,  7.42it/s, est. speed input: 4925.46 toks/s, output: 315.21 toks/s]
Processed prompts:  31%|███       | 131/424 [00:59<00:38,  7.56it/s, est. speed input: 4962.44 toks/s, output: 319.59 toks/s]
Processed prompts:  32%|███▏      | 134/424 [00:59<00:43,  6.63it/s, est. speed input: 5013.34 toks/s, output: 325.04 toks/s]
Processed prompts:  32%|███▏      | 136/424 [00:59<00:41,  6.93it/s, est. speed input: 5076.87 toks/s, output: 329.40 toks/s]
Processed prompts:  33%|███▎      | 140/424 [01:01<00:54,  5.19it/s, est. speed input: 5115.96 toks/s, output: 334.90 toks/s]
Processed prompts:  33%|███▎      | 142/424 [01:01<00:51,  5.44it/s, est. speed input: 5136.42 toks/s, output: 338.86 toks/s]
Processed prompts:  34%|███▍      | 144/424 [01:01<00:55,  5.06it/s, est. speed input: 5150.78 toks/s, output: 341.82 toks/s]
Processed prompts:  34%|███▍      | 146/424 [01:02<00:49,  5.65it/s, est. speed input: 5198.94 toks/s, output: 346.16 toks/s]
Processed prompts:  35%|███▌      | 149/424 [01:02<00:47,  5.75it/s, est. speed input: 5279.89 toks/s, output: 351.78 toks/s]
Processed prompts:  36%|███▌      | 152/424 [01:02<00:41,  6.49it/s, est. speed input: 5375.76 toks/s, output: 358.26 toks/s]
Processed prompts:  37%|███▋      | 155/424 [01:03<00:46,  5.77it/s, est. speed input: 5452.64 toks/s, output: 363.02 toks/s]
Processed prompts:  37%|███▋      | 158/424 [01:03<00:43,  6.16it/s, est. speed input: 5516.60 toks/s, output: 369.03 toks/s]
Processed prompts:  38%|███▊      | 160/424 [01:04<00:48,  5.45it/s, est. speed input: 5548.96 toks/s, output: 371.69 toks/s]
Processed prompts:  39%|███▊      | 164/424 [01:04<00:42,  6.17it/s, est. speed input: 5659.87 toks/s, output: 379.82 toks/s]
Processed prompts:  39%|███▉      | 167/424 [01:05<00:45,  5.69it/s, est. speed input: 5689.18 toks/s, output: 384.51 toks/s]
Processed prompts:  41%|████▏     | 175/424 [01:05<00:24, 10.05it/s, est. speed input: 6077.81 toks/s, output: 405.10 toks/s]
Processed prompts:  42%|████▏     | 178/424 [01:06<00:21, 11.50it/s, est. speed input: 6147.41 toks/s, output: 412.64 toks/s]
Processed prompts:  43%|████▎     | 183/424 [01:06<00:15, 15.24it/s, est. speed input: 6282.49 toks/s, output: 425.84 toks/s]
Processed prompts:  44%|████▍     | 186/424 [01:06<00:15, 15.38it/s, est. speed input: 6327.91 toks/s, output: 433.13 toks/s]
Processed prompts:  45%|████▍     | 190/424 [01:06<00:12, 18.26it/s, est. speed input: 6454.63 toks/s, output: 443.76 toks/s]
Processed prompts:  46%|████▌     | 196/424 [01:06<00:09, 24.23it/s, est. speed input: 6647.57 toks/s, output: 460.24 toks/s]
Processed prompts:  47%|████▋     | 200/424 [01:06<00:08, 26.12it/s, est. speed input: 6747.69 toks/s, output: 471.02 toks/s]
Processed prompts:  48%|████▊     | 204/424 [01:06<00:07, 27.78it/s, est. speed input: 6857.25 toks/s, output: 481.91 toks/s]
Processed prompts:  49%|████▉     | 208/424 [01:06<00:08, 26.01it/s, est. speed input: 6946.98 toks/s, output: 492.51 toks/s]
Processed prompts:  50%|████▉     | 211/424 [01:07<00:08, 26.12it/s, est. speed input: 7034.65 toks/s, output: 500.68 toks/s]
Processed prompts:  51%|█████     | 216/424 [01:07<00:06, 30.74it/s, est. speed input: 7161.01 toks/s, output: 514.92 toks/s]
Processed prompts:  53%|█████▎    | 224/424 [01:07<00:04, 41.63it/s, est. speed input: 7364.67 toks/s, output: 538.39 toks/s]
Processed prompts:  54%|█████▍    | 229/424 [01:07<00:08, 22.36it/s, est. speed input: 7495.29 toks/s, output: 549.98 toks/s]
Processed prompts:  55%|█████▍    | 233/424 [01:08<00:08, 21.38it/s, est. speed input: 7650.01 toks/s, output: 561.06 toks/s]
Processed prompts:  56%|█████▌    | 237/424 [01:08<00:13, 13.97it/s, est. speed input: 7689.22 toks/s, output: 568.12 toks/s]
Processed prompts:  57%|█████▋    | 240/424 [01:09<00:19,  9.60it/s, est. speed input: 7717.72 toks/s, output: 571.93 toks/s]
Processed prompts:  57%|█████▋    | 242/424 [01:09<00:17, 10.52it/s, est. speed input: 7766.67 toks/s, output: 578.14 toks/s]
Processed prompts:  58%|█████▊    | 244/424 [01:09<00:15, 11.60it/s, est. speed input: 7806.54 toks/s, output: 582.35 toks/s]
Processed prompts:  58%|█████▊    | 246/424 [01:09<00:16, 10.54it/s, est. speed input: 7877.06 toks/s, output: 584.24 toks/s]
Processed prompts:  59%|█████▊    | 249/424 [01:09<00:14, 12.44it/s, est. speed input: 7928.18 toks/s, output: 590.09 toks/s]
Processed prompts:  60%|█████▉    | 254/424 [01:09<00:09, 17.16it/s, est. speed input: 8043.82 toks/s, output: 597.58 toks/s]
Processed prompts:  61%|██████    | 257/424 [01:10<00:12, 13.72it/s, est. speed input: 8080.71 toks/s, output: 602.20 toks/s]
Processed prompts:  61%|██████▏   | 260/424 [01:10<00:12, 13.38it/s, est. speed input: 8132.04 toks/s, output: 607.95 toks/s]
Processed prompts:  62%|██████▏   | 264/424 [01:10<00:09, 16.36it/s, est. speed input: 8215.24 toks/s, output: 614.57 toks/s]
Processed prompts:  63%|██████▎   | 267/424 [01:10<00:08, 17.46it/s, est. speed input: 8283.13 toks/s, output: 620.02 toks/s]
Processed prompts:  64%|██████▍   | 271/424 [01:10<00:07, 20.15it/s, est. speed input: 8378.17 toks/s, output: 626.65 toks/s]
Processed prompts:  65%|██████▍   | 274/424 [01:11<00:07, 20.53it/s, est. speed input: 8424.30 toks/s, output: 632.73 toks/s]
Processed prompts:  66%|██████▌   | 278/424 [01:11<00:06, 22.87it/s, est. speed input: 8555.29 toks/s, output: 639.59 toks/s]
Processed prompts:  67%|██████▋   | 282/424 [01:11<00:06, 22.72it/s, est. speed input: 8661.04 toks/s, output: 648.21 toks/s]
Processed prompts:  67%|██████▋   | 286/424 [01:11<00:05, 24.67it/s, est. speed input: 8787.07 toks/s, output: 655.62 toks/s]
Processed prompts:  68%|██████▊   | 289/424 [01:11<00:05, 24.16it/s, est. speed input: 8859.49 toks/s, output: 660.55 toks/s]
Processed prompts:  69%|██████▉   | 292/424 [01:11<00:05, 23.89it/s, est. speed input: 8918.63 toks/s, output: 666.63 toks/s]
Processed prompts:  71%|███████   | 299/424 [01:11<00:03, 32.70it/s, est. speed input: 9121.64 toks/s, output: 680.69 toks/s]
Processed prompts:  72%|███████▏  | 306/424 [01:12<00:02, 40.14it/s, est. speed input: 9297.85 toks/s, output: 696.29 toks/s]
Processed prompts:  74%|███████▎  | 312/424 [01:12<00:02, 43.83it/s, est. speed input: 9430.23 toks/s, output: 708.11 toks/s]
Processed prompts:  75%|███████▌  | 320/424 [01:12<00:01, 52.07it/s, est. speed input: 9705.81 toks/s, output: 724.40 toks/s]
Processed prompts:  77%|███████▋  | 326/424 [01:12<00:02, 45.44it/s, est. speed input: 9838.39 toks/s, output: 735.41 toks/s]
Processed prompts:  78%|███████▊  | 331/424 [01:12<00:02, 43.00it/s, est. speed input: 10000.11 toks/s, output: 744.81 toks/s]
Processed prompts:  79%|███████▉  | 336/424 [01:12<00:02, 38.75it/s, est. speed input: 10117.25 toks/s, output: 753.58 toks/s]
Processed prompts:  82%|████████▏ | 347/424 [01:12<00:01, 48.84it/s, est. speed input: 10394.58 toks/s, output: 777.68 toks/s]
Processed prompts:  84%|████████▍ | 357/424 [01:13<00:01, 58.02it/s, est. speed input: 10729.21 toks/s, output: 800.03 toks/s]
Processed prompts:  86%|████████▌ | 365/424 [01:13<00:00, 61.70it/s, est. speed input: 11031.09 toks/s, output: 820.20 toks/s]
Processed prompts:  88%|████████▊ | 372/424 [01:13<00:00, 59.36it/s, est. speed input: 11249.60 toks/s, output: 835.54 toks/s]
Processed prompts:  90%|█████████ | 383/424 [01:13<00:00, 68.63it/s, est. speed input: 11671.72 toks/s, output: 868.53 toks/s]
Processed prompts:  92%|█████████▏| 391/424 [01:13<00:00, 58.63it/s, est. speed input: 11901.19 toks/s, output: 888.64 toks/s]
Processed prompts:  94%|█████████▍| 398/424 [01:13<00:00, 57.02it/s, est. speed input: 12113.52 toks/s, output: 908.23 toks/s]
Processed prompts:  95%|█████████▌| 404/424 [01:13<00:00, 57.02it/s, est. speed input: 12243.45 toks/s, output: 923.25 toks/s]
Processed prompts:  97%|█████████▋| 410/424 [01:13<00:00, 53.89it/s, est. speed input: 12449.89 toks/s, output: 941.26 toks/s]
Processed prompts:  98%|█████████▊| 416/424 [01:14<00:00, 54.98it/s, est. speed input: 12632.50 toks/s, output: 957.50 toks/s]
Processed prompts: 100%|█████████▉| 422/424 [01:14<00:00, 36.80it/s, est. speed input: 12756.42 toks/s, output: 978.48 toks/s]
Processed prompts: 100%|██████████| 424/424 [01:14<00:00,  5.69it/s, est. speed input: 12818.75 toks/s, output: 983.39 toks/s]
{  "personalized_answer": "Your question touches on a profound theological issue that has puzzled many throughout history. The concept of divine sovereignty and human responsibility is indeed complex. In the Bible, we see examples where God makes decisions that are beyond our control, yet we are still held accountable for our actions. For instance, in the case of Job, God allowed Satan to test Job, but Job remained faithful (Job 1-2). Similarly, in the story of Noah, God chose Noah to build the ark, but Noah still had to follow God's instructions (Genesis 6-7). This duality suggests that while God has ultimate control, He also gives us free will to make choices. Romans 9:20-21 provides insight: 'But who are you, O man, to talk back to God? Shall what is formed say to the one who formed it, "Why did you make me like this?" ' This passage implies that even when we don't understand God's reasons, we are still responsible for our actions. So, while God's decisions are beyond our control, our choices and responses to those decisions are within our realm of responsibility."}
Invalid JSON
{  "personalized_answer": "Given your interest in historical storytelling and vivid narration, you might find that 'Making my Day' in the office can be approached with a touch of historical flair. Consider using the 'Historical Present' technique to bring your workday to life. For example, you could write: 'As I sit down at my desk, the morning light filters through the blinds, casting a warm glow on my computer screen. The sound of the printer in the next room is a familiar rhythm, and the smell of fresh coffee wafts from the break room. Suddenly, a colleague bursts in, "Hey, do you have a minute? I need some help with this report." And so, the day begins with a burst of energy and collaboration.' This approach not only makes the narrative more engaging but also reflects the dynamic and sometimes chaotic nature of a typical workday. Remember, the key is to use it sparingly and to enhance the storytelling rather than detract from it."}
Invalid JSON
None

Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  50%|█████     | 1/2 [00:02<00:02,  2.45s/it, est. speed input: 1822.86 toks/s, output: 68.90 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:02<00:00,  1.22s/it, est. speed input: 2352.74 toks/s, output: 130.98 toks/s]
Processed prompts: 100%|██████████| 2/2 [00:02<00:00,  1.41s/it, est. speed input: 2352.74 toks/s, output: 130.98 toks/s]
[rank0]:[W715 12:31:33.917298087 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Experiment complete! Output can be found at data/out/rag/full_profile/sc_rag_full_profile_test_10_limit_6_output.json
Cleaned temporary files.
